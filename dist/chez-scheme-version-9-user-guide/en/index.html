<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="author" content="Cisco Systems, Inc.">
<link rel="icon" type="image/x-icon" href="images/favicon.ico">
<title>Chez Scheme Version 9 User&#8217;s Guide</title>
<link rel="stylesheet" href="../../theme/default/asciidoctor.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Chez Scheme Version 9 User&#8217;s Guide</h1>
<div class="details">
<span id="author" class="author">Cisco Systems, Inc.</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#preface">Preface</a></li>
<li><a href="#chp_1">Chapter 1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#section_1.1.">Section 1.1. Chez Scheme Syntax</a></li>
<li><a href="#section_1.2.">Section 1.2. Notational Conventions</a></li>
<li><a href="#section_1.3.">Section 1.3. Parameters</a></li>
<li><a href="#section_1.4.">Section 1.4. More Information</a></li>
</ul>
</li>
<li><a href="#chp_2">Chapter 2. Using Chez Scheme</a>
<ul class="sectlevel2">
<li><a href="#section_2.1.">Section 2.1. Interacting with Chez Scheme</a></li>
<li><a href="#section_2.2.">Section 2.2. Expression Editor</a></li>
<li><a href="#section_2.3.">Section 2.3. The Interaction Environment</a></li>
<li><a href="#section_2.4.">Section 2.4. Using Libraries and Top-Level Programs</a></li>
<li><a href="#section_2.5.">Section 2.5. Scheme Shell Scripts</a></li>
<li><a href="#section_2.6.">Section 2.6. Optimization</a></li>
<li><a href="#section_2.7.">Section 2.7. Customization</a></li>
<li><a href="#section_2.8.">Section 2.8. Building and Distributing Applications</a></li>
<li><a href="#section_2.9.">Section 2.9. Command-Line Options</a></li>
</ul>
</li>
<li><a href="#chp_3">Chapter 3. Debugging</a>
<ul class="sectlevel2">
<li><a href="#section_3.1.">Section 3.1. Tracing</a></li>
<li><a href="#section_3.2.">Section 3.2. The Interactive Debugger</a></li>
<li><a href="#section_3.3.">Section 3.3. The Interactive Inspector</a></li>
<li><a href="#section_3.4.">Section 3.4. The Object Inspector</a></li>
<li><a href="#section_3.5.">Section 3.5. Locating objects</a></li>
<li><a href="#section_3.6.">Section 3.6. Nested object size and composition</a></li>
</ul>
</li>
<li><a href="#chp_4">Chapter 4. Foreign Interface</a>
<ul class="sectlevel2">
<li><a href="#section_4.1.">Section 4.1. Subprocess Communication</a></li>
<li><a href="#section_4.2.">Section 4.2. Calling out of Scheme</a></li>
<li><a href="#section_4.3.">Section 4.3. Calling into Scheme</a></li>
<li><a href="#section_4.4.">Section 4.4. Continuations and Foreign Calls</a></li>
<li><a href="#section_4.5.">Section 4.5. Foreign Data</a></li>
<li><a href="#section_4.6.">Section 4.6. Providing Access to Foreign Procedures</a></li>
<li><a href="#section_4.7.">Section 4.7. Using Other Foreign Languages</a></li>
<li><a href="#section_4.8.">Section 4.8. C Library Routines</a></li>
<li><a href="#section_4.9.">Section 4.9. Example: Socket Operations</a></li>
</ul>
</li>
<li><a href="#chp_5">Chapter 5. Binding Forms</a>
<ul class="sectlevel2">
<li><a href="#section_5.1.">Section 5.1. Definitions</a></li>
<li><a href="#section_5.2.">Section 5.2. Multiple-value Definitions</a></li>
<li><a href="#section_5.3.">Section 5.3. Recursive Bindings</a></li>
<li><a href="#section_5.4.">Section 5.4. Fluid Bindings</a></li>
<li><a href="#section_5.5.">Section 5.5. Top-Level Bindings</a></li>
</ul>
</li>
<li><a href="#chp_6">Chapter 6. Control Structures</a>
<ul class="sectlevel2">
<li><a href="#section_6.1.">Section 6.1. Conditionals</a></li>
<li><a href="#section_6.2.">Section 6.2. Mapping and Folding</a></li>
<li><a href="#section_6.3.">Section 6.3. Continuations</a></li>
<li><a href="#section_6.4.">Section 6.4. Engines</a></li>
</ul>
</li>
<li><a href="#chp_7">Chapter 7. Operations on Objects</a>
<ul class="sectlevel2">
<li><a href="#section_7.1.">Section 7.1. Missing R6RS Type Predicates</a></li>
<li><a href="#section_7.2.">Section 7.2. Pairs and Lists</a></li>
<li><a href="#section_7.3.">Section 7.3. Characters</a></li>
<li><a href="#section_7.4.">Section 7.4. Strings</a></li>
<li><a href="#section_7.5.">Section 7.5. Vectors</a></li>
<li><a href="#section_7.6.">Section 7.6. Fixnum-Only Vectors</a></li>
<li><a href="#section_7.7.">Section 7.7. Bytevectors</a></li>
<li><a href="#section_7.8.">Section 7.8. Boxes</a></li>
<li><a href="#section_7.9.">Section 7.9. Symbols</a></li>
<li><a href="#section_7.10.">Section 7.10. Void</a></li>
<li><a href="#section_7.11.">Section 7.11. Sorting</a></li>
<li><a href="#section_7.12.">Section 7.12. Hashtables</a></li>
<li><a href="#section_7.13.">Section 7.13. Record Types</a></li>
<li><a href="#section_7.14.">Section 7.14. Record Equality and Hashing</a></li>
<li><a href="#section_7.15.">Section 7.15. Legacy Record Types</a></li>
<li><a href="#section_7.16.">Section 7.16. Procedures</a></li>
</ul>
</li>
<li><a href="#chp_8">Chapter 8. Numeric Operations</a>
<ul class="sectlevel2">
<li><a href="#section_8.1.">Section 8.1. Numeric Type Predicates</a></li>
<li><a href="#section_8.2.">Section 8.2. Fixnum Operations</a></li>
<li><a href="#section_8.3.">Section 8.3. Flonum Operations</a></li>
<li><a href="#section_8.4.">Section 8.4. Inexact Complex Operations</a></li>
<li><a href="#section_8.5.">Section 8.5. Bitwise and Logical Operators</a></li>
<li><a href="#section_8.6.">Section 8.6. Random Number Generation</a></li>
<li><a href="#section_8.7.">Section 8.7. Miscellaneous Numeric Operations</a></li>
</ul>
</li>
<li><a href="#chp_9">Chapter 9. Input/Output Operations</a>
<ul class="sectlevel2">
<li><a href="#section_9.1.">Section 9.1. Generic Ports</a></li>
<li><a href="#section_9.2.">Section 9.2. File Options</a></li>
<li><a href="#section_9.3.">Section 9.3. Transcoders</a></li>
<li><a href="#section_9.4.">Section 9.4. Port Operations</a></li>
<li><a href="#section_9.5.">Section 9.5. String Ports</a></li>
<li><a href="#section_9.6.">Section 9.6. File Ports</a></li>
<li><a href="#section_9.7.">Section 9.7. Custom Ports</a></li>
<li><a href="#section_9.8.">Section 9.8. Input Operations</a></li>
<li><a href="#section_9.9.">Section 9.9. Output Operations</a></li>
<li><a href="#section_9.10.">Section 9.10. Input/Output Operations</a></li>
<li><a href="#section_9.11.">Section 9.11. Non-Unicode Bytevector/String Conversions</a></li>
<li><a href="#section_9.12.">Section 9.12. Pretty Printing</a></li>
<li><a href="#section_9.13.">Section 9.13. Formatted Output</a></li>
<li><a href="#section_9.14.">Section 9.14. Input/Output Control Operations</a></li>
<li><a href="#section_9.15.">Section 9.15. Fasl Output</a></li>
<li><a href="#section_9.16.">Section 9.16. File System Interface</a></li>
<li><a href="#section_9.17.">Section 9.17. Generic Port Examples</a></li>
</ul>
</li>
<li><a href="#chp_10">Chapter 10. Libraries and Top-level Programs</a>
<ul class="sectlevel2">
<li><a href="#section_10.1.">Section 10.1. Built-in Libraries</a></li>
<li><a href="#section_10.2.">Section 10.2. Running Top-level Programs</a></li>
<li><a href="#section_10.3.">Section 10.3. Library and Top-level Program Forms</a></li>
<li><a href="#section_10.4.">Section 10.4. Standalone import and export forms</a></li>
<li><a href="#section_10.5.">Section 10.5. Explicitly invoking libraries</a></li>
<li><a href="#section_10.6.">Section 10.6. Library Parameters</a></li>
<li><a href="#section_10.7.">Section 10.7. Library Inspection</a></li>
</ul>
</li>
<li><a href="#chp_11">Chapter 11. Syntactic Extension and Modules</a>
<ul class="sectlevel2">
<li><a href="#section_11.1.">Section 11.1. Fluid Keyword Bindings</a></li>
<li><a href="#section_11.2.">Section 11.2. Syntax-Rules Transformers</a></li>
<li><a href="#section_11.3.">Section 11.3. Syntax-Case Transformers</a></li>
<li><a href="#section_11.4.">Section 11.4. Compile-time Values and Properties</a></li>
<li><a href="#section_11.5.">Section 11.5. Modules</a></li>
<li><a href="#section_11.6.">Section 11.6. Standalone import and export forms</a></li>
<li><a href="#section_11.7.">Section 11.7. Built-in Modules</a></li>
<li><a href="#section_11.8.">Section 11.8. Meta Definitions</a></li>
<li><a href="#section_11.9.">Section 11.9. Conditional expansion</a></li>
<li><a href="#section_11.10.">Section 11.10. Aliases</a></li>
<li><a href="#section_11.11.">Section 11.11. Annotations</a></li>
<li><a href="#section_11.12.">Section 11.12. Source Tables</a></li>
</ul>
</li>
<li><a href="#chp_12">Chapter 12. System Operations</a>
<ul class="sectlevel2">
<li><a href="#section_12.1.">Section 12.1. Exceptions</a></li>
<li><a href="#section_12.2.">Section 12.2. Interrupts</a></li>
<li><a href="#section_12.3.">Section 12.3. Environments</a></li>
<li><a href="#section_12.4.">Section 12.4. Compilation, Evaluation, and Loading</a></li>
<li><a href="#section_12.5.">Section 12.5. Source Directories and Files</a></li>
<li><a href="#section_12.6.">Section 12.6. Compiler Controls</a></li>
<li><a href="#section_12.7.">Section 12.7. Profiling</a></li>
<li><a href="#section_12.8.">Section 12.8. Waiter Customization</a></li>
<li><a href="#section_12.9.">Section 12.9. Transcript Files</a></li>
<li><a href="#section_12.10.">Section 12.10. Times and Dates</a></li>
<li><a href="#section_12.11.">Section 12.11. Timing and Statistics</a></li>
<li><a href="#section_12.12.">Section 12.12. Cost Centers</a></li>
<li><a href="#section_12.13.">Section 12.13. Parameters</a></li>
<li><a href="#section_12.14.">Section 12.14. Virtual registers</a></li>
<li><a href="#section_12.15.">Section 12.15. Environmental Queries and Settings</a></li>
<li><a href="#section_12.16.">Section 12.16. Subset Modes</a></li>
</ul>
</li>
<li><a href="#chp_13">Chapter 13. Storage Management</a>
<ul class="sectlevel2">
<li><a href="#section_13.1.">Section 13.1. Garbage Collection</a></li>
<li><a href="#section_13.2.">Section 13.2. Weak Pairs, Ephemeron Pairs, and Guardians</a></li>
<li><a href="#section_13.3.">Section 13.3. Locking Objects</a></li>
</ul>
</li>
<li><a href="#chp_14">Chapter 14. Expression Editor</a>
<ul class="sectlevel2">
<li><a href="#section_14.1.">Section 14.1. Expression Editor Parameters</a></li>
<li><a href="#section_14.2.">Section 14.2. Key Binding</a></li>
<li><a href="#section_14.3.">Section 14.3. Editing Commands</a></li>
<li><a href="#section_14.4.">Section 14.4. Creating New Editing Commands</a></li>
</ul>
</li>
<li><a href="#chp_15">Chapter 15. Thread System</a>
<ul class="sectlevel2">
<li><a href="#section_15.1.">Section 15.1. Thread Creation</a></li>
<li><a href="#section_15.2.">Section 15.2. Mutexes</a></li>
<li><a href="#section_15.3.">Section 15.3. Conditions</a></li>
<li><a href="#section_15.4.">Section 15.4. Locks</a></li>
<li><a href="#section_15.5.">Section 15.5. Locked increment and decrement</a></li>
<li><a href="#section_15.6.">Section 15.6. Reference counting with ftype guardians</a></li>
<li><a href="#section_15.7.">Section 15.7. Thread Parameters</a></li>
<li><a href="#section_15.8.">Section 15.8. Buffered I/O</a></li>
<li><a href="#section_15.9.">Section 15.9. Example: Bounded Queues</a></li>
</ul>
</li>
<li><a href="#chp_16">Chapter 16. Compatibility Features</a>
<ul class="sectlevel2">
<li><a href="#section_16.1.">Section 16.1. Hash Tables</a></li>
<li><a href="#section_16.2.">Section 16.2. Extend-Syntax Macros</a></li>
<li><a href="#section_16.3.">Section 16.3. Structures</a></li>
<li><a href="#section_16.4.">Section 16.4. Compatibility File</a></li>
</ul>
</li>
<li><a href="#bibliography">Bibliography</a></li>
<li><a href="#summary_of_forms">Summary of Forms</a></li>
<li><a href="#index">Index</a></li>
<li><a href="#_book_converting_tools">Appendix A: Book Converting Tools</a></li>
<li><a href="#_format_javascript_and_replacement_regex_for_the_original_book">Appendix B: Format Javascript and Replacement Regex for The Original Book</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock text-center">
<div class="content">
<img src="images/logo.png" alt="logo">
</div>
</div>
<div class="paragraph">
<p><a href="http://cisco.github.io/ChezScheme/csug9.5/index.html">Chez Scheme Version 9 User&#8217;s Guide</a><br>
Copyright © 2020 Cisco Systems, Inc.<br>
Licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License Version 2.0</a> (<a href="http://cisco.github.io/ChezScheme/csug9.5/canned/copyright.html">full copyright notice</a>.).<br>
Revised August 2020 for Chez Scheme Version 9.5.4<br>
<a href="http://cisco.github.io/ChezScheme/csug9.5/canned/about.html">about this book</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="preface">Preface</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Chez Scheme</em> is both a general-purpose programming language and an implementation of that language, with supporting tools and documentation. As a superset of the language described in the Revised<sup>6</sup> Report on Scheme (R6RS), <em>Chez Scheme</em> supports all standard features of Scheme, including first-class procedures, proper treatment of tail calls, continuations, user-defined records, libraries, exceptions, and hygienic macro expansion. <em>Chez Scheme</em> supports numerous non-R6RS features. A few of these are local and top-level modules, local import, foreign datatypes and procedures, nonblocking I/O, an interactive top-level, compile-time values and properties, pretty-printing, and formatted output.</p>
</div>
<div class="paragraph">
<p>The implementation includes a compiler that generates native code for each processor upon which it runs along with a run-time system that provides automatic storage management, foreign-language interfaces, source-level debugging, profiling support, and an extensive run-time library.</p>
</div>
<div class="paragraph">
<p>The threaded versions of <em>Chez Scheme</em> support native threads, allowing Scheme programs to take advantage of multiprocessor or multiple-core systems. Nonthreaded versions are also available and are faster for single-threaded applications. Both 32-bit and 64-bit versions are available for some platforms. The 64-bit versions support larger heaps, while the 32-bit versions are faster for some applications.</p>
</div>
<div class="paragraph">
<p><em>Chez Scheme</em>'s interactive programming system includes an expression editor that, like many shells, supports command-line editing, a history mechanism, and command completion. Unlike most shells that support command-line editing, the expression editor properly supports multiline expressions.</p>
</div>
<div class="paragraph">
<p><em>Chez Scheme</em> is intended to be as reliable and efficient as possible, with reliability taking precedence over efficiency if necessary. Reliability means behaving as designed and documented. While a <em>Chez Scheme</em> program can always fail to work properly because of a bug in the program, it should never fail because of a bug in the <em>Chez Scheme</em> implementation. Efficiency means performing at a high level, consuming minimal CPU time and memory. Performance should be balanced across features, across run time and compile time, and across programs and data of different sizes. These principles guide <em>Chez Scheme</em> language and tool design as well as choice of implementation technique; for example, a language feature or debugging hook might not exist in <em>Chez Scheme</em> because its presence would reduce reliability, efficiency, or both.</p>
</div>
<div class="paragraph">
<p>The compiler has been rewritten for Version 9 and generates substantially faster code than the earlier compiler at the cost of greater compile time. This is the primary difference between Versions 8 and 9.</p>
</div>
<div class="paragraph">
<p>This book (CSUG) is a companion to <a href="../../the-scheme-programming-language-4th/en/index.html">The Scheme Programming Language, 4th Edition</a> (TSPL4). TSPL4 serves as an introduction to and reference for R6RS, while CSUG describes <em>Chez Scheme</em> features and tools that are not part of R6RS. For the reader&#8217;s convenience, the summary of forms and index at the back of this book contain entries from both books, with each entry from TSPL4 marked with a "t" in front of its page number. In the online version, the page numbers given in the summary of forms and index double as direct links into one of the documents or the other.</p>
</div>
<div class="paragraph">
<p>Additional documentation for <em>Chez Scheme</em> includes release notes, a manual page, and a number of published papers and articles that describe various aspects of the system&#8217;s design and implementation.</p>
</div>
<div class="paragraph">
<p>Thank you for using <em>Chez Scheme</em>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chp_1">Chapter 1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This book describes <em>Chez Scheme</em> extensions to the Revised<sup>6</sup> Report on Scheme <a href="#ref28">[28]</a> (R6RS). It contains as well a concise summary of standard and <em>Chez Scheme</em> forms and procedures, which gives the syntax of each form and the number and types of arguments accepted by each procedure. Details on standard R6RS features can be found in <a href="../../the-scheme-programming-language-4th/en/index.html">The Scheme Programming Language, 4th Edition</a> (TSPL4) <a href="#ref11">[11]</a> or the Revised<sup>6</sup> Report on Scheme. <a href="../../the-scheme-programming-language-4th/en/index.html">The Scheme Programming Language, 4th Edition</a> also contains an extensive introduction to the Scheme language and numerous short and extended examples.</p>
</div>
<div class="paragraph">
<p>Most of this document also applies equally to <em>Petite Chez Scheme</em>, which is fully compatible with the complete <em>Chez Scheme</em> system but uses a high-speed interpreter in place of <em>Chez Scheme</em>'s incremental native-code compiler. Programs written for <em>Chez Scheme</em> run unchanged in <em>Petite Chez Scheme</em> as long as they do not require the compiler to be invoked. In fact, <em>Petite Chez Scheme</em> is built from the same sources as <em>Chez Scheme</em>, with all but the compiler sources included. A detailed discussion of the impact of this distinction appears in <a href="#section_2.8.">Section 2.8</a>.</p>
</div>
<div class="paragraph">
<p>The remainder of this chapter covers <em>Chez Scheme</em> extensions to Scheme syntax (<a href="#section_1.1.">Section 1.1</a>), notational conventions used in this book (<a href="#section_1.2.">Section 1.2</a>), the use of parameters for system customization (<a href="#section_1.3.">Section 1.3</a>), and where to look for more information on <em>Chez Scheme</em> (<a href="#section_1.4.">Section 1.4</a>).</p>
</div>
<div class="paragraph">
<p><a href="#chp_2">Chapter 2</a> describes how one uses <em>Chez Scheme</em> for program development, scripting, and application delivery, plus how to get the compiler to generate the most efficient code possible. <a href="#chp_3">Chapter 3</a> describes debugging and object inspection facilities. <a href="#chp_4">Chapter 4</a> documents facilities for interacting with separate processes or code written in other languages. <a href="#chp_5">Chapter 5</a> describes binding forms. <a href="#chp_6">Chapter 6</a> documents control structures. <a href="#chp_7">Chapter 7</a> documents operations on nonnumeric objects, while <a href="#chp_8">Chapter 8</a> documents various numeric operations, including efficient type-specific operations. <a href="#chp_9">Chapter 9</a> describes input/output operations and generic ports, which allow the definition of ports with arbitrary input/output semantics. <a href="#chp_10">Chapter 10</a> discusses how R6RS libraries and top-level programs are loaded into <em>Chez Scheme</em> along with various features for controlling and tracking the loading process. <a href="#chp_11">Chapter 11</a> describes syntactic extension and modules. <a href="#chp_12">Chapter 12</a> describes system operations, such as operations for interacting with the operating system and customizing <em>Chez Scheme</em>'s user interface. <a href="#chp_13">Chapter 13</a> describes how to invoke and control the storage management system and documents guardians and weak pairs. <a href="#chp_14">Chapter 14</a> describes <em>Chez Scheme</em>'s expression editor and how it can be customized. <a href="#chp_15">Chapter 15</a> documents the procedures and syntactic forms that comprise the interface to <em>Chez Scheme</em>'s native thread system. Finally, <a href="#chp_16">Chapter 16</a> describes various compatibility features.</p>
</div>
<div class="paragraph">
<p>The back of this book contains a bibliography, the summary of forms, and an index. The page numbers appearing in the summary of forms and the italicized page numbers appearing in the index indicate the locations in the text where forms and procedures are formally defined. The summary of forms and index includes entries from TSPL4, so that they cover the entire set of <em>Chez Scheme</em> features. A TSPL4 entry is marked by a "t" prefix on the page number.</p>
</div>
<div class="paragraph">
<p>Online versions and errata for this book and for TSPL4 can be found at www.scheme.com.</p>
</div>
<div class="paragraph">
<p><em>Acknowledgments:</em> Michael Adams, Mike Ashley, Carl Bruggeman, Bob Burger, Sam Daniel, George Davidson, Matthew Flatt, Aziz Ghuloum, Bob Hieb, Andy Keep, and Oscar Waddell have contributed substantially to the development of <em>Chez Scheme</em>. <em>Chez Scheme</em>'s expression editor is based on a command-line editor for Scheme developed from 1989 through 1994 by C. David Boyer. File compression is performed with the use of the lz4 compression library developed by Yann Collet or the zlib compression library developed by Jean-loup Gailly and Mark Adler. Implementations of the list and vector sorting routines are based on Olin Shiver&#8217;s opportunistic merge-sort algorithm and implementation. Michael Lenaghan provided a number of corrections for earlier drafts of this book. Many of the features documented in this book were suggested by current <em>Chez Scheme</em> users, and numerous comments from users have also led to improvements in the text. Additional suggestions for improvements to <em>Chez Scheme</em> and to this book are welcome.</p>
</div>
<div class="sect2">
<h3 id="section_1.1.">Section 1.1. Chez Scheme Syntax</h3>
<div class="paragraph">
<p><em>Chez Scheme</em> extends Scheme&#8217;s syntax both at the object (datum) level and at the level of syntactic forms. At the object level, <em>Chez Scheme</em> supports additional representations for symbols that contain nonstandard characters, nondecimal numbers expressed in floating-point and scientific notation, vectors with explicit lengths, shared and cyclic structures, records, boxes, and more. These extensions are described below. Form-level extensions are described throughout the book and summarized in the Summary of Forms, which also appears in the back of this book.</p>
</div>
<div class="paragraph">
<p><em>Chez Scheme</em> extends the syntax of identifiers in several ways. First, the sequence of characters making up an identifier&#8217;s name may start with digits, periods, plus signs, and minus signs as long as the sequence cannot be parsed as a number. For example, <code>0abc</code>, <code>+++</code>, and <code>..</code> are all valid identifiers in <em>Chez Scheme</em>. Second, the single-character sequences <code>{</code> and <code>}</code> are identifiers. Third, identifiers containing arbitrary characters may be printed by escaping them with <code>\</code> or with <code>|</code>. <code>\</code> is used to escape a single character (except 'x', since <code>\x</code> marks the start of a hex scalar value), whereas <code>|</code> is used to escape the group of characters that follow it up through the matching <code>|</code>. For example, <code>\||\|</code> is an identifier with a two-character name consisting of the character <code>|</code> followed by the character <code>\</code>, and <code>|hit me!|</code> is an identifier whose name contains a space.</p>
</div>
<div class="paragraph">
<p>In addition, gensyms (<a href="#section_7.9.">Section 7.9</a>) are printed with <code>#{</code> and <code>}</code> brackets that enclose both the "pretty" and "unique" names, e.g., <code>#{g1426 e5g1c94g642dssw-a}</code>. They may also be printed using the pretty name only with the prefix <code>#:</code>, e.g., <code>#:g1426</code>.</p>
</div>
<div class="paragraph">
<p>Arbitrary radixes from two through 36 may be specified with the prefix <code>#<em>n</em>r</code>, where <code><em>n</em></code> is the radix. Case is not significant, so <code>#<em>n</em>R</code> may be used as well. Digit values from 10 through 35 are specified as either lower- or upper-case alphabetic characters, just as for hexadecimal numbers. For example, <code>#36rZZ</code> is \(35 × 36 + 35\), or 1295.</p>
</div>
<div class="paragraph">
<p><em>Chez Scheme</em> also permits nondecimal numbers to be printed in floating-point or scientific notation. For example, <code>#o1.4</code> is equivalent to <code>1.5</code>, and <code>#b1e10</code> is equivalent to <code>4.0</code>. Digits take precedence over exponent specifiers, so that <code>#x1e20</code> is simply the four-digit hexadecimal number equivalent to <code>7712</code>.</p>
</div>
<div class="paragraph">
<p>In addition to the standard named characters <code>#\alarm</code>, <code>#\backspace</code>, <code>#\delete</code>, <code>#\esc</code>, <code>#\linefeed</code>, <code>#\newline</code>, <code>#\page</code>, <code>#\return</code>, <code>#\space</code>, and <code>#\tab</code>, <em>Chez Scheme</em> recognizes <code>#\bel</code>, <code>#\ls</code>, <code>#\nel</code>, <code>#\nul</code>, <code>#\rubout</code>, and <code>#\vt</code> (or <code>#\vtab</code>). Characters whose scalar values are less than 256 may also be printed with an octal syntax consisting of the prefix <code>#\</code> followed by a three octal-digit sequence. For example, <code>#\000</code> is equivalent to <code>#\nul</code>.</p>
</div>
<div class="paragraph">
<p><em>Chez Scheme</em>'s fxvectors, or fixnum vectors, are printed like vectors but with the prefix <code>#vfx(</code> in place of <code>#(</code>. Vectors, bytevectors, and fxvectors may be printed with an explicit length prefix, and when the explicit length prefix is specified, duplicate trailing elements may be omitted. For example, <code>\#(a b c)</code> may be printed as <code>#3(a b c)</code>, and a vector of length 100 containing all zeros may be printed as <code>#100(0)</code>.</p>
</div>
<div class="paragraph">
<p><em>Chez Scheme</em>'s boxes are printed with a <code>#&amp;</code> prefix, e.g., <code>#&amp;17</code> is a box containing the integer <code>17</code>.</p>
</div>
<div class="paragraph">
<p>Records are printed with the syntax <code>#[<em>type-name</em> <em>field</em> ...]</code>, where the symbol <code><em>type-name</em></code> is the name of the record type and <code><em>field</em> ...</code> are the printed representations for the contents of the fields of the record.</p>
</div>
<div class="paragraph">
<p>Shared and cyclic structure may be printed using the graph mark and reference prefixes <code>#<em>n</em>=</code> and <code>#<em>n</em>#</code>. <code>#<em>n</em>=</code> is used to mark an item in the input, and <code>#<em>n</em>#</code> is used to refer to the item marked <code><em>n</em></code>. For example, <code>'(#1=(a) . #1#)</code> is a pair whose car and cdr contain the same list, and <code>#0=(a . #0#)</code> is a cyclic list, i.e., its cdr is itself.</p>
</div>
<div class="paragraph">
<p>A <code>$primitive</code> form (see <a href="#desc:hash-primitive">page 358</a>) may be abbreviated in the same manner as a <code>quote</code> form, using the <code>#%</code> prefix. For example, <code>#%car</code> is equivalent to <code>($primitive car)</code>, <code>#2%car</code> to <code>($primitive 2 car)</code>, and <code>#3%car</code> to <code>($primitive 3 car)</code>.</p>
</div>
<div class="paragraph">
<p><em>Chez Scheme</em>'s end-of-file object is printed <code>#!eof</code>. If the end-of-file object appears outside of any datum within a file being loaded, <code>load</code> will treat it as if it were a true end of file and stop loading at that point. Inserting <code>#!eof</code> into the middle of a file can thus be handy when tracking down a load-time error.</p>
</div>
<div class="paragraph">
<p>Broken pointers in weak pairs (see <a href="#desc:weak-cons">page 406</a>) are represented by the <em>broken weak pointer</em> object, which is printed <code>#!bwp</code>.</p>
</div>
<div class="paragraph">
<p>In addition to the standard delimiters (whitespace, open and close parentheses, open and close brackets, double quotes, semi-colon, and <code>#</code>), <em>Chez Scheme</em> also treats as delimiters open and close braces, single quote, backward quote, and comma.</p>
</div>
<div class="paragraph">
<p>The <em>Chez Scheme</em> lexical extensions described above are disabled in an input stream after an <code>#!r6rs</code> comment directive has been seen, unless a <code>#!chezscheme</code> comment directive has been seen since. Each library loaded implicitly via <code>import</code> and each RNRS top-level program loaded via the <code>--program</code> command-line option, the <code>scheme-script</code> command, or the <code>load-program</code> procedure is treated as if it begins implicitly with an <code>#!r6rs</code> comment directive.</p>
</div>
<div class="paragraph">
<p>The case of symbol and character names is normally significant, as required by the Revised<sup>6</sup> Report. Names are folded, as if by <code>string-foldcase</code>, following a <code>#!fold-case</code> comment directive in the same input stream unless a <code>#!no-fold-case</code> has been seen since. Names are also folded if neither directive has been seen and the parameter <code>case-sensitive</code> has been set to <code>#f</code>.</p>
</div>
<div class="paragraph">
<p>The printer invoked by <code>write</code>, <code>put-datum</code>, <code>pretty-print</code>, and the <code>format</code> <code>~s</code> option always prints standard Revised<sup>6</sup> Report objects using the standard syntax, unless a different behavior is requested via the setting of one of the print parameters. For example, it prints symbols in the extended identifier syntax of Chez Scheme described above using hex scalar value escapes, unless the parameter <code>print-extended-identifiers</code> is set to true. Similarly, it does not print the explicit length or suppress duplicate trailing elements unless the parameter <code>print-vector-length</code> is set to true.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_1.2.">Section 1.2. Notational Conventions</h3>
<div class="paragraph">
<p>This book follows essentially the same notational conventions as <a href="../../the-scheme-programming-language-4th/en/index.html">The Scheme Programming Language, 4th Edition</a>. These conventions are repeated below, with notes specific to <em>Chez Scheme</em>.</p>
</div>
<div class="paragraph">
<p>When the value produced by a procedure or syntactic form is said to be <em>unspecified</em>, the form or procedure may return any number of values, each of which may be any Scheme object. <em>Chez Scheme</em> usually returns a single, unique <em>void</em> object (see <code>void</code>) whenever the result is unspecified; avoid counting on this behavior, however, especially if your program may be ported to another Scheme implementation. Printing of the void object is suppressed by <em>Chez Scheme</em>'s waiter (read-evaluate-print loop).</p>
</div>
<div id="intro:s33" class="paragraph">
<p>This book uses the words "must" and "should" to describe program requirements, such as the requirement to provide an index that is less than the length of the vector in a call to <code>vector-ref</code>. If the word "must" is used, it means that the requirement is enforced by the implementation, i.e., an exception is raised, usually with condition type <code>&amp;assertion</code>. If the word "should" is used, an exception may or may not be raised, and if not, the behavior of the program is undefined. The phrase "syntax violation" is used to describe a situation in which a program is malformed. Syntax violations are detected prior to program execution. When a syntax violation is detected, an exception of type <code>&amp;syntax</code> is raised and the program is not executed.</p>
</div>
<div class="paragraph">
<p>Scheme objects are displayed in a <code>typewriter</code> typeface just as they are to be typed at the keyboard. This includes identifiers, constant objects, parenthesized Scheme expressions, and whole programs. An <em>italic</em> typeface is used to set off syntax variables in the descriptions of syntactic forms and arguments in the descriptions of procedures. Italics are also used to set off technical terms the first time they appear. The first letter of an identifier that is not ordinarily capitalized is not capitalized when it appears at the beginning of a sentence. The same is true for syntax variables written in italics.</p>
</div>
<div class="paragraph">
<p>In the description of a syntactic form or procedure, a pattern shows the syntactic form or the application of the procedure. The syntax keyword or procedure name is given in typewriter font, as are parentheses. The remaining pieces of the syntax or arguments are shown in italics, using names that imply the types of the expressions or arguments expected by the syntactic form or procedure. Ellipses are used to specify zero or more occurrences of a subexpression or argument.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_1.3.">Section 1.3. Parameters</h3>
<div id="intro:s35" class="paragraph">
<p>All <em>Chez Scheme</em> system customization is done via <em>parameters</em>. A parameter is a procedure that encapsulates a hidden state variable. When invoked without arguments, a parameter returns the value of the encapsulated variable. When invoked with one argument, the parameter changes the value of the variable to the value of its argument. A parameter may raise an exception if its argument is not appropriate, or it may filter the argument in some way.</p>
</div>
<div class="paragraph">
<p>New parameters may be created and used by programs running in <em>Chez Scheme</em>. Parameters are used rather than global variables for program customization for two reasons: First, unintentional redefinition of a customization variable can cause unexpected problems, whereas unintentional redefinition of a parameter simply makes the parameter inaccessible. For example, a program that defines <code>*print-level*</code> for its own purposes in early releases of <em>Chez Scheme</em> would have unexpected effects on the printing of Scheme objects, whereas a program that defines <code>print-level</code> for its own purposes simply loses the ability to alter the printer&#8217;s behavior. Of course, a program that invokes <code>print-level</code> by accident can still affect the system in unintended ways, but such an occurrence is less likely, and can only happen in an incorrect program.</p>
</div>
<div class="paragraph">
<p>Second, invalid values for parameters can be detected and rejected immediately when the "assignment" is made, rather than at the point where the first use occurs, when it is too late to recover and reinstate the old value. For example, an assignment of <code>*print-level*</code> to -1 would not have been caught until the first call to <code>write</code> or <code>pretty-print</code>, whereas an attempted assignment of -1 to the parameter <code>print-level</code>, i.e., <code>(print-level -1)</code>, is flagged as an error immediately, before the change is actually made.</p>
</div>
<div class="paragraph">
<p>Built-in system parameters are described in different sections throughout this book and are listed along with other syntactic forms and procedures in the Summary of Forms in the back of this book. Parameters marked "thread parameters" have per-thread values in threaded versions of <em>Chez Scheme</em>, while the values of parameters marked "global parameters" are shared by all threads. Nonthreaded versions of <em>Chez Scheme</em> do not distinguish between thread and global parameters. See Sections <a href="#section_12.13.">12.13</a> and <a href="#section_15.7.">15.7</a> for more information on creating and manipulating parameters.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_1.4.">Section 1.4. More Information</h3>
<div class="paragraph">
<p>The articles and technical reports listed below document various features of <em>Chez Scheme</em> and its implementation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>syntactic abstraction (<a href="#ref14">[14]</a>,<a href="#ref8">[8]</a>,<a href="#ref17">[17]</a>),</p>
</li>
<li>
<p>modules <a href="#ref32">[32]</a>,</p>
</li>
<li>
<p>libraries <a href="#ref21">[21]</a>,</p>
</li>
<li>
<p>storage management (<a href="#ref12">[12]</a>,<a href="#ref13">[13]</a>),</p>
</li>
<li>
<p>threads <a href="#ref10">[10]</a>,</p>
</li>
<li>
<p>multiple return values <a href="#ref2">[2]</a>,</p>
</li>
<li>
<p>optional arguments <a href="#ref16">[16]</a>,</p>
</li>
<li>
<p>continuations (<a href="#ref7">[7]</a>,<a href="#ref25">[25]</a>,<a href="#ref3">[3]</a>),</p>
</li>
<li>
<p>eq? hashtables <a href="#ref20">[20]</a>,</p>
</li>
<li>
<p>internal definitions, <code>letrec</code>, and <code>letrec*</code> (<a href="#ref33">[33]</a>,<a href="#ref22">[22]</a>),</p>
</li>
<li>
<p><code>equal?</code> <a href="#ref1">[1]</a>,</p>
</li>
<li>
<p>engines <a href="#ref15">[15]</a>,</p>
</li>
<li>
<p>floating-point printing <a href="#ref4">[4]</a>,</p>
</li>
<li>
<p>code generation <a href="#ref18">[18]</a>,</p>
</li>
<li>
<p>register allocation <a href="#ref6">[6]</a>,</p>
</li>
<li>
<p>procedure inlining <a href="#ref31">[31]</a>,</p>
</li>
<li>
<p>profiling <a href="#ref5">[5]</a>, and</p>
</li>
<li>
<p>history of the implementation <a href="#ref9">[9]</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Links to abstracts and electronic versions of these publications are available at the url <a href="http://www.cs.indiana.edu/chezscheme/pubs/" class="bare">http://www.cs.indiana.edu/chezscheme/pubs/</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chp_2">Chapter 2. Using Chez Scheme</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Chez Scheme</em> is often used interactively to support program development and debugging, yet it may also be used to create stand-alone applications with no interactive component. This chapter describes the various ways in which <em>Chez Scheme</em> is typically used and, more generally, how to get the most out of the system. Sections <a href="#section_2.1.">2.1</a>, <a href="#section_2.2.">2.2</a>, and <a href="#section_2.3.">2.3</a> describe how one uses <em>Chez Scheme</em> interactively. <a href="#section_2.4.">Section 2.4</a> discusses how libraries and RNRS top-level programs are used in <em>Chez Scheme</em>. <a href="#section_2.5.">Section 2.5</a> covers support for writing and running Scheme scripts, including compiled scripts and compiled RNRS top-level programs. <a href="#section_2.6.">Section 2.6</a> describes how to structure and compile an application to get the most efficient code possible out of the compiler. <a href="#section_2.7.">Section 2.7</a> describes how one can customize the startup process, e.g., to alter or eliminate the command-line options, to preload Scheme or foreign code, or to run <em>Chez Scheme</em> as a subordinate program of another program. <a href="#section_2.8.">Section 2.8</a> describes how to build applications using <em>Chez Scheme</em> with <em>Petite Chez Scheme</em> for run-time support. Finally, <a href="#section_2.9.">Section 2.9</a> covers command-line options used when invoking <em>Chez Scheme</em>.</p>
</div>
<div class="sect2">
<h3 id="section_2.1.">Section 2.1. Interacting with Chez Scheme</h3>
<div class="paragraph">
<p>One of the simplest and most effective ways to write and test Scheme programs is to compose them using a text editor, like <code>vi</code> or <code>emacs</code>, and test them interactively with <em>Chez Scheme</em> running in a shell window. When <em>Chez Scheme</em> is installed with default options, entering the command <code>scheme</code> at the shell&#8217;s prompt starts an interactive Scheme session. The command <code>petite</code> does the same for <em>Petite Chez Scheme</em>. After entering this command, you should see a short greeting followed by an angle-bracket on a line by itself, like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">Chez Scheme Version 9.5.1
Copyright 1984-2017 Cisco Systems, Inc.

></code></pre>
</div>
</div>
<div class="paragraph">
<p>You also should see that the cursor is sitting one space to the right of the angle-bracket. The angle-bracket is a prompt issued by the system&#8217;s "REPL," which stands for "Read Eval Print Loop," so called because it reads, evaluates, and prints an expression, then loops back to read, evaluate, and print the next, and so on. (In <em>Chez Scheme</em>, the REPL is also called a waiter.)</p>
</div>
<div class="paragraph">
<p>In response to the prompt, you can type any Scheme expression. If the expression is well-formed, the REPL will run the expression and print the value. Here are a few examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> 3
3
> (+ 3 4)
7
> (cons 'a '(b c d))
(a b c d)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The reader used by the REPL is more sophisticated than an ordinary reader. In fact, it&#8217;s a full-blown "expression editor" ("expeditor" for short) like a regular text editor but for just one expression at a time. One thing you might soon notice is that the system automatically indents the second and subsequent lines of an expression. For example, let&#8217;s say we want to define <code>fact</code>, a procedure that implements the factorial function. If we type <code>(define fact</code> followed by the enter key, the cursor should be sitting under the first <code>e</code> in <code>define</code>, so that if we then type <code>(lambda (x)</code>, we should see:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (define fact
    (lambda (x)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The expeditor also allows us to move around within the expression (even across lines) and edit the expression to correct mistakes. After typing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (define fact
    (lambda (x)
      (if (= n 0)
          0
          (* n (fact</code></pre>
</div>
</div>
<div class="paragraph">
<p>we might notice that the procedure&#8217;s argument is named <code>x</code> but we have been referencing it as <code>n</code>. We can move back to the second line using the arrow keys, remove the offending <code>x</code> with the backspace key, and replace it with <code>n</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (define fact
    (lambda (n)
      (if (= n 0)
          0
          (* n (fact</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can then return to the end of the expression with the arrow keys and complete the definition.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (define fact
    (lambda (n)
      (if (= n 0)
          0
          (* n (fact (- n 1))))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now that we have a complete form with balanced parentheses, if we hit enter with the cursor just after the final parenthesis, the expeditor will send it on to the evaluator. We&#8217;ll know that it has accepted the definition when we get another right-angle prompt.</p>
</div>
<div class="paragraph">
<p>Now we can test our definition by entering, say, <code>(fact 6)</code> in response to the prompt:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (fact 6)
0</code></pre>
</div>
</div>
<div class="paragraph">
<p>The printed value isn&#8217;t what we&#8217;d hoped for, since \(6!\) is actually 720. The problem, of course, is that the base-case return-value <code>0</code> should have been <code>1</code>. Fortunately, we don&#8217;t have to retype the definition to correct the mistake. Instead, we can use the expeditor&#8217;s history mechanism to retrieve the earlier definition. The up-arrow key moves backward through the history. In this case, the first up-arrow retrieves <code>(fact 6)</code>, and the second retrieves the <code>fact</code> definition.</p>
</div>
<div class="paragraph">
<p>As we move back through the history, the expression editor shows us only the first line, so after two up arrows, this is all we see of the definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (define fact</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can force the expeditor to show the entire expression by typing <code>^L</code> (control <code>L</code>, i.e., the control and <code>L</code> keys pressed together):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (define fact
    (lambda (n)
      (if (= n 0)
          0
          (* n (fact (- n 1))))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we can move to the fourth line and change the <code>0</code> to a <code>1</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (define fact
    (lambda (n)
      (if (= n 0)
          1
          (* n (fact (- n 1))))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>We&#8217;re now ready to enter the corrected definition. If the cursor is on the fourth line and we hit enter, however, it will just open up a new line between the old fourth and fifth lines. This is useful in other circumstances, but not now. Of course, we can work around this by using the arrow keys to move to the end of the expression, but an easier way is to type <code>^J</code>, which forces the expression to be entered immediately no matter where the cursor is.</p>
</div>
<div class="paragraph">
<p>Finally, we can bring back <code>(fact 6)</code> with another two hits of the up-arrow key and try it again:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (fact 6)
720</code></pre>
</div>
</div>
<div class="paragraph">
<p>To exit from the REPL and return back to the shell, we can type <code>^D</code> or call the <code>exit</code> procedure.</p>
</div>
<div class="paragraph">
<p>The interaction described above uses just a few of the expeditor&#8217;s features. The expeditor&#8217;s remaining features are described in the following section.</p>
</div>
<div class="paragraph">
<p>Running programs may be interrupted by typing the interrupt character (typically <code>^C</code>). In response, the system enters a debug handler, which prompts for input with a <code>break&gt;</code> prompt. One of several commands may be issued to the break handler (followed by a newline), including</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">"e"</dt>
<dd>
<p>or end-of-file to exit from the handler and continue,</p>
</dd>
<dt class="hdlist1">"r"</dt>
<dd>
<p>to stop execution and reset to the current café,</p>
</dd>
<dt class="hdlist1">"a"</dt>
<dd>
<p>to abort <em>Chez Scheme</em>,</p>
</dd>
<dt class="hdlist1">"n"</dt>
<dd>
<p>to enter a new café (see below),</p>
</dd>
<dt class="hdlist1">"i"</dt>
<dd>
<p>to inspect the current continuation,</p>
</dd>
<dt class="hdlist1">"s"</dt>
<dd>
<p>to display statistics about the interrupted program, and</p>
</dd>
<dt class="hdlist1">"?"</dt>
<dd>
<p>to display a list of these options.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>When an exception other than a warning occurs, the default exception handler prints a message that describes the exception to the console error port. If a REPL is running, the exception handler then returns to the REPL, where the programmer can call the <code>debug</code> procedure to start up the debug handler, if desired. The debug handler is similar to the break handler and allows the programmer to inspect the continuation (control stack) of the exception to help determine the cause of the problem. If no REPL is running, as is the case for a script or top-level program run via the <code>--script</code> or <code>--program</code> command-line options, the default exception handler exits from the script or program after printing the message. To allow scripts and top-level programs to be debugged, the default exception handler can be forced via the <code>debug-on-exception</code> parameter or the <code>--debug-on-exception</code> command-line option to invoke <code>debug</code> directly.</p>
</div>
<div class="paragraph">
<p>Developing a large program entirely in the REPL is unmanageable, and we usually even want to store smaller programs in a file for future use. (The expeditor&#8217;s history is saved across Scheme sessions, but there is a limit on the number of items, so it is not a good idea to count on a program remaining in the history indefinitely.) Thus, a Scheme programmer typically creates a file containing Scheme source code using a text editor, such as <code>vi</code>, and loads the file into <em>Chez Scheme</em> to test them. The conventional filename extension for <em>Chez Scheme</em> source files is <code>.ss</code>, but the file can have any extension or even no extension at all. A source file can be loaded during an interactive session by typing <code>(load "<em>path</em>")</code>. Files to be loaded can also be named on the command line when the system is started. Any form that can be typed interactively can be placed in a file to be loaded.</p>
</div>
<div class="paragraph">
<p><em>Chez Scheme</em> compiles source forms as it sees them to machine code before evaluating them, i.e., "just in time." In order to speed loading of a large file or group of files, each file can be compiled ahead of time via <code>compile-file</code>, which puts the compiled code into a separate object file. For example, <code>(compile-file "<em>path</em>")</code> compiles the forms in the file <code><em>path</em></code>.ss and places the resulting object code in the file <code><em>path</em></code>.so. Loading a pre-compiled file is essentially no different from loading the source file, except that loading is faster since compilation has already been done.</p>
</div>
<div id="use:s6" class="paragraph">
<p>When compiling a file or set of files, it is often more convenient to use a shell command than to enter <em>Chez Scheme</em> interactively to perform the compilation. This is easily accomplished by "piping" in the command to compile the file as shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">echo '(compile-file "<em>filename</em>")' | scheme -q</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>-q</code> option suppresses the system&#8217;s greeting messages for more compact output, which is especially useful when compiling numerous files. The single-quote marks surrounding the <code>compile-file</code> call should be left off for Windows shells.</p>
</div>
<div class="paragraph">
<p>When running in this "batch" mode, especially from within "make" files, it is often desirable to force the default exception handler to exit immediately to the shell with a nonzero exit status. This may be accomplished by setting the <code>reset-handler</code> to <code>abort</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">echo '(reset-handler abort) (compile-file "<em>filename</em>")' | scheme -q</code></pre>
</div>
</div>
<div class="paragraph">
<p>One can also redefine the <code>base-exception-handler</code> (<a href="#section_12.1.">Section 12.1</a>) to achieve a similar effect while exercising more control over the format of the messages that are produced.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_2.2.">Section 2.2. Expression Editor</h3>
<div class="paragraph">
<p>When Chez Scheme is used interactively in a shell window, as described above, or when <code>new-cafe</code> is invoked explicitly from a top-level program or script run via <code>--program</code> or <code>--script</code>, the waiter&#8217;s "prompt and read" procedure employs an expression editor that permits entry and editing of single- and multiple-line expressions, automatically indents expressions as they are entered, supports identifier completion outside string constants based on the identifiers defined in the interactive environment, and supports filename completion within string constants. The expression editor also maintains a history of expressions typed during and across sessions and supports tcsh-like history movement and search commands. Other editing commands include simple cursor movement via arrow keys, deletion of characters via backspace and delete, and movement, deletion, and other commands using mostly emacs key bindings.</p>
</div>
<div class="paragraph">
<p>The expression editor does not run if the TERM environment variable is not set (on Unix-based systems), if the standard input or output files have been redirected, or if the <code>--eedisable</code> command-line option (<a href="#section_2.9.">Section 2.9</a>) has been used. The history is saved across sessions, by default, in the file ".chezscheme_history" in the user&#8217;s home directory. The <code>--eehistory</code> command-line option (<a href="#section_2.9.">Section 2.9</a>) can be used to specify a different location for the history file or to disable the saving and restoring of the history file.</p>
</div>
<div class="paragraph">
<p>Keys for nearly all printing characters (letters, digits, and special characters) are "self inserting" by default. The open parenthesis, close parenthesis, open bracket, and close bracket keys are self inserting as well, but also cause the editor to "flash" to the matching delimiter, if any. Furthermore, when a close parenthesis or close bracket is typed, it is automatically corrected to match the corresponding open delimiter, if any.</p>
</div>
<div class="paragraph">
<p>Key bindings for other keys and key sequences initially recognized by the expression editor are given below, organized into groups by function. Some keys or key sequences serve more than one purpose depending upon context. For example, tab is used for identifier completion, filename completion, and indentation. Such bindings are shown in each applicable functional group.</p>
</div>
<div class="paragraph">
<p>Multiple-key sequences are displayed with hyphens between the keys of the sequences, but these hyphens should not be entered. When two or more key sequences perform the same operation, the sequences are shown separated by commas.</p>
</div>
<div class="paragraph">
<p>Detailed descriptions of the editing commands are given in <a href="#chp_14">Chapter 14</a>, which also describes parameters that allow control over the expression editor, mechanisms for adding or changing key bindings, and mechanisms for creating new commands.</p>
</div>
<div class="paragraph">
<p>Newlines, acceptance, exiting, and redisplay:</p>
</div>
<table class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">enter, <code>^M</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">accept balanced entry if used at end of entry;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">else add a newline before the cursor and indent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^J</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">accept entry unconditionally</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^O</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">insert newline after the cursor and indent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^D</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">exit from the waiter if entry is empty;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">else delete character under cursor</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^Z</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">suspend to shell if shell supports job control</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^L</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">redisplay entry</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^L</code>-<code>^L</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">clear screen and redisplay entry</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Basic movement and deletion:</p>
</div>
<table class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">leftarrow, <code>^B</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">move cursor left</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rightarrow, <code>^F</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">move cursor right</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">uparrow, <code>^P</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">move cursor up; from top of unmodified entry,</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">move to preceding history entry.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">downarrow, <code>^N</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">move cursor down; from bottom of unmodified entry,</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">move to next history entry</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^D</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">delete character under cursor if entry not empty,</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">else exit from the waiter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">backspace, <code>^H</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">delete character before cursor</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">delete</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">delete character under cursor</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Line movement and deletion:</p>
</div>
<table class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">home, <code>^A</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">move cursor to beginning of line</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">end, <code>^E</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">move cursor to end of line</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^K</code>, esc-k</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">delete to end of line or, if cursor is at the end</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">of a line, join with next line</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^U</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">delete contents of current line</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>When used on the first line of a multiline entry of which only the first line is displayed, i.e., immediately after history movement, <code>^U</code> deletes the contents of the entire entry, like <code>^G</code> (described below).</p>
</div>
<div class="paragraph">
<p>Expression movement and deletion:</p>
</div>
<table class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esc-<code>^F</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">move cursor to next expression</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esc-<code>^B</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">move cursor to preceding expression</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esc-<code>]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">move cursor to matching delimiter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">flash cursor to matching delimiter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esc-<code>^K</code>, esc-delete</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">delete next expression</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esc-backspace, esc-<code>^H</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">delete preceding expression</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Entry movement and deletion:</p>
</div>
<table class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esc-<code>&lt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">move cursor to beginning of entry</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esc-<code>&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">move cursor to end of entry</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^G</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">delete current entry contents</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^C</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">delete current entry contents; reset to end of history</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Indentation:</p>
</div>
<table class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tab</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">re-indent current line if identifier/filename prefix</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not just entered; else insert completion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esc-tab</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">re-indent current line unconditionally</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esc-<code>q</code>, esc-<code>Q</code>, esc-<code>^Q</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">re-indent each line of entry</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifier/filename completion:</p>
</div>
<table class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tab</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">insert completion if identifier/filename prefix just</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">entered; else re-indent current line</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tab-tab</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">show possible identifier/filename completions at end</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">of identifier/filename just typed, else re-indent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^R</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">insert next identifier/filename completion</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifier completion is performed outside of a string constant, and filename completion is performed within a string constant. (In determining whether the cursor is within a string constant, the expression editor looks only at the current line and so can be fooled by string constants that span multiple lines.) If at end of existing identifier or filename, i.e., not one just typed, the first tab re-indents, the second tab inserts identifier completion, and the third shows possible completions.</p>
</div>
<div class="paragraph">
<p>History movement:</p>
</div>
<table class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">uparrow, <code>^P</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">move to preceding entry if at top of unmodified</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">entry; else move up within entry</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">downarrow, <code>^N</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">move to next entry if at bottom of unmodified</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">entry; else move down within entry</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esc-uparrow, esc-<code>^P</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">move to preceding entry from unmodified entry</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esc-downarrow, esc-<code>^N</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">move to next entry from unmodified entry</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esc-p</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">search backward through history for given prefix</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esc-n</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">search forward through history for given prefix</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esc-P</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">search backward through history for given string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esc-N</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">search forward through history for given string</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>To search, enter a prefix or string followed by one of the search key sequences. Follow with additional search key sequences to search further backward or forward in the history. For example, enter "(define" followed by one or more esc-p key sequences to search backward for entries that are definitions, or "(define" followed by one or more esc-P key sequences for entries that contain definitions.</p>
</div>
<div class="paragraph">
<p>Word and page movement:</p>
</div>
<table class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esc-<code>f</code>, esc-<code>F</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">move cursor to end of next word</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esc-<code>b</code>, esc-<code>B</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">move cursor to start of preceding word</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^X</code>-<code>[</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">move cursor up one screen page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^X</code>-<code>]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">move cursor down one screen page</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Inserting saved text:</p>
</div>
<table class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^Y</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">insert most recently deleted text</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^V</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">insert contents of window selection/paste buffer</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Mark operations:</p>
</div>
<table class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^@</code>, <code>^</code>space, <code>^^</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">set mark to current cursor position</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^X</code>-<code>^X</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">move cursor to mark, leave mark at old cursor position</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^W</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">delete between current cursor position and mark</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Command repetition:</p>
</div>
<table class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esc-<code>^U</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">repeat next command four times</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esc-<code>^U</code>-<em>n</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">repeat next command <em>n</em> times</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="section_2.3.">Section 2.3. The Interaction Environment</h3>
<div id="use:s11" class="paragraph">
<p>In the language of the Revised<sup>6</sup> Report, code is structured into libraries and "top-level programs." The Revised<sup>6</sup> Report does not require an implementation to support interactive use, and it does not specify how an interactive top level should operate, leaving such details up to the implementation.</p>
</div>
<div class="paragraph">
<p>In <em>Chez Scheme</em>, when one enters definitions or expressions at the prompt or loads them from a file, they operate on an interaction environment, which is a mutable environment that initially holds bindings only for built-in keywords and primitives. It may be augmented by user-defined identifier bindings via top-level definitions. The interaction environment is also referred to as the top-level environment, because it is at the top level for purposes of scoping. Programs entered at the prompt or loaded from a file via <code>load</code> should not be confused with RNRS top-level programs, which are actually more similar to libraries in their behavior. In particular, while the same identifier can be defined multiple times in the interaction environment, to support incremental program development, an identifier can be defined at most once in an RNRS top-level program.</p>
</div>
<div class="paragraph">
<p>The default interaction environment used for any code that occurs outside of an RNRS top-level program or library (including such code typed at a prompt or loaded from a file) contains all of the bindings of the <code>(chezscheme)</code> library (or <code>scheme</code> module, which exports the same set of bindings). This set contains a number of bindings that are not in the RNRS libraries. It also contains a number of bindings that extend the RNRS counterparts in some way and are thus not strictly compatible with the RNRS bindings for the same identifiers. To replace these with bindings strictly compatible with RNRS, simply import the <code>rnrs</code> libraries into the interaction environment by typing the following into the REPL or loading it from a file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(import
  (rnrs)
  (rnrs eval)
  (rnrs mutable-pairs)
  (rnrs mutable-strings)
  (rnrs r5rs))</code></pre>
</div>
</div>
<div id="use:s12" class="paragraph">
<p>To obtain an interaction environment that contains all <em>and only</em> RNRS bindings, use the following.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(interaction-environment
  (copy-environment
    (environment
      '(rnrs)
      '(rnrs eval)
      '(rnrs mutable-pairs)
      '(rnrs mutable-strings)
      '(rnrs r5rs))
    #t))</code></pre>
</div>
</div>
<div class="paragraph">
<p>To be useful for most purposes, <code>library</code> and <code>import</code> should probably also be included, from the <code>(chezscheme)</code> library.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(interaction-environment
  (copy-environment
    (environment
      '(rnrs)
      '(rnrs eval)
      '(rnrs mutable-pairs)
      '(rnrs mutable-strings)
      '(rnrs r5rs)
      '(only (chezscheme) library import))
    #t))</code></pre>
</div>
</div>
<div class="paragraph">
<p>It might also be useful to include <code>debug</code> in the set of identifiers imported from <code>(chezscheme)</code> to allow the debugger to be entered after an exception is raised.</p>
</div>
<div class="paragraph">
<p>Most of the identifiers bound in the default interaction environment that are not strictly compatible with the Revised<sup>6</sup> Report are variables bound to procedures with extended interfaces, i.e., optional arguments or extended argument domains. The others are keywords bound to transformers that extend the Revised<sup>6</sup> Report syntax in some way. This should not be a problem except for programs that count on exceptions being raised in cases that coincide with the extensions. For example, if a program passes the <code>=</code> procedure a single numeric argument and expects an exception to be raised, it will fail in the initial interaction environment because <code>=</code> returns <code>#t</code> when passed a single numeric argument.</p>
</div>
<div class="paragraph">
<p>Within the default interaction environment and those created as described above, variables that name built-in procedures are read-only, i.e., cannot be assigned, since they resolve to the read-only bindings exported from the <code>(chezscheme)</code> library or some other library:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(set! cons +) ⇒ <em>exception: cons is immutable</em></code></pre>
</div>
</div>
<div class="paragraph">
<p>Before assigning a variable bound to the name of a built-in procedure, the programmer must first define the variable. For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define cons-count 0)
(define original-cons cons)
(define cons
  (lambda (x y)
    (set! cons-count (+ cons-count 1))
    (original-cons x y)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>redefines <code>cons</code> to count the number of times it is called, and</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(set! cons original-cons)</code></pre>
</div>
</div>
<div class="paragraph">
<p>assigns <code>cons</code> to its original value. Once a variable has been defined in the interaction environment using <code>define</code>, a subsequent definition of the same variable is equivalent to a <code>set!</code>, so</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define cons original-cons)</code></pre>
</div>
</div>
<div class="paragraph">
<p>has the same effect as the <code>set!</code> above. The expression</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(import (only (chezscheme) cons))</code></pre>
</div>
</div>
<div class="paragraph">
<p>also binds <code>cons</code> to its original value. It also returns it to its original read-only state.</p>
</div>
<div class="paragraph">
<p>The simpler redefinition</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define cons (let () (import scheme) cons))</code></pre>
</div>
</div>
<div class="paragraph">
<p>turns <code>cons</code> into a mutable variable with the same value as it originally had. Doing so, however, prevents the compiler from generating efficient code for calls to <code>cons</code> or producing warning messages when <code>cons</code> is passed the wrong number of arguments.</p>
</div>
<div class="paragraph">
<p>All identifiers not bound in the initial interaction environment and not defined by the programmer are treated as "potentially bound" as variables to facilitate the definition of mutually recursive procedures. For example, assuming that <code>yin</code> and <code>yang</code> have not been defined,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define yin (lambda () (- (yang) 1)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>defines <code>yin</code> at top level as a variable bound to a procedure that calls the value of the top-level variable <code>yang</code>, even though <code>yang</code> has not yet been defined. If this is followed by</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define yang (lambda () (+ (yin) 1)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>the result is a mutually recursive pair of procedures that, when called, will loop indefinitely or until the system runs out of space to hold the recursion stack. If <code>yang</code> must be defined as anything other than a variable, its definition should precede the definition of <code>yin</code>, since the compiler assumes <code>yang</code> is a variable in the absence of any indication to the contrary when <code>yang</code> has not yet been defined.</p>
</div>
<div id="use:s13" class="paragraph">
<p>A subtle consequence of this useful quirk of the interaction environment is that the procedure <code>free-identifier=?</code> (<a href="../../the-scheme-programming-language-4th/en/index.html#section_8.3.">Section 8.3</a> of <em>The Scheme Programming Language, 4th Edition</em>) does not consider unbound library identifiers to be equivalent to (as yet) undefined top-level identifiers, even if they have the same name, because the latter are actually assumed to be valid variable bindings.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(library (A) (export a)
  (import (rnrs))
  (define-syntax a
    (lambda (x)
      (syntax-case x ()
        [(_ id) (free-identifier=? #'id #'undefined)]))))
(let () (import (A)) (a undefined)) ⇒ #f</code></pre>
</div>
</div>
<div id="use:s14" class="paragraph">
<p>If it is necessary that they have the same binding, as in the case where an identifier is used as an auxiliary keyword in a syntactic abstraction exported from a library and used at top level, the library should define and export a binding for the identifier.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(library (A) (export a aux-a)
  (import (rnrs) (only (chezscheme) syntax-error))
  (define-syntax aux-a
    (lambda (x)
      (syntax-error x "invalid context")))
  (define-syntax a
    (lambda (x)
      (syntax-case x (aux-a)
        [(_ aux-a) #''okay]
        [(_ _) #''oops]))))
(let () (import (A)) (a aux-a)) ⇒ okay
(let () (import (only (A) a)) (a aux-a)) ⇒ oops</code></pre>
</div>
</div>
<div class="paragraph">
<p>This issue does not arise when libraries are used entirely within other libraries or within RNRS top-level programs, since the interaction environment does not come into play.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_2.4.">Section 2.4. Using Libraries and Top-Level Programs</h3>
<div id="use:s16" class="paragraph">
<p>An R6RS library can be defined directly in the REPL, loaded explicitly from a file (using <code>load</code> or <code>load-library</code>), or loaded implicitly from a file via <code>import</code>. When defined directly in the REPL or loaded explicitly from a file, a library form can be used to redefine an existing library, but <code>import</code> never reloads a library once it has been defined.</p>
</div>
<div class="paragraph">
<p>A library to be loaded implicitly via <code>import</code> must reside in a file whose name reflects the name of the library. For example, if the library&#8217;s name is <code>(tools sorting)</code>, the base name of the file must be <code>sorting</code> with a valid extension, and the file must be in a directory named <code>tools</code> which itself resides in one of the directories searched by <code>import</code>. The set of directories searched by <code>import</code> is determined by the <code>library-directories</code> parameter, and the set of extensions is determined by the <code>library-extensions</code> parameter.</p>
</div>
<div class="paragraph">
<p>The values of both parameters are lists of pairs of strings. The first string in each <code>library-directories</code> pair identifies a source-file base directory, and the second identifies the corresponding object-file base directory. Similarly, the first string in each <code>library-extensions</code> pair identifies a source-file extension, and the second identifies the corresponding object-file extension. The full path of a library source or object file consists of the source or object base followed by the components of the library name, separated by slashes, with the library extension added on the end. For example, for base <code>/usr/lib/scheme</code>, library name <code>(app lib1)</code>, and extension <code>.sls</code>, the full path is <code>/usr/lib/scheme/app/lib1.sls</code>. So, if <code>(library-directories)</code> contains the pathnames <code>"/usr/lib/scheme/libraries"</code> and <code>"."</code>, and <code>(library-extensions)</code> contains the extensions <code>.ss</code> and <code>.sls</code>, the path of the <code>(tools sorting)</code> library must be one of the following.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">/usr/lib/scheme/libraries/tools/sorting.ss
/usr/lib/scheme/libraries/tools/sorting.sls
./tools/sorting.ss
./tools/sorting.sls</code></pre>
</div>
</div>
<div class="paragraph">
<p>When searching for a library, <code>import</code> first constructs a partial name from the list of components in the library name, e.g., <code>a/b</code> for library <code>(a b)</code>. It then searches for the partial name in each pair of base directories, in order, trying each of the source extensions then each of the object extensions in turn before moving onto the next pair of base directories. If the partial name is an absolute pathname, e.g., <code>~/.myappinit</code> for a library named <code>(~/.myappinit)</code>, only the specified absolute path is searched, first with each source extension, then with each object extension. If the expander finds both a source file and its corresponding object file, and the object file is not older than the source file, the expander loads the object file. If the object file does not exist, if the object file is older, or if after loading the object file, the expander determines it was built using a library or include file that has changed, the source file is loaded or compiled, depending on the value of the parameter <code>compile-imported-libraries</code>. If <code>compile-imported-libraries</code> is set to <code>#t</code>, the expander compiles the library via the value of the <code>compile-library-handler</code> parameter, which by default calls <code>compile-library</code> (which is described below). Otherwise, the expander loads the source file. (Loading the source file actually causes the code to be compiled, assuming the default value of <code>current-eval</code>, but the compiled code is not saved to an object file.) An exception is raised during this process if a source or object file exists but is not readable or if an object file cannot be created.</p>
</div>
<div id="use:s21" class="paragraph">
<p>The search process used by the expander when processing an <code>import</code> for a library that has not yet been loaded can be monitored by setting the parameter <code>import-notify</code> to <code>#t</code>. This parameter can be set from the command line via the <code>--import-notify</code> command-line option.</p>
</div>
<div class="paragraph">
<p>Whenever the expander determines it must compile a library to a file or load one from source, it adds the directory in which the file resides to the front of the <code>source-directories</code> list while compiling or loading the library. This allows a library to include files stored in or relative to its own directory.</p>
</div>
<div class="paragraph">
<p>When <code>import</code> compiles a library as described above, it does not also load the compiled library, because this would cause portions of library to be reevaluated. Because of this, run-time expressions in the file outside of a <code>library</code> form will not be evaluated. If such expressions are present and should be evaluated, the library should be compiled ahead of time or loaded explicitly.</p>
</div>
<div id="use:s24" class="paragraph">
<p>A file containing a library may be compiled with <code>compile-file</code> or <code>compile-library</code>. The only difference between the two is that the latter treats the source file as if it were prefixed by an implicit <code>#!r6rs</code>, which disables <em>Chez Scheme</em> lexical extensions unless an explicit <code>#!chezscheme</code> marker appears in the file. Any libraries upon which the library depends must be compiled first. If one of the libraries imported by the library is subsequently recompiled (say because it was modified), the importing library must also be recompiled. Compilation and recompilation of imported libraries must be done explicitly by default but is done automatically when the parameter <code>compile-imported-libraries</code> is set to <code>#t</code> before compiling the importing library.</p>
</div>
<div class="paragraph">
<p>As with <code>compile-file</code>, <code>compile-library</code> can be used in "batch" mode via a shell command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">echo '(compile-library "<em>filename</em>")' | scheme -q</code></pre>
</div>
</div>
<div class="paragraph">
<p>with single-quote marks surrounding the <code>compile-library</code> call omitted for Windows shells.</p>
</div>
<div class="paragraph">
<p>An RNRS top-level-program usually resides in a file, but one can also enter one directly into the REPL using the <code>top-level-program</code> forms, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(top-level-program
  (import (rnrs))
  (display "What's up?\n"))</code></pre>
</div>
</div>
<div class="paragraph">
<p>A top-level program stored in a file does not have the <code>top-level-program</code> wrapper, so the same top-level program in a file is just:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(import (rnrs))
(display "What's up?\n")</code></pre>
</div>
</div>
<div class="paragraph">
<p>A top-level program stored in a file can be loaded from the file via the <code>load-program</code> procedure. A top-level program can also be loaded via <code>load</code>, but not without affecting the semantics. A program loaded via <code>load</code> is scoped at top level, where it can see all top-level bindings, whereas a top-level program loaded via <code>load-program</code> is self-contained, i.e., it can see only the bindings made visible by the leading <code>import</code> form. Also, the variable bindings in a program loaded via <code>load</code> also become top-level bindings, whereas they are local to the program when the program is loaded via <code>load-program</code>. Moreover, <code>load-program</code>, like <code>load-library</code>, treats the source file as if it were prefixed by an implicit <code>#!r6rs</code>, which disables <em>Chez Scheme</em> lexical extensions unless an explicit <code>#!chezscheme</code> marker appears in the file. A program loaded via <code>load</code> is also likely to be less efficient. Since the program&#8217;s variables are not local to the program, the compiler must assume they could change at any time, which inhibits many of its optimizations.</p>
</div>
<div id="use:s25" class="paragraph">
<p>Top-level programs may be compiled using <code>compile-program</code>, which is like <code>compile-file</code> but, as with <code>load-program</code>, properly implements the semantics and lexical restrictions of top-level programs. <code>compile-program</code> also copies the leading <code>#!</code> line, if any, from the source file to the object file, resulting in an executable object file. Any libraries upon which the top-level program depends, other than built-in libraries, must be compiled first. The program must be recompiled if any of the libraries upon which it depends are recompiled. Compilation and recompilation of imported libraries must be done explicitly by default but is done automatically when the parameter <code>compile-imported-libraries</code> is set to <code>#t</code> before compiling the importing library.</p>
</div>
<div class="paragraph">
<p>As with <code>compile-file</code> and <code>compile-library</code>, <code>compile-program</code> can be used in "batch" mode via a shell command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">echo '(compile-program "<em>filename</em>")' | scheme -q</code></pre>
</div>
</div>
<div class="paragraph">
<p>with single-quote marks surrounding the <code>compile-program</code> call omitted for Windows shells.</p>
</div>
<div class="paragraph">
<p><code>compile-program</code> returns a list of libraries directly invoked by the compiled top-level program. When combined with the <code>library-requirements</code> and <code>library-object-filename</code> procedures, the list of libraries returned by <code>compile-program</code> can be used to determine the set of files that must be distributed with the compiled program file.</p>
</div>
<div class="paragraph">
<p>When run, a compiled program automatically loads the run-time code for each library upon which it depends, as if via <code>revisit</code>. If the program also imports one of the same libraries at run time, e.g., via the <code>environment</code> procedure, the system will attempt to load the compile-time information from the same file. The compile-time information can also be loaded explicitly from the same or a different file via <code>load</code> or <code>visit</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_2.5.">Section 2.5. Scheme Shell Scripts</h3>
<div id="use:s31" class="paragraph">
<p>When the <code>--script</code> command-line option is present, the named file is treated as a Scheme shell script, and the command-line is made available via the parameter <code>command-line</code>. This is primarily useful on Unix-based systems, where the script file itself may be made executable. To support executable shell scripts, the system ignores the first line of a loaded script if it begins with <code>#!</code> followed by a space or forward slash. For example, assuming that the <em>Chez Scheme</em> executable has been installed as <code>/usr/bin/scheme</code>, the following script prints its command-line arguments.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">#! /usr/bin/scheme --script
(for-each
  (lambda (x) (display x) (newline))
  (cdr (command-line)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following script implements the traditional Unix <code>echo</code> command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">#! /usr/bin/scheme --script
(let ([args (cdr (command-line))])
  (unless (null? args)
    (let-values ([(newline? args)
                  (if (equal? (car args) "-n")
                      (values #f (cdr args))
                      (values #t args))])
      (do ([args args (cdr args)] [sep "" " "])
          ((null? args))
        (printf "~a~a" sep (car args)))
      (when newline? (newline)))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Scripts may be compiled using <code>compile-script</code>, which is like <code>compile-file</code> but differs in that it copies the leading <code>#!</code> line from the source-file script into the object file.</p>
</div>
<div class="paragraph">
<p>If <em>Petite Chez Scheme</em> is installed, but not <em>Chez Scheme</em>, <code>/usr/bin/scheme</code> may be replaced with <code>/usr/bin/petite</code>.</p>
</div>
<div id="use:s34" class="paragraph">
<p>The <code>--program</code> command-line option is like <code>--script</code> except that the script file is treated as an RNRS top-level program (<a href="#chp_10">Chapter 10</a>). The following RNRS top-level program implements the traditional Unix <code>echo</code> command, as with the script above.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">#! /usr/bin/scheme --program
(import (rnrs))
(let ([args (cdr (command-line))])
  (unless (null? args)
    (let-values ([(newline? args)
                  (if (equal? (car args) "-n")
                      (values #f (cdr args))
                      (values #t args))])
      (do ([args args (cdr args)] [sep "" " "])
          ((null? args))
        (display sep)
        (display (car args)))
      (when newline? (newline)))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again, if only <em>Petite Chez Scheme</em> is installed, <code>/usr/bin/scheme</code> may be replaced with <code>/usr/bin/petite</code>.</p>
</div>
<div class="paragraph">
<p><code>scheme-script</code> may be used in place of <code>scheme --program</code> or <code>petite --program</code>, i.e.,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">#! /usr/bin/scheme-script</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>scheme-script</code> runs <em>Chez Scheme</em>, if available, otherwise <em>Petite Chez Scheme</em>.</p>
</div>
<div class="paragraph">
<p>It is also possible to use <code>/usr/bin/env</code>, as recommended in the Revised<sup>6</sup> Report nonnormative appendices, which allows <code>scheme-script</code> to appear anywhere in the user&#8217;s path.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">#! /usr/bin/env scheme-script</code></pre>
</div>
</div>
<div id="use:s36" class="paragraph">
<p>If a top-level program depends on libraries other than those built into <em>Chez Scheme</em>, the <code>--libdirs</code> option can be used to specify which source and object directories to search. Similarly, if a library upon which a top-level program depends has an extension other than one of the standard extensions, the <code>--libexts</code> option can be used to specify additional extensions to search.</p>
</div>
<div id="use:s38" class="paragraph">
<p>These options set the corresponding <em>Chez Scheme</em> parameters <code>library-directories</code> and <code>library-extensions</code>, which are described in <a href="#section_2.4.">Section 2.4</a>. The format of the arguments to <code>--libdirs</code> and <code>--libexts</code> is the same: a sequence of substrings separated by a single separator character. The separator character is a colon (:), except under Windows where it is a semi-colon (;). Between single separators, the source and object strings, if both are specified, are separated by two separator characters. If a single separator character appears at the end of the string, the specified pairs are added to the front of the existing list; otherwise, the specified pairs replace the existing list.</p>
</div>
<div class="paragraph">
<p>For example, where the separator is a colon,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">scheme --libdirs "/home/moi/lib:"</code></pre>
</div>
</div>
<div class="paragraph">
<p>adds the source/object directory pair</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">("/home/moi/lib" . "/home/moi/lib")</code></pre>
</div>
</div>
<div class="paragraph">
<p>to the front of the default set of library directories, and</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">scheme --libdirs "/home/moi/libsrc::/home/moi/libobj:"</code></pre>
</div>
</div>
<div class="paragraph">
<p>adds the source/object directory pair</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">("/home/moi/libsrc" . "/home/moi/libobj")</code></pre>
</div>
</div>
<div class="paragraph">
<p>to the front of the default set of library directories. The parameters are set after all boot files have been loaded.</p>
</div>
<div id="use:s40" class="paragraph">
<p>If no <code>--libdirs</code> option appears and the CHEZSCHEMELIBDIRS environment variable is set, the string value of CHEZSCHEMELIBDIRS is treated as if it were specified by a <code>--libdirs</code> option. Similarly, if no <code>--libexts</code> option appears and the CHEZSCHEMELIBEXTS environment variable is set, the string value of CHEZSCHEMELIBEXTS is treated as if it were specified by a <code>--libexts</code> option.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_2.6.">Section 2.6. Optimization</h3>
<div id="use:s41" class="paragraph">
<p>To get the most out of the <em>Chez Scheme</em> compiler, it is necessary to give it a little bit of help. The most important assistance is to avoid the use of top-level (interaction-environment) bindings. Top-level bindings are convenient and appropriate during program development, since they simplify testing, redefinition, and tracing (<a href="#section_3.1.">Section 3.1</a>) of individual procedures and syntactic forms. This convenience comes at a sizable price, however.</p>
</div>
<div id="use:s43" class="paragraph">
<p>The compiler can propagate copies (of one variable to another or of a constant to a variable) and inline procedures bound to local, unassigned variables within a single top-level expression. For the procedures it does not inline, it can avoid constructing and passing unneeded closures, bypass argument-count checks, branch to the proper entry point in a case-lambda, and build rest arguments (more efficiently) on the caller side, where the length of the rest list is known at compile time. It can also discard the definitions of unreferenced variables, so there&#8217;s no penalty for including a large library of routines, only a few of which are actually used.</p>
</div>
<div class="paragraph">
<p>It cannot do any of this with top-level variable bindings, since the top-level bindings can change at any time and new references to those bindings can be introduced at any time.</p>
</div>
<div id="use:s45" class="paragraph">
<p>Fortunately, it is easy to restructure a program to avoid top-level bindings. This is naturally accomplished for portable code by placing the code into a single RNRS top-level program or by placing a portion of the code in a top-level program and the remainder in one or more separate libraries. Although not portable, one can also put all of the code into a single top-level <code>module</code> form or <code>let</code> expression, perhaps using <code>include</code> to bring in portions of the code from separate files. The compiler performs some optimization even across library boundaries, so the penalty for breaking a program up in this manner is generally acceptable. The compiler also supports whole-program optimization (via <code>compile-whole-program</code>), which can be used to eliminate all overhead for placing portions of a program into separate libraries.</p>
</div>
<div class="paragraph">
<p>Once an application&#8217;s code has been placed into a single top-level program or into a top-level program and one or more libraries, the code can be loaded from source via <code>load-program</code> or compiled via <code>compile-program</code> and <code>compile-library</code>, as described in <a href="#section_2.4.">Section 2.4</a>. Be sure not to use <code>compile-file</code> for the top-level program since this does not preserve the semantics nor result in code that is as efficient.</p>
</div>
<div class="paragraph">
<p>With an application structured as a single top-level program or as a top-level program and one or more libraries that do not interact frequently, we have done most of what can be done to help the compiler, but there are still a few more things we can do.</p>
</div>
<div id="use:s49" class="paragraph">
<p>First, we can allow the compiler to generate "unsafe" code, i.e., allow the compiler to generate code in which the usual run-time type checks have been disabled. We do this by using the compiler&#8217;s "optimize level 3" when compiling the program and library files. This can be accomplished by setting the parameter <code>optimize-level</code> to 3 while compiling the library or program, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(parameterize ([optimize-level 3]) (compile-program "<em>filename</em>"))</code></pre>
</div>
</div>
<div id="use:s50" class="paragraph">
<p>or in batch mode via the <code>--optimize-level</code> command-line option:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">echo '(compile-program "<em>filename</em>")' | scheme -q --optimize-level 3</code></pre>
</div>
</div>
<div class="paragraph">
<p>It may also be useful to experiment with some of the other compiler control parameters and also with the storage manager&#8217;s run-time operation. The compiler-control parameters, including <code>optimize-level</code>, are described in <a href="#section_12.6.">Section 12.6</a>, and the storage manager control parameters are described in <a href="#section_13.1.">Section 13.1</a>.</p>
</div>
<div id="use:s51" class="paragraph">
<p>Finally, it is often useful to "profile" your code to determine that parts of the code that are executed most frequently. While this will not help the system optimize your code, it can help you identify "hot spots" where you need to concentrate your own hand-optimization efforts. In these hot spots, consider using more efficient operators, like fixnum or flonum operators in place of generic arithmetic operators, and using explicit loops rather than nested combinations of linear list-processing operators like <code>append</code>, <code>reverse</code>, and <code>map</code>. These operators can make code more readable when used judiciously, but they can slow down time-critical code.</p>
</div>
<div class="paragraph">
<p><a href="#section_12.7.">Section 12.7</a> describes how to use the compiler&#8217;s support for automatic profiling. Be sure that profiling is not enabled when you compile your production code, since the code introduced into the generated code to perform the profiling adds significant run-time overhead.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_2.7.">Section 2.7. Customization</h3>
<div id="use:s55" class="paragraph">
<p><em>Chez Scheme</em> and <em>Petite Chez Scheme</em> are built from several subsystems: a "kernel" encapsulated in a static or shared library (dynamic link library) that contains operating-system interface and low-level storage management code, an executable that parses command-line arguments and calls into the kernel to initialize and run the system, a base boot file (petite.boot) that contains the bulk of the run-time library code, and an additional boot file (scheme.boot), for <em>Chez Scheme</em> only, that contains the compiler.</p>
</div>
<div class="paragraph">
<p>While the kernel and base boot file are essential to the operation of all programs, the executable may be replaced or even eliminated, and the compiler boot file need be loaded only if the compiler is actually used. In fact, the compiler is typically not loaded for distributed applications unless the application creates and executes code at run time.</p>
</div>
<div class="paragraph">
<p>The kernel exports a set of entry points that are used to initialize the Scheme system, load boot or heap files, run an interactive Scheme session, run script files, and deinitialize the system. In the threaded versions of the system, the kernel also exports entry points for activating, deactivating, and destroying threads. These entry points may be used to create your own executable image that has different (or no) command-line options or to run Scheme as a subordinate program within another program, i.e., for use as an extension language.</p>
</div>
<div class="paragraph">
<p>These entry points are described in <a href="#section_4.8.">Section 4.8</a>, along with other entry points for accessing and modifying Scheme data structures and calling Scheme procedures.</p>
</div>
<div id="use:s56" class="paragraph">
<p>The file main.c in the 'c' subdirectory contains the "main" routine for the distributed executable image; look at this file to gain an understanding of how the system startup entry points are used.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_2.8.">Section 2.8. Building and Distributing Applications</h3>
<div id="use:s58" class="paragraph">
<p>Although useful as a stand-alone Scheme system, <em>Petite Chez Scheme</em> was conceived as a run-time system for compiled <em>Chez Scheme</em> applications. The remainder of this section describes how to create and distribute such applications using <em>Petite Chez Scheme</em>. It begins with a discussion of the characteristics of <em>Petite Chez Scheme</em> and how it compares with <em>Chez Scheme</em>, then describes how to prepare application source code, how to build and run applications, and how to distribute them.</p>
</div>
<div class="paragraph">
<p>Petite Chez Scheme Characteristics.  Although interpreter-based, <em>Petite Chez Scheme</em> evaluates Scheme source code faster than might be expected. Some of the reasons for this are listed below.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The run-time system is fully compiled, so library implementations of primitives ranging from <code>+</code> and <code>car</code> to <code>sort</code> and <code>printf</code> are just as efficient as in <em>Chez Scheme</em>, although they cannot be open-coded as in code compiled by <em>Chez Scheme</em>.</p>
</li>
<li>
<p>The interpreter is itself a compiled Scheme application. Because it is written in Scheme, it directly benefits from various characteristics of Scheme that would have to be dealt with explicitly and with additional overhead in most other languages, including proper treatment of tail calls, first-class procedures, automatic storage management, and continuations.</p>
</li>
<li>
<p>The interpreter employs a preprocessor that converts the code into a form that can be interpreted efficiently. In fact, the preprocessor shares its front end with the compiler, and this front end performs a variety of source-level optimizations.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Nevertheless, compiled code is still more efficient for most applications. The difference between the speed of interpreted and compiled code varies significantly from one application to another, but often amounts to a factor of five and sometimes to a factor of ten or more.</p>
</div>
<div class="paragraph">
<p>Several additional limitations result from the fact that <em>Petite Chez Scheme</em> does not include the compiler:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The compiler must be present to process <code>foreign-procedure</code> and <code>foreign-callable</code> expressions, even when these forms are evaluated by the interpreter. These forms cannot be processed by the interpreter alone, so they cannot appear in source code to be processed by <em>Petite Chez Scheme</em>. Compiled versions of <code>foreign-procedure</code> and <code>foreign-callable</code> forms may, however, be included in compiled code loaded into <em>Petite Chez Scheme</em>.</p>
</li>
<li>
<p>Inspector information is attached to code objects, which are generated only by the compiler, so source information and variable names are not available for interpreted procedures or continuations into interpreted procedures. This makes the inspector less effective for debugging interpreted code than it is for debugging compiled code.</p>
</li>
<li>
<p>Procedure names are also attached to code objects, so while the compiler associates a name with each procedure when an appropriate name can be determined, the interpreter does not do so. This mostly impacts the quality of error messages, e.g., an error message might read " incorrect number of arguments to <code>#&lt;procedure&gt;</code> " rather than the likely more useful " incorrect number of arguments to <code>#&lt;procedure <em>name</em>&gt;</code> ".</p>
</li>
<li>
<p>The compiler detects, at compile time, some potential errors that the interpreter does not detect and reports them via compile-time warnings that identify the expression or the location in the source file, if any, where the expression appears.</p>
</li>
<li>
<p>Automatic profiling cannot be enabled for interpreted code as it is for compiled code when <code>compile-profile</code> is set to <code>#t</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Except as noted above, <em>Petite Chez Scheme</em> does not restrict what programs can do, and like <em>Chez Scheme</em>, it places essentially no limits on the size of programs or the memory images they create, beyond the inherent limitations of the underlying hardware or operating system.</p>
</div>
<div class="paragraph">
<p><strong>Compiled scripts and programs.</strong> One simple mechanism for distributing an application is to structure it as a script or RNRS top-level program, use <code>compile-script</code> or <code>compile-program</code>, as appropriate to compile it as described in <a href="#section_2.5.">Section 2.5</a>, and distribute the resulting object file along with a complete distribution of <em>Petite Chez Scheme</em>. When this mechanism is used on Unix-based systems, if the source file begins with <code>#!</code> and the path that follows is the path to the <em>Chez Scheme</em> executable, e.g., <code>/usr/bin/scheme</code>, the one at the front of the object file should be replaced with the path to the <em>Petite Chez Scheme</em> executable, e.g., <code>/usr/bin/petite</code>. The path may have to be adjusted by the application&#8217;s installation program based on where <em>Petite Chez Scheme</em> is installed on the target system. When used under Windows, the application&#8217;s installation program should set up an appropriate shortcut that starts <em>Petite Chez Scheme</em> with the <code>--script</code> or <code>--program</code> option, as appropriate, followed by the path to the object file.</p>
</div>
<div class="paragraph">
<p>The remainder of this section describes how to distribute applications that do not require <em>Petite Chez Scheme</em> to be installed as a stand-alone system on the target machine.</p>
</div>
<div class="paragraph">
<p><strong>Preparing Application Code.</strong> While it is possible to distribute applications in source-code form, i.e., as a set of Scheme source files to be loaded into <em>Petite Chez Scheme</em> by the end user, distributing compiled code has two major advantages over distributing source code. First, compiled code is usually much more efficient, as discussed in the preceding section, and second, compiled code is in binary form and thus provides more protection for proprietary application code.</p>
</div>
<div class="paragraph">
<p>Application source code generally consists of a set of Scheme source files possibly augmented by foreign code developed specifically for the application and packaged in shared libraries (also known as shared objects or, on Windows, dynamic link libraries). The following assumes that any shared-library source code has been converted into object form; how to do this varies by platform. (Some hints are given in <a href="#section_4.6.">Section 4.6</a>.) The result is a set of one or more shared libraries that are loaded explicitly by the Scheme source code during program initialization.</p>
</div>
<div class="paragraph">
<p>Once the shared libraries have been created, the next step is to compile the Scheme source files into a set of Scheme object files. Doing so typically involves simply invoking <code>compile-file</code>, <code>compile-library</code>, or <code>compile-program</code>, as appropriate, on each source file to produce the corresponding object file. This may be done within a build script or "make" file via a command line such as the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">echo '(compile-file "<em>filename</em>")' | scheme</code></pre>
</div>
</div>
<div class="paragraph">
<p>which produces the object file <code>filename.so</code> from the source file <code>filename.ss</code>.</p>
</div>
<div class="paragraph">
<p>If the application code has been developed interactively or is usually loaded directly from source, it may be necessary to make some adjustments to a file to be compiled if the file contains expressions or definitions that affect the compilation of subsequent forms in the file. This can be accomplished via <code>eval-when</code> (<a href="#section_12.4.">Section 12.4</a>). This is not typically necessary or desirable if the application consists of a set of RNRS libraries and programs.</p>
</div>
<div class="paragraph">
<p>You may also wish to disable generation of inspector information both to reduce the size of the compiled application code and to prevent others from having access to the expanded source code that is retained as part of the inspector information. To do so, set the parameter <code>generate-inspector-information</code> to <code>#f</code> while compiling each file The downside of disabling inspector information is that the information will not be present if you need to debug your application, so it is usually desirable to disable inspector information only for production builds of your application. An alternative is to compile the code with inspector information enabled and strip out the debugging information later with <code>strip-fasl-file</code>.</p>
</div>
<div class="paragraph">
<p>The Scheme startup procedure determines what the system does when it is started. The default startup procedure loads the files listed on the command line (via <code>load</code>) and starts up a new café, like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(lambda fns (for-each load fns) (new-cafe))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The startup procedure may be changed via the parameter <code>scheme-start</code>. The following example demonstrates the installation of a variant of the default startup procedure that prints the name of each file before loading it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(scheme-start
  (lambda fns
    (for-each
      (lambda (fn)
        (printf "loading ~a ..." fn)
        (load fn)
        (printf "~%"))
      fns)
    (new-cafe)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>A typical application startup procedure would first invoke the application&#8217;s initialization procedure(s) and then start the application itself:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(scheme-start
  (lambda fns
    (initialize-application)
    (start-application fns)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Any shared libraries that must be present during the running of an application must be loaded during initialization. In addition, all foreign procedure expressions must be executed after the shared libraries are loaded so that the addresses of foreign routines are available to be recorded with the resulting foreign procedures. The following demonstrates one way in which initialization might be accomplished for an application that links to a foreign procedure <code>show_state</code> in the Windows shared library <code>state.dll</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define show-state)

(define app-init
  (lambda ()
    (load-shared-object "state.dll")
    (set! show-state
      (foreign-procedure "show_state" (integer-32)
        integer-32))))

(scheme-start
  (lambda fns
    (app-init)
    (app-run fns)))</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Building and Running the Application.</strong> Building and running an application is straightforward once all shared libraries have been built and Scheme source files have been compiled to object code.</p>
</div>
<div class="paragraph">
<p>Although not strictly necessary, we suggest that you concatenate your object files, if you have more than one, into a single object file via the <code>concatenate-object-files</code> procedure. Placing all of the object code into a single file simplifies both building and distribution of applications.</p>
</div>
<div class="paragraph">
<p>For top-level programs with separate libraries, <code>compile-whole-program</code> can be used to produce a single, fully optimized object file. Otherwise, when concatenating object files, put each library after the libraries it depends upon, with the program last.</p>
</div>
<div class="paragraph">
<p>With the Scheme object code contained within a single composite object file, it is possible to run the application simply by loading the composite object file into <em>Petite Chez Scheme</em>, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">petite app.so</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>app.so</code> is the name of the composite object file, and invoking the startup procedure to restart the system:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> ((scheme-start))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The point of setting <code>scheme-start</code>, however, is to allow the set of object files to be converted into a <em>boot file</em>. Boot files are loaded during the process of building the initial heap. Because of this, boot files have the following advantages over ordinary object files.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Any code and data structures contained in the boot file or created while it is loaded is automatically compacted along with the base run-time library code and made static. Static code and data are never collected by the storage manager, so garbage collection overhead is reduced. (It is also possible to make code and data static explicitly at any time via the <code>collect</code> procedure.)</p>
</li>
<li>
<p>The system looks for boot files automatically in a set of standard directories based on the name of the executable image, so you can install a copy of the <em>Petite Chez Scheme</em> executable image under your application&#8217;s name and spare your users from supplying any command-line arguments or running a separate script to load the application code.</p>
</li>
</ul>
</div>
<div id="use:s69" class="paragraph">
<p>When an application is packaged into a boot file, the source code that is compiled and converted into a boot file should set <code>scheme-start</code> to a procedure that starts the application, as shown in the example above. The application should not be started directly from the boot file, because boot files are loaded before final initialization of the Scheme system. The value of <code>scheme-start</code> is invoked automatically after final initialization.</p>
</div>
<div class="paragraph">
<p>A boot file is simply an object file containing the code for one or more source files, prefixed by a boot header. The boot header identifies a base boot file upon which the application directly depends, or possibly two or more alternatives upon which the application can be run. In most cases, petite.boot will be identified as the base boot file, but in a layered application it may be another boot file of your creation that in turn depends upon petite.boot. The base boot file, and its base boot file, if any, are loaded automatically when your application boot file is loaded.</p>
</div>
<div class="paragraph">
<p>Boot files are created with <code>make-boot-file</code>. This procedure accepts two or more arguments. The first is a string naming the file into which the boot header and object code should be placed, the second is a list of strings naming base boot files, and the remainder are strings naming input files. For example, the call:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(make-boot-file "app.boot" '("petite") "app1.so" "app2.ss" "app3.so")</code></pre>
</div>
</div>
<div class="paragraph">
<p>creates the boot file app.boot that identifies a dependency upon petite.boot and contains the object code for app1.so, the object code resulting from compiling app2.ss, and the object code for app3.so. The call:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(make-boot-file "app.boot" '("scheme" "petite") "app.so")</code></pre>
</div>
</div>
<div class="paragraph">
<p>creates a header file that identifies a dependency upon either scheme.boot or petite.boot, with the object code from app.so. In the former case, the system will automatically load petite.boot when the application boot file is loaded, and in the latter it will load scheme.boot if it can find it, otherwise petite.boot. This would allow your application to run on top of the full <em>Chez Scheme</em> if present, otherwise <em>Petite Chez Scheme</em>.</p>
</div>
<div class="paragraph">
<p>In most cases, you can construct your application so it does not depend upon features of scheme.boot (specifically, the compiler) by specifying only <code>"petite"</code> in the call to <code>make-boot-file</code>. If your application calls <code>eval</code>, however, and you wish to allow users to be able to take advantage of the faster execution speed of compiled code, then specifying both <code>"scheme"</code> and <code>"petite"</code> is appropriate.</p>
</div>
<div class="paragraph">
<p>Here is how we might create and run a simple "echo" application from a Linux shell:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">echo '(suppress-greeting #t)' > myecho.ss
echo '(scheme-start (lambda fns (printf "~{~a~^ ~}\n" fns)))' >> myecho.ss
echo '(compile-file "myecho.ss") \
      (make-boot-file "myecho.boot" (quote ("petite")) "myecho.so")' \
     | scheme -q
scheme -b myecho.boot hello world</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we take the extra step of installing a copy of the <em>Petite Chez Scheme</em> executable as <code>myecho</code> and copying <code>myecho.boot</code> into the same directory as <code>petite.boot</code> (or set SCHEMEHEAPDIRS to include the directory containing myecho.boot), we can simply invoke <code>myecho</code> to run our echo application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">myecho hello world</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Distributing the Application.</strong> Distributing an application involves can be as simple as creating a distribution package that includes the following items:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <em>Petite Chez Scheme</em> distribution,</p>
</li>
<li>
<p>the application boot file,</p>
</li>
<li>
<p>any application-specific shared libraries,</p>
</li>
<li>
<p>an application installation script.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The application installation script should install <em>Petite Chez Scheme</em> if not already installed on the target system. It should install the application boot file in the same directory as the <em>Petite Chez Scheme</em> boot file petite.boot is installed, and it should install the application shared libraries, if any, either in the same location or in a standard location for shared libraries on the target system. It should also create a link to or copy of the <em>Petite Chez Scheme</em> executable under the name of your application, i.e., the name given to your application boot file. Where appropriate, it should also install desktop and start-menu shortcuts to run the executable.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_2.9.">Section 2.9. Command-Line Options</h3>
<div id="use:s91" class="paragraph">
<p><em>Chez Scheme</em> recognizes the following command-line options.</p>
</div>
<table class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-q</code>, <code>--quiet</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">suppress greeting and prompt</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--script <em>path</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">run as shell script</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--program <em>path</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">run rnrs top-level program as shell script</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--libdirs <em>dir</em>:...</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">set library directories</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--libexts <em>ext</em>:...</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">set library extensions</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--compile-imported-libraries</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compile libraries before loading</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--import-notify</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">enable import search messages</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--optimize-level 0 | 1 | 2 | 3</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">set initial optimize level</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--debug-on-exception</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">on uncaught exception, call <code>debug</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--eedisable</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">disable expression editor</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--eehistory off | <em>path</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">expression-editor history file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--enable-object-counts</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">have collector maintain object counts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--retain-static-relocation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">keep reloc info for compute-size, etc.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-b <em>path</em></code>, <code>--boot <em>path</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">load boot file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--verbose</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">trace boot-file search process</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--version</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">print version and exit</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--help</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">print help and exit</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pass through remaining args</p></td>
</tr>
</tbody>
</table>
<div id="use:s97" class="paragraph">
<p>The following options are recognized but cause the system to print an error message and exit because saved heaps are no longer supported.</p>
</div>
<table class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-h <em>path</em></code>, <code>--heap <em>path</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">load heap file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-s[<em>n</em>] <em>path</em></code>, <code>--saveheap[<em>n</em>] <em>path</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">save heap file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-c</code>, <code>--compact</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">toggle compaction flag</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>With the default <code>scheme-start</code> procedure (<a href="#section_2.8.">Section 2.8</a>), any remaining command-line arguments are treated as the names of files to be loaded before <em>Chez Scheme</em> begins interacting with the user, unless the <code>--script</code> or <code>--program</code> is present, in which case the remaining arguments are made available to the script via the <code>command-line</code> parameter (<a href="#section_2.1.">Section 2.1</a>).</p>
</div>
<div class="paragraph">
<p>Most of the options are described elsewhere in this chapter, and a few are self-explanatory. The remainder pertain to the loading of boot files at system start-up time and are described below.</p>
</div>
<div id="use:s99" class="paragraph">
<p>When <em>Chez Scheme</em> is run, it looks for one or more boot files to load. Boot files contain the compiled Scheme code that implements most of the Scheme system, including the interpreter, compiler, and most libraries. Boot files may be specified explicitly on the command line via <code>-b</code> options or implicitly. In the simplest case, no <code>-b</code> options are given and the necessary boot files are loaded automatically based on the name of the executable.</p>
</div>
<div class="paragraph">
<p>For example, if the executable name is "frob", the system looks for "frob.boot" in a set of standard directories. It also looks for and loads any subordinate boot files required by "frob.boot".</p>
</div>
<div class="paragraph">
<p>Subordinate boot files are also loaded automatically for the first boot file explicitly specified via the command line. Each boot file must be listed before those that depend upon it.</p>
</div>
<div class="paragraph">
<p>The <code>--verbose</code> option may be used to trace the file searching process and must appear before any boot arguments for which search tracing is desired.</p>
</div>
<div class="paragraph">
<p>Ordinarily, the search for boot files is limited to a set of installation directories, but this may be overridden by setting the environment variable <code>SCHEMEHEAPDIRS</code>. <code>SCHEMEHEAPDIRS</code> should be a colon-separated list of directories, listed in the order in which they should be searched. Within each directory, the two-character escape sequence <code>%v</code> is replaced by the current version, and the two-character escape sequence <code>%m</code> is replaced by the machine type. A percent followed by any other character is replaced by the second character; in particular, <code>%%</code> is replaced by <code>%</code>, and <code>%:</code> is replaced by <code>:</code>. If <code>SCHEMEHEAPDIRS</code> ends in a non-escaped colon, the default directories are searched after those in <code>SCHEMEHEAPDIRS</code>; otherwise, only those listed in <code>SCHEMEHEAPDIRS</code> are searched.</p>
</div>
<div class="paragraph">
<p>Under Windows, semi-colons are used in place of colons, and one additional escape is recognized: <code>%x</code>, which is replaced by the directory in which the executable file resides. The default search path under Windows consists of <code>%x</code> and <code>%x\..\..\boot\%m</code>. The registry key <code>HeapSearchPath</code> in <code>HKLM\SOFTWARE\Chez Scheme\csv<em>version</em></code>, where <code><em>version</em></code> is the <em>Chez Scheme</em> version number, e.g., <code>7.9.4</code>, can be set to override the default search path, and the <code>SCHEMEHEAPDIRS</code> environment variable overrides both the default and the registry setting, if any.</p>
</div>
<div class="paragraph">
<p>Boot files consist of ordinary compiled code and consist of a boot header and the compiled code for one or more source files. See <a href="#section_2.8.">Section 2.8</a> for instructions on how to create boot files.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chp_3">Chapter 3. Debugging</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Chez Scheme</em> has several features that support debugging. In addition to providing error messages when fully type-checked code is run, <em>Chez Scheme</em> also permits tracing of procedure calls, interruption of any computation, redefinition of exception and interrupt handlers, and inspection of any object, including the continuations of exceptions and interrupts.</p>
</div>
<div class="paragraph">
<p>Programmers new to Scheme or <em>Chez Scheme</em>, and even more experienced Scheme programmers, might want to consult the tutorial "How to Debug Chez Scheme Programs." HTML and PDF versions are available at <a href="http://www.cs.indiana.edu/chezscheme/debug/" class="bare">http://www.cs.indiana.edu/chezscheme/debug/</a>.</p>
</div>
<div class="sect2">
<h3 id="section_3.1.">Section 3.1. Tracing</h3>
<div class="paragraph">
<p>Tracing is one of the most useful mechanisms for debugging Scheme programs. <em>Chez Scheme</em> permits any primitive or user-defined procedure to be traced. The trace package prints the arguments and return values for each traced procedure with a compact indentation mechanism that shows the nesting depth of calls. The distinction between tail calls and nontail calls is reflected properly by an increase in indentation for nontail calls only. For nesting depths of 10 or greater, a number in brackets is used in place of indentation to signify nesting depth.</p>
</div>
<div class="paragraph">
<p>This section covers the mechanisms for tracing procedures and controlling trace output.</p>
</div>
<div id="debug:s0" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(trace-lambda <em>name</em> <em>formals</em> <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a traced procedure</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="debug:s1" class="paragraph">
<p>A <code>trace-lambda</code> expression is equivalent to a <code>lambda</code> expression with the same formals and body except that trace information is printed to the trace output port whenever the procedure is invoked, using <code><em>name</em></code> to identify the procedure. The trace information shows the value of the arguments passed to the procedure and the values returned by the procedure, with indentation to show the nesting of calls.</p>
</div>
<div class="paragraph">
<p>The traced procedure <code>half</code> defined below returns the integer quotient of its argument and 2.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define half
  (trace-lambda half (x)
    (cond
      [(zero? x) 0]
      [(odd? x) (half (- x 1))]
      [(even? x) (+ (half (- x 1)) 1)])))</code></pre>
</div>
</div>
<div class="paragraph">
<p>A trace of the call <code>(half 5)</code>, which returns 2, is shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">|(half 5)
|(half 4)
| (half 3)
| (half 2)
| |(half 1)
| |(half 0)
| |0
| 1
|2</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example highlights the proper treatment of tail and nontail calls by the trace package. Since <code>half</code> tail calls itself when its argument is odd, the call <code>(half 4)</code> appears at the same level of indentation as the call <code>(half 5)</code>. Furthermore, since the return values of <code>(half 5)</code> and <code>(half 4)</code> are necessarily the same, only one return value is shown for both calls.</p>
</div>
<div id="debug:s3" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(trace-case-lambda <em>name</em> <em>clause</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a traced procedure</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="debug:s4" class="paragraph">
<p>A <code>trace-case-lambda</code> expression is equivalent to a <code>case-lambda</code> expression with the same clauses except that trace information is printed to the trace output port whenever the procedure is invoked, using <code><em>name</em></code> to identify the procedure. The trace information shows the value of the arguments passed to the procedure and the values returned by the procedure, with indentation to show the nesting of calls.</p>
</div>
<div id="debug:s5" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(trace-let <em>name</em> ((<em>var</em> <em>expr</em>) ...) <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the values of the body <code><em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="debug:s6" class="paragraph">
<p>A <code>trace-let</code> expression is equivalent to a named <code>let</code> expression with the same name, bindings, and body except that trace information is printed to the trace output port on entry or reentry (via invocation of the procedure bound to <code>name</code>) into the <code>trace-let</code> expression.</p>
</div>
<div class="paragraph">
<p>A <code>trace-let</code> expression of the form</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(trace-let <em>name</em> ([<em>var</em> <em>expr</em>] ...)
  <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></pre>
</div>
</div>
<div class="paragraph">
<p>can be rewritten in terms of <code>trace-lambda</code> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">((letrec ([<em>name</em>
           (trace-lambda <em>name</em> (<em>var</em> ...)
             <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)])
   <em>name</em>)
 <em>expr</em> ...)</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>trace-let</code> may be used to trace ordinary <code>let</code> expressions as well as <code>let</code> expressions as long as the name inserted along with the <code>trace-let</code> keyword in place of <code>let</code> does not appear free within the body of the <code>let</code> expression. It is also sometimes useful to insert a <code>trace-let</code> expression into a program simply to display the value of an arbitrary expression at the current trace indentation. For example, a call to the following variant of <code>half</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define half
  (trace-lambda half (x)
    (cond
      [(zero? x) 0]
      [(odd? x) (half (trace-let decr-value () (- x 1)))]
      [(even? x) (+ (half (- x 1)) 1)])))</code></pre>
</div>
</div>
<div class="paragraph">
<p>with argument 5 results in the trace:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">|(half 5)
| (decr-value)
| 4
|(half 4)
| (half 3)
| |(decr-value)
| |2
| (half 2)
| |(half 1)
| | (decr-value)
| | 0
| |(half 0)
| 1
|2</code></pre>
</div>
</div>
<div id="debug:s7" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(trace-do ((<em>var</em> <em>init</em> <em>update</em>) ...) (<em>test</em> <em>result</em> ...) <em>expr</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the values of the last <code><em>result</em></code> expression</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="debug:s8" class="paragraph">
<p>A <code>trace-do</code> expression is equivalent to a <code>do</code> expression with the same subforms, except that trace information is printed to the trace output port, showing the values of <code><em>var</em> ...</code> and each iteration and the final value of the loop on termination. For example, the expression</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(trace-do ([old '(a b c) (cdr old)]
           [new '() (cons (car old) new)])
  ((null? old) new))</code></pre>
</div>
</div>
<div class="paragraph">
<p>produces the trace</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">|(do (a b c) ())
|(do (b c) (a))
|(do (c) (b a))
|(do () (c b a))
|(c b a)</code></pre>
</div>
</div>
<div class="paragraph">
<p>and returns <code>(c b a)</code>.</p>
</div>
<div id="debug:s9" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(trace <em>var<sub>1</sub></em> <em>var<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of <code><em>var<sub>1</sub></em> <em>var<sub>2</sub></em> ...</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(trace)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of all currently traced top-level variables</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the first form, <code>trace</code> reassigns the top-level values of <code><em>var<sub>1</sub></em> <em>var<sub>2</sub></em> ...</code>, whose values must be procedures, to equivalent procedures that display trace information in the manner of <code>trace-lambda</code>.</p>
</div>
<div class="paragraph">
<p><code>trace</code> works by encapsulating the old value of each var in a traced procedure. It could be defined approximately as follows. (The actual version records and returns information about traced variables.)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax trace
  (syntax-rules ()
    [(_ var ...)
     (begin
       (set-top-level-value! 'var
         (let ([p (top-level-value 'var)])
           (trace-lambda var args (apply p args))))
       ...)]))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Tracing for a procedure traced in this manner may be disabled via <code>untrace</code> (see below), an assignment of the corresponding variable to a different, untraced value, or a subsequent use of <code>trace</code> for the same variable. Because the value is traced and not the binding, however, a traced value obtained before tracing is disabled and retained after tracing is disabled will remain traced.</p>
</div>
<div class="paragraph">
<p><code>trace</code> without subexpressions evaluates to a list of all currently traced variables. A variable is currently traced if it has been traced and not subsequently untraced or assigned to a different value.</p>
</div>
<div class="paragraph">
<p>The following transcript demonstrates the use of <code>trace</code> in an interactive session.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (define half
    (lambda (x)
      (cond
        [(zero? x) 0]
        [(odd? x) (half (- x 1))]
        [(even? x) (+ (half (- x 1)) 1)])))
> (half 5)
2
> (trace half)
(half)
> (half 5)
|(half 5)
|(half 4)
| (half 3)
| (half 2)
| |(half 1)
| |(half 0)
| |0
| 1
|2
2
> (define traced-half half)
> (untrace half)
(half)
> (half 2)
1
> (traced-half 2)
|(half 2)
|1
1</code></pre>
</div>
</div>
<div id="debug:s10" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(untrace <em>var<sub>1</sub></em> <em>var<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(untrace)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of untraced variables</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>untrace</code> restores the original (pre-<code>trace</code>) top-level values of each currently traced variable in <code><em>var<sub>1</sub></em> <em>var<sub>2</sub></em> ...</code>, effectively disabling the tracing of the values of these variables. Any variable in <code><em>var<sub>1</sub></em> <em>var<sub>2</sub></em> ...</code> that is not currently traced is ignored. If <code>untrace</code> is called without arguments, the values of all currently traced variables are restored.</p>
</div>
<div class="paragraph">
<p>The following transcript demonstrates the use of <code>trace</code> and <code>untrace</code> in an interactive session to debug an incorrect procedure definition.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (define square-minus-one
    (lambda (x)
      (- (* x x) 2)))
> (square-minus-one 3)
7
> (trace square-minus-one * -)
(square-minus-one * -)
> (square-minus-one 3)
|(square-minus-one 3)
| (* 3 3)
| 9
|(- 9 2)
|7
7
> (define square-minus-one
    (lambda (x)
      (- (* x x) 1))) ; change the 2 to 1
> (trace)
(- <strong>)
> (square-minus-one 3)
|(</strong> 3 3)
|9
|(- 9 1)
|8
8
> (untrace square-minus-one)
()
> (untrace * -)
(- *)
> (square-minus-one 3)
8</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first call to <code>square-minus-one</code> indicates there is an error, the second (traced) call indicates the step at which the error occurs, the third call demonstrates that the fix works, and the fourth call demonstrates that <code>untrace</code> does not wipe out the fix.</p>
</div>
<div id="debug:s11" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>trace-output-port</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>trace-output-port</code> is a parameter that determines the output port to which tracing information is sent. When called with no arguments, <code>trace-output-port</code> returns the current trace output port. When called with one argument, which must be a textual output port, <code>trace-output-port</code> changes the value of the current trace output port.</p>
</div>
<div id="debug:s12" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>trace-print</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of <code>trace-print</code> must be a procedure of two arguments, an object and an output port. The trace package uses the value of <code>trace-print</code> to print the arguments and return values for each call to a traced procedure. <code>trace-print</code> is set to <code>pretty-print</code> by default.</p>
</div>
<div class="paragraph">
<p>The trace package sets <code>pretty-initial-indent</code> to an appropriate value for the current nesting level before calling the value of <code>trace-print</code> so that multiline output can be indented properly.</p>
</div>
<div id="debug:s14" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(trace-define <em>var</em> <em>expr</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(trace-define (<em>var</em> . <em>idspec</em>) <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>trace-define</code> is a convenient shorthand for defining variables bound to traced procedures of the same name. The first form is equivalent to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define <em>var</em>
  (let ([x <em>expr</em>])
    (trace-lambda <em>var</em> args
      (apply x args))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>and the second is equivalent to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define <em>var</em>
  (trace-lambda <em>var</em> <em>idspec</em>
    <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...))</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the former case, <code><em>expr</em></code> must evaluate to a procedure.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (let ()
    (trace-define plus
      (lambda (x y)
        (+ x y)))
    (list (plus 3 4) (+ 5 6)))
|(plus 3 4)
|7
(7 11)</code></pre>
</div>
</div>
<div id="debug:s15" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(trace-define-syntax <em>keyword</em> <em>expr</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>trace-define-syntax</code> traces the input and output to the transformer value of <code><em>expr</em></code>, stripped of the contextual information used by the expander to maintain lexical scoping.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (trace-define-syntax let*
    (syntax-rules ()
      [(_ () b1 b2 ...)
       (let () b1 b2 ...)]
      [(_ ((x e) m ...) b1 b2 ...)
       (let ((x e))
         (let* (m ...) b1 b2 ...))]))
> (let* ([x 3] [y (+ x x)]) (list x y))
|(let* (let* [(x 3) (y (+ x x))] [list x y]))
|(let ([x 3]) (let* ([y (+ x x)]) (list x y)))
|(let* (let* [(y (+ x x))] [list x y]))
|(let ([y (+ x x)]) (let* () (list x y)))
|(let* (let* () [list x y]))
|(let () (list x y))
(3 6)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Without contextual information, the displayed forms are more readable but less precise, since different identifiers with the same name are indistinguishable, as shown in the example below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (let ([x 0])
    (trace-define-syntax a
      (syntax-rules ()
        [(_ y) (eq? x y)]))
    (let ([x 1])
      (a x)))
|(a (a x))
|(eq? x x)
#f</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_3.2.">Section 3.2. The Interactive Debugger</h3>
<div class="paragraph">
<p>The interactive debugger is entered as a result of a call to the procedure <code>debug</code> after an exception is handled by the default exception handler. It can also be entered directly from the default exception handler, for serious or non-warning conditions, if the parameter <code>debug-on-exception</code> is true.</p>
</div>
<div class="paragraph">
<p>Within the debugger, the command "?" lists the debugger command options. These include commands to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>inspect the raise continuation,</p>
</li>
<li>
<p>display the condition,</p>
</li>
<li>
<p>inspect the condition, and</p>
</li>
<li>
<p>exit the debugger.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The raise continuation is the continuation encapsulated within the condition, if any. The standard exception reporting procedures and forms <code>assert</code>, <code>assertion-violation</code>, and <code>error</code> as well as the <em>Chez Scheme</em> procedures <code>assertion-violationf</code>, <code>errorf</code>, and <code>syntax-error</code> all raise exceptions with conditions that encapsulate the continuations of their calls, allowing the programmer to inspect the frames of pending calls at the point of a violation, error, or failed assertion.</p>
</div>
<div class="paragraph">
<p>A variant of the interactive debugger, the break handler, is entered as the result of a keyboard interrupt handled by the default keyboard-interrupt handler or an explicit call to the procedure <code>break</code> handled by the default break handler. Again, the command "?" lists the command options. These include commands to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>exit the break handler and continue,</p>
</li>
<li>
<p>reset to the current café,</p>
</li>
<li>
<p>abort the entire Scheme session,</p>
</li>
<li>
<p>enter a new café,</p>
</li>
<li>
<p>inspect the current continuation, and</p>
</li>
<li>
<p>display program statistics (run time and memory usage).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is also usually possible to exit from the debugger or break handler by typing the end-of-file character ("control-D" under Unix, "control-Z" under Windows).</p>
</div>
<div id="debug:s16" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(debug)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>does not return</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When the default exception handler receives a serious or non-warning condition, it displays the condition and resets to the current café. Before it resets, it saves the condition in the parameter <code>debug-condition</code>. The <code>debug</code> procedure may be used to inspect the condition. Whenever one of the built-in error-reporting mechanisms is used to raise an exception, the continuation at the point where the exception was raised can be inspected as well. More generally, <code>debug</code> allows the continuation contained within any continuation condition created by <code>make-continuation-condition</code> to be inspected.</p>
</div>
<div class="paragraph">
<p>If the parameter <code>debug-on-exception</code> is set to <code>#t</code>, the default exception handler enters the debugger directly for all serious and non-warning conditions, delaying its reset until after the debugger exits. The <code>--debug-on-exception</code> command-line option may be used to set <code>debug-on-exception</code> to <code>#t</code> from the command line, which is particularly useful when debugging scripts or top-level programs run via the <code>--script</code> or <code>--program</code> command-line options.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_3.3.">Section 3.3. The Interactive Inspector</h3>
<div class="paragraph">
<p>The inspector may be called directly via the procedure <code>inspect</code> or indirectly from the debugger. It allows the programmer to examine circular objects, objects such as ports and procedures that do not have a reader syntax, and objects such as continuations and variables that are not directly accessible by the programmer, as well as ordinary printable Scheme objects.</p>
</div>
<div class="paragraph">
<p>The primary intent of the inspector is examination, not alteration, of objects. The values of assignable variables may be changed from within the inspector, however. Assignable variables are generally limited to those for which assignments occur in the source program. It is also possible to invoke arbitrary procedures (including mutation procedures such as <code>set-car!</code>) on an object. No mechanism is provided for altering objects that are inherently immutable, e.g., nonassignable variables, procedures, and bignums, since doing so can violate assumptions made by the compiler and run-time system.</p>
</div>
<div class="paragraph">
<p>The user is presented with a prompt line that includes a printed representation of the current object, abbreviated if necessary to fit on the line. Various commands are provided for displaying objects and moving around inside of objects. On-line descriptions of the command options are provided. The command "?" displays commands that apply specifically to the current object. The command "??" displays commands that are always applicable. The command "h" provides a brief description of how to use the inspector. The end-of-file character or the command "q" exits the inspector.</p>
</div>
<div id="debug:s22" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(inspect <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Invokes the inspector on <code><em>obj</em></code>, as described above. The commands recognized by the inspector are listed below, categorized by the type of the current object.</p>
</div>
<div class="paragraph">
<p><strong>Generally applicable commands</strong></p>
</div>
<div class="paragraph">
<p><code>help</code> or <code>h</code> displays a brief description of how to use the inspector.</p>
</div>
<div class="paragraph">
<p><code>?</code> displays commands applicable to the current type of object.</p>
</div>
<div class="paragraph">
<p><code>??</code> displays the generally applicable commands.</p>
</div>
<div class="paragraph">
<p><code>print</code> or <code>p</code> prints the current object (using <code>pretty-print</code>).</p>
</div>
<div class="paragraph">
<p><code>write</code> or <code>w</code> writes the current object (using <code>write</code>).</p>
</div>
<div class="paragraph">
<p><code>size</code> writes the size in bytes occupied by the current object (determined via <code>compute-size</code>), including any objects accessible from the current object except those for which the size was previously requested during the same interactive inspector session.</p>
</div>
<div class="paragraph">
<p><code>find</code> <code><em>expr</em></code> [ <code><em>g</em></code> ] evaluates <code><em>expr</em></code>, which should evaluate to a procedure of one argument, and searches (via <code>make-object-finder</code>) for the first occurrence of an object within the current object for which the predicate returns a true value, treating immediate values (e.g., fixnums), values in generations older than <code><em>g</em></code>, and values already visited during the search as leaves. If <code><em>g</em></code> is not unspecified, it defaults to the current maximum generation, i.e., the value of <code>collect-maximum-generation</code>. If specified, <code><em>g</em></code> must be an exact nonnegative integer less than or equal to the current maximum generation or the symbol <code>static</code> representing the static generation. If such an object is found, the inspector&#8217;s focus moves to that object as if through a series of steps that lead from the current object to the located object, so that the <code>up</code> command can be used to determine where the object was found relative to the original object.</p>
</div>
<div class="paragraph">
<p><code>find-next</code> repeats the last <code>find</code>, locating an occurrence not previously found, if any.</p>
</div>
<div class="paragraph">
<p><code>up</code> or <code>u</code> <code><em>n</em></code> returns to the <code><em>nth</em></code> previous level. Used to move outwards in the structure of the inspected object. <code><em>n</em></code> defaults to 1.</p>
</div>
<div class="paragraph">
<p><code>top</code> or <code>t</code> returns to the outermost level of the inspected object.</p>
</div>
<div class="paragraph">
<p><code>forward</code> or <code>f</code> moves to the <code><em>nth</em></code> next expression. Used to move from one element to another of an object containing a sequence of elements, such as a list, vector, record, frame, or closure. <code><em>n</em></code> defaults to 1.</p>
</div>
<div class="paragraph">
<p><code>back</code> or <code>b</code> moves to the <code><em>nth</em></code> previous expression. Used to move from one element to another of an object containing a sequence of elements, such as a list, vector, record, frame, or closure. <code><em>n</em></code> defaults to 1.</p>
</div>
<div class="paragraph">
<p><code>=&gt;</code> <code><em>expr</em></code> sends the current object to the procedure value of <code><em>expr</em></code>. <code><em>expr</em></code> may begin on the current or following line and may span multiple lines.</p>
</div>
<div class="paragraph">
<p><code>file</code> <code><em>path</em></code> opens the source file at the specified path for listing. The parameter <code>source-directories</code> (<a href="#section_12.5.">Section 12.5</a>) determines the set of directories searched for source files.</p>
</div>
<div class="paragraph">
<p><code>list</code> <code><em>line</em></code> <code><em>count</em></code> lists <code><em>count</em></code> lines of the current source file (see <code>file</code>) starting at <code><em>line</em></code>. <code><em>line</em></code> defaults to the end of the previous set of lines listed and <code><em>count</em></code> defaults to ten or the number of lines previously listed. If <code><em>line</em></code> is negative, listing begins <code><em>line</em></code> lines before the previous set of lines listed.</p>
</div>
<div class="paragraph">
<p><code>files</code> shows the currently open source files.</p>
</div>
<div class="paragraph">
<p><code>mark</code> or <code>m</code> <code><em>m</em></code> marks the current location with the symbolic mark <code><em>m</em></code>. If <code><em>m</em></code> is not specified, the current location is marked with a unique default mark.</p>
</div>
<div class="paragraph">
<p><code>goto</code> or <code>g</code> <code><em>m</em></code> returns to the location marked <code><em>m</em></code>. If <code><em>m</em></code> is not specified, the inspector returns to the location marked with the default mark.</p>
</div>
<div class="paragraph">
<p><code>new-cafe</code> or <code>n</code> enters a new read-eval-print loop (café), giving access to the normal top-level environment.</p>
</div>
<div class="paragraph">
<p><code>quit</code> or <code>q</code> exits from the inspector.</p>
</div>
<div class="paragraph">
<p><code>reset</code> or <code>r</code> resets to the current café.</p>
</div>
<div class="paragraph">
<p><code>abort</code> or <code>a</code> <code><em>x</em></code> aborts from Scheme with exit status <code><em>x</em></code>, which defaults to -1.</p>
</div>
<div class="paragraph">
<p><strong>Continuation commands</strong></p>
</div>
<div class="paragraph">
<p><code>show-frames</code> or <code>sf</code> shows the next <code><em>n</em></code> frames. If <code><em>n</em></code> is not specified, all frames are displayed.</p>
</div>
<div class="paragraph">
<p><code>depth</code> displays the number of frames in the continuation.</p>
</div>
<div class="paragraph">
<p><code>down</code> or <code>d</code> <code><em>n</em></code> move to the <code><em>nth</em></code> frame down in the continuation. <code><em>n</em></code> defaults to 1.</p>
</div>
<div class="paragraph">
<p><code>show</code> or <code>s</code> shows the continuation (next frame) and, if available, the calling procedure source, the pending call source, the closure, and the frame and free-variable values. Source is available only if generation of inspector information was enabled during compilation of the corresponding lambda expression.</p>
</div>
<div class="paragraph">
<p><code>show-local</code> or <code>sl</code> is like <code>show</code> or <code>s</code> except that free variable values are not shown. (If present, free variable values can be found by inspecting the closure.)</p>
</div>
<div class="paragraph">
<p><code>length</code> or <code>l</code> displays the number of elements in the topmost frame of the continuation.</p>
</div>
<div class="paragraph">
<p><code>ref</code> or <code>r</code> moves to the <code><em>nth</em></code> or named frame element. <code><em>n</em></code> defaults to 0. If multiple elements have the same name, only one is accessible by name, and the others must be accessed by number.</p>
</div>
<div class="paragraph">
<p><code>code</code> or <code>c</code> moves to the source for the calling procedure.</p>
</div>
<div class="paragraph">
<p><code>call</code> moves to the source for the pending call.</p>
</div>
<div class="paragraph">
<p><code>file</code> opens the source file containing the pending call, if known. The parameter <code>source-directories</code> (<a href="#section_12.5.">Section 12.5</a>) determines the list of source directories searched for source files identified by relative path names.</p>
</div>
<div class="paragraph">
<p>For absolute pathnames starting with a <code>/</code> (or <code>\</code> or a directory specifier under Windows), the inspector tries the absolute pathname first, then looks for the last (filename) component of the path in the list of source directories. For pathnames starting with <code>./</code> (or <code>.\</code> under Windows) or <code>../</code> (or <code>..\</code> under Windows), the inspector looks in <code>"."</code> or <code>".."</code> first, as appropriate, then for the entire <code>.</code>- or <code>..</code>-prefixed pathname in the source directories, then for the last (filename) component in the source directories. For other (relative) pathnames, the inspector looks for the entire relative pathname in the list of source directories, then the last (filename) component in the list of source directories.</p>
</div>
<div class="paragraph">
<p>If a file by the same name as but different contents from the original source file is found during this process, it will be skipped over. This typically happens because the file has been modified since it was compiled. Pass an explicit filename argument to force opening of a particular file (see the generally applicable commands above).</p>
</div>
<div class="paragraph">
<p><code>eval</code> or <code>e</code> <code><em>expr</em></code> evaluates the expression <code><em>expr</em></code> in an environment containing bindings for the elements of the frame. Within the evaluated expression, the value of each frame element <code><em>n</em></code> is accessible via the variable <code>%<em>n</em></code>. Named elements are accessible via their names as well. Names are available only if generation of inspector information was enabled during compilation of the corresponding lambda expression.</p>
</div>
<div class="paragraph">
<p><code>set!</code> or <code>!</code> <code><em>n</em></code> <code><em>e</em></code> sets the value of the <code><em>nth</em></code> frame element to <code><em>e</em></code>, if the frame element corresponds to an assignable variable. <code><em>n</em></code> defaults to 0.</p>
</div>
<div class="paragraph">
<p><strong>Procedure commands</strong></p>
</div>
<div class="paragraph">
<p><code>show</code> or <code>s</code> shows the source and free variables of the procedure. Source is available only if generation of inspector information was enabled during compilation of the corresponding lambda expression.</p>
</div>
<div class="paragraph">
<p><code>code</code> or <code>c</code> moves to the source for the procedure.</p>
</div>
<div class="paragraph">
<p><code>file</code> opens the file containing the procedure&#8217;s source code, if known. See the description of the continuation <code>file</code> entry above for more information.</p>
</div>
<div class="paragraph">
<p><code>length</code> or <code>l</code> displays the number of free variables whose values are recorded in the procedure object.</p>
</div>
<div class="paragraph">
<p><code>ref</code> or <code>r</code> moves to the <code><em>nth</em></code> or named free variable. <code><em>n</em></code> defaults to 0. If multiple free variables have the same name, only one is accessible by name, and the others must be accessed by number.</p>
</div>
<div class="paragraph">
<p><code>set!</code> or <code>!</code> <code><em>n</em></code> <code><em>e</em></code> sets the value of the <code><em>nth</em></code> free variable to <code><em>e</em></code>, if the variable is assignable. <code><em>n</em></code> defaults to 0.</p>
</div>
<div class="paragraph">
<p><code>eval</code> or <code>e</code> <code><em>expr</em></code> evaluates the expression <code><em>expr</em></code> in an environment containing bindings for the free variables of the procedure. Within the evaluated expression, the value of each free variable <code><em>n</em></code> is accessible via the variable <code>%<em>n</em></code>. Named free variables are accessible via their names as well. Names are available only if generation of inspector information was enabled during compilation of the corresponding lambda expression.</p>
</div>
<div class="paragraph">
<p><strong>Pair (list) commands</strong></p>
</div>
<div class="paragraph">
<p><code>show</code> or <code>s</code> <code><em>n</em></code> shows the first <code><em>n</em></code> elements of the list. If <code><em>n</em></code> is not specified, all elements are displayed.</p>
</div>
<div class="paragraph">
<p><code>length</code> or <code>l</code> displays the list length.</p>
</div>
<div class="paragraph">
<p><code>car</code> moves to the object in the car of the current object.</p>
</div>
<div class="paragraph">
<p><code>cdr</code> moves to the object in the cdr.</p>
</div>
<div class="paragraph">
<p><code>ref</code> or <code>r</code> <code><em>n</em></code> moves to the <code><em>nth</em></code> element of the list. <code><em>n</em></code> defaults to 0.</p>
</div>
<div class="paragraph">
<p><code>tail</code> <code><em>n</em></code> moves to the <code><em>nth</em></code> cdr of the list. <code><em>n</em></code> defaults to 1.</p>
</div>
<div class="paragraph">
<p><strong>Vector, Bytevector, and Fxvector commands</strong></p>
</div>
<div class="paragraph">
<p><code>show</code> or <code>s</code> <code><em>n</em></code> shows the first <code><em>n</em></code> elements of the vector. If <code><em>n</em></code> is not specified, all elements are displayed.</p>
</div>
<div class="paragraph">
<p><code>length</code> or <code>l</code> displays the vector length.</p>
</div>
<div class="paragraph">
<p><code>ref</code> or <code>r</code> <code><em>n</em></code> moves to the <code><em>nth</em></code> element of the vector. <code><em>n</em></code> defaults to 0.</p>
</div>
<div class="paragraph">
<p><strong>String commands</strong></p>
</div>
<div class="paragraph">
<p><code>show</code> or <code>s</code> <code><em>n</em></code> shows the first <code><em>n</em></code> elements of the string. If <code><em>n</em></code> is not specified, all elements are displayed.</p>
</div>
<div class="paragraph">
<p><code>length</code> or <code>l</code> displays the string length.</p>
</div>
<div class="paragraph">
<p><code>ref</code> or <code>r</code> <code><em>n</em></code> moves to the <code><em>nth</em></code> element of the string. <code><em>n</em></code> defaults to 0.</p>
</div>
<div class="paragraph">
<p><code>unicode</code> <code><em>n</em></code> displays the first <code><em>n</em></code> elements of the string as hexadecimal Unicode scalar values.</p>
</div>
<div class="paragraph">
<p><code>ascii</code> <code><em>n</em></code> displays the first <code><em>n</em></code> elements of the string as hexadecimal ASCII values, using <code>--</code> to denote characters whose Unicode scalar values are not in the ASCII range.</p>
</div>
<div class="paragraph">
<p><strong>Symbol commands</strong></p>
</div>
<div class="paragraph">
<p><code>show</code> or <code>s</code> shows the fields of the symbol.</p>
</div>
<div class="paragraph">
<p><code>value</code> or <code>v</code> moves to the top-level value of the symbol.</p>
</div>
<div class="paragraph">
<p><code>name</code> or <code>n</code> moves to the name of the symbol.</p>
</div>
<div class="paragraph">
<p><code>property-list</code> or <code>pl</code> moves to the property list of the symbol.</p>
</div>
<div class="paragraph">
<p><code>ref</code> or <code>r</code> <code><em>n</em></code> moves to the <code><em>nth</em></code> field of the symbol. Field 0 is the top-level value of the symbol, field 1 is the symbol&#8217;s name, and field 2 is its property list. <code><em>n</em></code> defaults to 0.</p>
</div>
<div class="paragraph">
<p><strong>Character commands</strong></p>
</div>
<div class="paragraph">
<p><code>unicode</code> displays the hexadecimal Unicode scalar value for the character.</p>
</div>
<div class="paragraph">
<p><code>ascii</code> displays the hexadecimal ASCII code for the character, using <code>--</code> to denote characters whose Unicode scalar values are not in the ASCII range.</p>
</div>
<div class="paragraph">
<p><strong>Box commands</strong></p>
</div>
<div class="paragraph">
<p><code>show</code> or <code>s</code> shows the contents of the box.</p>
</div>
<div class="paragraph">
<p><code>unbox</code> or <code>ref</code> or <code>r</code> moves to the boxed object.</p>
</div>
<div class="paragraph">
<p><strong>Port commands</strong></p>
</div>
<div class="paragraph">
<p><code>show</code> or <code>s</code> shows the fields of the port, including the input and output size, index, and buffer fields.</p>
</div>
<div class="paragraph">
<p><code>name</code> moves to the port&#8217;s name.</p>
</div>
<div class="paragraph">
<p><code>handler</code> moves to the port&#8217;s handler.</p>
</div>
<div class="paragraph">
<p><code>output-buffer</code> or <code>ob</code> moves to the port&#8217;s output buffer.</p>
</div>
<div class="paragraph">
<p><code>input-buffer</code> or <code>ib</code> moves to the port&#8217;s input buffer.</p>
</div>
<div class="paragraph">
<p><strong>Record commands</strong></p>
</div>
<div class="paragraph">
<p><code>show</code> or <code>s</code> shows the contents of the record.</p>
</div>
<div class="paragraph">
<p><code>fields</code> moves to the list of field names of the record.</p>
</div>
<div class="paragraph">
<p><code>name</code> moves to the name of the record.</p>
</div>
<div class="paragraph">
<p><code>rtd</code> moves to the record-type descriptor of the record.</p>
</div>
<div class="paragraph">
<p><code>ref</code> or <code>r</code> <code><em>name</em></code> moves to the named field of the record, if accessible.</p>
</div>
<div class="paragraph">
<p><code>set!</code> or <code>!</code> <code><em>name</em></code> <code><em>value</em></code> sets the value of the named field of the record, if mutable.</p>
</div>
<div class="paragraph">
<p><strong>Transport Link Cell (TLC) commands</strong></p>
</div>
<div class="paragraph">
<p><code>show</code> or <code>s</code> shows the fields of the TLC.</p>
</div>
<div class="paragraph">
<p><code>keyval</code> moves to the keyval of the TLC.</p>
</div>
<div class="paragraph">
<p><code>tconc</code> moves to the tconc of the TLC.</p>
</div>
<div class="paragraph">
<p><code>next</code> moves to the next link of the TLC.</p>
</div>
<div class="paragraph">
<p><code>ref</code> or <code>r</code> <code><em>n</em></code> moves to the <code><em>nth</em></code> field of the symbol. Field 0 is the keyval, field 1 the tconc, and field 2 the next link. <code><em>n</em></code> defaults to 0.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_3.4.">Section 3.4. The Object Inspector</h3>
<div class="paragraph">
<p>A facility for noninteractive inspection is also provided to allow construction of different inspection interfaces. Like the interactive facility, it allows objects to be examined in ways not ordinarily possible. The noninteractive system follows a simple, object-oriented protocol. Ordinary Scheme objects are encapsulated in procedures, or inspector objects, that take symbolic messages and return either information about the encapsulated object or new inspector objects that encapsulate pieces of the object.</p>
</div>
<div id="debug:s25" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(inspect/object <em>object</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>an inspector object procedure</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>inspect/object</code> is used to turn an ordinary Scheme object into an inspector object. All inspector objects accept the messages <code>type</code>, <code>print</code>, <code>write</code>, and <code>size</code>. The <code>type</code> message returns a symbolic representation of the type of the object. The <code>print</code> and <code>write</code> messages must be accompanied by a port parameter. They cause a representation of the object to be written to the port, using the Scheme procedures <code>pretty-print</code> and <code>write</code>. The <code>size</code> message returns a fixnum representing the size in bytes occupied by the object, including any objects accessible from the current object except those for which the size was already requested via an inspector object derived from the argument of the same <code>inspect/object</code> call.</p>
</div>
<div class="paragraph">
<p>All inspector objects except for variable inspector objects accept the message <code>value</code>, which returns the actual object encapsulated in the inspector object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define x (inspect/object '(1 2 3)))
(x 'type) ⇒ pair
(define p (open-output-string))
(x 'write p)
(get-output-string p) ⇒ "(1 2 3)"
(x 'length) ⇒ (proper 3)
(define y (x 'car))
(y 'type) ⇒ simple
(y 'value) ⇒ 1</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Pair inspector objects.</strong> Pair inspector objects contain Scheme pairs.</p>
</div>
<div class="paragraph">
<p><code>(<em>pair-object</em> 'type)</code> returns the symbol <code>pair</code>.</p>
</div>
<div class="paragraph">
<p><code>(<em>pair-object</em> 'car)</code> returns an inspector object containing the "car" field of the pair.</p>
</div>
<div class="paragraph">
<p><code>(<em>pair-object</em> 'cdr)</code> returns an inspector object containing the "cdr" field of the pair.</p>
</div>
<div class="paragraph">
<p><code>(<em>pair-object</em> 'length)</code> returns a list of the form <code>(<em>type</em> <em>count</em>)</code>. The type field contains the symbol <code>proper</code>, the symbol <code>improper</code>, or the symbol <code>circular</code>, depending on the structure of the list. The count field contains the number of distinct pairs in the list.</p>
</div>
<div class="paragraph">
<p><strong>Box inspector objects.</strong> Box inspector objects contain <em>Chez Scheme</em> boxes.</p>
</div>
<div class="paragraph">
<p><code>(<em>box-object</em> 'type)</code> returns the symbol <code>box</code>.</p>
</div>
<div class="paragraph">
<p><code>(<em>box-object</em> 'unbox)</code> returns an inspector object containing the contents of the box.</p>
</div>
<div class="paragraph">
<p><strong>TLC inspector objects.</strong> Box inspector objects contain <em>Chez Scheme</em> boxes.</p>
</div>
<div class="paragraph">
<p><code>(<em>tlc-object</em> 'type)</code> returns the symbol <code>tlc</code>.</p>
</div>
<div class="paragraph">
<p><code>(<em>tlc-object</em> 'keyval)</code> returns an inspector object containing the TLC&#8217;s keyval.</p>
</div>
<div class="paragraph">
<p><code>(<em>tlc-object</em> 'tconc)</code> returns an inspector object containing the TLC&#8217;s tconc.</p>
</div>
<div class="paragraph">
<p><code>(<em>tlc-object</em> 'next)</code> returns an inspector object containing the TLC&#8217;s next link.</p>
</div>
<div class="paragraph">
<p><strong>Vector, String, Bytevector, and Fxvector inspector objects.</strong> Vector (bytevector, string, fxvector) inspector objects contain Scheme vectors (bytevectors, strings, fxvectors).</p>
</div>
<div class="paragraph">
<p><code>(<em>vector-object</em> 'type)</code> returns the symbol <code>vector</code> (<code>string</code>, <code>bytevector</code>, <code>fxvector</code>).</p>
</div>
<div class="paragraph">
<p><code>(<em>vector-object</em> 'length)</code> returns the number of elements in the vector or string.</p>
</div>
<div class="paragraph">
<p><code>(<em>vector-object</em> 'ref <em>n</em>)</code> returns an inspector object containing the <code><em>nth</em></code> element of the vector or string.</p>
</div>
<div class="paragraph">
<p><strong>Simple inspector objects.</strong> Simple inspector objects contain unstructured, unmodifiable objects. These include numbers, booleans, the empty list, the end-of-file object, and the void object. They may be examined directly by asking for the <code>value</code> of the object.</p>
</div>
<div class="paragraph">
<p><code>(<em>simple-object</em> 'type)</code> returns the symbol <code>simple</code>.</p>
</div>
<div class="paragraph">
<p><strong>Unbound inspector objects.</strong> Although unbound objects are not normally accessible to Scheme programs, they may be encountered when inspecting variables.</p>
</div>
<div class="paragraph">
<p><code>(<em>unbound-object</em> 'type)</code> returns the symbol <code>unbound</code>.</p>
</div>
<div class="paragraph">
<p><strong>Procedure inspector objects.</strong> Procedure inspector objects contain Scheme procedures.</p>
</div>
<div class="paragraph">
<p><code>(<em>procedure-object</em> 'type)</code> returns the symbol <code>procedure</code>.</p>
</div>
<div class="paragraph">
<p><code>(<em>procedure-object</em> 'length)</code> returns the number of free variables.</p>
</div>
<div class="paragraph">
<p><code>(<em>procedure-object</em> 'ref <em>n</em>)</code> returns an inspector object containing the <code><em>nth</em></code> free variable of the procedure. See the description below of variable inspector objects. <code><em>n</em></code> must be nonnegative and less than the length of the procedure.</p>
</div>
<div class="paragraph">
<p><code>(<em>procedure-object</em> 'eval <em>expr</em>)</code> evaluates expr and returns its value. The values of the procedure&#8217;s free variables are bound within the evaluated expression to identifiers of the form %<em>n</em>, where <em>n</em> is the location number displayed by the inspector. The values of named variables are also bound to their names.</p>
</div>
<div class="paragraph">
<p><code>(<em>procedure-object</em> 'code)</code> returns an inspector object containing the procedure&#8217;s code object. See the description below of code inspector objects.</p>
</div>
<div class="paragraph">
<p><strong>Continuation inspector objects.</strong> Continuations created by <code>call/cc</code> are actually procedures. However, when inspecting such a procedure the underlying data structure that embodies the continuation may be exposed. A continuation structure contains the location at which computation is to resume, the variable values necessary to perform the computation, and a link to the next continuation.</p>
</div>
<div class="paragraph">
<p><code>(<em>continuation-object</em> 'type)</code> returns the symbol <code>continuation</code>.</p>
</div>
<div class="paragraph">
<p><code>(<em>continuation-object</em> 'length)</code> returns the number of free variables.</p>
</div>
<div class="paragraph">
<p><code>(<em>continuation-object</em> 'ref <em>n</em>)</code> returns an inspector object containing the <code><em>nth</em></code> free variable of the continuation. See the description below of variable inspector objects. <code><em>n</em></code> must be nonnegative and less than the length of the continuation.</p>
</div>
<div class="paragraph">
<p><code>(<em>continuation-object</em> 'eval <em>expr</em>)</code> evaluates expr and returns its value. The values of frame locations are bound within the evaluated expression to identifiers of the form %<em>n</em>, where <em>n</em> is the location number displayed by the inspector. The values of named locations are also bound to their names.</p>
</div>
<div class="paragraph">
<p><code>(<em>continuation-object</em> 'code)</code> returns an inspector object containing the code object for the procedure that was active when the current continuation frame was created. See the description below of code inspector objects.</p>
</div>
<div class="paragraph">
<p><code>(<em>continuation-object</em> 'depth)</code> returns the number of frames in the continuation.</p>
</div>
<div class="paragraph">
<p><code>(<em>continuation-object</em> 'link)</code> returns an inspector object containing the next continuation frame. The depth must be greater than 1.</p>
</div>
<div class="paragraph">
<p><code>(<em>continuation-object</em> 'link* <em>n</em>)</code> returns an inspector object containing the <code><em>nth</em></code> continuation link. <code><em>n</em></code> must be less than the depth.</p>
</div>
<div class="paragraph">
<p><code>(<em>continuation-object</em> 'source)</code> returns an inspector object containing the source information attached to the continuation (representing the source for the application that resulted in the formation of the continuation) or <code>#f</code> if no source information is attached.</p>
</div>
<div class="paragraph">
<p><code>(<em>continuation-object</em> 'source-object)</code> returns an inspector object containing the source object for the procedure application that resulted in the formation of the continuation or <code>#f</code> if no source object is attached.</p>
</div>
<div class="paragraph">
<p><code>(<em>continuation-object</em> 'source-path)</code> attempts to find the pathname of the file containing the source for the procedure application that resulted in the formation of the continuation. If successful, three values are returned to identify the file and position of the application within the file: <code><em>path</em></code>, <code><em>line</em></code>, and <code><em>char</em></code>. Two values, a file name and an absolute character position, are returned if the file name is known but the named file cannot be found. The search may be unsuccessful even if a file by the expected name is found in the path if the file has been modified since the source code was compiled. If no file name is known, no values are returned. The parameter <code>source-directories</code> (<a href="#section_12.5.">Section 12.5</a>) determines the set of directories searched for source files identified by relative path names.</p>
</div>
<div class="paragraph">
<p><strong>Code inspector objects.</strong> Code inspector objects contain <em>Chez Scheme</em> code objects.</p>
</div>
<div class="paragraph">
<p><code>(<em>code-object</em> 'type)</code> returns the symbol <code>code</code>.</p>
</div>
<div class="paragraph">
<p><code>(<em>code-object</em> 'name)</code> returns a string or <code>#f</code>. The name associated with a code inspector object is the name of the variable to which the procedure was originally bound or assigned. Since the binding of a variable can be changed, this name association may not always be accurate. <code>#f</code> is returned if the inspector cannot determine a name for the procedure.</p>
</div>
<div class="paragraph">
<p><code>(<em>code-object</em> 'source)</code> returns an inspector object containing the source information attached to the code object or <code>#f</code> if no source information is attached.</p>
</div>
<div class="paragraph">
<p><code>(<em>continuation-object</em> 'source-object)</code> returns an inspector object containing the source object for the code object or <code>#f</code> if no source object is attached.</p>
</div>
<div class="paragraph">
<p><code>(<em>code-object</em> 'source-path)</code> attempts to find the pathname of the file containing the source for the lambda expression that produced the code object. If successful, three values are returned to identify the file and position of the application within the file: <code><em>path</em></code>, <code><em>line</em></code>, and <code><em>char</em></code>. Two values, a file name and an absolute character position, are returned if the file name is known but the named file cannot be found. The search may be unsuccessful even if a file by the expected name is found in the path if the file has been modified since the source code was compiled. If no file name is known, no values are returned. The parameter <code>source-directories</code> (<a href="#section_12.5.">Section 12.5</a>) determines the set of directories searched for source files identified by relative path names.</p>
</div>
<div class="paragraph">
<p><code>(<em>code-object</em> 'free-count)</code> returns the number of free variables in any procedure for which this is the corresponding code.</p>
</div>
<div class="paragraph">
<p><strong>Variable inspector objects.</strong> Variable inspector objects encapsulate variable bindings. Although the actual underlying representation varies, the variable inspector object provides a uniform interface.</p>
</div>
<div class="paragraph">
<p><code>(<em>variable-object</em> 'type)</code> returns the symbol <code>variable</code>.</p>
</div>
<div class="paragraph">
<p><code>(<em>variable-object</em> 'name)</code> returns a symbol or <code>#f</code>. <code>#f</code> is returned if the name is not available or if the variable is a compiler-generated temporary variable. Variable names are not retained when the parameter <code>generate-inspector-information</code> (<a href="#section_12.6.">Section 12.6</a>) is false during compilation.</p>
</div>
<div class="paragraph">
<p><code>(<em>variable-object</em> 'ref)</code> returns an inspector object containing the current value of the variable.</p>
</div>
<div class="paragraph">
<p><code>(<em>variable-object</em> 'set! <em>e</em>)</code> returns unspecified, after setting the current value of the variable to <code><em>e</em></code>. An exception is raised with condition type <code>&amp;assertion</code> if the variable is not assignable.</p>
</div>
<div class="paragraph">
<p><strong>Port inspector objects.</strong> Port inspector objects contain ports.</p>
</div>
<div class="paragraph">
<p><code>(<em>port-object</em> 'type)</code> returns the symbol <code>port</code>.</p>
</div>
<div class="paragraph">
<p><code>(<em>port-object</em> 'input?)</code> returns <code>#t</code> if the port is an input port, <code>#f</code> otherwise.</p>
</div>
<div class="paragraph">
<p><code>(<em>port-object</em> 'output?)</code> returns <code>#t</code> if the port is an output port, <code>#f</code> otherwise.</p>
</div>
<div class="paragraph">
<p><code>(<em>port-object</em> 'binary?)</code> returns <code>#t</code> if the port is a binary port, <code>#f</code> otherwise.</p>
</div>
<div class="paragraph">
<p><code>(<em>port-object</em> 'closed?)</code> returns <code>#t</code> if the port is closed, <code>#f</code> if the port is open.</p>
</div>
<div class="paragraph">
<p><code>(<em>port-object</em> 'name)</code> returns an inspector object containing the port&#8217;s name.</p>
</div>
<div class="paragraph">
<p><code>(<em>port-object</em> 'handler)</code> returns a procedure inspector object encapsulating the port handler, such as would be returned by <code>port-handler</code>.</p>
</div>
<div class="paragraph">
<p><code>(<em>port-object</em> 'output-size)</code> returns the output buffer size as a fixnum if the port is an output port (otherwise the value is unspecified).</p>
</div>
<div class="paragraph">
<p><code>(<em>port-object</em> 'output-index)</code> returns the output buffer index as a fixnum if the port is an output port (otherwise the value is unspecified).</p>
</div>
<div class="paragraph">
<p><code>(<em>port-object</em> 'output-buffer)</code> returns an inspector object containing the string used for buffered output.</p>
</div>
<div class="paragraph">
<p><code>(<em>port-object</em> 'input-size)</code> returns the input buffer size as a fixnum if the port is an input port (otherwise the value is unspecified).</p>
</div>
<div class="paragraph">
<p><code>(<em>port-object</em> 'input-index)</code> returns the input buffer index as a fixnum if the port is an input port (otherwise the value is unspecified).</p>
</div>
<div class="paragraph">
<p><code>(<em>port-object</em> 'input-buffer)</code> returns an inspector object containing the string used for buffered input.</p>
</div>
<div class="paragraph">
<p><strong>Symbol inspector objects.</strong> Symbol inspector objects contain symbols. These include gensyms.</p>
</div>
<div class="paragraph">
<p><code>(<em>symbol-object</em> 'type)</code> returns the symbol <code>symbol</code>.</p>
</div>
<div class="paragraph">
<p><code>(<em>symbol-object</em> 'name)</code> returns a string inspector object. The string name associated with a symbol inspector object is the print representation of a symbol, such as would be returned by the procedure <code>symbol-&gt;string</code>.</p>
</div>
<div class="paragraph">
<p><code>(<em>symbol-object</em> 'gensym?)</code> returns <code>#t</code> if the symbol is a gensym, <code>#f</code> otherwise. Gensyms are created by <code>gensym</code>.</p>
</div>
<div class="paragraph">
<p><code>(<em>symbol-object</em> 'top-level-value)</code> returns an inspector object containing the global value of the symbol.</p>
</div>
<div class="paragraph">
<p><code>(<em>symbol-object</em> 'property-list)</code> returns an inspector object containing the property list for the symbol.</p>
</div>
<div class="paragraph">
<p><strong>Record inspector objects.</strong> Record inspector objects contain records.</p>
</div>
<div class="paragraph">
<p><code>(<em>record-object</em> 'type)</code> returns the symbol <code>record</code>.</p>
</div>
<div class="paragraph">
<p><code>(<em>record-object</em> 'name)</code> returns a string inspector object corresponding to the name of the record type.</p>
</div>
<div class="paragraph">
<p><code>(<em>record-object</em> 'fields)</code> returns an inspector object containing a list of the field names of the record type.</p>
</div>
<div class="paragraph">
<p><code>(<em>record-object</em> 'length)</code> returns the number of fields.</p>
</div>
<div class="paragraph">
<p><code>(<em>record-object</em> 'rtd)</code> returns an inspector object containing the record-type descriptor of the record type.</p>
</div>
<div class="paragraph">
<p><code>(<em>record-object</em> 'accessible? <em>name</em>)</code> returns <code>#t</code> if the named field is accessible, <code>#f</code> otherwise. A field may be inaccessible if optimized away by the compiler.</p>
</div>
<div class="paragraph">
<p><code>(<em>record-object</em> 'ref <em>name</em>)</code> returns an inspector object containing the value of the named field. An exception is raised with condition type <code>&amp;assertion</code> if the named field is not accessible.</p>
</div>
<div class="paragraph">
<p><code>(<em>record-object</em> 'mutable? <em>name</em>)</code> returns <code>#t</code> if the named field is mutable, <code>#f</code> otherwise. A field is immutable if it is not declared mutable or if the compiler optimizes away all assignments to the field.</p>
</div>
<div class="paragraph">
<p><code>(<em>record-object</em> 'set! <em>name</em> <em>value</em>)</code> sets the value of the named field to <code><em>value</em></code>. An exception is raised with condition type <code>&amp;assertion</code> if the named field is not assignable.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_3.5.">Section 3.5. Locating objects</h3>
<div id="debug:s26" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-object-finder <em>pred</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-object-finder <em>pred</em> <em>g</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-object-finder <em>pred</em> <em>x</em> <em>g</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The procedure <code>make-object-finder</code> takes a predicate <code><em>pred</em></code> and two optional arguments: a starting point <code><em>x</em></code> and a maximum generation <code><em>g</em></code>. The starting point defaults to the value of the procedure <code>oblist</code>, and the maximum generation defaults to the value of the parameter <code>collect-maximum-generation</code>. <code>make-object-finder</code> returns an object finder <code><em>p</em></code> that can be used to search for objects satisfying <code><em>pred</em></code> within the starting-point object <code><em>x</em></code>. Immediate objects and objects in generations older than <code><em>g</em></code> are treated as leaves. <code><em>p</em></code> is a procedure accepting no arguments. If an object <code><em>y</em></code> satisfying <code><em>pred</em></code> can be found starting with <code><em>x</em></code>, <code><em>p</em></code> returns a list whose first element is <code><em>y</em></code> and whose remaining elements represent the path of objects from <code><em>x</em></code> to <code><em>y</em></code>, listed in reverse order. <code><em>p</em></code> can be invoked multiple times to find additional objects satisfying the predicate, if any. <code><em>p</em></code> returns <code>#f</code> if no more objects matching the predicate can be found.</p>
</div>
<div class="paragraph">
<p><code><em>p</em></code> maintains internal state recording where it has been so it can restart at the point of the last found object and not return the same object twice. The state can be several times the size of the starting-point object <code><em>x</em></code> and all that is reachable from <code><em>x</em></code>.</p>
</div>
<div class="paragraph">
<p>The interactive inspector provides a convenient interface to the object finder in the form of <code>find</code> and <code>find-next</code> commands.</p>
</div>
<div class="paragraph">
<p>Relocation tables for static code objects are discarded by default, which prevents object finders from providing accurate results when static code objects are involved. That is, they will not find any objects pointed to directly from a code object that has been promoted to the static generation. If this is a problem, the command-line argument <code>--retain-static-relocation</code> can be used to prevent the relocation tables from being discarded.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_3.6.">Section 3.6. Nested object size and composition</h3>
<div class="paragraph">
<p>The procedures <code>compute-size</code> and <code>compute-composition</code> can be used to determine the size or composition of an object, including anything reachable via pointers from the object. Depending on the number of objects reachable from the object, the procedures potentially allocate a large amount of memory. In an application for which knowing the number, size, generation, and types of all objects in the heap is sufficient, <code>object-counts</code> is potentially much more efficient.</p>
</div>
<div class="paragraph">
<p>These procedures treat immediate objects such as fixnums, booleans, and characters as zero-count, zero-byte leaves.</p>
</div>
<div class="paragraph">
<p>By default, these procedures also treat static objects (those in the initial heap) as zero-count, zero-byte leaves. Both procedures accept an optional second argument that specifies the maximum generation of interest, with the symbol <code>static</code> being used to represent the static generation.</p>
</div>
<div class="paragraph">
<p>Objects sometimes point to a great deal more than one might expect. For example, if static data is included, the procedure value of <code>(lambda (x) x)</code> points indirectly to the exception handling subsystem (because of the argument-count check) and many other things as a result of that.</p>
</div>
<div class="paragraph">
<p>Relocation tables for static code objects are discarded by default, which prevents these procedures from providing accurate results when static code objects are involved. That is, they will not find any objects pointed to directly from a code object that has been promoted to the static generation. If accurate sizes and compositions for static code objects are required, the command-line argument <code>--retain-static-relocation</code> can be used to prevent the relocation tables from being discarded.</p>
</div>
<div id="debug:s30" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compute-size <em>object</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compute-size <em>object</em> <em>generation</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>object</em></code> can be any object. <code><em>generation</em></code> must be a fixnum between 0 and the value of <code>collect-maximum-generation</code>, inclusive, or the symbol <code>static</code>. If <code><em>generation</em></code> is not supplied, it defaults to the value of <code>collect-maximum-generation</code>.</p>
</div>
<div class="paragraph">
<p><code>compute-size</code> returns the amount of memory, in bytes, occupied by <code><em>object</em></code> and anything reachable from <code><em>object</em></code> in any generation less than or equal to <code><em>generation</em></code>. Immediate values such as fixnums, booleans, and characters have zero size.</p>
</div>
<div class="paragraph">
<p>The following examples are valid for machines with 32-bit pointers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(compute-size 0) ⇒ 0
(compute-size (cons 0 0)) ⇒ 8
(compute-size (cons (vector #t #f) 0)) ⇒ 24

(compute-size
  (let ([x (cons 0 0)])
    (set-car! x x)
    (set-cdr! x x)
    x))                  ⇒ 8

(define-record-type frob (fields x))
(collect 1 1) ; force rtd into generation 1
(compute-size
  (let ([x (make-frob 0)])
    (cons x x))
  0)                       ⇒ 16</code></pre>
</div>
</div>
<div id="debug:s31" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compute-composition <em>object</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compute-composition <em>object</em> <em>generation</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>object</em></code> can be any object. <code><em>generation</em></code> must be a fixnum between 0 and the value of <code>collect-maximum-generation</code>, inclusive, or the symbol <code>static</code>. If <code><em>generation</em></code> is not supplied, it defaults to the value of <code>collect-maximum-generation</code>.</p>
</div>
<div class="paragraph">
<p><code>compute-composition</code> returns an association list representing the composition of <code><em>object</em></code>, including anything reachable from it in any generation less than or equal to <code><em>generation</em></code>. The association list has the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">((<em>type</em> <em>count</em> . <em>bytes</em>) ...)</code></pre>
</div>
</div>
<div class="paragraph">
<p><code><em>type</em></code> is either the name of a primitive type, represented as a symbol, e.g., <code>pair</code>, or a record-type descriptor (rtd). <code><em>count</em></code> and <code><em>bytes</em></code> are nonnegative fixnums.</p>
</div>
<div class="paragraph">
<p>Immediate values such as fixnums, booleans, and characters are not included in the composition.</p>
</div>
<div class="paragraph">
<p>The following examples are valid for machines with 32-bit pointers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(compute-composition 0) ⇒ ()
(compute-composition (cons 0 0)) ⇒ ((pair 1 . 8))
(compute-composition
  (cons (vector #t #f) 0)) ⇒ ((pair 1 . 8) (vector 1 . 16))

(compute-composition
  (let ([x (cons 0 0)])
    (set-car! x x)
    (set-cdr! x x)
    x))                 ⇒ ((pair 1 . 8)

(define-record-type frob (fields x))
(collect 1 1) ; force rtd into generation 1
(compute-composition
  (let ([x (make-frob 0)])
    (cons x x))
  0)                       ⇒ ((pair 1 . 8)
                                (#&lt;record type frob&gt; 1 . 8))</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chp_4">Chapter 4. Foreign Interface</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Chez Scheme</em> provides two ways to interact with "foreign" code, i.e., code written in other languages. The first is via subprocess creation and communication, which is discussed in the <a href="#section_4.1.">Section 4.1</a>. The second is via static or dynamic loading and invocation from Scheme of procedures written in C and invocation from C of procedures written in Scheme. These mechanisms are discussed in Sections <a href="#section_4.2.">4.2</a> through <a href="#section_4.4.">4.4</a>.</p>
</div>
<div class="paragraph">
<p>The method for static loading of C object code is dependent upon which machine you are running; see the installation instructions distributed with <em>Chez Scheme</em>.</p>
</div>
<div class="sect2">
<h3 id="section_4.1.">Section 4.1. Subprocess Communication</h3>
<div class="paragraph">
<p>Two procedures, <code>system</code> and <code>process</code>, are used to create subprocesses. Both procedures accept a single string argument and create a subprocess to execute the shell command contained in the string. The <code>system</code> procedure waits for the process to exit before returning, however, while the <code>process</code> procedure returns immediately without waiting for the process to exit. The standard input and output files of a subprocess created by <code>system</code> may be used to communicate with the user&#8217;s console. The standard input and output files of a subprocess created by <code>process</code> may be used to communicate with the Scheme process.</p>
</div>
<div id="foreign:s4" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(system <em>command</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>command</em></code> must be a string.</p>
</div>
<div class="paragraph">
<p>The <code>system</code> procedure creates a subprocess to perform the operation specified by <code><em>command</em></code>. The subprocess may communicate with the user through the same console input and console output files used by the Scheme process. After creating the subprocess, <code>system</code> waits for the process to exit before returning.</p>
</div>
<div class="paragraph">
<p>When the subprocess exits, <code>system</code> returns the exit code for the subprocess, unless (on Unix-based systems) a signal caused the subprocess to terminate, in which case <code>system</code> returns the negation of the signal that caused the termination, e.g., -1 for <code>SIGHUP</code>.</p>
</div>
<div id="foreign:s5" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(open-process-ports <em>command</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(open-process-ports <em>command</em> <em>b-mode</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(open-process-ports <em>command</em> <em>b-mode</em> <em>?transcoder</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>command</em></code> must be a string. If <code><em>?transcoder</em></code> is present and not <code>#f</code>, it must be a transcoder, and this procedure creates textual ports, each of whose transcoder is <code><em>?transcoder</em></code>. Otherwise, this procedure returns binary ports. <code><em>b-mode</em></code> specifies the buffer mode used by each of the ports returned by this procedure and defaults to <code>block</code>. Buffer modes are described in <a href="../../the-scheme-programming-language-4th/en/index.html#section_7.2.">Section 7.2</a> of <em>The Scheme Programming Language, 4th Edition</em>.</p>
</div>
<div class="paragraph">
<p><code>open-process-ports</code> creates a subprocess to perform the operation specified by <code><em>command</em></code>. Unlike <code>system</code>, <code>process</code> returns immediately after creating the subprocess, i.e., without waiting for the subprocess to terminate. It returns four values:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code><em>to-stdin</em></code> is an output port to which Scheme can send output to the subprocess through the subprocess&#8217;s standard input file.</p>
</li>
<li>
<p><code><em>from-stdout</em></code> is an input port from which Scheme can read input from the subprocess through the subprocess&#8217;s standard output file.</p>
</li>
<li>
<p><code><em>from-stderr</em></code> is an input port from which Scheme can read input from the subprocess through the subprocess&#8217;s standard error file.</p>
</li>
<li>
<p><code><em>process-id</em></code> is an integer identifying the created subprocess provided by the host operating system.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If the process exits or closes its standard output file descriptor, any procedure that reads input from <code><em>from-stdout</em></code> will return an end-of-file object. Similarly, if the process exits or closes its standard error file descriptor, any procedure that reads input from <code><em>from-stderr</em></code> will return an end-of-file object.</p>
</div>
<div class="paragraph">
<p>The predicate <code>input-port-ready?</code> may be used to detect whether input has been sent by the subprocess to Scheme.</p>
</div>
<div class="paragraph">
<p>It is sometimes necessary to force output to be sent immediately to the subprocess by invoking <code>flush-output-port</code> on <code><em>to-stdin</em></code>, since <em>Chez Scheme</em> buffers the output for efficiency.</p>
</div>
<div class="paragraph">
<p>On UNIX systems, the <code><em>process-id</em></code> is the process identifier for the shell created to execute <code><em>command</em></code>. If <code><em>command</em></code> is used to invoke an executable file rather than a shell command, it may be useful to prepend <code><em>command</em></code> with the string <code>"exec "</code>, which causes the shell to load and execute the named executable directly, without forking a new process---the shell equivalent of a tail call. This will reduce by one the number of subprocesses created and cause <code><em>process-id</em></code> to reflect the process identifier for the executable once the shell has transferred control.</p>
</div>
<div id="foreign:s7" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(process <em>command</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see explanation</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>command</em></code> must be a string.</p>
</div>
<div class="paragraph">
<p><code>process</code> is similar to <code>open-process-ports</code>, but less general. It does not return a port from which the subproces&#8217;s standard error output can be read, and it always creates textual ports. It returns a list of three values rather than the four separate values of <code>open-process-ports</code>. The returned list contains, in order: <code><em>from-stdout</em></code>, <code><em>to-stdin</em></code>, and <code><em>process-id</em></code>, which correspond to the second, first, and fourth return values of <code>open-process-ports</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_4.2.">Section 4.2. Calling out of Scheme</h3>
<div class="paragraph">
<p><em>Chez Scheme</em>'s foreign-procedure interface allows a Scheme program to invoke procedures written in C or in languages that obey the same calling conventions as C. Two steps are necessary before foreign procedures can be invoked from Scheme. First, the foreign procedure must be compiled and loaded, either statically or dynamically, as described in <a href="#section_4.6.">Section 4.6</a>. Then, access to the foreign procedure must be established in Scheme, as described in this section. Once access to a foreign procedure has been established it may be called as an ordinary Scheme procedure.</p>
</div>
<div class="paragraph">
<p>Since foreign procedures operate independently of the Scheme memory management and exception handling system, great care must be taken when using them. Although the foreign-procedure interface provides type checking (at optimize levels less than 3) and type conversion, the programmer must ensure that the sharing of data between Scheme and foreign procedures is done safely by specifying proper argument and result types.</p>
</div>
<div class="paragraph">
<p>Scheme-callable wrappers for foreign procedures can also be created via <code>ftype-ref</code> and function ftypes (<a href="#section_4.5.">Section 4.5</a>).</p>
</div>
<div id="foreign:s10" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(foreign-procedure <em>conv</em> ... <em>entry-exp</em> (<em>param-type</em> ...) <em>res-type</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a procedure</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>entry-exp</em></code> must evaluate to a string representing a valid foreign procedure entry point or an integer representing the address of the foreign procedure. The <code><em>param-types</em></code> and <code><em>res-type</em></code> must be symbols or structured forms as described below. When a <code>foreign-procedure</code> expression is evaluated, a Scheme procedure is created that will invoke the foreign procedure specified by <code><em>entry-exp</em></code>. When the procedure is called each argument is checked and converted according to the specified <code><em>param-type</em></code> before it is passed to the foreign procedure. The result of the foreign procedure call is converted as specified by the <code><em>res-type</em></code>. Multiple procedures may be created for the same foreign entry.</p>
</div>
<div class="paragraph">
<p>Each <code><em>conv</em></code> adjusts specifies the calling convention to be used. A <code>#f</code> is allowed as <code><em>conv</em></code> to indicate the default calling convention on the target machine (so the <code>#f</code> has no effect). Three other conventions are currently supported under Windows: <code>__stdcall</code>, <code>__cdecl</code>, and <code>__com</code> (32-bit only). Since <code>__cdecl</code> is the default, specifying <code>__cdecl</code> is equivalent to specifying <code>#f</code> or no convention. Finally, <code><em>conv</em></code> can be <code>__collect_safe</code> to indicate that garbage collection is allowed concurrent to a call of the foreign procedure.</p>
</div>
<div class="paragraph">
<p>Use <code>__stdcall</code> to access most Windows API procedures. Use <code>__cdecl</code> for Windows API varargs procedures, for C library procedures, and for most other procedures. Use <code>__com</code> to invoke COM interface methods; COM uses the <code>__stdcall</code> convention but additionally performs the indirections necessary to obtain the correct method from a COM instance. The address of the COM instance must be passed as the first argument, which should normally be declared as <code>iptr</code>. For the <code>__com</code> interface only, <code><em>entry-exp</em></code> must evaluate to the byte offset of the method in the COM vtable. For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(foreign-procedure __com 12 (iptr double-float) integer-32)</code></pre>
</div>
</div>
<div class="paragraph">
<p>creates an interface to a COM method at offset 12 in the vtable encapsulated within the COM instance passed as the first argument, with the second argument being a double float and the return value being an integer.</p>
</div>
<div class="paragraph">
<p>Use <code>__collect_safe</code> to declare that garbage collection is allowed concurrent to the foreign procedure. The <code>__collect_safe</code> declaration allows concurrent collection by deactivating the current thread (see <code>fork-thread</code>) when the foreign procedure is called, and the thread is activated again when the foreign procedure returns. The <code>__collect_safe</code> declaration is useful, for example, when calling a blocking I/O call to allow other Scheme threads to run normally. Refrain from passing collectable memory to a <code>__collect_safe</code> foreign procedure, or use <code>lock-object</code> to lock the memory in place; see also <code>Sdeactivate_thread</code>. The <code>__collect_safe</code> declaration has no effect on a non-threaded version of the system.</p>
</div>
<div class="paragraph">
<p>For example, calling the C <code>sleep</code> function with the default convention will block other Scheme threads from performing a garbage collection, but adding the <code>__collect_safe</code> declaration avoids that problem:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define c-sleep
  (foreign-procedure __collect_safe "sleep" (unsigned) unsigned))
(c-sleep 10) ; sleeps for 10 seconds without blocking other threads</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a foreign procedure that is called with <code>__collect_safe</code> can invoke callables, then each callable should also be declared with <code>__collect_safe</code> so that the callable reactivates the thread.</p>
</div>
<div class="paragraph">
<p>Complete type checking and conversion is performed on the parameters to a foreign procedure. The types <code>scheme-object</code>, <code>string</code>, <code>wstring</code>, <code>u8*</code>, <code>u16*</code>, <code>u32*</code>, <code>utf-8</code>, <code>utf-16le</code>, <code>utf-16be</code>, <code>utf-32le</code>, and <code>utf-32be</code>, must be used with caution, however, since they allow allocated Scheme objects to be used in places the Scheme memory management system cannot control. No problems will arise as long as such objects are not retained in foreign variables or data structures while Scheme code is running, and as long as they are not passed as arguments to a <code>__collect_safe</code> procedure, since garbage collection can occur only while Scheme code is running or when concurrent garbage collection is enabled. Other parameter types are converted to equivalent foreign representations and consequently they can be retained indefinitely in foreign variables and data structures.</p>
</div>
<div class="paragraph">
<p>For argument types <code>string</code>, <code>wstring</code>, <code>utf-8</code>, <code>utf-16le</code>, <code>utf-16be</code>, <code>utf-32le</code>, and <code>utf-32be</code>, an argument is converted to a fresh object that is passed to the foreign procedure. Since the fresh object is not accessible for locking before the call, it can never be treated correctly for a <code>__collect_safe</code> foreign procedure, so those types are disallowed as argument types for a <code>__collect_safe</code> foreign procedure. For analogous reasons, those types are disallowed as the result of a <code>__collect_safe</code> foreign callable.</p>
</div>
<div class="paragraph">
<p>Following are the valid parameter types:</p>
</div>
<div id="foreign:s28" class="paragraph">
<p><code>integer-8</code>: Exact integers from -2<sup>7</sup> through 2<sup>8</sup> - 1 are valid. Integers in the range 2<sup>7</sup> through 2<sup>8</sup> - 1 are treated as two&#8217;s complement representations of negative numbers, e.g., <code>#xff</code> is treated as -1. The argument is passed to C as an integer of the appropriate size (usually <code>signed char</code>).</p>
</div>
<div id="foreign:s29" class="paragraph">
<p><code>unsigned-8</code>: Exact integers from -2<sup>7</sup> to 2<sup>8</sup> - 1 are valid. Integers in the range -2<sup>7</sup> through -1 are treated as the positive equivalents of their two&#8217;s complement representation, e.g., -1 is treated as <code>#xff</code>. The argument is passed to C as an unsigned integer of the appropriate size (usually <code>unsigned char</code>).</p>
</div>
<div id="foreign:s30" class="paragraph">
<p><code>integer-16</code>: Exact integers from -2<sup>15</sup> through 2<sup>16</sup> - 1 are valid. Integers in the range 2<sup>15</sup> through 2<sup>16</sup> - 1 are treated as two&#8217;s complement representations of negative numbers, e.g., <code>#xffff</code> is treated as -1. The argument is passed to C as an integer of the appropriate size (usually <code>short</code>).</p>
</div>
<div id="foreign:s31" class="paragraph">
<p><code>unsigned-16</code>: Exact integers from -2<sup>15</sup> to 2<sup>16</sup> - 1 are valid. Integers in the range -2<sup>15</sup> through -1 are treated as the positive equivalents of their two&#8217;s complement representation, e.g., -1 is treated as <code>#xffff</code>. The argument is passed to C as an unsigned integer of the appropriate size (usually <code>unsigned short</code>).</p>
</div>
<div id="foreign:s32" class="paragraph">
<p><code>integer-32</code>: Exact integers from -2<sup>31</sup> through 2<sup>32</sup> - 1 are valid. Integers in the range 2<sup>31</sup> through 2<sup>32</sup> - 1 are treated as two&#8217;s complement representations of negative numbers, e.g., <code>#xffffffff</code> is treated as -1. The argument is passed to C as an integer of the appropriate size (usually <code>int</code>).</p>
</div>
<div id="foreign:s33" class="paragraph">
<p><code>unsigned-32</code>: Exact integers from -2<sup>31</sup> to 2<sup>32</sup> - 1 are valid. Integers in the range -2<sup>31</sup> through -1 are treated as the positive equivalents of their two&#8217;s complement representation, e.g., -1 is treated as <code>#xffffffff</code>. The argument is passed to C as an unsigned integer of the appropriate size (usually <code>unsigned int</code>).</p>
</div>
<div id="foreign:s34" class="paragraph">
<p><code>integer-64</code>: Exact integers from -2<sup>63</sup> through 2<sup>64</sup> - 1 are valid. Integers in the range 2<sup>63</sup> through 2<sup>64</sup> - 1 are treated as two&#8217;s complement representations of negative numbers. The argument is passed to C as an integer of the appropriate size (usually <code>long long</code> or, on many 64-bit platforms, <code>long</code>).</p>
</div>
<div id="foreign:s35" class="paragraph">
<p><code>unsigned-64</code>: Exact integers from -2<sup>63</sup> through 2<sup>64</sup> - 1 are valid. Integers in the range -2<sup>63</sup> through -1 are treated as the positive equivalents of their two&#8217;s complement representation, The argument is passed to C as an integer of the appropriate size (usually <code>unsigned long long</code> or, on many 64-bit platforms, <code>long</code>).</p>
</div>
<div id="foreign:s36" class="paragraph">
<p><code>double-float</code>: Only Scheme flonums are valid---other Scheme numeric types are not automatically converted. The argument is passed to C as a double float.</p>
</div>
<div id="foreign:s37" class="paragraph">
<p><code>single-float</code>: Only Scheme flonums are valid---other Scheme numeric types are not automatically converted. The argument is passed to C as a single float. Since <em>Chez Scheme</em> represents flonums in double-float format, the parameter is first converted into single-float format.</p>
</div>
<div id="foreign:s38" class="paragraph">
<p><code>short</code>: This type is an alias for the appropriate fixed-size type above, depending on the size of a C <code>short</code>.</p>
</div>
<div id="foreign:s39" class="paragraph">
<p><code>unsigned-short</code>: This type is an alias for the appropriate fixed-size type above, depending on the size of a C <code>unsigned short</code>.</p>
</div>
<div id="foreign:s40" class="paragraph">
<p><code>int</code>: This type is an alias for the appropriate fixed-size type above, depending on the size of a C <code>int</code>.</p>
</div>
<div id="foreign:s41" class="paragraph">
<p><code>unsigned</code>: This type is an alias for the appropriate fixed-size type above, depending on the size of a C <code>unsigned</code>.</p>
</div>
<div id="foreign:s42" class="paragraph">
<p><code>unsigned-int</code>: This type is an alias <code>unsigned</code>. fixed-size type above, depending on the size of a C <code>unsigned</code>.</p>
</div>
<div id="foreign:s43" class="paragraph">
<p><code>long</code>: This type is an alias for the appropriate fixed-size type above, depending on the size of a C <code>long</code>.</p>
</div>
<div id="foreign:s44" class="paragraph">
<p><code>unsigned-long</code>: This type is an alias for the appropriate fixed-size type above, depending on the size of a C <code>unsigned long</code>.</p>
</div>
<div id="foreign:s45" class="paragraph">
<p><code>long-long</code>: This type is an alias for the appropriate fixed-size type above, depending on the size of the nonstandard C type <code>long long</code>.</p>
</div>
<div id="foreign:s46" class="paragraph">
<p><code>unsigned-long-long</code>: This type is an alias for the appropriate fixed-size type above, depending on the size of the nonstandard C type <code>unsigned long long</code>.</p>
</div>
<div id="foreign:s47" class="paragraph">
<p><code>ptrdiff_t</code>: This type is an alias for the appropriate fixed-size type above, depending on its definition in the host machine&#8217;s <code>stddef.h</code> include file.</p>
</div>
<div id="foreign:s48" class="paragraph">
<p><code>size_t</code>: This type is an alias for the appropriate unsigned fixed-size type above, depending on its definition in the host machine&#8217;s <code>stddef.h</code> include file.</p>
</div>
<div id="foreign:s49" class="paragraph">
<p><code>ssize_t</code>: This type is an alias for the appropriate signed fixed-size type above, depending on its definition in the host machine&#8217;s <code>stddef.h</code> include file.</p>
</div>
<div id="foreign:s50" class="paragraph">
<p><code>iptr</code>: This type is an alias for the appropriate fixed-size type above, depending on the size of a C pointer.</p>
</div>
<div id="foreign:s51" class="paragraph">
<p><code>uptr</code>: This type is an alias for the appropriate (unsigned) fixed-size type above, depending on the size of a C pointer.</p>
</div>
<div id="foreign:s52" class="paragraph">
<p><code>void*</code>: This type is an alias for <code>uptr</code>.</p>
</div>
<div id="foreign:s53" class="paragraph">
<p><code>fixnum</code>: This type is equivalent to <code>iptr</code>, except only values in the fixnum range are valid. Transmission of fixnums is slightly faster than transmission of <code>iptr</code> values, but the fixnum range is smaller, so some <code>iptr</code> values do not have a fixnum representation.</p>
</div>
<div id="foreign:s54" class="paragraph">
<p><code>boolean</code>: Any Scheme object may be passed as a boolean. <code>#f</code> is converted to 0; all other objects are converted to 1. The argument is passed to C as an <code>int</code>.</p>
</div>
<div id="foreign:s55" class="paragraph">
<p><code>char</code>: Only Scheme characters with Unicode scalar values in the range 0 through 255 are valid <code>char</code> parameters. The character is converted to its Unicode scalar value, as with <code>char-&gt;integer</code>, and passed to C as an <code>unsigned char</code>.</p>
</div>
<div id="foreign:s56" class="paragraph">
<p><code>wchar_t</code>: Only Scheme characters are valid <code>wchar_t</code> parameters. Under Windows and any other system where <code>wchar_t</code> holds only 16-bit values rather than full Unicode scalar values, only characters with 16-bit Unicode scalar values are valid. On systems where <code>wchar_t</code> is a full 32-bit value, any Scheme character is valid. The character is converted to its Unicode scalar value, as with <code>char-&gt;integer</code>, and passed to C as a <code>wchar_t</code>.</p>
</div>
<div id="foreign:s57" class="paragraph">
<p><code>wchar</code>: This type is an alias for <code>wchar_t</code>.</p>
</div>
<div id="foreign:s58" class="paragraph">
<p><code>double</code>: This type is an alias for <code>double-float</code>.</p>
</div>
<div id="foreign:s59" class="paragraph">
<p><code>float</code>: This type is an alias for <code>single-float</code>.</p>
</div>
<div id="foreign:s60" class="paragraph">
<p><code>scheme-object</code>: The argument is passed directly to the foreign procedure; no conversion or type checking is performed. This form of parameter passing should be used with discretion. Scheme objects should not be preserved in foreign variables or data structures since the memory management system may relocate them between foreign procedure calls.</p>
</div>
<div id="foreign:s61" class="paragraph">
<p><code>ptr</code>: This type is an alias for <code>scheme-object</code>.</p>
</div>
<div id="foreign:s62" class="paragraph">
<p><code>u8*</code>: The argument must be a Scheme bytevector or <code>#f</code>. For <code>#f</code>, the null pointer (0) is passed to the foreign procedure. For a bytevector, a pointer to the first byte of the bytevector&#8217;s data is passed. If the C routine to which the data is passed requires the input to be null-terminated, a null (0) byte must be included explicitly in the bytevector. The bytevector should not be retained in foreign variables or data structures, since the memory management system may relocate or discard them between foreign procedure calls, and use their storage for some other purpose.</p>
</div>
<div id="foreign:s63" class="paragraph">
<p><code>u16*</code>: Arguments of this type are treated just like arguments of type <code>u8*</code>. If the C routine to which the data is passed requires the input to be null-terminated, two null (0) bytes must be included explicitly in the bytevector, aligned on a 16-bit boundary.</p>
</div>
<div id="foreign:s64" class="paragraph">
<p><code>u32*</code>: Arguments of this type are treated just like arguments of type <code>u8*</code>. If the C routine to which the data is passed requires the input to be null-terminated, four null (0) bytes must be included explicitly in the bytevector, aligned on a 32-bit boundary.</p>
</div>
<div id="foreign:s65" class="paragraph">
<p><code>utf-8</code>: The argument must be a Scheme string or <code>#f</code>. For <code>#f</code>, the null pointer (0) is passed to the foreign procedure. A string is converted into a bytevector, as if via <code>string-&gt;utf8</code>, with an added null byte, and the address of the first byte of the bytevector is passed to C. The bytevector should not be retained in foreign variables or data structures, since the memory management system may relocate or discard them between foreign procedure calls and use their storage for some other purpose. The <code>utf-8</code> argument type is not allowed for a <code>__collect_safe</code> foreign procedure.</p>
</div>
<div id="foreign:s66" class="paragraph">
<p><code>utf-16le</code>: Arguments of this type are treated like arguments of type <code>utf-8</code>, except they are converted as if via <code>string-&gt;utf16</code> with endianness <code>little</code>, and they are extended by two null bytes rather than one.</p>
</div>
<div id="foreign:s67" class="paragraph">
<p><code>utf-16be</code>: Arguments of this type are treated like arguments of type <code>utf-8</code>, except they are converted as if via <code>string-&gt;utf16</code> with endianness <code>big</code>, and they are extended by two null bytes rather than one.</p>
</div>
<div id="foreign:s68" class="paragraph">
<p><code>utf-32le</code>: Arguments of this type are treated like arguments of type <code>utf-8</code>, except they are converted as if via <code>string-&gt;utf32</code> with endianness <code>little</code>, and they are extended by four null bytes rather than one.</p>
</div>
<div id="foreign:s69" class="paragraph">
<p><code>utf-32be</code>: Arguments of this type are treated like arguments of type <code>utf-8</code>, except they are converted as if via <code>string-&gt;utf32</code> with endianness <code>big</code>, and they are extended by four null bytes rather than one.</p>
</div>
<div id="foreign:s70" class="paragraph">
<p><code>string</code>: This type is an alias for <code>utf-8</code>.</p>
</div>
<div id="foreign:s71" class="paragraph">
<p><code>wstring</code>: This type is an alias for <code>utf-16le</code>, <code>utf-16be</code>, <code>utf-32le</code>, or <code>utf-32be</code> as appropriate depending on the size of a C <code>wchar_t</code> and the endianness of the target machine. For example, <code>wstring</code> is equivalent to <code>utf-16le</code> under Windows running on Intel hardware.</p>
</div>
<div id="foreign:s72" class="paragraph">
<p><code>(* <em>ftype</em>)</code>: This type allows a pointer to a foreign type (ftype) to be passed. The argument must be an ftype pointer of type <code><em>ftype</em></code>, and the actual argument is the address encapsulated in the ftype pointer. See <a href="#section_4.5.">Section 4.5</a> for a description of foreign types.</p>
</div>
<div id="foreign:s73" class="paragraph">
<p><code>(&amp; <em>ftype</em>)</code>: This type allows a foreign type (ftype) to be passed as a value, but represented on the Scheme side as a pointer to the foreign-type data. That is, a <code>(&amp; <em>ftype</em>)</code> argument is represented on the Scheme side the same as a <code>(* <em>ftype</em>)</code> argument, but a <code>(&amp; <em>ftype</em>)</code> argument is passed to the foreign procedure as the content at the foreign pointer&#8217;s address instead of as the address. For example, if <code><em>ftype</em></code> is a <code>struct</code> type, then <code>(&amp; <em>ftype</em>)</code> passes a struct argument instead of a struct-pointer argument. The <code><em>ftype</em></code> cannot refer to an array type.</p>
</div>
<div class="paragraph">
<p>The result types are similar to the parameter types with the addition of a <code>void</code> type. In general, the type conversions are the inverse of the parameter type conversions. No error checking is performed on return, since the system cannot determine whether a foreign result is actually of the indicated type. Particular caution should be exercised with the result types <code>scheme-object</code>, <code>double-float</code>, <code>double</code>, <code>single-float</code>, <code>float</code>, and the types that result in the construction of bytevectors or strings, since invalid return values may lead to invalid memory references as well as incorrect computations. Following are the valid result types:</p>
</div>
<div id="foreign:s80" class="paragraph">
<p><code>void</code>: The result of the foreign procedure call is ignored and an unspecified Scheme object is returned. <code>void</code> should be used when foreign procedures are called for effect only.</p>
</div>
<div id="foreign:s81" class="paragraph">
<p><code>integer-8</code>: The result is interpreted as a signed 8-bit integer and is converted to a Scheme exact integer.</p>
</div>
<div id="foreign:s82" class="paragraph">
<p><code>unsigned-8</code>: The result is interpreted as an unsigned 8-bit integer and is converted to a Scheme nonnegative exact integer.</p>
</div>
<div id="foreign:s83" class="paragraph">
<p><code>integer-16</code>: The result is interpreted as a signed 16-bit integer and is converted to a Scheme exact integer.</p>
</div>
<div id="foreign:s84" class="paragraph">
<p><code>unsigned-16</code>: The result is interpreted as an unsigned 16-bit integer and is converted to a Scheme nonnegative exact integer.</p>
</div>
<div id="foreign:s85" class="paragraph">
<p><code>integer-32</code>: The result is interpreted as a signed 32-bit integer and is converted to a Scheme exact integer.</p>
</div>
<div id="foreign:s86" class="paragraph">
<p><code>unsigned-32</code>: The result is interpreted as an unsigned 32-bit integer and is converted to a Scheme nonnegative exact integer.</p>
</div>
<div id="foreign:s87" class="paragraph">
<p><code>integer-64</code>: The result is interpreted as a signed 64-bit integer and is converted to a Scheme exact integer.</p>
</div>
<div id="foreign:s88" class="paragraph">
<p><code>unsigned-64</code>: The result is interpreted as an unsigned 64-bit integer and is converted to a Scheme nonnegative exact integer.</p>
</div>
<div id="foreign:s89" class="paragraph">
<p><code>double-float</code>: The result is interpreted as a double float and is translated into a <em>Chez Scheme</em> flonum.</p>
</div>
<div id="foreign:s90" class="paragraph">
<p><code>single-float</code>: The result is interpreted as a single float and is translated into a <em>Chez Scheme</em> flonum. Since <em>Chez Scheme</em> represents flonums in double-float format, the result is first converted into double-float format.</p>
</div>
<div id="foreign:s91" class="paragraph">
<p><code>short</code>: This type is an alias for the appropriate fixed-size type above, depending on the size of a C <code>short</code>.</p>
</div>
<div id="foreign:s92" class="paragraph">
<p><code>unsigned-short</code>: This type is an alias for the appropriate fixed-size type above, depending on the size of a C <code>unsigned short</code>.</p>
</div>
<div id="foreign:s93" class="paragraph">
<p><code>int</code>: This type is an alias for the appropriate fixed-size type above, depending on the size of a C <code>int</code>.</p>
</div>
<div id="foreign:s94" class="paragraph">
<p><code>unsigned</code>: This type is an alias for the appropriate fixed-size type above, depending on the size of a C <code>unsigned</code>.</p>
</div>
<div id="foreign:s95" class="paragraph">
<p><code>unsigned-int</code>: This type is an alias <code>unsigned</code>. fixed-size type above, depending on the size of a C <code>unsigned</code>.</p>
</div>
<div id="foreign:s96" class="paragraph">
<p><code>long</code>: This type is an alias for the appropriate fixed-size type above, depending on the size of a C <code>long</code>.</p>
</div>
<div id="foreign:s97" class="paragraph">
<p><code>unsigned-long</code>: This type is an alias for the appropriate fixed-size type above, depending on the size of a C <code>unsigned long</code>.</p>
</div>
<div id="foreign:s98" class="paragraph">
<p><code>long-long</code>: This type is an alias for the appropriate fixed-size type above, depending on the size of the nonstandard C type <code>long long</code>.</p>
</div>
<div id="foreign:s99" class="paragraph">
<p><code>unsigned-long-long</code>: This type is an alias for the appropriate fixed-size type above, depending on the size of the nonstandard C type <code>unsigned long long</code>.</p>
</div>
<div id="foreign:s100" class="paragraph">
<p><code>ptrdiff_t</code>: This type is an alias for the appropriate fixed-size type above, depending on its definition in the host machine&#8217;s <code>stddef.h</code> include file.</p>
</div>
<div id="foreign:s101" class="paragraph">
<p><code>size_t</code>: This type is an alias for the appropriate unsigned fixed-size type above, depending on its definition in the host machine&#8217;s <code>stddef.h</code> include file.</p>
</div>
<div id="foreign:s102" class="paragraph">
<p><code>ssize_t</code>: This type is an alias for the appropriate signed fixed-size type above, depending on its definition in the host machine&#8217;s <code>stddef.h</code> include file.</p>
</div>
<div id="foreign:s103" class="paragraph">
<p><code>iptr</code>: This type is an alias for the appropriate fixed-size type above, depending on the size of a C pointer.</p>
</div>
<div id="foreign:s104" class="paragraph">
<p><code>uptr</code>: This type is an alias for the appropriate (unsigned) fixed-size type above, depending on the size of a C pointer.</p>
</div>
<div id="foreign:s105" class="paragraph">
<p><code>void*</code>: This type is an alias for <code>uptr</code>.</p>
</div>
<div id="foreign:s106" class="paragraph">
<p><code>boolean</code>: This type converts a C <code>int</code> return value into a Scheme boolean. 0 is converted to <code>#f</code>; all other values are converted to <code>#t</code>.</p>
</div>
<div id="foreign:s107" class="paragraph">
<p><code>char</code>: This type converts a C <code>unsigned char</code> return value into a Scheme character, as if via <code>integer-&gt;char</code>.</p>
</div>
<div id="foreign:s108" class="paragraph">
<p><code>wchar_t</code>: This type converts a C <code>wchar_t</code> return value into a Scheme character, as if via <code>integer-&gt;char</code>. The <code>wchar_t</code> value must be a valid Unicode scalar value.</p>
</div>
<div id="foreign:s109" class="paragraph">
<p><code>wchar</code>: This type is an alias for <code>wchar_t</code>.</p>
</div>
<div id="foreign:s110" class="paragraph">
<p><code>double</code>: This type is an alias for <code>double-float</code>.</p>
</div>
<div id="foreign:s111" class="paragraph">
<p><code>float</code>: This type is an alias for <code>single-float</code>.</p>
</div>
<div id="foreign:s112" class="paragraph">
<p><code>scheme-object</code>: The result is assumed to be a valid Scheme object, and no conversion is performed. This type is inherently dangerous, since an invalid Scheme object can corrupt the memory management system with unpredictable (but always unpleasant) results. Since Scheme objects are actually typed pointers, even integers cannot safely be returned as type <code>scheme-object</code> unless they were created by the Scheme system.</p>
</div>
<div id="foreign:s113" class="paragraph">
<p><code>ptr</code>: This type is an alias for <code>scheme-object</code>.</p>
</div>
<div id="foreign:s114" class="paragraph">
<p><code>u8*</code>: The result is interpreted as a pointer to a null-terminated sequence of 8-bit unsigned integers (bytes). If the result is a null pointer, <code>#f</code> is returned. Otherwise, the sequence of bytes is stored in a freshly allocated bytevector of the appropriate length, and the bytevector is returned to Scheme.</p>
</div>
<div id="foreign:s115" class="paragraph">
<p><code>u16*</code>: The result is interpreted as a pointer to a null-terminated sequence of 16-bit unsigned integers. If the result is a null pointer, <code>#f</code> is returned. Otherwise, the sequence of 16-bit integers is stored in a freshly allocated bytevector of the appropriate length, and the bytevector is returned to Scheme. The null terminator must be a properly aligned 16-bit word, i.e., two bytes of zero aligned on a 16-bit boundary.</p>
</div>
<div id="foreign:s116" class="paragraph">
<p><code>u32*</code>: The result is interpreted as a pointer to a null-terminated sequence of 32-bit unsigned integers. If the result is a null pointer, <code>#f</code> is returned. Otherwise, the sequence of 16-bit integers is stored in a freshly allocated bytevector of the appropriate length, and the bytevector is returned to Scheme. The null terminator must be a properly aligned 32-bit word, i.e., four bytes of zero aligned on a 32-bit boundary.</p>
</div>
<div id="foreign:s117" class="paragraph">
<p><code>utf-8</code>: The result is interpreted as a pointer to a null-terminated sequence of 8-bit unsigned character values. If the result is a null pointer, <code>#f</code> is returned. Otherwise, the sequence of bytes is converted into a Scheme string, as if via <code>utf8-&gt;string</code>, and the string is returned to Scheme.</p>
</div>
<div id="foreign:s118" class="paragraph">
<p><code>utf-16le</code>: The result is interpreted as a pointer to a null-terminated sequence of 16-bit unsigned integers. If the result is a null pointer, <code>#f</code> is returned. Otherwise, the sequence of integers is converted into a Scheme string, as if via <code>utf16-&gt;string</code> with endianness <code>little</code>, and the string is returned to Scheme. A byte-order mark in the sequence of integers as treated as an ordinary character value and does not affect the byte ordering.</p>
</div>
<div id="foreign:s119" class="paragraph">
<p><code>utf-16be</code>: The result is interpreted as a pointer to a null-terminated sequence of 16-bit unsigned integers. If the result is a null pointer, <code>#f</code> is returned. Otherwise, the sequence of integers is converted into a Scheme string, as if via <code>utf16-&gt;string</code> with endianness <code>big</code>, and the string is returned to Scheme. A byte-order mark in the sequence of integers as treated as an ordinary character value and does not affect the byte ordering.</p>
</div>
<div id="foreign:s120" class="paragraph">
<p><code>utf-32le</code>: The result is interpreted as a pointer to a null-terminated sequence of 32-bit unsigned integers. If the result is a null pointer, <code>#f</code> is returned. Otherwise, the sequence of integers is converted into a Scheme string, as if via <code>utf32-&gt;string</code> with endianness <code>little</code>, and the string is returned to Scheme. A byte-order mark in the sequence of integers as treated as an ordinary character value and does not affect the byte ordering.</p>
</div>
<div id="foreign:s121" class="paragraph">
<p><code>utf-32be</code>: The result is interpreted as a pointer to a null-terminated sequence of 32-bit unsigned integers. If the result is a null pointer, <code>#f</code> is returned. Otherwise, the sequence of integers is converted into a Scheme string, as if via <code>utf32-&gt;string</code> with endianness <code>big</code>, and the string is returned to Scheme. A byte-order mark in the sequence of integers as treated as an ordinary character value and does not affect the byte ordering.</p>
</div>
<div id="foreign:s122" class="paragraph">
<p><code>string</code>: This type is an alias for <code>utf-8</code>.</p>
</div>
<div id="foreign:s123" class="paragraph">
<p><code>wstring</code>: This type is an alias for <code>utf-16le</code>, <code>utf-16be</code>, <code>utf-32le</code>, or <code>utf-32be</code> as appropriate depending on the size of a C <code>wchar_t</code> and the endianness of the target machine. For example, <code>wstring</code> is equivalent to <code>utf-16le</code> under Windows running on Intel hardware.</p>
</div>
<div id="foreign:s124" class="paragraph">
<p><code>(* <em>ftype</em>)</code>: The result is interpreted as the address of a foreign object whose structure is described by <code><em>ftype</em></code>, and a freshly allocated ftype pointer encapsulating the address is returned. See <a href="#section_4.5.">Section 4.5</a> for a description of foreign types.</p>
</div>
<div id="foreign:s125" class="paragraph">
<p><code>(&amp; <em>ftype</em>)</code>: The result is interpreted as a foreign object whose structure is described by <code><em>ftype</em></code>, where the foreign procedure returns a <code><em>ftype</em></code> result, but the caller must provide an extra <code>(* <em>ftype</em>)</code> argument before all other arguments to receive the result. An unspecified Scheme object is returned when the foreign procedure is called, since the result is instead written into storage referenced by the extra argument. The <code><em>ftype</em></code> cannot refer to an array type.</p>
</div>
<div class="paragraph">
<p>Consider a C identity procedure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="c" class="language-c hljs">int id(x) int x; { return x; }</code></pre>
</div>
</div>
<div class="paragraph">
<p>After a file containing this procedure has been compiled and loaded (see <a href="#section_4.6.">Section 4.6</a>) it can be accessed as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(foreign-procedure "id"
  (int) int) ⇒ #&lt;procedure&gt;
((foreign-procedure "id"
   (int) int)
 1) ⇒ 1
(define int-id
  (foreign-procedure "id"
    (int) int))
(int-id 1) ⇒ 1</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>"id"</code> entry can also be interpreted as accepting and returning a boolean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define bool-id
  (foreign-procedure "id"
    (boolean) boolean))
(bool-id #f) ⇒ #f
(bool-id #t) ⇒ #t
(bool-id 1) ⇒ #t</code></pre>
</div>
</div>
<div class="paragraph">
<p>As the last example reveals, <code>bool-id</code> is actually a conversion procedure. When a Scheme object is passed as type <code>boolean</code> it is converted to 0 or 1, and when it is returned it is converted to <code>#f</code> or <code>#t</code>. As a result objects are converted to normalized boolean values. The <code>"id"</code> entry can be used to create other conversion procedures by varying the type specifications:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define int->bool
  (foreign-procedure "id"
    (int) boolean))
(int->bool 0) ⇒ #f
(int->bool 5) ⇒ #t
(map (foreign-procedure "id"
       (boolean) int)
     '(#t #f)) ⇒ (1 0)
(define void
  (foreign-procedure "id"
    (int) void))
(void 10) ⇒ <em>unspecified</em></code></pre>
</div>
</div>
<div class="paragraph">
<p>There are, of course, simpler and more efficient ways of accomplishing these conversions directly in Scheme.</p>
</div>
<div class="paragraph">
<p>A foreign entry is resolved when a <code>foreign-procedure</code> expression is evaluated, rather than either when the code is loaded or each time the procedure is invoked. Thus, the following definition is always valid since the <code>foreign-procedure</code> expression is not immediately evaluated:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define doit
  (lambda ()
    ((foreign-procedure "doit" () void))))</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>doit</code> should not be invoked, however, before an entry for <code>"doit"</code> has been provided. Similarly, an entry for <code>"doit"</code> must exist before the following code is evaluated:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define doit
  (foreign-procedure "doit" () void))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Although the second definition is more constraining on the load order of foreign files, it is more efficient since the entry resolution need be done only once.</p>
</div>
<div class="paragraph">
<p>It is often useful to define a template to be used in the creation of several foreign procedures with similar argument types and return values. For example, the following code creates two foreign procedures from a single foreign procedure expression, by abstracting out the foreign procedure name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define double->double
  (lambda (proc-name)
    (foreign-procedure proc-name
      (double)
      double)))

(define log10 (double->double "log10"))
(define gamma (double->double "gamma"))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Both <code>"log10"</code> and <code>"gamma"</code> must be available as foreign entries (see <a href="#section_4.6.">Section 4.6</a>) before the corresponding definitions. The use of foreign procedure templates can simplify the coding process and reduce the amount of code generated when a large number of foreign procedures are involved, e.g., when an entire library of foreign procedures is imported into Scheme.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_4.3.">Section 4.3. Calling into Scheme</h3>
<div class="paragraph">
<p><a href="#section_4.2.">Section 4.2</a> describes the <code>foreign-procedure</code> form, which permits Scheme code to invoke C or C-compatible foreign procedures. This section describes the <code>foreign-callable</code> form, which permits C or C-compatible code to call Scheme procedures. A more primitive mechanism for calling Scheme procedures from C is described in <a href="#section_4.8.">Section 4.8</a>.</p>
</div>
<div class="paragraph">
<p>As when calling foreign procedures from Scheme, great care must be taken when sharing data between Scheme and foreign code that calls Scheme to avoid corrupting Scheme&#8217;s memory management system.</p>
</div>
<div class="paragraph">
<p>A foreign-callable wrapper for a Scheme procedure can also be created by passing the procedure to <code>make-ftype-pointer</code> with an appropriate function ftype (<a href="#section_4.5.">Section 4.5</a>).</p>
</div>
<div id="foreign:s127" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(foreign-callable <em>conv</em> ... <em>proc-exp</em> (<em>param-type</em> ...) <em>res-type</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a code object</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>proc-exp</em></code> must evaluate to a procedure, the Scheme procedure that is to be invoked by foreign code. The parameter and result types are as described for <code>foreign-procedure</code> in <a href="#section_4.2.">Section 4.2</a>, except that the requirements and conversions are effectively reversed, e.g., the conversions described for <code>foreign-procedure</code> arguments are performed for <code>foreign-callable</code> return values. A <code>(&amp; <em>ftype</em>)</code> argument to the callable refers to an address that is valid only during the dynamic extent of the callback invocation. A <code>(&amp; <em>ftype</em>)</code> result type for a callable causes the Scheme procedure to receive an extra <code>(&amp; <em>ftype</em>)</code> argument before all others; the Scheme procedure should write a result into the extra argument, and the direct result of the Scheme procedure is ignored. Type checking is performed for result values but not argument values, since the parameter values are provided by the foreign code and must be assumed to be correct.</p>
</div>
<div class="paragraph">
<p>Each <code><em>conv</em></code> adjusts the calling convention to be used. <code>foreign-callable</code> supports the same conventions as <code>foreign-procedure</code> with the exception of <code>__com</code>. The <code>__collect_safe</code> convention for a callable activates a calling thread if the thread is not already activated, and the thread&#8217;s activation state is reverted when the callable returns. If a calling thread is not currently registered with the Scheme system, then reverting the thread&#8217;s activation state implies destroying the thread&#8217;s registration (see <code>Sdestroy_thread</code>).</p>
</div>
<div class="paragraph">
<p>The value produced by <code>foreign-callable</code> is a Scheme code object, which contains some header information as well as code that performs the call to the encapsulated Scheme procedure. The code object may be converted into a foreign-callable address via <code>foreign-callable-entry-point</code>, which returns an integer representing the address of the entry point within the code object. (The C-callable library function <code>Sforeign_callable_entry_point</code>, described in <a href="#section_4.8.">Section 4.8</a>, may be used to obtain the entry point as well.) This is an implicit pointer into a Scheme object, and in many cases, it is necessary to lock the code object (using <code>lock-object</code>) before converting it into an entry point to prevent Scheme&#8217;s storage management system from relocating or destroying the code object, e.g., when the entry point is registered as a callback and retained in the "C" side indefinitely.</p>
</div>
<div class="paragraph">
<p>The following code creates a foreign-callable code object, locks the code object, and returns the entry point.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([x (foreign-callable
           (lambda (x y) (pretty-print (cons x (* y 2))))
           (string integer-32)
           void)])
  (lock-object x)
  (foreign-callable-entry-point x))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Unless the entry point is intended to be permanent, a pointer to the code object returned by <code>foreign-callable</code> should be retained so that it can be unlocked when no longer needed.</p>
</div>
<div class="paragraph">
<p>Mixed use of <code>foreign-callable</code> and <code>foreign-procedure</code> may result in nesting of foreign and Scheme calls, and this results in some interesting considerations when continuations are involved, directly or indirectly (as via the default exception handler). See <a href="#section_4.4.">Section 4.4</a> for a discussion of the interaction between foreign calls and continuations.</p>
</div>
<div class="paragraph">
<p>The following example demonstrates how the "callback" functions required by many windowing systems might be defined in Scheme with the use of <code>foreign-callable</code>. Assume that the following C code has been compiled and loaded (see <a href="#section_4.6.">Section 4.6</a>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="c" class="language-c hljs">#include &lt;stdio.h&gt;

typedef void (*CB)(char);

CB callbacks[256];

void cb_init(void) {
   int i;

   for (i = 0; i < 256; i += 1)
       callbacks[i] = (CB)0;
}

void register_callback(char c, CB cb) {
    callbacks[c] = cb;
}

void event_loop(void) {
    CB f; char c;

    for (;;) {
        c = getchar();
        if (c == EOF) break;
        f = callbacks[c];
        if (f != (CB)0) f(c);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Interfaces to these functions may be defined in Scheme as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define cb-init
  (foreign-procedure "cb_init" () void))
(define register-callback
  (foreign-procedure "register_callback" (char void*) void))
(define event-loop
  (foreign-procedure __collect_safe "event_loop" () void))</code></pre>
</div>
</div>
<div class="paragraph">
<p>A callback for selected characters can then be defined.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define callback
  (lambda (p)
    (let ([code (foreign-callable __collect_safe p (char) void)])
      (lock-object code)
      (foreign-callable-entry-point code))))
(define ouch
  (callback
    (lambda (c)
      (printf "Ouch! Hit by '~c'~%" c))))
(define rats
  (callback
    (lambda (c)
      (printf "Rats! Received '~c'~%" c))))

(cb-init)
(register-callback #\a ouch)
(register-callback #\c rats)
(register-callback #\e ouch)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This sets up the following interaction.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (event-loop)
a
Ouch! Hit by 'a'
b
c
Rats! Received 'c'
d
e
Ouch! Hit by 'e'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>__collect_safe</code> declarations in this example ensure that other threads can continue working while <code>event-loop</code> blocks waiting for input. A more well-behaved version of the example would save each code object returned by <code>foreign-callable</code> and unlock it when it is no longer registered as a callback.</p>
</div>
<div id="foreign:s130" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(foreign-callable-entry-point <em>code</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the address of the foreign-callable entry point in <code><em>code</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>code</em></code> should be a code object produced by <code>foreign-callable</code>.</p>
</div>
<div id="foreign:s131" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(foreign-callable-code-object <em>address</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the code object corresponding to the foreign-callable entry point <code><em>address</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>address</em></code> must be an exact integer and should be the address of the entry point of a code object produced by <code>foreign-callable</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_4.4.">Section 4.4. Continuations and Foreign Calls</h3>
<div class="paragraph">
<p><code>foreign-callable</code> and <code>foreign-procedure</code> allow arbitrary nesting of foreign and Scheme calls. Because other languages do not support the fully general first-class continuations of Scheme, the interaction between continuations and nested calls among Scheme and foreign procedures is problematic. <em>Chez Scheme</em> handles this interaction in a general manner by trapping attempts to return to <em>stale</em> foreign contexts rather than by restricting the use of continuations directly. A foreign context is a foreign frame and return point corresponding to a particular call from a foreign language, e.g., C, into Scheme. A foreign context becomes stale after a normal return to the context or after a return to some other foreign context beneath it on the control stack.</p>
</div>
<div class="paragraph">
<p>As a result of this treatment, Scheme continuations may be used to throw control either upwards or downwards logically through any mix of Scheme and foreign frames. Furthermore, until some return to a foreign context is actually performed, all return points remain valid. In particular, this means that programs that use continuations exclusively for nonlocal exits never attempt to return to a stale foreign context. (Nonlocal exits themselves are no problem and are implemented by the C library function <code>longjmp</code> or the equivalent.) Programs that use continuations more generally also function properly as long as they never actually return to a stale foreign context, even if control logically moves past stale foreign contexts via invocation of continuations.</p>
</div>
<div class="paragraph">
<p>One implication of this mechanism is that the C stack pointer is not automatically restored to its base value when a continuation is used on the Scheme side to perform a nonlocal exit. If the program continues to run after the nonlocal exit, any further build-up of the C stack will add to the existing build up, which might result in a C stack overflow. To avoid this situation, a program can arrange to set up a single C call frame before obtaining the continuation and return to the C frame after the nonlocal exit. The procedure <code>with-exit-proc</code> below arranges to do this without involving any C code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define with-exit-proc
  (lambda (p)
    (define th (lambda () (call/cc p)))
    (define-ftype ->ptr (function () ptr))
    (let ([fptr (make-ftype-pointer ->ptr th)])
      (let ([v ((ftype-ref ->ptr () fptr))])
        (unlock-object
          (foreign-callable-code-object
            (ftype-pointer-address fptr)))
        v))))</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>with-exit-proc</code> behaves like <code>call/cc</code> except it resets the C stack when the continuation is invoked. To do this, it creates an ftype-pointer representing a foreign-callable entry point for <code>th</code> and creates a Scheme-callable procedure for that entry point. This creates a wrapper for <code>th</code> that involves a C call. When a call to the wrapper returns, either by explicit invocation of the continuation passed to <code>p</code> or by a normal return from <code>p</code>, the C stack is reset to its original value.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_4.5.">Section 4.5. Foreign Data</h3>
<div class="paragraph">
<p>The procedures described in this section directly create and manipulate foreign data, i.e., data that resides outside of the Scheme heap. With the exception of <code>foreign-alloc</code> and <code>foreign-sizeof</code>, these procedures are inherently unsafe in the sense that they do not (and cannot) check the validity of the addresses they are passed. Improper use of these procedures can result in invalid memory references, corrupted data, or system crashes.</p>
</div>
<div class="paragraph">
<p>This section also describes a higher-level syntactic mechanism for manipulating foreign data, including foreign structures, unions, arrays, and bit fields. The syntactic interface is safer than the procedural interface but must still assume that the addresses it&#8217;s given are appropriate for the types of object being manipulated.</p>
</div>
<div id="foreign:s132" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(foreign-alloc <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the address of a freshly allocated block of foreign data <code><em>n</em></code> bytes long</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>n</em></code> must be a positive fixnum. The returned value is an exact integer and is guaranteed to be properly aligned for any type of value according to the requirements of the underlying hardware. An exception is raised with condition type <code>&amp;assertion</code> if the block of foreign data cannot be allocated.</p>
</div>
<div id="foreign:s133" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(foreign-free <em>address</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure frees the block of storage to which <code><em>address</em></code> points. <code><em>address</em></code> must be an exact integer in the range -2<sup><em>w</em>-1</sup> through 2<sup><em>w</em></sup> - 1, where <em>w</em> is the width in bits of a pointer, e.g., 64 for a 64-bit machine. It should be an address returned by an earlier call to <code>foreign-alloc</code> and not subsequently passed to <code>foreign-free</code>.</p>
</div>
<div id="foreign:s134" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(foreign-ref <em>type</em> <em>address</em> <em>offset</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>foreign-ref</code> extracts the value of type <code><em>type</em></code> <code><em>offset</em></code> bytes into the block of foreign data addressed by <code><em>address</em></code>.</p>
</div>
<div class="paragraph">
<p><code><em>type</em></code> must be a symbol identifying the type of value to be extracted. The following types have machine-dependent sizes and correspond to the like-named C types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>short</code>,</p>
</li>
<li>
<p><code>unsigned-short</code>,</p>
</li>
<li>
<p><code>int</code>,</p>
</li>
<li>
<p><code>unsigned</code>,</p>
</li>
<li>
<p><code>unsigned-int</code>,</p>
</li>
<li>
<p><code>long</code>,</p>
</li>
<li>
<p><code>unsigned-long</code>,</p>
</li>
<li>
<p><code>long-long</code>,</p>
</li>
<li>
<p><code>unsigned-long-long</code>,</p>
</li>
<li>
<p><code>ptrdiff_t</code>,</p>
</li>
<li>
<p><code>size_t</code>,</p>
</li>
<li>
<p><code>ssize_t</code>,</p>
</li>
<li>
<p><code>char</code>,</p>
</li>
<li>
<p><code>wchar_t</code>,</p>
</li>
<li>
<p><code>float</code>,</p>
</li>
<li>
<p><code>double</code>, and</p>
</li>
<li>
<p><code>void*</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The types <code>long-long</code> and <code>unsigned-long-long</code> correspond to the C types <code>long long</code> and <code>unsigned long long</code>. A value of type <code>char</code> is referenced as a single byte and converted (as if via <code>integer-&gt;char</code>) into a Scheme character. A value of type <code>wchar_t</code> is converted (as if via <code>integer-&gt;char</code>) into a Scheme character. The value must be a valid Unicode scalar value.</p>
</div>
<div class="paragraph">
<p><code>wchar</code> is an alias for <code>wchar_t</code>.</p>
</div>
<div class="paragraph">
<p>Several additional machine-dependent types are recognized:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>iptr</code>,</p>
</li>
<li>
<p><code>uptr</code>,</p>
</li>
<li>
<p><code>fixnum</code>, and</p>
</li>
<li>
<p><code>boolean</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>uptr</code> is equivalent to <code>void*</code>; both are treated as unsigned integers the size of a pointer. <code>iptr</code> is treated as a signed integer the size of a pointer. <code>fixnum</code> is treated as an <code>iptr</code>, but with a range limited to the fixnum range. <code>boolean</code> is treated as an <code>int</code>, with zero converted to the Scheme value <code>#f</code> and all other values converted to <code>#t</code>.</p>
</div>
<div class="paragraph">
<p>Finally, several fixed-sized types are also supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>integer-8</code>,</p>
</li>
<li>
<p><code>unsigned-8</code>,</p>
</li>
<li>
<p><code>integer-16</code>,</p>
</li>
<li>
<p><code>unsigned-16</code>,</p>
</li>
<li>
<p><code>integer-32</code>,</p>
</li>
<li>
<p><code>unsigned-32</code>,</p>
</li>
<li>
<p><code>integer-64</code>,</p>
</li>
<li>
<p><code>unsigned-64</code>,</p>
</li>
<li>
<p><code>single-float</code>, and</p>
</li>
<li>
<p><code>double-float</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code><em>address</em></code> must be an exact integer in the range -2<sup><em>w</em>-1</sup> through 2<sup><em>w</em></sup> - 1, where <em>w</em> is the width in bits of a pointer, e.g., 64 for a 64-bit machine. <code><em>offset</em></code> must be an exact fixnum. The sum of <code><em>address</em></code> and <code><em>offset</em></code> should address a readable block of memory large enough to hold a value of type <code><em>type</em></code>, within a block of storage previously returned by <code>foreign-alloc</code> and not subsequently freed by <code>foreign-free</code> or within a block of storage obtained via some other mechanism, e.g., a foreign call. For multiple-byte values, the native endianness of the machine is assumed.</p>
</div>
<div id="foreign:s135" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(foreign-set! <em>type</em> <em>address</em> <em>offset</em> <em>value</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>foreign-set!</code> stores a representation of <code><em>value</em></code> as type <code><em>type</em></code> <code><em>offset</em></code> bytes into the block of foreign data addressed by <code><em>address</em></code>.</p>
</div>
<div class="paragraph">
<p><code><em>type</em></code> must be a symbol identifying the type of value to be stored, one of those listed in the description of <code>foreign-ref</code> above. Scheme characters are converted to type <code>char</code> or <code>wchar_t</code> as if via <code>char-&gt;integer</code>. For type <code>boolean</code>, Scheme <code>#f</code> is converted to the <code>int</code> 0, and any other Scheme object is converted to 1.</p>
</div>
<div class="paragraph">
<p><code><em>address</em></code> must be an exact integer in the range -2<sup><em>w</em>-1</sup> through 2<sup><em>w</em></sup> - 1, where <em>w</em> is the width in bits of a pointer, e.g., 64 for a 64-bit machine. <code><em>offset</em></code> must be an exact fixnum. The sum of <code><em>address</em></code> and <code><em>offset</em></code> should address a writable block of memory large enough to hold a value of type <code><em>type</em></code>, within a block of storage previously returned by <code>foreign-alloc</code> and not subsequently freed by <code>foreign-free</code> or within a block of storage obtained via some other mechanism, e.g., a foreign call. <code><em>value</em></code> must be an appropriate value for <code><em>type</em></code>, e.g., a floating-point number for the float types or an exact integer within the appropriate range for the integer types. For multiple-byte values, the native endianness of the machine is assumed.</p>
</div>
<div id="foreign:s136" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(foreign-sizeof <em>type</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the size in bytes of <code><em>type</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>type</em></code> must be one of the symbols listed in the description of <code>foreign-ref</code> above. <a id="foreign:s137"></a></p>
</div>
<div id="defn:define-ftype" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(define-ftype <em>ftype-name</em> <em>ftype</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(define-ftype (<em>ftype-name</em> <em>ftype</em>) ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="foreign:s139" class="paragraph">
<p>A <code>define-ftype</code> form is a definition and can appear anywhere other definitions can appear. It establishes one or more foreign-type (ftype) bindings for the identifier <code><em>ftype-name</em></code> or identifiers <code><em>ftype-name</em> ...</code> to the foreign type represented <code><em>ftype</em></code> or the foreign types represented by <code><em>ftype</em> ...</code>. Each <code><em>ftype-name</em></code> can be used to access foreign objects with the declared shape, and each can be used in the formation of other ftypes.</p>
</div>
<div class="paragraph">
<p>An <code><em>ftype</em></code> must take one of the following forms:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs"><em>ftype-name</em>
(struct (<em>field-name</em> <em>ftype</em>) ...)
(union (<em>field-name</em> <em>ftype</em>) ...)
(array <em>length</em> <em>ftype</em>)
(* <em>ftype</em>)
(bits (<em>field-name</em> <em>signedness</em> <em>bits</em>) ...)
(function <em>conv</em> ... (<em>ftype</em> ...) <em>ftype</em>)
(packed <em>ftype</em>)
(unpacked <em>ftype</em>)
(endian <em>endianness</em> <em>ftype</em>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code><em>length</em></code> is an exact nonnegative integer, <code><em>bits</em></code> is an exact positive integer, <code><em>field-name</em></code> is an identifier, <code><em>conv</em></code> is <code>#f</code> or a string naming a valid convention as described on page 4.2, signedness is either <code>signed</code> or <code>unsigned</code>, and endianness is one of <code>native</code>, <code>big</code>, or <code>little</code>.</p>
</div>
<div class="paragraph">
<p>A restriction not reflected above is that <code>function</code> ftypes cannot be used as the types of field names or array elements. That is, function ftypes are valid only at the top level of an ftype, e.g,:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-ftype bvcopy_t (function (u8* u8* size_t) void))</code></pre>
</div>
</div>
<div class="paragraph">
<p>or as the immediate sub-type of a pointer (<code>*</code>) ftype, as in the following definitions, which are equivalent assuming the definition of <code>bvcopy_t</code> above.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-ftype A
  (struct
    [x int]
    [f (* (function (u8* u8* size_t) void))]))

(define-ftype A
  (struct
    [x int]
    [f (* bvcopy_t)]))</code></pre>
</div>
</div>
<div class="paragraph">
<p>That is, a function cannot be embedded within a struct, union, or array, but a pointer to a function can be so embedded.</p>
</div>
<div class="paragraph">
<p>The following definitions establish ftype bindings for <code>F</code>, <code>A</code>, and <code>E</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-ftype F (function (wchar_t int) int))

(define-ftype A (array 10 wchar_t))

(define-ftype E
  (struct
    [a int]
    [b double]
    [c (array 25
         (struct
           [a short]
           [_ long]
           [b A]))]
    [d (endian big
         (union
           [v1 unsigned-32]
           [v2 (bits
                 [hi unsigned 12]
                 [lo unsigned 20])]))]
    [e (* A)]
    [f (* F)]))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The ftype <code>F</code> describes the type of a foreign function that takes two arguments, a wide character and an integer, and returns an integer. The ftype <code>A</code> is simply an array of 10 <code>wchar_t</code> values, and its size will be 10 times the size of a single <code>wchar_t</code>. The ftype <code>E</code> is a structure with five fields: an integer <code>a</code>, a double-float <code>b</code>, an array <code>c</code>, a union <code>d</code>, and a pointer <code>e</code>. The array <code>c</code> is an array of 25 structs, each of which contains a short integer, a long integer, and a <code>A</code> array. The size of the <code>c</code> array will be 25 times the size of a single <code>A</code> array, plus 25 times the space needed to store each of the short and long integers. The union <code>d</code> is either a 32-bit unsigned integer or a 32-bit unsigned integer split into high (12 bits) and low (20 bits) components. The fields of a union overlap so that writing to one effectively overlaps the other. Thus, one can use the <code>d</code> union type to split apart an unsigned integer by writing the integer into <code>v1</code> and reading the pieces from <code>hi</code> and <code>lo</code>. The pointer <code>e</code> points to an <code>A</code> array; it is not itself an array, and its size is just the size of a single pointer. Similarly, <code>f</code> points to a function, and its size is also that of a single pointer.</p>
</div>
<div class="paragraph">
<p>An underscore ( <code>_</code> ) can be used as the field name for one or more fields of a <code>struct</code>, <code>union</code>, or <code>bits</code> ftype. Such fields are included in the layout but are considered unnamed and cannot be accessed via the ftype operators described below. Thus, in the example above, the <code>long</code> field within the <code>c</code> array is inaccessible.</p>
</div>
<div class="paragraph">
<p>Non-underscore field names are handled symbolically, i.e., they are treated as symbols rather than identifiers. Each symbol must be unique (as a symbol) with respect to the other field names within a single <code>struct</code>, <code>union</code>, or <code>bits</code> ftype but need not be unique with respect to field names in other <code>struct</code>, <code>union</code>, or <code>bits</code> ftypes within the same ftype.</p>
</div>
<div class="paragraph">
<p>Each <code><em>ftype-name</em></code> in an <code><em>ftype</em></code> must either (a) have been defined previously by <code>define-ftype</code>, (b) be defined by the current <code>define-ftype</code>, or (c) be a base-type name, i.e., one of the type names supported by <code>foreign-ref</code> and <code>foreign-set!</code>. In case (b), any reference within one <code><em>ftype</em></code> to the <code><em>ftype-name</em></code> of one of the earlier bindings is permissible, but a reference to the <code><em>ftype-name</em></code> of the current or a subsequent binding can appear only within a pointer field.</p>
</div>
<div class="paragraph">
<p>For example, in:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-ftype
  [Qlist (struct
           [head int]
           [tail (* Qlist)])])</code></pre>
</div>
</div>
<div class="paragraph">
<p>the reference to <code>Qlist</code> is permissible since it appears within a pointer field. Similarly, in:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-ftype
  [Qfrob (struct
           [head int]
           [tail (* Qsnark)])]
  [Qsnark (struct
            [head int]
            [xtra Qfrob]
            [tail (* Qfrob)])])</code></pre>
</div>
</div>
<div class="paragraph">
<p>the mutually recursive references to <code>Qsnark</code> and <code>Qfrob</code> are permissible. In the following, however:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-ftype
  [Qfrob (struct
           [head int]
           [xtra Qfrob]
           [tail (* Qsnark)])]
  [Qsnark (struct
            [head int]
            [tail (* Qfrob)])])</code></pre>
</div>
</div>
<div class="paragraph">
<p>the reference to <code>Qfrob</code> within the <code><em>ftype</em></code> for <code>Qfrob</code> is invalid, and in:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-ftype
  [Qfrob (struct
           [head int]
           [xtra Qsnark]
           [tail (* Qsnark)])]
  [Qsnark (struct
            [head int]
            [tail (* Qfrob)])])</code></pre>
</div>
</div>
<div class="paragraph">
<p>the reference to <code>Qsnark</code> is similarly invalid.</p>
</div>
<div class="paragraph">
<p>By default, padding is inserted where appropriate to maintain proper alignment of multiple-byte scalar values in an attempt to mirror the target machine&#8217;s C struct layout conventions, where such layouts are adequately documented. For packed ftypes (ftypes wrapped in a <code>packed</code> form with no closer enclosing <code>unpacked</code> form), this padding is not inserted.</p>
</div>
<div class="paragraph">
<p>Multiple-byte scalar values are stored in memory using the target machine&#8217;s native "endianness," e.g., <code>little</code> on X86 and X86_64-based platforms and <code>big</code> on Sparc-based platforms. Big-endian or little-endian representation can be forced via the <code>endian</code> ftype with a <code>big</code> or <code>little</code> <code><em>endianness</em></code> specifier. The <code>native</code> specifier can be used to force a return back to <code>native</code> representation. Each <code>endian</code> form affects only ftypes nested syntactically within it and not nested within a closer <code>endian</code> form.</p>
</div>
<div class="paragraph">
<p>The total size <em>n</em> of the fields within an ftype bits form must be 8, 16, 24, 32, 40, 48, 56, or 64. padding must be added manually if needed. In little-endian representation, the first field occupies the low-order bits of the containing 8, 16, 24, 32, 40, 48, 56, or 64-bit word, with each subsequent field just above the preceding field. In big-endian representation, the first field occupies the high-order bits, with each subsequent field just below the preceding field.</p>
</div>
<div class="paragraph">
<p>Two ftypes are considered equivalent only if defined by the same <code>ftype</code> binding. If two ftype definitions look identical but appear in two parts of the same program, the ftypes are not identical, and attempts to access one using the name of the other via the operators described below will fail with a run-time exception.</p>
</div>
<div class="paragraph">
<p>Array bounds must always be constant. If an array&#8217;s length cannot be known until run time, the array can be placed at the end of the ftype (and any containing ftype) and declared to have size zero, as illustrated by the example below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-ftype Vec
  (struct
    [len int]
    [data (array 0 double)]))
(define make-Vec
  (lambda (n)
    (let ([fptr (make-ftype-pointer Vec
                  (foreign-alloc
                    (+ (ftype-sizeof Vec)
                       (* (ftype-sizeof double) n))))])
      (ftype-set! Vec (len) fptr n)
      fptr)))
(define x (make-Vec 100))
(/ (- (ftype-pointer-address (ftype-&ref Vec (data 10) x))
      (ftype-pointer-address x)                            ⇒ 10
      (ftype-sizeof int))
   (ftype-sizeof double))
(foreign-free (ftype-pointer-address x))</code></pre>
</div>
</div>
<div class="paragraph">
<p>No array bounds checks are performed for zero-length arrays. Only one variable-sized array can appear in a single foreign object, but one can work around this by treating the object as multiple individual objects.</p>
</div>
<div class="paragraph">
<p>To avoid specifying the constant length of an array in more than one place, a macro that binds both a variable to the size as well as an ftype name to the ftype can be used. For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax define-array
  (syntax-rules ()
    [(_ array-name type size-name size)
     (begin
       (define size-name size)
       (define-ftype array-name
         (array size type)))]))
(define-array A int A-size 100)
A-size ⇒ 100
(ftype-pointer-ftype
  (make-ftype-pointer A
    (foreign-alloc (ftype-sizeof A)))) ⇒ (array 100 int)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This technique can be used to define arbitrary ftypes with arbitrary numbers of array fields.</p>
</div>
<div id="foreign:s141" class="paragraph">
<p>A struct ftype is an implicit subtype of the type of the first field of the struct. Similarly, an array ftype is an implicit subtype of the type of its elements. Thus, the struct or array extends the type of first field or element with additional fields or elements. This allows an instance of the struct or array to be treated as an instance of the type of its first field or element, without the need to use <code>ftype-&amp;ref</code> to allocate a new pointer to the field or element.</p>
</div>
<div id="foreign:s142" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-sizeof <em>ftype-name</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the size in bytes of the ftype identified by <code><em>ftype-name</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The size includes the sizes of any ftypes directly embedded within the identified ftype but excludes those indirectly embedded via a pointer ftype. In the latter case, the size of the pointer is included.</p>
</div>
<div class="paragraph">
<p><code><em>ftype-name</em></code> must not be defined as a function ftype, since the size of a function cannot generally be determined.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-ftype B
  (struct
    [b1 integer-32]
    [b2 (array 10 integer-32)]))
(ftype-sizeof B) ⇒ 44

(define-ftype C (* B))
(ftype-sizeof C) ⇒ 4  <em>; on 32-bit machines</em>
(ftype-sizeof C) ⇒ 8  <em>; on 64-bit machines</em>

(define-ftype BB
  (struct
    [bb1 B]
    [bb2 (* B)]))
(- (ftype-sizeof BB) (ftype-sizeof void*)) ⇒ 44</code></pre>
</div>
</div>
<div id="desc:make-ftype-pointer" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(make-ftype-pointer <em>ftype-name</em> <em>expr</em>)</code> <a id="foreign:s143"></a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>an ftype-pointer object</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code><em>ftype-name</em></code> does not describe a function ftype, <code><em>expr</em></code> must evaluate to an <code><em>address</em></code> represented as an exact integer in the appropriate range for the target machine.</p>
</div>
<div class="paragraph">
<p>The ftype-pointer object returned by this procedure encapsulates the address and is tagged with a representation of the type identified by <code><em>ftype-name</em></code> to enable various forms of checking to be done by the access routines described below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(make-ftype-pointer E #x80000000) ⇒ #&lt;ftype-pointer #x80000000&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The address will not typically be a constant, as shown. Instead, it might instead come from a call to <code>foreign-alloc</code>, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(make-ftype-pointer E (foreign-alloc (ftype-sizeof E)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>It might also come from source outside of Scheme such as from a C routine called from Scheme via the foreign-procedure interface.</p>
</div>
<div class="paragraph">
<p>If <code><em>ftype-name</em></code> describes a function ftype, <code><em>expr</em></code> must evaluate to an address, procedure, or string. If it evaluates to address, the call behaves like any other call to <code>make-ftype-pointer</code> with an address argument.</p>
</div>
<div class="paragraph">
<p>If it evaluates to a procedure, a foreign-callable code object is created for the procedure, as if via <code>foreign-callable</code> (<a href="#section_4.3.">Section 4.3</a>). The address encapsulated in the resulting ftype-pointer object is the address of the procedure&#8217;s entry point.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define fact
  (lambda (n)
    (if (= n 0) 1 (fact (- n 1)))))
(define-ftype fact_t (function (int) int))
(define fact-fptr (make-ftype-pointer fact_t fact))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The resulting ftype pointer can be passed to a C routine, if the argument is declared to be a pointer to the same ftype, and the C routine can invoke the function pointer it receives as it would any other function pointer. Thus, <code>make-ftype-pointer</code> with a function ftype is an alternative to <code>foreign-callable</code> for creating C-callable wrappers for Scheme procedures.</p>
</div>
<div class="paragraph">
<p>Since all Scheme objects, including code objects, can be relocated or even reclaimed by the garbage collector the foreign-callable code object is automatically locked, as if via <code>lock-object</code>, before it is embedded in the ftype pointer. The code object should be unlocked after its last use from C, since locked objects take up space, cause fragmentation, and increase the cost of collection. Since the system cannot determine automatically when the last use from C occurs, the program must explicitly unlock the code object, which it can do by extracting the address from the ftype-pointer converting the address (back) into a code object, and passing it to <code>unlock-object</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(unlock-object
  (foreign-callable-code-object
    (ftype-pointer-address fact-fptr)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once unlocked, the ftype pointer should not be used again, unless it is relocked, e.g., via:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(lock-object
  (foreign-callable-code-object
    (ftype-pointer-address fact-fptr)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>A program can determine whether an object is already locked via the <code>locked-object?</code> predicate.</p>
</div>
<div class="paragraph">
<p>A function ftype can be also used with <code>make-ftype-pointer</code> to create an ftype-pointer to a C function, either by providing the address of the C function or its name, represented as a string. For example, with the following definition of <code>bvcopy_t</code>,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-ftype bvcopy_t (function (u8* u8* size_t) void))</code></pre>
</div>
</div>
<div class="paragraph">
<p>the two definitions of <code>bvcopy-ftpr</code> below are equivalent.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define bvcopy-fptr (make-ftype-pointer bvcopy_t "memcpy"))
(define bvcopy-fptr (make-ftype-pointer bvcopy_t (foreign-entry "memcpy")))</code></pre>
</div>
</div>
<div class="paragraph">
<p>A library that defines <code><em>memcpy</em></code> must be loaded first via <code>load-shared-object</code>, or <code>memcpy</code> must be registered via one of the methods described in Section  4.6.</p>
</div>
<div id="foreign:s147" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-pointer? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is an ftype pointer, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-pointer? <em>ftype-name</em> <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is an <code><em>ftype-name</em></code>, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-ftype Widget1 (struct [x int] [y int]))
(define-ftype Widget2 (struct [w Widget1] [b boolean]))

(define x1 (make-ftype-pointer Widget1 #x80000000))
(define x2 (make-ftype-pointer Widget2 #x80000000))

(ftype-pointer? x1) ⇒ #t
(ftype-pointer? x2) ⇒ #t

(ftype-pointer? Widget1 x1) ⇒ #t
(ftype-pointer? Widget1 x2) ⇒ #t

(ftype-pointer? Widget2 x1) ⇒ #f
(ftype-pointer? Widget2 x2) ⇒ #t

(ftype-pointer? #x80000000) ⇒ #f
(ftype-pointer? Widget1 #x80000000) ⇒ #f</code></pre>
</div>
</div>
<div id="foreign:s148" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(ftype-pointer-address <em>fptr</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the address encapsulated within <code><em>fptr</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>fptr</em></code> must be an ftype-pointer object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define x (make-ftype-pointer E #x80000000))
(ftype-pointer-address x) ⇒ #x80000000</code></pre>
</div>
</div>
<div id="foreign:s149" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-pointer=? <em>fptr<sub>1</sub></em> <em>fptr<sub>2</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>fptr<sub>1</sub></em></code> and <code><em>fptr<sub>2</sub></em></code> have the same address, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>fptr<sub>1</sub></em></code> and <code><em>fptr<sub>2</sub></em></code> must be ftype-pointer objects.</p>
</div>
<div class="paragraph">
<p><code>ftype-pointer=?</code> might be defined as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ftype-pointer=?
  (lambda (fptr1 fptr2)
    (= (ftype-pointer-address fptr1) (ftype-pointer-address fptr2))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is, however, guaranteed not to allocate bignums for the addresses even if the addresses do not fit in fixnum range.</p>
</div>
<div id="foreign:s150" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-pointer-null? <em>fptr</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the address of <code><em>fptr</em></code> is 0, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>fptr</em></code> must be an ftype-pointer object.</p>
</div>
<div class="paragraph">
<p><code>ftype-pointer-null?</code> might be defined as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ftype-pointer-null?
  (lambda (fptr)
    (= (ftype-pointer-address fptr) 0)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is, however, guaranteed not to allocate a bignum for the address even if the address does not fit in fixnum range.</p>
</div>
<div id="foreign:s151" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-&amp;ref <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-&amp;ref <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em> <em>index</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>an ftype-pointer object</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The ftype-pointer object returned by <code>ftype-&amp;ref</code> encapsulates the address of some object embedded directly or indirectly within the foreign object pointed to by the value of <code><em>fptr-expr</em></code>, offset by <code><em>index</em></code>, if present. The value of <code><em>fptr-expr</em></code> must be an ftype pointer (fptr) of the ftype identified by <code><em>ftype-name</em></code>, and <code><em>index</em></code> must either be the identifier <code>*</code> or evaluate to a fixnum, possibly negative. The index is automatically scaled by the size of the ftype identified by <code><em>ftype-name</em></code>, which allows the fptr to be treated as an array of <code><em>ftype-name</em></code> objects and <code><em>index</em></code> as an index into that array. An index of <code>*</code> or 0 is the same as no index.</p>
</div>
<div class="paragraph">
<p>The sequence of accessors <code><em>a</em> ...</code> must specify a valid path through the identified ftype. For <code>struct</code>, <code>union</code>, and <code>bits</code> ftypes, an accessor must be a valid field name for the ftype, while for pointer and array ftypes, an accessor must be the identifier <code>*</code> or evaluate to a fixnum index. For array ftypes, an index must be nonnegative, and for array ftypes with nonzero length, an index must also be less than the length.</p>
</div>
<div class="paragraph">
<p>The examples below assume the definitions of <code>B</code> and <code>BB</code> shown above in the description of <code>ftype-sizeof</code>. Fixed addresses are shown for illustrative purposes and are assumed to be valid, although addresses are generally determined at run time via <code>foreign-alloc</code> or some other mechanism.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define x (make-ftype-pointer B #x80000000))
(ftype-&ref B () x) ⇒ #&lt;ftype-pointer #x80000000&gt;
(let ([idx 1])             ⇒ #&lt;ftype-pointer #x8000002C&gt;
  (ftype-&ref B () x idx))
(let ([idx -1])            ⇒ #&lt;ftype-pointer #x7FFFFFD4&gt;
  (ftype-&ref B () x idx))
(ftype-&ref B (b1) x) ⇒ #&lt;ftype-pointer #x80000000&gt;
(ftype-&ref B (b2) x) ⇒ #&lt;ftype-pointer #x80000004&gt;
(ftype-&ref B (b2 5) x) ⇒ #&lt;ftype-pointer #x80000018&gt;
(let ([n 5]) (ftype-&ref B (b2 n) x)) ⇒ #&lt;ftype-pointer #x80000018&gt;

(ftype-&ref B (b1 b2) x) ⇒ <em>syntax error</em>
(ftype-&ref B (b2 15) x) ⇒ <em>run-time exception</em>

(define y (make-ftype-pointer BB #x90000000))
(ftype-set! BB (bb2) y x)
(ftype-&ref BB (bb1 b2) y) ⇒ #&lt;ftype-pointer #x90000004&gt;
(ftype-&ref BB (bb2 * b2) y) ⇒ #&lt;ftype-pointer #x80000004&gt;
(let ([idx 1])                    ⇒ #&lt;ftype-pointer #x80000030&gt;
  (ftype-&ref BB (bb2 idx b2) y))</code></pre>
</div>
</div>
<div class="paragraph">
<p>With no accessors and no index, as in the first use of <code>ftype-&amp;ref</code> above, the returned <code>ftype-pointer</code> might be <code>eq?</code> to the input. Otherwise, the <code>ftype-pointer</code> is freshly allocated. <a id="foreign:s152"></a></p>
</div>
<div id="defn:ftype-set!" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-set! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em> <em>val-expr</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-set! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em> <em>index</em> <em>val-expr</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-ref <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-ref <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em> <em>index</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>an ftype-pointer object</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These forms are used to store values into or retrieve values from the object pointed to by the value of <code><em>fptr-expr</em></code>, offset by <code><em>index</em></code>, if present. The value of <code><em>fptr-expr</em></code> must be an ftype pointer (fptr) of the ftype identified by <code><em>ftype-name</em></code>, and <code><em>index</em></code> must either be the identifier <code>*</code> or evaluate to a fixnum, possibly negative. The index is automatically scaled by the size of the ftype identified by <code><em>ftype-name</em></code>, which allows the fptr to be treated as an array of <code><em>ftype-name</em></code> objects and <code><em>index</em></code> as an index into that array. An index of <code>*</code> or 0 is the same as no index.</p>
</div>
<div class="paragraph">
<p>The sequence of accessors <code><em>a</em> ...</code> must specify a valid path through the identified ftype. For <code>struct</code>, <code>union</code>, and <code>bits</code> ftypes, an accessor must be a valid field name for the ftype, while for pointer and array ftypes, an accessor must be the identifier <code>*</code> or evaluate to a fixnum index. For array ftypes, an index must be nonnegative, and for array ftypes with nonzero length, an index must also be less than the length. The field or element specified by the sequence of accessors must be a scalar field, e.g., a pointer field or a field containing a base type such as an <code>int</code>, <code>char</code>, or <code>double</code>.</p>
</div>
<div class="paragraph">
<p>For <code>ftype-set!</code>, <code><em>val-expr</em></code> must evaluate to a value of the appropriate type for the specified field, e.g., an ftype pointer of the appropriate type or an appropriate base-type value.</p>
</div>
<div class="paragraph">
<p>For both signed and unsigned integer fields, values in the range -2<sup><em>w</em>-1</sup> through 2<sup><em>w</em></sup> - 1 are accepted, where <em>w</em> is the width in bits of the integer field. For signed integer fields, values in the range 2<sup><em>w</em>-1</sup> through 2<sup><em>w</em></sup> - 1 are treated as two&#8217;s complement representations of the corresponding negative numbers. For unsigned integer fields, values in the range -2<sup><em>w</em>-1</sup> through -1 are similarly treated as two&#8217;s complement representations of the corresponding positive numbers.</p>
</div>
<div class="paragraph">
<p><code>char</code> and <code>wchar_t</code> (<code>wchar</code>) field values are converted from (<code>ftype-set!</code>) or to (<code>ftype-ref</code>) Scheme characters, as if with <code>char-&gt;integer</code> and <code>integer-&gt;char</code>. Characters stored by <code>ftype-set!</code> into a <code>char</code> field must have Unicode scalar values in the range 0 through 255. Under Windows and any other system where <code>wchar_t</code> (<code>wchar</code>) is a 16-bit value, characters stored by <code>ftype-set!</code> into a <code>whar_t</code> (<code>wchar</code>) field must have Unicode scalar values in the range 0 through 2<sup>16</sup> - 1. On systems where <code>wchar_t</code> is a 32-bit value, any character can be stored in a <code>wchar_t</code> (<code>wchar</code>) field.</p>
</div>
<div class="paragraph">
<p>The examples below assume that <code>B</code> and <code>C</code> have been defined as shown in the description of <code>ftype-sizeof</code> above.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define b
  (make-ftype-pointer B
    (foreign-alloc
      (* (ftype-sizeof B) 3))))
(define c
  (make-ftype-pointer C
    (foreign-alloc (ftype-sizeof C))))

(ftype-set! B (b1) b 5)
(ftype-set! B (b1) b 1 6)
(ftype-set! B (b1) c 5) ⇒ <em>exception: ftype mismatch</em>
(ftype-set! B (b2) b 0) ⇒ <em>exception: not a scalar</em>
(ftype-set! B (b2 -1) b 0) ⇒ <em>exception: invalid index</em>
(ftype-set! B (b2 0) b 50)
(ftype-set! B (b2 4) b 55)
(ftype-set! B (b2 10) b 55) ⇒ <em>exception: invalid index</em>

(ftype-set! C () c (ftype-&ref B () b 1))

(= (ftype-pointer-address (ftype-ref C () c))      ⇒ #t
   (+ (ftype-pointer-address b) (ftype-sizeof B)))
(= (ftype-pointer-address (ftype-&ref C (*) c)) ⇒ #t
   (+ (ftype-pointer-address b) (ftype-sizeof B)))
(= (ftype-pointer-address (ftype-&ref C (-1) c)) ⇒ #t
   (ftype-pointer-address b))

(ftype-ref C (-1 b1) c) ⇒ 5
(ftype-ref C (* b1) c) ⇒ 6
(ftype-ref C (-1 b2 0) c) ⇒ 50
(let ([i 4]) (ftype-ref C (-1 b2 i) c)) ⇒ 55

(ftype-set! C (-1 b2 0) c 75)
(ftype-ref B (b2 0) b) ⇒ 75
(foreign-free (ftype-pointer-address c))
(foreign-free (ftype-pointer-address b))</code></pre>
</div>
</div>
<div class="paragraph">
<p>A function ftype pointer can be converted into a Scheme-callable procedure via <code>ftype-ref</code>. Assuming that a library defining <code><em>memcpy</em></code> has been loaded via <code>load-shared-object</code> or <code>memcpy</code> has been registered via one of the methods described in <a href="#section_4.6.">Section 4.6</a>, A Scheme-callable <code>memcpy</code> can be defined as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-ftype bvcopy_t (function (u8* u8* size_t) void))
(define bvcopy-fptr (make-ftype-pointer bvcopy_t "memcpy"))
(define bvcopy (ftype-ref bvcopy_t () bvcopy-fptr))

(define bv1 (make-bytevector 8 0))
(define bv2 (make-bytevector 8 57))
bv1 ⇒ #vu8(0 0 0 0 0 0 0 0)
bv2 ⇒ #vu8(57 57 57 57 57 57 57 57)
(bvcopy bv1 bv2 5)
bv1 ⇒ #vu8(57 57 57 57 57 0 0 0)</code></pre>
</div>
</div>
<div class="paragraph">
<p>An ftype pointer can also be obtained as a return value from a C function declared to return a pointer to a function ftype.</p>
</div>
<div class="paragraph">
<p>Thus, <code>ftype-ref</code> with a function ftype is an alternative to <code>foreign-procedure</code> (<a href="#section_4.2.">Section 4.2</a>) for creating Scheme-callable wrappers for C functions.</p>
</div>
<div id="foreign:s155" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(ftype-pointer-ftype <em>fptr</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code><em>fptr</em></code>'s ftype, represented as an s-expression</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>fptr</em></code> must be an ftype-pointer object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-ftype Q0
  (struct
    [x int]
    [y int]))
(define-ftype Q1
  (struct
    [x double]
    [y char]
    [z (endian big
         (bits
           [_ unsigned 3]
           [a unsigned 9]
           [b unsigned 4]))]
    [w (* Q0)]))
(define q1 (make-ftype-pointer Q1 0))
(ftype-pointer-ftype q1) ⇒ (struct
                            [x double]
                            [y char]
                            [z (endian big
                                 (bits
                                   [_ unsigned 3]
                                   [a unsigned 9]
                                   [b unsigned 4]))]
                            [w (* Q0)])</code></pre>
</div>
</div>
<div id="foreign:s156" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(ftype-pointer-&gt;sexpr <em>fptr</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>an s-expression representation of the object to which <code><em>fptr</em></code> points</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>fptr</em></code> must be an ftype-pointer object.</p>
</div>
<div class="paragraph">
<p>For each unnamed field, i.e., each whose field name is an underscore, the corresponding field value in the resulting s-expression is also an underscore. Similarly, if a field is inaccessible, i.e., if its address is invalid, the value is the symbol <code>invalid</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-ftype Frob
  (struct
    [p boolean]
    [q char]))
(define-ftype Snurk
  (struct
    [a Frob]
    [b (* Frob)]
    [c (* Frob)]
    [d (bits
         [_ unsigned 15]
         [dx signed 17])]
    [e (array 5 double)]))
(define x
  (make-ftype-pointer Snurk
    (foreign-alloc (ftype-sizeof Snurk))))
(ftype-set! Snurk (b) x
  (make-ftype-pointer Frob
    (foreign-alloc (ftype-sizeof Frob))))
(ftype-set! Snurk (c) x
  (make-ftype-pointer Frob 0))
(ftype-set! Snurk (a p) x #t)
(ftype-set! Snurk (a q) x #\A)
(ftype-set! Snurk (b * p) x #f)
(ftype-set! Snurk (b * q) x #\B)
(ftype-set! Snurk (d dx) x -2500)
(do ([i 0 (fx+ i 1)])
    ((fx= i 5))
  (ftype-set! Snurk (e i) x (+ (* i 5.0) 3.0)))
(ftype-pointer->sexpr x) ⇒ (struct
                            [a (struct [p #t] [q #\A])]
                            [b (* (struct [p #f] [q #\B]))]
                            [c (* (struct [p invalid] [q invalid]))]
                            [d (bits [_ _] [dx -2500])]
                            [e (array 5 3.0 8.0 13.0 18.0 23.0)])</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_4.6.">Section 4.6. Providing Access to Foreign Procedures</h3>
<div class="paragraph">
<p>Access to foreign procedures can be provided in several ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Foreign procedures may be loaded from "shared objects" using <code>load-shared-object</code>.</p>
</li>
<li>
<p>A new <em>Chez Scheme</em> image can be built with additional foreign code linked in. (Consult with the person who installed <em>Chez Scheme</em> at your site for details.) These entries are typically registered via <code>Sforeign_symbol</code> or <code>Sregister_symbol</code>, documented in <a href="#section_4.8.">Section 4.8</a>.</p>
</li>
<li>
<p>Additional entries may be dynamically loaded or otherwise obtained by foreign code. These are also typically registered using <code>Sforeign_symbol</code> or <code>Sregister_symbol</code>.</p>
</li>
<li>
<p>The address of an entry, i.e., a function pointer, may be passed into Scheme and used as the value of the entry expression in a foreign-procedure expression. This allows foreign entry points to be used even when they are not registered by name.</p>
</li>
</ul>
</div>
<div id="foreign:s157" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(foreign-entry? <em>entry-name</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>entry-name</em></code> is an existing foreign procedure entry point, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>entry-name</em></code> must be a string. <code>foreign-entry?</code> may be used to determine if an entry exists for a foreign procedure.</p>
</div>
<div class="paragraph">
<p>The following examples assume that a library that defines <code><em>strlen</em></code> has been loaded via <code>load-shared-object</code> or that <code>strlen</code> has been registered via one of the other methods described in this section.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(foreign-entry? "strlen") ⇒ #t
((foreign-procedure "strlen"
    (string) size_t)
 "hey!") ⇒ 4</code></pre>
</div>
</div>
<div id="foreign:s158" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(foreign-entry <em>entry-name</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the address of <code><em>entry-name</em></code> as an exact integer</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>entry-name</em></code> must be a string naming an existing foreign entry point.</p>
</div>
<div class="paragraph">
<p>The following examples assume that a library that defines <code><em>strlen</em></code> has been loaded via <code>load-shared-object</code> or that <code>strlen</code> has been registered via one of the other methods described in this section.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([addr (foreign-entry "strlen")])
  (and (integer? addr) (exact? addr))) ⇒ #t

(define-ftype strlen-type (function (string) size_t))
(define strlen
  (ftype-ref strlen-type ()
    (make-ftype-pointer strlen-type "strlen")))
(strlen "hey!") ⇒ 4</code></pre>
</div>
</div>
<div id="foreign:s159" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(foreign-address-name <em>address</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the entry name corresponding to <code><em>address</em></code>, if known, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following examples assume that a library that defines <code><em>strlen</em></code> has been loaded via <code>load-shared-object</code> or that <code>strlen</code> has been registered via one of the other methods described in this section.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(foreign-address-name (foreign-entry "strlen")) ⇒ "strlen"</code></pre>
</div>
</div>
<div id="foreign:s160" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(load-shared-object <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. <code>load-shared-object</code> loads the shared object named by <code><em>path</em></code>. Shared objects may be system libraries or files created from ordinary C programs. All external symbols in the shared object, along with external symbols available in other shared objects linked with the shared object, are made available as foreign entries.</p>
</div>
<div class="paragraph">
<p>This procedure is supported for most platforms upon which <em>Chez Scheme</em> runs.</p>
</div>
<div class="paragraph">
<p>If <code><em>path</em></code> does not begin with a "." or "/", the shared object is searched for in a default set of directories determined by the system.</p>
</div>
<div class="paragraph">
<p>On most Unix systems, <code>load-shared-object</code> is based on the system routine <code>dlopen</code>. Under Windows, <code>load-shared-object</code> is based on <code>LoadLibrary</code>. Refer to the documentation for these routines and for the C compiler and loader for precise rules for locating and building shared objects.</p>
</div>
<div class="paragraph">
<p><code>load-shared-object</code> can be used to access built-in C library functions, such as <code>getenv</code>. The name of the shared object varies from one system to another. On Linux systems:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(load-shared-object "libc.so.6")</code></pre>
</div>
</div>
<div class="paragraph">
<p>On Solaris, OpenSolaris, FreeBSD, NetBSD, and OpenBSD systems:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(load-shared-object "libc.so")</code></pre>
</div>
</div>
<div class="paragraph">
<p>On MacOS X systems:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(load-shared-object "libc.dylib")</code></pre>
</div>
</div>
<div class="paragraph">
<p>On Windows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(load-shared-object "crtdll.dll")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the C library has been loaded, <code>getenv</code> should be available as a foreign entry.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(foreign-entry? "getenv") ⇒ #t</code></pre>
</div>
</div>
<div class="paragraph">
<p>An equivalent Scheme procedure may be defined and invoked as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define getenv
  (foreign-procedure "getenv"
    (string)
    string))
(getenv "HOME") ⇒ "/home/elmer/fudd"
(getenv "home") ⇒ #f</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>load-shared-object</code> can be used to access user-created libraries as well. Suppose the C file <code>"even.c"</code> contains</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="c" class="language-c hljs">int even(n) int n; { return n == 0 || odd(n - 1); }</code></pre>
</div>
</div>
<div class="paragraph">
<p>and the C file <code>"odd.c"</code> contains</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="c" class="language-c hljs">int odd(n) int n; { return n != 0 && even(n - 1); }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The files must be compiled and linked into a shared object before they can be loaded. How this is done depends upon the host system. On Linux, FreeBSD, OpenBSD, and OpenSolaris systems:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(system "cc -fPIC -shared -o evenodd.so even.c odd.c")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Depending on the host configuration, the <code>-m32</code> or <code>-m64</code> option might be needed to specify 32-bit or 64-bit compilation as appropriate.</p>
</div>
<div class="paragraph">
<p>On MacOS X (Intel or PowerPC) systems:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(system "cc -dynamiclib -o evenodd.so even.c odd.c")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Depending on the host configuration, the <code>-m32</code> or <code>-m64</code> option might be needed to specify 32-bit or 64-bit compilation as appropriate.</p>
</div>
<div class="paragraph">
<p>On 32-bit Sparc Solaris:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(system "cc -KPIC -G -o evenodd.so even.c odd.c")</code></pre>
</div>
</div>
<div class="paragraph">
<p>On 64-bit Sparc Solaris:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(system "cc -xarch=v9 -KPIC -G -o evenodd.so even.c odd.c")</code></pre>
</div>
</div>
<div class="paragraph">
<p>On Windows, we build a DLL (dynamic link library) file. In order to make the compiler generate the appropriate entry points, we alter <code>even.c</code> to read</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="c" class="language-c hljs">#ifdef WIN32
#define EXPORT extern __declspec (dllexport)
#else
#define EXPORT extern
#endif

EXPORT int even(n) int n; { return n == 0 || odd(n - 1); }</code></pre>
</div>
</div>
<div class="paragraph">
<p>and <code>odd.c</code> to read</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="c" class="language-c hljs">#ifdef WIN32
#define EXPORT extern __declspec (dllexport)
#else
#define EXPORT extern
#endif

EXPORT int odd(n) int n; { return n != 0 && even(n - 1); }</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can then build the DLL as follows, giving it the extension ".so" rather than ".dll" for consistency with the other systems.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(system "cl -c -DWIN32 even.c")
(system "cl -c -DWIN32 odd.c")
(system "link -dll -out:evenodd.so even.obj odd.obj")</code></pre>
</div>
</div>
<div class="paragraph">
<p>The resulting ".so" file can be loaded into Scheme and <code>even</code> and <code>odd</code> made available as foreign procedures:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(load-shared-object "./evenodd.so")
(let ([odd (foreign-procedure "odd"
             (integer-32) boolean)]
      [even (foreign-procedure "even"
              (integer-32) boolean)])
  (list (even 100) (odd 100))) ⇒ (#t #f)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The filename is given as <code>"./evenodd.so"</code> rather than simply <code>"evenodd.so"</code>, because some systems look for shared libraries in a standard set of system directories that does not include the current directory.</p>
</div>
<div id="foreign:s162" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(remove-foreign-entry <em>entry-name</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>remove-foreign-entry</code> blocks further access to the entry specified by the string <code><em>entry-name</em></code>. An exception is raised with condition type <code>&amp;assertion</code> if the entry does not exist. Since access previously established by <code>foreign-procedure</code> is not affected, <code>remove-foreign-entry</code> may be used to clean up after the desired interface to a group of foreign procedures has been established.</p>
</div>
<div class="paragraph">
<p><code>remove-foreign-entry</code> can be used to remove entries registered using <code>Sforeign_symbol</code> and <code>Sregister_symbol</code> but not entries created as a result of a call to <code>load-shared-object</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_4.7.">Section 4.7. Using Other Foreign Languages</h3>
<div class="paragraph">
<p>Although the <em>Chez Scheme</em> foreign procedure interface is oriented primarily toward procedures defined in C or available in C libraries, it is possible to invoke procedures defined in other languages that follow C calling conventions. One source of difficulty may be the interpretation of names. Since Unix-based C compilers often prepend an underscore to external names, the foreign interface attempts to interpret entry names in a manner consistent with the host C compiler. Occasionally, such as for assembly coded files, this entry name interpretation may not be desired. It can be prevented by prefixing the entry name with an "=" character. For example, after loading an assembly file containing a procedure <code>"foo"</code> one might have:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(foreign-entry? "foo") ⇒ #f
(foreign-entry? "=foo") ⇒ #t</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_4.8.">Section 4.8. C Library Routines</h3>
<div id="foreign:s167" class="paragraph">
<p>Additional foreign interface support is provided via a set of C preprocessor macros and C-callable library functions. Some of these routines allow C programs to examine, allocate, and alter Scheme objects. Others permit C functions to call Scheme procedures via a more primitive interface than that defined in <a href="#section_4.3.">Section 4.3</a>. Still others permit the development of custom executable images and use of the Scheme system as a subordinate program within another program, e.g., for use as an extension language.</p>
</div>
<div class="paragraph">
<p>C code that uses these routines must include the <code>"scheme.h"</code> header file distributed with <em>Chez Scheme</em> and must be linked (statically or dynamically) with the <em>Chez Scheme</em> kernel. The header file contains definitions for the preprocessor macros and <code>extern</code> declarations for the library functions. The file is customized to the release of <em>Chez Scheme</em> and machine type with which it is distributed; it should be left unmodified to facilitate switching among <em>Chez Scheme</em> releases, and the proper version of the header file should always be used with C code compiled for use with a particular version of <em>Chez Scheme</em>. The version and machine type are defined in <code>"scheme.h"</code> under the names <code>VERSION</code> and <code>MACHINE_TYPE</code>.</p>
</div>
<div class="paragraph">
<p>The name of each routine begins with a capital <code>S</code>, e.g., <code>Sfixnump</code>. Many of the names are simple translations of the names of closely related Scheme procedures, e.g., <code>Sstring_to_symbol</code> is the C interface equivalent of <code>string-&gt;symbol</code>. Most externally visible entries in the <em>Chez Scheme</em> executable that are not documented here begin with capital <code>S</code> followed by an underscore (<code>S_</code>); their use should be avoided.</p>
</div>
<div class="paragraph">
<p>In addition to the various macros and external declarations given in <code>scheme.h</code>, the header file also defines (<code>typedefs</code>) several types used in the header file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ptr</code>: type of a Scheme value,</p>
</li>
<li>
<p><code>iptr</code>: a signed integer the same size as a Scheme value, and</p>
</li>
<li>
<p><code>uptr</code>: an unsigned integer the same size as a Scheme value.</p>
</li>
<li>
<p><code>string_char</code>: type of a single Scheme string element.</p>
</li>
<li>
<p><code>octet</code>: type of a single Scheme bytevector element (unsigned char).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These types may vary depending upon the platform, although <code>ptr</code> is typically <code>void *</code>, <code>iptr</code> is typically <code>long</code> <code>int</code>, and <code>uptr</code> is typically <code>unsigned</code> <code>long</code> <code>int</code>.</p>
</div>
<div class="paragraph">
<p>Under Windows, defining <code>SCHEME_IMPORT</code> before including scheme.h causes scheme.h to declare its entry points using <code>extern</code> <code>declspec</code> <code>(dllimport)</code> rather than <code>extern</code> <code>declspec</code> <code>(dllexport)</code> (the default). Not defining <code>SCHEME_IMPORT</code> and instead defining <code>SCHEME_STATIC</code> causes scheme.h to declare exports using just <code>extern</code>. The static libraries distributed with Chez Scheme are built using <code>SCHEME_STATIC</code>.</p>
</div>
<div class="paragraph">
<p>The remainder of this section describes each of the C interface routines in turn. A declaration for each routine is given in ANSI C function prototype notation to precisely specify the argument and result types. Scheme objects have the C type <code>ptr</code>, which is defined in <code>"scheme.h"</code>. Where appropriate, C values are accepted as arguments or returned as values in place of Scheme objects.</p>
</div>
<div class="paragraph">
<p>The preprocessor macros may evaluate their arguments more than once (or not at all), so care should be taken to ensure that this does not cause problems.</p>
</div>
<div class="paragraph">
<p><strong>Customization.</strong>  The functions described here are used to initialize the Scheme system, build the Scheme heap, and run the Scheme system from a separate program.</p>
</div>
<div id="foreign:s169" class="ulist">
<ul>
<li>
<p>[func] <code>char* Skernel_version(void)</code></p>
</li>
<li>
<p>[func] <code>void Sscheme_init(void (*<em>abnormal_exit</em>)(void))</code></p>
</li>
<li>
<p>[func] <code>void Sset_verbose(int <em>v</em>)</code></p>
</li>
<li>
<p>[func] <code>void Sregister_boot_file(const char *<em>name</em>)</code></p>
</li>
<li>
<p>[func] <code>void Sregister_boot_file_fd(const char *<em>name</em>, int <em>fd</em>)</code></p>
</li>
<li>
<p>[func] <code>void Sbuild_heap(const char *<em>exec</em>, void (*<em>custom_init</em>)(void))</code></p>
</li>
<li>
<p>[func] <code>void Senable_expeditor(const char *<em>history_file</em>)</code></p>
</li>
<li>
<p>[func] <code>void Sretain_static_relocation(void)</code></p>
</li>
<li>
<p>[func] <code>int Sscheme_start(int <em>argc</em>, char *<em>argv</em>[])</code></p>
</li>
<li>
<p>[func] <code>int Sscheme_script(char *<em>scriptfile</em>, int <em>argc</em>, char *<em>argv</em>[])</code></p>
</li>
<li>
<p>[func] <code>int Sscheme_program(char *<em>programfile</em>, int <em>argc</em>, char *<em>argv</em>[])</code></p>
</li>
<li>
<p>[func] <code>void Scompact_heap(void)</code></p>
</li>
<li>
<p>[func] <code>void Sscheme_deinit(void)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>Skernel_version</code> returns a string representing the Scheme version. It should be compared against the value of the VERSION preprocessor macro before any of the initialization functions listed above are used to verify that the correct <code>"scheme.h"</code> header file has been used.</p>
</div>
<div class="paragraph">
<p><code>Sscheme_init</code> causes the Scheme system to initialize its static memory in preparation for boot file registration. The <code><em>abnormal_exit</em></code> parameter should be a (possibly null) pointer to a C function of no arguments that takes appropriate action if the initialization or subsequent heap-building process fails. If null, the default action is to call <code>exit(1)</code>.</p>
</div>
<div class="paragraph">
<p><code>Sset_verbose</code> sets verbose mode on for nonzero values of <code><em>v</em></code> and off when <code><em>v</em></code> is zero. In verbose mode, the system displays a trace of the search process for subsequently registered boot files.</p>
</div>
<div class="paragraph">
<p><code>Sregister_boot_file</code> searches for the named boot file and register it for loading, while <code>Sregister_boot_file_fd</code> provides a specific boot file as a file descriptor. When only a boot file name is provided, the file is opened but not loaded until the heap is built via <code>Sbuild_heap</code>. When a file descriptor is provided, the given file name is used only for error reporting. For the first boot file registered only, the system also searches for the boot files upon which the named file depends, either directly or indirectly.</p>
</div>
<div class="paragraph">
<p><code>Sbuild_heap</code> creates the Scheme heap from the registered boot files. <code><em>exec</em></code> is assumed to be the name of or path to the executable image and is used when no boot files have been registered as the base name for the boot-file search process. <code><em>exec</em></code> may be null only if one or more boot files have been registered. <code><em>custom_init</em></code> must be a (possibly null) pointer to a C function of no arguments; if non-null, it is called before any boot files are loaded.</p>
</div>
<div class="paragraph">
<p><code>Sscheme_start</code> invokes the interactive startup procedure, i.e., the value of the parameter <code>scheme-start</code>, with one Scheme string argument for the first <code><em>argc</em></code> elements of <code><em>argv</em></code>, not including <code>argv[0]</code>. <code>Sscheme_script</code> similarly invokes the script startup procedure, i.e., the value of the parameter <code>scheme-script</code>, with one Scheme string argument for <code><em>scriptfile</em></code> and the first <code><em>argc</em></code> elements of <code><em>argv</em></code>, not including <code>argv[0]</code>. <code>Sscheme_program</code> similarly invokes the program startup procedure, i.e., the value of the parameter <code>scheme-program</code>, with one Scheme string argument for <code><em>programfile</em></code> and the first <code><em>argc</em></code> elements of <code><em>argv</em></code>, not including <code>argv[0]</code>.</p>
</div>
<div class="paragraph">
<p><code>Senable_expeditor</code> enables the expression editor (<a href="#section_2.2.">Section 2.2</a>, <a href="#chp_14">Chapter 14</a>), which is disabled by default, and determines the history file from which it restores and to which it saves the history. This procedure must be called after the heap is built, or an error will result. It must also be called before <code>Sscheme_start</code> in order to be effective. If the <code><em>history_file</em></code> argument is the null pointer, the history is not restored or saved. The preprocessor variable <code>FEATURE_EXPEDITOR</code> is defined in <code>scheme.h</code> if support for the expression editor has been compiled into the system.</p>
</div>
<div class="paragraph">
<p><code>Sretain_static_relocation</code> causes relocation information to be retained for static generation code objects created by heap compaction for the benefit of <code>compute-size</code> and related procedures.</p>
</div>
<div class="paragraph">
<p><code>Scompact_heap</code> compacts the Scheme heap and places all objects currently in the heap into a <em>static</em> generation. Objects in the static generation are never collected. That is, they are never moved during collection and the storage used for them is never reclaimed even if they become inaccessible. <code>Scompact_heap</code> is called implicitly after any boot files have been loaded.</p>
</div>
<div class="paragraph">
<p><code>Sscheme_deinit</code> closes any open files, tears down the Scheme heap, and puts the Scheme system in an uninitialized state.</p>
</div>
<div class="paragraph">
<p><strong>Predicates.</strong>  The predicates described here correspond to the similarly named Scheme predicates. A trailing letter <code>p</code>, for "predicate," is used in place of the question mark that customarily appears at the end of a Scheme predicate name. Each predicate accepts a single Scheme object and returns a boolean (C integer) value.</p>
</div>
<div id="foreign:s182" class="ulist">
<ul>
<li>
<p>[macro] <code>int Sfixnump(ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>int Scharp(ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>int Snullp(ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>int Seof_objectp(ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>int Sbwp_objectp(ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>int Sbooleanp(ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>int Spairp(ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>int Ssymbolp(ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>int Sprocedurep(ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>int Sflonump(ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>int Svectorp(ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>int Sbytevectorp(ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>int Sfxvectorp(ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>int Sstringp(ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>int Sbignump(ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>int Sboxp(ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>int Sinexactnump(ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>int Sexactnump(ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>int Sratnump(ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>int Sinputportp(ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>int Soutputportp(ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>int Srecordp(ptr <em>obj</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Accessors.</strong>  Some of the accessors described here correspond to similarly named Scheme procedures, while others are unique to this interface. <code>Sfixnum_value</code>, <code>Schar_value</code>, <code>Sboolean_value</code>, and <code>Sflonum_value</code> return the C equivalents of the given Scheme value.</p>
</div>
<div id="foreign:s204" class="ulist">
<ul>
<li>
<p>[macro] <code>iptr</code> <code>Sfixnum_value(ptr <em>fixnum</em>)</code></p>
</li>
<li>
<p>[macro] <code>uptr</code> <code>Schar_value(ptr <em>character</em>)</code></p>
</li>
<li>
<p>[macro] <code>int Sboolean_value(ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>double</code> <code>Sflonum_value(ptr <em>flonum</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>Sinteger_value</code> and <code>Sunsigned_value</code> are similar to <code>Sfixnum_value</code>, except they accept not only fixnum arguments but bignum arguments in the range of C integer or unsigned values. <code>Sinteger_value</code> and <code>Sunsigned_value</code> accept the same range of Scheme integer values. They differ only in the result type, and so allow differing interpretations of negative and large unsigned values.</p>
</div>
<div id="foreign:s208" class="ulist">
<ul>
<li>
<p>[func] <code>iptr</code> <code>Sinteger_value(ptr <em>integer</em>)</code></p>
</li>
<li>
<p>[macro] <code>uptr</code> <code>Sunsigned_value(ptr <em>integer</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>Sinteger32_value</code>, <code>Sunsigned32_value</code>, <code>Sinteger64_value</code>, and <code>Sunsigned64_value</code> accept signed or unsigned Scheme integers in the 32- or 64-bit range and return integers of the appropriate type for the machine type.</p>
</div>
<div id="foreign:s210" class="ulist">
<ul>
<li>
<p>[func] <code>&lt;32-bit int type&gt;</code> <code>Sinteger32_value(ptr <em>integer</em>)</code></p>
</li>
<li>
<p>[macro] <code>&lt;32-bit unsigned type&gt;</code> <code>Sunsigned32_value(ptr <em>integer</em>)</code></p>
</li>
<li>
<p>[func] <code>&lt;64-bit int type&gt;</code> <code>Sinteger64_value(ptr <em>integer</em>)</code></p>
</li>
<li>
<p>[macro] <code>&lt;64-bit unsigned type&gt;</code> <code>Sunsigned64_value(ptr <em>integer</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>Scar</code>, <code>Scdr</code>, <code>Ssymbol_to_string</code> (corresponding to <code>symbol-&gt;string</code>), and <code>Sunbox</code> are identical to their Scheme counterparts.</p>
</div>
<div id="foreign:s214" class="ulist">
<ul>
<li>
<p>[macro] <code>ptr Scar(ptr <em>pair</em>)</code></p>
</li>
<li>
<p>[macro] <code>ptr Scdr(ptr <em>pair</em>)</code></p>
</li>
<li>
<p>[macro] <code>ptr Ssymbol_to_string(ptr <em>sym</em>)</code></p>
</li>
<li>
<p>[macro] <code>ptr Sunbox(ptr <em>box</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>Sstring_length</code>, <code>Svector_length</code>, <code>Sbytevector_length</code>, and <code>Sfxvector_length</code> each return a C integer representing the length (in elements) of the object.</p>
</div>
<div id="foreign:s218" class="ulist">
<ul>
<li>
<p>[macro] <code>iptr</code> <code>Sstring_length(ptr <em>str</em>)</code></p>
</li>
<li>
<p>[macro] <code>iptr</code> <code>Svector_length(ptr <em>vec</em>)</code></p>
</li>
<li>
<p>[macro] <code>iptr</code> <code>Sbytevector_length(ptr <em>bytevec</em>)</code></p>
</li>
<li>
<p>[macro] <code>iptr</code> <code>Sfxvector_length(ptr <em>fxvec</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>Sstring_ref</code>, <code>Svector_ref</code>, <code>Sbytevector_u8_ref</code>, and <code>Sfxvector_ref</code> correspond to their Scheme counterparts, except that the index arguments are C integers, the return value for <code>Sstring_ref</code> is a C character, and the return value for <code>Sbytevector_u8_ref</code> is an octet (unsigned char).</p>
</div>
<div id="foreign:s222" class="ulist">
<ul>
<li>
<p>[macro] <code>char Sstring_ref(ptr <em>str</em>, iptr <em>i</em>)</code></p>
</li>
<li>
<p>[macro] <code>ptr Svector_ref(ptr <em>vec</em>, iptr <em>i</em>)</code></p>
</li>
<li>
<p>[macro] <code>octet Sbytevector_u8_ref(ptr <em>fxvec</em>, iptr <em>i</em>)</code></p>
</li>
<li>
<p>[macro] <code>ptr Sfxvector_ref(ptr <em>fxvec</em>, iptr <em>i</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A Scheme bytevector is represented as a length field followed by a sequence of octets (unsignec chars). <code>Sbytevector_data</code> returns a pointer to the start of the sequence of octets. Extreme care should be taken to stop dereferencing the pointer returned by <code>Sbytevector_data</code> or to lock the bytevector into memory (see <code>Slock_object</code> below) before any Scheme code is executed, whether by calling into Scheme or returning to a Scheme caller. The storage manager may otherwise relocate or discard the object into which the pointer points and may copy other data over the object.</p>
</div>
<div id="foreign:s226" class="ulist">
<ul>
<li>
<p>[macro] <code>octet* Sbytevector_data(ptr <em>bytevec</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Mutators.</strong>  Changes to mutable objects that contain pointers, such as pairs and vectors, must be tracked on behalf of the storage manager, as described in one of the references <a href="#ref13">[13]</a>. The operations described here perform this tracking automatically where necessary.</p>
</div>
<div id="foreign:s227" class="ulist">
<ul>
<li>
<p>[func] <code>void Sset_box(ptr <em>box</em>, ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[func] <code>void Sset_car(ptr <em>pair</em>, ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[func] <code>void Sset_cdr(ptr <em>pair</em>, ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>void Sstring_set(ptr <em>str</em>, iptr <em>i</em>, char <em>c</em>)</code></p>
</li>
<li>
<p>[func] <code>void Svector_set(ptr <em>vec</em>, iptr <em>i</em>, ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[macro] <code>void Sbytevector_u8_set(ptr <em>bytevec</em>, iptr <em>i</em>, octet <em>n</em>)</code></p>
</li>
<li>
<p>[macro] <code>void Sfxvector_set(ptr <em>fxvec</em>, iptr <em>i</em>, ptr <em>fixnum</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Some Scheme objects, such as procedures and numbers, are not mutable, so no operators are provided for altering the contents of those objects.</p>
</div>
<div class="paragraph">
<p><strong>Constructors.</strong>  The constructors described here create Scheme objects. Some objects, such as fixnums and the empty list, are represented as immediate values that do not require any heap allocation; others, such as pairs and vectors, are represented as pointers to heap allocated objects.</p>
</div>
<div class="paragraph">
<p><code>Snil</code>, <code>Strue</code>, <code>Sfalse</code>, <code>Sbwp_object</code>, <code>Seof_object</code>, and <code>Svoid</code> construct constant immediate values representing the empty list ( <code>()</code> ), the boolean values (<code>#t</code> and <code>#f</code>), the broken-weak-pointer object (<code>#!bwp</code>), the eof object (<code>#!eof</code>), and the void object.</p>
</div>
<div id="foreign:s234" class="ulist">
<ul>
<li>
<p>[macro] <code>ptr Snil</code></p>
</li>
<li>
<p>[macro] <code>ptr Strue</code></p>
</li>
<li>
<p>[macro] <code>ptr Sfalse</code></p>
</li>
<li>
<p>[macro] <code>ptr Sbwp_object</code></p>
</li>
<li>
<p>[macro] <code>ptr Seof_object</code></p>
</li>
<li>
<p>[macro] <code>ptr Svoid</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Fixnums, characters, booleans, flonums, and strings may be created from their C equivalents.</p>
</div>
<div id="foreign:s240" class="ulist">
<ul>
<li>
<p>[macro] <code>ptr Sfixnum(iptr <em>n</em>)</code></p>
</li>
<li>
<p>[macro] <code>ptr Schar(char <em>c</em>)</code></p>
</li>
<li>
<p>[macro] <code>ptr Sboolean(int <em>b</em>)</code></p>
</li>
<li>
<p>[func] <code>ptr Sflonum(double x)</code></p>
</li>
<li>
<p>[func] <code>ptr Sstring(const char *<em>s</em>)</code></p>
</li>
<li>
<p>[func] <code>ptr Sstring_of_length(const char *<em>s</em>, iptr <em>n</em>)</code></p>
</li>
<li>
<p>[func] <code>ptr Sstring_utf8(const char *<em>s</em>, iptr <em>n</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>Sstring</code> creates a Scheme copy of the C string <code><em>s</em></code>, while <code>Sstring_of_length</code> creates a Scheme string of length <code><em>n</em></code> and copies the first <code><em>n</em></code> bytes from <code><em>s</em></code> into the new Scheme string.</p>
</div>
<div class="paragraph">
<p>If the C string is encoded in UTF-8, use <code>Sstring_utf8</code> instead. Specify the number of bytes to convert as <code><em>n</em></code> or use -1 to convert until the null terminator.</p>
</div>
<div class="paragraph">
<p>It is possible to determine whether a C integer is within fixnum range by comparing the fixnum value of a fixnum created from a C integer with the C integer:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="c" class="language-c hljs">#define fixnum_rangep(x) (Sfixnum_value(Sfixnum(x)) == x)</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>Sinteger</code> and <code>Sunsigned</code> may be used to create Scheme integers whether they are in fixnum range or not.</p>
</div>
<div id="foreign:s247" class="ulist">
<ul>
<li>
<p>[func] <code>ptr Sinteger(iptr <em>n</em>)</code></p>
</li>
<li>
<p>[func] <code>ptr Sunsigned(uptr <em>n</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>Sinteger</code> and <code>Sunsigned</code> differ in their treatment of negative C integer values as well as C unsigned integer values that would appear negative if cast to integers. <code>Sinteger</code> converts such values into negative Scheme values, whereas <code>Sunsigned</code> converts such values into the appropriate positive Scheme values. For example, assuming a 32-bit, two&#8217;s complement representation for <code>iptrs</code>, <code>Sinteger(-1)</code> and <code>Sunsigned((iptr)0xffffffff)</code> both evaluate to the Scheme integer <code>-1</code>, whereas <code>Sunsigned(0xffffffff)</code> and <code>Sunsigned((uptr)-1)</code> both evaluate to the Scheme integer <code>#xffffffff</code> (<code>4294967295</code>).</p>
</div>
<div class="paragraph">
<p>Whichever routine is used, <code>Sinteger_value</code> and <code>Sunsigned_value</code> always reproduce the corresponding C input value, thus the following are all equivalent to <code><em>x</em></code> if <code><em>x</em></code> is an iptr.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="c" class="language-c hljs">Sinteger_value(Sinteger(<em>x</em>))
(iptr)Sunsigned_value(Sinteger(<em>x</em>))
Sinteger_value(Sunsigned((uptr)<em>x</em>))
(iptr)Sunsigned_value(Sunsigned((uptr)<em>x</em>))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly, the following are all equivalent to <code><em>x</em></code> if <code><em>x</em></code> is a uptr.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="c" class="language-c hljs">(uptr)Sinteger_value(Sinteger((iptr)<em>x</em>))
Sunsigned_value(Sinteger((iptr)<em>x</em>))
(uptr)Sinteger_value(Sunsigned(<em>x</em>))
Sunsigned_value(Sunsigned(<em>x</em>))</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>Sinteger32</code>, <code>Sunsigned32</code>, <code>Sinteger64</code>, and <code>Sunsigned64</code> are like the generic equivalents but restrict their arguments to the 32- or 64-bit range.</p>
</div>
<div id="foreign:s249" class="ulist">
<ul>
<li>
<p>[func] <code>ptr Sinteger32(&lt;32-bit int type&gt; <em>n</em>)</code></p>
</li>
<li>
<p>[func] <code>ptr Sunsigned32(&lt;32-bit unsigned type&gt; <em>n</em>)</code></p>
</li>
<li>
<p>[func] <code>ptr Sinteger64(&lt;64-bit int type&gt; <em>n</em>)</code></p>
</li>
<li>
<p>[func] <code>ptr Sunsigned64(&lt;64-bit unsigned type&gt; <em>n</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>Scons</code> and <code>Sbox</code> are identical to their Scheme counterparts.</p>
</div>
<div id="foreign:s253" class="ulist">
<ul>
<li>
<p>[func] <code>ptr Scons(ptr <em>obj<sub>1</sub></em>, ptr <em>obj<sub>2</sub></em>)</code></p>
</li>
<li>
<p>[func] <code>ptr Sbox(ptr <em>obj</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>Sstring_to_symbol</code> is similar to its Scheme counterpart, <code>string-&gt;symbol</code>, except that it takes a C string (character pointer) as input.</p>
</div>
<div id="foreign:s255" class="ulist">
<ul>
<li>
<p>[func] <code>ptr Sstring_to_symbol(const char *<em>s</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>Smake_string</code>, <code>Smake_vector</code>, <code>Smake_bytevector</code>, and <code>Smake_fxvector</code> are similar to their Scheme counterparts.</p>
</div>
<div id="foreign:s256" class="ulist">
<ul>
<li>
<p>[func] <code>ptr Smake_string(iptr <em>n</em>, int <em>c</em>)</code></p>
</li>
<li>
<p>[func] <code>ptr Smake_vector(iptr <em>n</em>, ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[func] <code>ptr Smake_bytevector(iptr <em>n</em>, int <em>fill</em>)</code></p>
</li>
<li>
<p>[func] <code>ptr Smake_fxvector(iptr <em>n</em>, ptr <em>fixnum</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>Smake_uninitialized_string</code> is similar to the one-argument <code>make-string</code>.</p>
</div>
<div id="foreign:s260" class="ulist">
<ul>
<li>
<p>[func] <code>ptr Smake_uninitialized_string(iptr <em>n</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Windows-specific helper functions.</strong>  The following helper functions are provided on Windows only.</p>
</div>
<div id="foreign:s261" class="ulist">
<ul>
<li>
<p>[func] <code>char* Sgetenv(const char *<em>name</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>Sgetenv</code> returns the UTF-8-encoded value of UTF-8-encoded environment variable <code><em>name</em></code> if found and NULL otherwise. Call <code>free</code> on the returned value when it is no longer needed.</p>
</div>
<div id="foreign:s262" class="ulist">
<ul>
<li>
<p>[func] <code>wchar_t* Sutf8_to_wide(const char *\s)</code></p>
</li>
<li>
<p>[func] <code>char* Swide_to_utf8(const wchar_t *\s)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>Sutf8_to_wide</code> and <code>Swide_to_utf8</code> convert between UTF-8-encoded and UTF-16LE-encoded null-terminated strings. Call <code>free</code> on the returned value when it is no longer needed.</p>
</div>
<div class="paragraph">
<p><strong>Accessing top-level values.</strong>  Top-level variable bindings may be accessed or assigned via <code>Stop_level_value</code> and <code>Sset_top_level_value</code>.</p>
</div>
<div id="foreign:s264" class="ulist">
<ul>
<li>
<p>[func] <code>ptr Stop_level_value(ptr <em>sym</em>)</code></p>
</li>
<li>
<p>[func] <code>void Sset_top_level_value(ptr <em>sym</em>, ptr <em>obj</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These procedures give fast access to the bindings in the original interaction environment and do not reflect changes to the <code>interaction-environment</code> parameter or top-level module imports. To access the current interaction-environment binding for a symbol, it is necessary to call the Scheme <code>top-level-value</code> and <code>set-top-level-value!</code> procedures instead.</p>
</div>
<div class="paragraph">
<p><strong>Locking Scheme objects.</strong>  The storage manager periodically relocates objects in order to reclaim storage and compact the heap. This relocation is completely transparent to Scheme programs, since all pointers to a relocated object are updated to refer to the new location of the object. The storage manager cannot, however, update Scheme pointers that reside outside of the Scheme heap.</p>
</div>
<div class="paragraph">
<p>As a general rule, all pointers from C variables or data structures to Scheme objects should be discarded before entry (or reentry) into Scheme. That is, if a C procedure receives an object from Scheme or obtains it via the mechanisms described in this section, all pointers to the object should be considered invalid once the C procedure calls into Scheme or returns back to Scheme. Dereferencing an invalid pointer or passing it back to Scheme can have disastrous effects, including unrecoverable memory faults. The foregoing does not apply to immediate objects, e.g., fixnums, characters, booleans, or the empty list. It does apply to all heap-allocated objects, including pairs, vectors, strings, all numbers other than fixnums, ports, procedures, and records.</p>
</div>
<div class="paragraph">
<p>In practice, the best way to ensure that C code does not retain pointers to Scheme objects is to immediately convert the Scheme objects into C equivalents, if possible. In certain cases, it is not possible to do so, yet retention of the Scheme object is essential to the design of the C portions of the program. In these cases, the object may be <em>locked</em> via the library routine <code>Slock_object</code> (or from Scheme, the equivalent procedure <code>lock-object</code>).</p>
</div>
<div id="foreign:s267" class="ulist">
<ul>
<li>
<p>[func] <code>void Slock_object(ptr <em>obj</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Locking an object prevents the storage manager from reclaiming or relocating the object. Locking should be used sparingly, as it introduces memory fragmentation and increases storage management overhead. Locking can also lead to accidental retention of storage if objects are not unlocked. Locking objects that have been made static via heap compaction (see <code>Scompact_heap</code> above) is unnecessary but harmless.</p>
</div>
<div class="paragraph">
<p>Objects may be unlocked via <code>Sunlock_object</code> (<code>unlock-object</code>).</p>
</div>
<div id="foreign:s270" class="ulist">
<ul>
<li>
<p>[func] <code>void Sunlock_object(ptr <em>obj</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An object may be locked more than once by successive calls to <code>Slock_object</code> or <code>lock-object</code>, in which case it must be unlocked by an equal number of calls to <code>Sunlock_object</code> or <code>unlock-object</code> before it is truly unlocked.</p>
</div>
<div class="paragraph">
<p>The function <code>Sunlocked_objectp</code> can be used to determine if an object is locked.</p>
</div>
<div id="foreign:s271" class="ulist">
<ul>
<li>
<p>[func] <code>int Sunlocked_objectp(ptr <em>obj</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When a foreign procedure call is made into Scheme, a return address pointing into the Scheme code object associated with the foreign procedure is passed implicitly to the C routine. The system therefore locks the code object before calls are made from C back into Scheme and unlocks it upon return from Scheme. This locking is performed automatically; user code should never need to lock such code objects.</p>
</div>
<div class="paragraph">
<p>An object contained within a locked object, such as an object in the car of a locked pair, need not also be locked unless a separate C pointer to the object exists.</p>
</div>
<div class="paragraph">
<p><strong>Registering foreign entry points.</strong>  Foreign entry points may be made visible to Scheme via <code>Sforeign_symbol</code> or <code>Sregister_symbol</code>.</p>
</div>
<div id="foreign:s272" class="ulist">
<ul>
<li>
<p>[func] <code>void Sforeign_symbol(const char *<em>name</em>, void *<em>addr</em>)</code></p>
</li>
<li>
<p>[func] <code>void Sregister_symbol(const char *<em>name</em>, void *<em>addr</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>External entry points in object files or shared objects loaded as a result of a call to <code>load-shared-object</code> are automatically made visible by the system. Once a foreign entry point is made visible, it may be named in a <code>foreign-procedure</code> expression to create a Scheme-callable version of the entry point. <code>Sforeign_symbol</code> and <code>Sregister_symbol</code> allow programs to register nonexternal entry points, entry points in code linked statically with <em>Chez Scheme</em>, and entry points into code loaded directly from C, i.e., without <code>load-shared-object</code>. <code>Sforeign_symbol</code> and <code>Sregister_symbol</code> differ only in that <code>Sforeign_symbol</code> raises an exception when an attempt is made to register an existing name, whereas <code>Sregister_symbol</code> permits existing names to be redefined.</p>
</div>
<div class="paragraph">
<p><strong>Obtaining Scheme entry points.</strong>  <code>Sforeign_callable_entry_point</code> extracts the entry point from a code object produced by <code>foreign-callable</code>, performing the same operation as its Scheme counterpart, i.e., the Scheme procedure <code>foreign-callable-entry-point</code>.</p>
</div>
<div id="foreign:s274" class="ulist">
<ul>
<li>
<p>[func] <code>(void (*) (void)) Sforeign_callable_entry_point(ptr <em>code</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This can be used to avoid converting the code object into an address until just when it is needed, which may eliminate the need to lock the code object in some circumstances, assuming that the code object is not saved across any calls back into Scheme.</p>
</div>
<div class="paragraph">
<p>The inverse translation can be made via <code>Sforeign_callable_code_object</code>.</p>
</div>
<div id="foreign:s275" class="ulist">
<ul>
<li>
<p>[func] <code>ptr Sforeign_callable_code_object((void (*addr)(void)))</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Low-level support for calls into Scheme.</strong>  Support for calling Scheme procedures from C is provided by the set of routines documented below. Calling a Scheme procedure that expects a small number of arguments (0-3) involves the use of one of the following routines.</p>
</div>
<div id="foreign:s276" class="ulist">
<ul>
<li>
<p>[func] <code>ptr Scall0(ptr <em>procedure</em>)</code></p>
</li>
<li>
<p>[func] <code>ptr Scall1(ptr <em>procedure</em>, ptr <em>obj<sub>1</sub></em>)</code></p>
</li>
<li>
<p>[func] <code>ptr Scall2(ptr <em>procedure</em>, ptr <em>obj<sub>1</sub></em>, ptr <em>obj<sub>2</sub></em>)</code></p>
</li>
<li>
<p>[func] <code>ptr Scall3(ptr <em>procedure</em>, ptr <em>obj<sub>1</sub></em>, ptr <em>obj<sub>2</sub></em>, ptr <em>obj<sub>3</sub></em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In each case, the first argument, <code><em>procedure</em></code>, should be a Scheme procedure. The remaining arguments, which should be Scheme objects, are passed to the procedure. The tools described earlier in this section may be used to convert C datatypes into their Scheme equivalents. A program that automatically generates conversion code from declarations that are similar to <code>foreign-procedure</code> expressions is distributed with <em>Chez Scheme</em>. It can be found in the Scheme library directory on most systems in the file <code>"foreign.ss"</code>.</p>
</div>
<div class="paragraph">
<p>A Scheme procedure may be obtained in a number of ways. For example, it may be received as an argument in a call from Scheme into C, obtained via another call to Scheme, extracted from a Scheme data structure, or obtained from the top-level environment via <code>Stop_level_value</code>.</p>
</div>
<div class="paragraph">
<p>A more general interface involving the following routines is available for longer argument lists.</p>
</div>
<div id="foreign:s280" class="ulist">
<ul>
<li>
<p>[func] <code>void Sinitframe(iptr <em>n</em>)</code></p>
</li>
<li>
<p>[func] <code>void Sput_arg(iptr <em>i</em>, ptr <em>obj</em>)</code></p>
</li>
<li>
<p>[func] <code>ptr Scall(ptr <em>procedure</em>, iptr <em>n</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A C procedure first calls <code>Sinitframe</code> with one argument, the number of arguments to be passed to Scheme. It then calls <code>Sput_arg</code> once for each argument (in any order), passing <code>Sput_arg</code> the argument number (starting with <code>1</code>) and the argument. Finally, it calls <code>Scall</code> to perform the call, passing it the Scheme procedure and the number of arguments (the same number as in the call to <code>Sinitframe</code>). Programmers should ensure a Scheme call initiated via <code>Sinitframe</code> is completed via <code>Scall</code> before any other calls to Scheme are made and before a return to Scheme is attempted. If for any reason the call is not completed after <code>Sinitframe</code> has been called, it may not be possible to return to Scheme.</p>
</div>
<div class="paragraph">
<p>The following examples serve to illustrate both the simpler and more general interfaces.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="c" class="language-c hljs">/* a particularly silly way to multiply two floating-point numbers */
double mul(double x, double y) {
    ptr times = Stop_level_value(Sstring_to_symbol("*"));

    return Sflonum_value(Scall2(times, Sflonum(x), Sflonum(y)));
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="c" class="language-c hljs">/* an equally silly way to call printf with five arguments */

/* it is best to define interfaces such as the one below to handle
 * calls into Scheme to prevent accidental attempts to nest frame
 * creation and to help ensure that initiated calls are completed
 * as discussed above.  Specialized versions tailored to particular
 * C argument types may be defined as well, with embedded conversions
 * to Scheme objects. */
ptr Scall5(ptr p, ptr x1, ptr x2, ptr x3, ptr x4, ptr x5) {
    Sinitframe(5);
    Sput_arg(1, x1);
    Sput_arg(2, x2);
    Sput_arg(3, x3);
    Sput_arg(4, x4);
    Sput_arg(5, x5);
    Scall(p, 5);
}

static void dumpem(char *s, int a, double b, ptr c, char *d) {
    printf(s, a, b, c, d);
}

static void foo(int x, double y, ptr z, char *s) {
    ptr ois, sip, read, expr, eval, c_dumpem;
    char *sexpr = "(foreign-procedure \"dumpem\" (string integer-32\
 double-float scheme-object string) void)";

  /* this series of statements is carefully crafted to avoid referencing
     variables holding Scheme objects after calls into Scheme */
    ois = Stop_level_value(Sstring_to_symbol("open-input-string"));
    sip = Scall1(ois, Sstring(sexpr));
    read = Stop_level_value(Sstring_to_symbol("read"));
    expr = Scall1(read, sip);
    eval = Stop_level_value(Sstring_to_symbol("eval"));
    Sforeign_symbol("dumpem", (void *)dumpem);
    c_dumpem = Scall1(eval, expr);
    Scall5(c_dumpem,
           Sstring("x = %d, y = %g, z = %x, s = %s\n"),
           Sinteger(x),
           Sflonum(y),
           z,
           Sstring(s));
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Calls from C to Scheme should not be made from C interrupt handlers. When Scheme calls into C, the system saves the contents of certain dedicated machine registers in a register save area. When C then calls into Scheme, the registers are restored from the register save area. Because an interrupt can occur at any point in a computation, the contents of the register save locations would typically contain invalid information that would cause the Scheme system to fail to operate properly.</p>
</div>
<div class="paragraph">
<p><strong>Activating, deactivating, and destroying threads.</strong>  Three functions are provided by the threaded versions of Scheme to allow C code to notify Scheme when a thread should be activated, deactivated, or destroyed.</p>
</div>
<div id="foreign:s283" class="ulist">
<ul>
<li>
<p>[func] <code>int Sactivate_thread(void)</code></p>
</li>
<li>
<p>[func] <code>void Sdeactivate_thread(void)</code></p>
</li>
<li>
<p>[func] <code>int Sdestroy_thread(void)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A thread created via the Scheme procedure <code>fork-thread</code> starts in the active state and need not be activated. Any thread that has been deactivated, and any thread created by some mechanism other than <code>fork-thread</code> must, however, be activated before it can access Scheme data or execute Scheme code. A foreign callable that is declared with <code>__collect_safe</code> can activate a calling thread. Otherwise, <code>Sactivate_thread</code> must be used to activate a thread. It returns 1 the first time the thread is activated and 0 on each subsequent call until the activation is destroyed with <code>Sdestroy_thread</code>.</p>
</div>
<div class="paragraph">
<p>Since active threads operating in C code prevent the storage management system from garbage collecting, a thread should be deactivated via <code>Sdeactivate_thread</code> or through a <code>foreign-procedure</code> <code>__collect_safe</code> declaration whenever the thread may spend a significant amount of time in C code. This is especially important whenever the thread calls a C library function, like <code>read</code>, that may block indefinitely. Once deactivated, the thread must not touch any Scheme data or execute any Scheme code until it is reactivated, with one exception. The exception is that the thread may access or even modify a locked Scheme object, such as a locked string, that contains no pointers to other, unlocked Scheme objects. (Objects that are not locked may be relocated by the garbage collector while the thread is inactive.)</p>
</div>
<div class="paragraph">
<p><code>Sdestroy_thread</code> is used to notify the Scheme system that the thread is shut down and any thread-specific data can be released.</p>
</div>
<div class="paragraph">
<p><strong>Low-level synchronization primitives.</strong>  The header file defines several preprocessor macros that can be used to lock memory locations in a manner identical to the corresponding ftype lock operations (sections  15.4 and 15.5).</p>
</div>
<div id="foreign:s286" class="ulist">
<ul>
<li>
<p>[macro] <code>void INITLOCK(void *<em>addr</em>)</code></p>
</li>
<li>
<p>[macro] <code>void SPINLOCK(void *<em>addr</em>)</code></p>
</li>
<li>
<p>[macro] <code>void UNLOCK(void *<em>addr</em>)</code></p>
</li>
<li>
<p>[macro] <code>void LOCKED_INCR(void *<em>addr</em>, int *<em>ret</em>)</code></p>
</li>
<li>
<p>[macro] <code>void LOCKED_DECR(void *<em>addr</em>, int *<em>ret</em>)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>LOCKED_INCR</code> and <code>LOCKED_DECR</code> set <code><em>ret</em></code> to a nonzero (true) value if the incremented or decremented value is 0. Otherwise they set <code><em>ret</em></code> to 0.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_4.9.">Section 4.9. Example: Socket Operations</h3>
<div id="foreign:s291" class="paragraph">
<p>This section presents a simple socket interface that employs a combination of Scheme and C code. The C code defines a set of convenient low-level operating-system interfaces that can be used in the higher-level Scheme code to open, close, read from, and write to sockets.</p>
</div>
<div class="paragraph">
<p>The C code (csocket.c) is given below, followed by the Scheme code (socket.ss). The code should require little or no modification to run on most Unix systems and can be modified to work under Windows (using the Windows <em>WinSock</em> interface).</p>
</div>
<div class="paragraph">
<p>A sample session demonstrating the socket interface follows the code. See <a href="#section_9.17.">Section 9.17</a> for an example that demonstrates how to use the same socket interface to build a process port that allows transparent input from and output to a subprocess via a Scheme port.</p>
</div>
<div class="paragraph">
<p><strong>C code.</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="c" class="language-c hljs">/* csocket.c */

#include &lt;sys/types.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;sys/un.h&gt;
#include &lt;string.h&gt;
#include &lt;errno.h&gt;
#include &lt;signal.h&gt;
#include &lt;sys/ioctl.h&gt;
#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;

/* c_write attempts to write the entire buffer, pushing through
   interrupts, socket delays, and partial-buffer writes */
int c_write(int fd, char *buf, ssize_t start, ssize_t n) {
    ssize_t i, m;

    buf += start;
    m = n;
    while (m > 0) {
        if ((i = write(fd, buf, m)) < 0) {
            if (errno != EAGAIN && errno != EINTR)
                return i;
        } else {
            m -= i;
            buf += i;
        }
    }
    return n;
}

/* c_read pushes through interrupts and socket delays */
int c_read(int fd, char *buf, size_t start, size_t n) {
    int i;

    buf += start;
    for (;;) {
        i = read(fd, buf, n);
        if (i >= 0) return i;
        if (errno != EAGAIN && errno != EINTR) return -1;
    }
}

/* bytes_ready(fd) returns true if there are bytes available
   to be read from the socket identified by fd */
int bytes_ready(int fd) {
    int n;

    (void) ioctl(fd, FIONREAD, &n);
    return n;
}

/* socket support */

/* do_socket() creates a new AF_UNIX socket */
int do_socket(void) {

    return socket(AF_UNIX, SOCK_STREAM, 0);
}

/* do_bind(s, name) binds name to the socket s */
int do_bind(int s, char *name) {
    struct sockaddr_un sun;
    int length;

    sun.sun_family = AF_UNIX;
    (void) strcpy(sun.sun_path, name);
    length = sizeof(sun.sun_family) + sizeof(sun.sun_path);

    return bind(s, (struct sockaddr*)(&sun), length);
}

/* do_accept accepts a connection on socket s */
int do_accept(int s) {
    struct sockaddr_un sun;
    socklen_t length;

    length = sizeof(sun.sun_family) + sizeof(sun.sun_path);

    return accept(s, (struct sockaddr*)(&sun), &length);
}

/* do_connect initiates a socket connection */
int do_connect(int s, char *name) {
    struct sockaddr_un sun;
    int length;

    sun.sun_family = AF_UNIX;
    (void) strcpy(sun.sun_path, name);
    length = sizeof(sun.sun_family) + sizeof(sun.sun_path);

    return connect(s, (struct sockaddr*)(&sun), length);
}

/* get_error returns the operating system's error status */
char* get_error(void) {
    extern int errno;
    return strerror(errno);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Scheme code.</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">;;; socket.ss

;;; Requires csocket.so, built from csocket.c.
(load-shared-object "./csocket.so")

;;; Requires from C library:
;;;   close, dup, execl, fork, kill, listen, tmpnam, unlink
(case (machine-type)
  [(i3le ti3le a6le ta6le) (load-shared-object "libc.so.6")]
  [(i3osx ti3osx a6osx ta6osx) (load-shared-object "libc.dylib")]
  [else (load-shared-object "libc.so")])

;;; basic C-library stuff

(define close
  (foreign-procedure "close" (int)
    int))

(define dup
  (foreign-procedure "dup" (int)
    int))

(define execl4
  (let ((execl-help
         (foreign-procedure "execl"
           (string string string string void*)
           int)))
    (lambda (s1 s2 s3 s4)
      (execl-help s1 s2 s3 s4 0))))

(define fork
  (foreign-procedure "fork" ()
    int))

(define kill
  (foreign-procedure "kill" (int int)
    int))

(define listen
  (foreign-procedure "listen" (int int)
    int))

(define tmpnam
  (foreign-procedure "tmpnam" (void*)
    string))

(define unlink
  (foreign-procedure "unlink" (string)
    int))

;;; routines defined in csocket.c

(define accept
  (foreign-procedure "do_accept" (int)
    int))

(define bytes-ready?
  (foreign-procedure "bytes_ready" (int)
    boolean))

(define bind
  (foreign-procedure "do_bind" (int string)
    int))

(define c-error
  (foreign-procedure "get_error" ()
    string))

(define c-read
  (foreign-procedure "c_read" (int u8* size_t size_t)
    ssize_t))

(define c-write
  (foreign-procedure "c_write" (int u8* size_t ssize_t)
    ssize_t))

(define connect
  (foreign-procedure "do_connect" (int string)
    int))

(define socket
  (foreign-procedure "do_socket" ()
    int))

;;; higher-level routines

(define dodup
 ; (dodup old new) closes old and dups new, then checks to
 ; make sure that resulting fd is the same as old
  (lambda (old new)
    (check 'close (close old))
    (unless (= (dup new) old)
      (error 'dodup
        "couldn't set up child process io for fd ~s" old))))

(define dofork
 ; (dofork child parent) forks a child process and invokes child
 ; without arguments and parent with the child's pid
  (lambda (child parent)
    (let ([pid (fork)])
      (cond
        [(= pid 0) (child)]
        [(> pid 0) (parent pid)]
        [else (error 'fork (c-error))]))))

(define setup-server-socket
 ; create a socket, bind it to name, and listen for connections
  (lambda (name)
    (let ([sock (check 'socket (socket))])
      (unlink name)
      (check 'bind (bind sock name))
      (check 'listen (listen sock 1))
      sock)))

(define setup-client-socket
 ; create a socket and attempt to connect to server
  (lambda (name)
    (let ([sock (check 'socket (socket))])
      (check 'connect (connect sock name))
      sock)))

(define accept-socket
 ; accept a connection
  (lambda (sock)
    (check 'accept (accept sock))))

(define check
 ; signal an error if status x is negative, using c-error to
 ; obtain the operating-system's error message
  (lambda (who x)
    (if (< x 0)
        (error who (c-error))
        x)))

(define terminate-process
 ; kill the process identified by pid
  (lambda (pid)
    (define sigterm 15)
    (kill pid sigterm)
    (void)))</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Sample session.</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (define client-pid)
> (define client-socket)
> (let* ([server-socket-name (tmpnam 0)]
         [server-socket (setup-server-socket server-socket-name)])
   ; fork a child, use it to exec a client Scheme process, and set
   ; up server-side client-pid and client-socket variables.
    (dofork   ; child
      (lambda ()
       ; the child establishes the socket input/output fds as
       ; stdin and stdout, then starts a new Scheme session
        (check 'close (close server-socket))
        (let ([sock (setup-client-socket server-socket-name)])
          (dodup 0 sock)
          (dodup 1 sock))
        (check 'execl (execl4 "/bin/sh" "/bin/sh" "-c" "exec scheme -q"))
        (errorf 'client "returned!"))
      (lambda (pid) ; parent
       ; the parent waits for a connection from the client
        (set! client-pid pid)
        (set! client-socket (accept-socket server-socket))
        (check 'close (close server-socket)))))
> (define put ; procedure to send data to client
    (lambda (x)
      (let ([s (format "~s~%" x)])
        (c-write client-socket s (string-length s)))
      (void)))
> (define get ; procedure to read data from client
    (let ([buff (make-string 1024)])
      (lambda ()
        (let ([n (c-read client-socket buff (string-length buff))])
          (printf "client:~%~a~%server:~%" (substring buff 0 n))))))
> (get)
server:
> (put '(let ([x 3]) x))
> (get)
client:
3
server:
> (terminate-process client-pid)
> (exit)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chp_5">Chapter 5. Binding Forms</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes <em>Chez Scheme</em> extensions to the set of Revised<sup>6</sup> Report binding forms. See <a href="../../the-scheme-programming-language-4th/en/index.html#chp_4">Chapter 4</a> of <em>The Scheme Programming Language, 4th Edition</em> or the Revised<sup>6</sup> Report for a description of standard binding forms.</p>
</div>
<div class="sect2">
<h3 id="section_5.1.">Section 5.1. Definitions</h3>
<div class="paragraph">
<p>A definition in Revised<sup>6</sup> Report Scheme is a variable definition, keyword definition, or derived definition, i.e., a syntactic extension that expands into a definition. In addition, the forms within a <code>begin</code> expression appearing after a sequence of definitions is spliced onto the end of the sequence of definitions so that definitions at the front of the <code>begin</code> expression are treated as if they were part of the outer sequence of definitions. A <code>let-syntax</code> or <code>letrec-syntax</code> form is treated similarly, so that definitions at the front of the body are treated as if they were part of the outer sequence of definitions, albeit scoped where the bindings of the <code>let-syntax</code> or <code>letrec-syntax</code> form are visible.</p>
</div>
<div class="paragraph">
<p><em>Chez Scheme</em> extends the set of definitions to include <code>module</code> forms, <code>import</code> forms, <code>import-only</code> forms, <code>meta</code> definitions, and <code>alias</code> forms, although the <code>module</code>, <code>import</code>, <code>import-only</code>, <code>meta</code>, and <code>alias</code> keywords are not available in a library or RNRS top-level program unless the <code>scheme</code> library is included in the library or top-level programs imports. These forms are described in <a href="#chp_11">Chapter 11</a>.</p>
</div>
<div class="paragraph">
<p>In Revised<sup>6</sup> Report Scheme, definitions can appear at the front of a <code>lambda</code> or similar body (e.g., a <code>let</code> or <code>letrec</code> body), at the front of a library body, or intermixed with expressions within an RNRS top-level program body. In <em>Chez Scheme</em>, definitions may also be used in the interactive top-level, i.e., they can be intermixed with expressions in the REPL or in program text to be loaded from a file via <code>load</code> (<a href="#section_12.4.">Section 12.4</a>). The Revised<sup>6</sup> Report does not mandate the existence nor specify the semantics of an interactive top-level, nor of a <code>load</code> procedure.</p>
</div>
<div class="paragraph">
<p>The macro expander uses the same two-pass algorithm for expanding top-level <code>begin</code> expressions as it uses for a <code>lambda</code>, <code>library</code>, or top-level program body. (This algorithm is described in <a href="../../the-scheme-programming-language-4th/en/index.html#section_8.1.">Section 8.1</a> of <em>The Scheme Programming Language, 4th Edition</em>.) As a result,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(begin
  (define-syntax a (identifier-syntax 3))
  (define x a))</code></pre>
</div>
</div>
<div class="paragraph">
<p>and</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(begin
  (define x a)
  (define-syntax a (identifier-syntax 3)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>both result in the giving <code>x</code> the value 3, even though an unbound variable reference to <code>a</code> would result if the two forms within the latter <code>begin</code> expression were run independently at top level.</p>
</div>
<div class="paragraph">
<p>Similarly, the <code>begin</code> form produced by a use of</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax define-constant
  (syntax-rules ()
    [(_ x e)
     (begin
       (define t e)
       (define-syntax x (identifier-syntax t)))]))</code></pre>
</div>
</div>
<div class="paragraph">
<p>and the <code>begin</code> form produced by a use of</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax define-constant
  (syntax-rules ()
    [(_ x e)
     (begin
       (define-syntax x (identifier-syntax t))
       (define t e))]))</code></pre>
</div>
</div>
<div class="paragraph">
<p>are equivalent.</p>
</div>
<div class="paragraph">
<p>The Revised<sup>6</sup> Report specifies that internal variable definitions be treated like <code>letrec*</code>, while earlier reports required internal variable definitions to be treated like <code>letrec</code>. By default, <em>Chez Scheme</em> implements the Revised<sup>6</sup> Report semantics for internal variable definitions, as for all other things, but this behavior may be overridden via the <code>internal-defines-as-letrec*</code> parameter.</p>
</div>
<div id="binding:s15" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>internal-defines-as-letrec*</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When this parameter is set to <code>#t</code> (the default), internal variable definitions are evaluated using <code>letrec*</code> semantics. It may be set to <code>#f</code> to revert to the <code>letrec</code> semantics for internal variable definitions, for backward compatibility.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_5.2.">Section 5.2. Multiple-value Definitions</h3>
<div id="binding:s16" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(define-values <em>formals</em> <em>expr</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A <code>define-values</code> form is a definition and can appear anywhere other definitions can appear. It is like a <code>define</code> form but permits an arbitrary formals list (like <code>lambda</code>) on the left-hand side. It evaluates <code><em>expr</em></code> and binds the variables appearing in <code><em>formals</em></code> to the resulting values, in the same manner as the formal parameters of a procedure are bound to its arguments.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ()
  (define-values (x y) (values 1 2))
  (list x y)) ⇒ (1 2)
(let ()
  (define-values (x y . z) (values 1 2 3 4))
  (list x y z)) ⇒ (1 2 (3 4))</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>define-values</code> form expands into a sequence of definitions, the first for a hidden temporary bound to a data structure holding the values returned by <code><em>expr</em></code> and the remainder binding each of the formals to the corresponding value or list of values, extracted from the data structure via a reference to the temporary. Because the temporary must be defined before the other variables are defined, this works for internal <code>define-values</code> forms only if <code>internal-defines-as-letrec*</code> is set to the default value <code>#t</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_5.3.">Section 5.3. Recursive Bindings</h3>
<div id="binding:s17" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(rec <em>var</em> <em>expr</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>value of <code><em>expr</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The syntactic form <code>rec</code> creates a recursive object from <code><em>expr</em></code> by establishing a binding of <code><em>var</em></code> within <code><em>expr</em></code> to the value of <code><em>expr</em></code>. In essence, it is a special case of <code>letrec</code> for self-recursive objects.</p>
</div>
<div class="paragraph">
<p>This form is useful for creating recursive objects (especially procedures) that do not depend on external variables for the recursion, which are sometimes undesirable because the external bindings can change. For example, a recursive procedure defined at top level depends on the value of the top-level variable given as its name. If the value of this variable should change, the meaning of the procedure itself would change. If the procedure is defined instead with <code>rec</code>, its meaning is independent of the variable to which it is bound.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(map (rec sum
       (lambda (x)
         (if (= x 0)
             0
             (+ x (sum (- x 1))))))
     '(0 1 2 3 4 5)) ⇒ (0 1 3 6 10 15)

(define cycle
  (rec self
    (list (lambda () self))))

(eq? ((car cycle)) cycle) ⇒ #t</code></pre>
</div>
</div>
<div class="paragraph">
<p>The definition below expands <code>rec</code> in terms of <code>letrec</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax rec
  (syntax-rules ()
    [(_ x e) (letrec ((x e)) x)]))</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_5.4.">Section 5.4. Fluid Bindings</h3>
<div id="binding:s19" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(fluid-let ((<em>var</em> <em>expr</em>) ...) <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the values of the body <code><em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="binding:s21" class="paragraph">
<p>The syntactic form <code>fluid-let</code> provides a way to temporarily assign values to a set of variables. The new values are in effect only during the evaluation of the body of the <code>fluid-let</code> expression. The scopes of the variables are not determined by <code>fluid-let</code>; as with <code>set!</code>, the variables must be bound at top level or by an enclosing <code>lambda</code> or other binding form. It is possible, therefore, to control the scope of a variable with <code>lambda</code> or <code>let</code> while establishing a temporary value with <code>fluid-let</code>.</p>
</div>
<div class="paragraph">
<p>Although it is similar in appearance to <code>let</code>, its operation is more like that of <code>set!</code>. Each <code><em>var</em></code> is assigned, as with <code>set!</code>, to the value of the corresponding <code><em>expr</em></code> within the body <code><em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...</code>. Should the body exit normally or by invoking a continuation made outside of the body (see <code>call/cc</code>), the values in effect before the bindings were changed are restored. Should control return back to the body by the invocation of a continuation created within the body, the bindings are changed once again to the values in effect when the body last exited.</p>
</div>
<div class="paragraph">
<p>Fluid bindings are most useful for maintaining variables that must be shared by a group of procedures. Upon entry to the group of procedures, the shared variables are fluidly bound to a new set of initial values so that on exit the original values are restored automatically. In this way, the group of procedures itself can be reentrant; it may call itself directly or indirectly without affecting the values of its shared variables.</p>
</div>
<div id="binding:s22" class="paragraph">
<p>Fluid bindings are similar to <em>special</em> bindings in Common Lisp <a href="#ref30">[30]</a>, except that (1) there is a single namespace for both lexical and fluid bindings, and (2) the scope of a fluidly bound variable is not necessarily global.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([x 3])
  (+ (fluid-let ([x 5])
       x)
     x)) ⇒ 8

(let ([x 'a])
  (letrec ([f (lambda (y) (cons x y))])
    (fluid-let ([x 'b])
      (f 'c)))) ⇒ (b . c)

(let ([x 'a])
  (call/cc
    (lambda (k)
       (fluid-let ([x 'b])
         (letrec ([f (lambda (y) (k '*))])
           (f '*)))))
  x) ⇒ a</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>fluid-let</code> may be defined in terms of <code>dynamic-wind</code> as follows.</p>
</div>
<div id="defn:fluid-let" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax fluid-let
  (lambda (x)
    (syntax-case x ()
      [(_ () b1 b2 ...) #'(let () b1 b2 ...)]
      [(_ ((x e) ...) b1 b2 ...)
       (andmap identifier? #'(x ...))
       (with-syntax ([(y ...) (generate-temporaries #'(x ...))])
         #'(let ([y e] ...)
             (let ([swap (lambda ()
                           (let ([t x]) (set! x y) (set! y t))
                           ...)])
               (dynamic-wind swap (lambda () b1 b2 ...) swap))))])))</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_5.5.">Section 5.5. Top-Level Bindings</h3>
<div class="paragraph">
<p>The procedures described in this section allow the direct manipulation of top-level bindings for variables and keywords. They are intended primarily to support the definition of interpreters or compilers for Scheme in Scheme but may be used to access or alter top-level bindings anywhere within a program whether at top level or not.</p>
</div>
<div id="binding:s24" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(define-top-level-value <em>symbol</em> <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(define-top-level-value <em>symbol</em> <em>obj</em> <em>env</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>define-top-level-value</code> is used to establish a binding for the variable named by <code><em>symbol</em></code> to the value <code><em>obj</em></code> in the environment <code><em>env</em></code>. If <code><em>env</em></code> is not provided, it defaults to the value of <code>interaction-environment</code>, i.e., the top-level evaluation environment (<a href="#section_12.3.">Section 12.3</a>).</p>
</div>
<div class="paragraph">
<p>An exception is raised with condition type <code>&amp;assertion</code> if <code><em>env</em></code> is not mutable.</p>
</div>
<div class="paragraph">
<p>A call to <code>define-top-level-value</code> is similar to a top-level <code>define</code> form, except that a call to <code>define-top-level-value</code> need not occur at top-level and the variable for which the binding is to be established can be determined at run time, as can the environment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(begin
  (define-top-level-value 'xyz "hi")
  xyz) ⇒ "hi"

(let ([var 'xyz])
  (define-top-level-value var "mom")
  (list var xyz)) ⇒ (xyz "mom")</code></pre>
</div>
</div>
<div id="binding:s26" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-top-level-value! <em>symbol</em> <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-top-level-value! <em>symbol</em> <em>obj</em> <em>env</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="binding:s27" class="paragraph">
<p><code>set-top-level-value!</code> assigns the variable named by <code><em>symbol</em></code> to the value <code><em>obj</em></code> in the environment <code><em>env</em></code>. If <code><em>env</em></code> is not provided, it defaults to the value of <code>interaction-environment</code>, i.e., the top-level evaluation environment (<a href="#section_12.3.">Section 12.3</a>).</p>
</div>
<div class="paragraph">
<p>An exception is raised with condition type <code>&amp;assertion</code> if the identifier named by <code><em>symbol</em></code> is not defined as a variable in <code><em>env</em></code> or if the variable or environment is not mutable.</p>
</div>
<div class="paragraph">
<p><code>set-top-level-value!</code> is similar to <code>set!</code> when <code>set!</code> is used on top-level variables except that the variable to be assigned can be determined at run time, as can the environment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([v (let ([cons list])
           (set-top-level-value! 'cons +)
           (cons 3 4))])
  (list v (cons 3 4))) ⇒ ((3 4) 7)</code></pre>
</div>
</div>
<div id="binding:s29" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(top-level-value <em>symbol</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(top-level-value <em>symbol</em> <em>env</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the top-level value of the variable named by <code><em>symbol</em></code> in <code><em>env</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code><em>env</em></code> is not provided, it defaults to the value of <code>interaction-environment</code>, i.e., the top-level evaluation environment (<a href="#section_12.3.">Section 12.3</a>).</p>
</div>
<div class="paragraph">
<p>An exception is raised with condition type <code>&amp;assertion</code> if the identifier named by <code><em>symbol</em></code> is not defined as a variable in <code><em>env</em></code>.</p>
</div>
<div class="paragraph">
<p><code>top-level-value</code> is similar to a top-level variable reference except that the variable to be referenced can be determined at run time, as can the environment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([cons +])
  (list (cons 3 4)
        ((top-level-value 'cons) 3 4))) ⇒ (7 (3 . 4))

(define e (copy-environment (scheme-environment)))
(define-top-level-value 'pi 3.14 e)
(top-level-value 'pi e) ⇒ 3.14
(set-top-level-value! 'pi 3.1416 e)
(top-level-value 'pi e) ⇒ 3.1416</code></pre>
</div>
</div>
<div id="binding:s30" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(top-level-bound? <em>symbol</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(top-level-bound? <em>symbol</em> <em>env</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>symbol</em></code> is defined as a variable in <code><em>env</em></code>, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code><em>env</em></code> is not provided, it defaults to the value of <code>interaction-environment</code>, i.e., the top-level evaluation environment (<a href="#section_12.3.">Section 12.3</a>).</p>
</div>
<div class="paragraph">
<p>This predicate is useful in an interpreter to check for the existence of a top-level binding before requesting the value with <code>top-level-value</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(top-level-bound? 'xyz) ⇒ #f

(begin
  (define-top-level-value 'xyz 3)
  (top-level-bound? 'xyz)) ⇒ #t

(define e (copy-environment (interaction-environment)))
(define-top-level-value 'pi 3.14 e)
(top-level-bound? 'pi) ⇒ #f
(top-level-bound? 'pi e) ⇒ #t</code></pre>
</div>
</div>
<div id="binding:s31" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(top-level-mutable? <em>symbol</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(top-level-mutable? <em>symbol</em> <em>env</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>symbol</em></code> is mutable in <code><em>env</em></code>, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code><em>env</em></code> is not provided, it defaults to the value of <code>interaction-environment</code>, i.e., the top-level evaluation environment (<a href="#section_12.3.">Section 12.3</a>).</p>
</div>
<div class="paragraph">
<p>This predicate is useful in an interpreter to check whether a variable can be assigned before assigning it with <code>set-top-level-value!</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define xyz 3)
(top-level-mutable? 'xyz) ⇒ #t
(set-top-level-value! 'xyz 4)
(top-level-value 'xyz) ⇒ 4

(define e (copy-environment (interaction-environment) #f))
(top-level-mutable? 'xyz e) ⇒ #f
(set-top-level-value! 'xyz e) ⇒ <em>exception: xyz is immutable</em></code></pre>
</div>
</div>
<div id="binding:s32" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(define-top-level-syntax <em>symbol</em> <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(define-top-level-syntax <em>symbol</em> <em>obj</em> <em>env</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>define-top-level-syntax</code> is used to establish a top-level binding for the identifier named by <code><em>symbol</em></code> to the value of <code><em>obj</em></code> in the environment <code><em>env</em></code>. The value must be a procedure, the result of a call to <code>make-variable-transformer</code>, or the result of a call to <code>top-level-syntax</code>. If <code><em>env</em></code> is not provided, it defaults to the value of <code>interaction-environment</code>, i.e., the top-level evaluation environment (<a href="#section_12.3.">Section 12.3</a>).</p>
</div>
<div class="paragraph">
<p>An exception is raised with condition type <code>&amp;assertion</code> if <code><em>env</em></code> is not mutable.</p>
</div>
<div class="paragraph">
<p>A call to <code>define-top-level-syntax</code> is similar to a top-level <code>define-syntax</code> form, except that a call to <code>define-top-level-syntax</code> need not occur at top-level and the identifier for which the binding is to be established can be determined at run time, as can the environment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-top-level-syntax 'let1
  (syntax-rules ()
    [(_ x e b1 b2 ...) (let ([x e]) b1 b2 ...)]))
(let1 a 3 (+ a 1)) ⇒ 4</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>define-top-level-syntax</code> can also be used to attach to an identifier arbitrary compile-time bindings obtained via <code>top-level-syntax</code>.</p>
</div>
<div id="binding:s34" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(top-level-syntax <em>symbol</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(top-level-syntax <em>symbol</em> <em>env</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>top-level-syntax</code> is used to retrieve the transformer, compile-time value, or other compile-time binding to which the identifier named by <code><em>symbol</em></code> is bound in the environment <code><em>env</em></code>. If <code><em>env</em></code> is not provided, it defaults to the value of <code>interaction-environment</code>, i.e., the top-level evaluation environment (<a href="#section_12.3.">Section 12.3</a>). All identifiers bound in an environment have compile-time bindings, including variables.</p>
</div>
<div class="paragraph">
<p>An exception is raised with condition type <code>&amp;assertion</code> if the identifier named by <code><em>symbol</em></code> is not defined as a keyword in <code><em>env</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-top-level-syntax 'also-let (top-level-syntax 'let))
(also-let ([x 3] [y 4]) (+ x y)) ⇒ 7

(define foo 17)
(define-top-level-syntax 'also-foo (top-level-syntax 'foo))
also-foo ⇒ 17
(set! also-foo 23)
also-foo ⇒ 23
foo ⇒ 23</code></pre>
</div>
</div>
<div class="paragraph">
<p>The effect of the last example can be had more clearly with <code>alias</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define foo 17)
(alias also-foo foo)
also-foo ⇒ 17
(set! also-foo 23)
also-foo ⇒ 23
foo ⇒ 23</code></pre>
</div>
</div>
<div id="binding:s35" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(top-level-syntax? <em>symbol</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(top-level-syntax? <em>symbol</em> <em>env</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>symbol</em></code> is bound as a keyword in <code><em>env</em></code>, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code><em>env</em></code> is not provided, it defaults to the value of <code>interaction-environment</code>, i.e., the top-level evaluation environment (<a href="#section_12.3.">Section 12.3</a>).</p>
</div>
<div class="paragraph">
<p>All identifiers bound in an environment have compile-time bindings, including variables, so this predicate amounts to a bound check, but is more general than <code>top-level-bound?</code>, which returns true only for bound variables.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define xyz 'hello)
(top-level-syntax? 'cons) ⇒ #t
(top-level-syntax? 'lambda) ⇒ #t
(top-level-syntax? 'hello) ⇒ #t

(top-level-syntax? 'cons (scheme-environment)) ⇒ #t
(top-level-syntax? 'lambda (scheme-environment)) ⇒ #t
(top-level-syntax? 'hello (scheme-environment)) ⇒ #f</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chp_6">Chapter 6. Control Structures</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes <em>Chez Scheme</em> extensions to the set of standard control structures. See <a href="../../the-scheme-programming-language-4th/en/index.html#chp_5">Chapter 5</a> of <em>The Scheme Programming Language, 4th Edition</em> or the Revised<sup>6</sup> Report on Scheme for a description of standard control structures.</p>
</div>
<div class="sect2">
<h3 id="section_6.1.">Section 6.1. Conditionals</h3>
<div id="control:s0" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(exclusive-cond <em>clause<sub>1</sub></em> <em>clause<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>exclusive-cond</code> is a version of <code>cond</code> (<a href="#section_5.3.">Section 5.3</a> of TSPLFOUR) that differs from <code>cond</code> in that the tests embedded within the clauses are assumed to be exclusive in the sense that if one of the tests is true, the others are not. This allows the implementation to reorder clauses when profiling information is available at expansion time (<a href="#section_12.7.">Section 12.7</a>).</p>
</div>
<div class="paragraph">
<p>The <code>(<em>test</em>)</code> form of clause is not supported. The order chosen when profiling information is available is based on the relative numbers of times the RHS of each clause is executed, and <code>(<em>test</em>)</code> has no RHS. <code>(<em>test</em> =&gt; values)</code> is equivalent, abeit less concise.</p>
</div>
<div id="control:s1" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(case <em>expr<sub>0</sub></em> <em>clause<sub>1</sub></em> <em>clause<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each clause but the last must take one of the forms:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">((<em>key</em> ...) <em>expr<sub>1</sub></em> <em>expr<sub>2</sub></em> ...)
(<em>key</em> <em>expr<sub>1</sub></em> <em>expr<sub>2</sub></em> ...)</code></pre>
</div>
</div>
<div class="paragraph">
<p>where each <code><em>key</em></code> is a datum distinct from the other keys. The last clause may be in the above form or it may be an <code>else</code> clause of the form</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(else <em>expr<sub>1</sub></em> <em>expr<sub>2</sub></em> ...)</code></pre>
</div>
</div>
<div class="paragraph">
<p><code><em>expr<sub>0</sub></em></code> is evaluated and the result is compared (using <code>equal?</code>) against the keys of each clause in order. If a clause containing a matching key is found, the expressions <code><em>expr<sub>1</sub></em> <em>expr<sub>2</sub></em> ...</code> are evaluated in sequence and the values of the last expression are returned.</p>
</div>
<div class="paragraph">
<p>If none of the clauses contains a matching key and an <code>else</code> clause is present, the expressions <code><em>expr<sub>1</sub></em> <em>expr<sub>2</sub></em> ...</code> of the <code>else</code> clause are evaluated in sequence and the values of the last expression are returned.</p>
</div>
<div class="paragraph">
<p>If none of the clauses contains a matching key and no <code>else</code> clause is present, the value or values are unspecified.</p>
</div>
<div class="paragraph">
<p>The Revised<sup>6</sup> Report version of <code>case</code> does not support singleton keys (the second of the first two clause forms above) and uses <code>eqv?</code> rather than <code>equal?</code> as the comparison procedure. Both versions are defined in terms of <code>exclusive-cond</code> so that if profiling information is available at expansion time, the clauses will be reordered to put those that are most frequently executed first.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([ls '(ii iv)])
  (case (car ls)
    [i 1]
    [ii 2]
    [iii 3]
    [(iiii iv) 4]
    [else 'out-of-range])) ⇒ 2

(define p
  (lambda (x)
    (case x
      [("abc" "def") 'one]
      [((a b c)) 'two]
      [else #f])))

(p (string #\d #\e #\f)) ⇒ one
(p '(a b c)) ⇒ two</code></pre>
</div>
</div>
<div id="control:s3" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(record-case <em>expr</em> <em>clause<sub>1</sub></em> <em>clause<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see explanation</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>record-case</code> is a restricted form of <code>case</code> that supports the destructuring of <em>records</em>, or <em>tagged lists</em>. A record has as its first element a tag that determines what "type" of record it is; the remaining elements are the fields of the record.</p>
</div>
<div class="paragraph">
<p>Each clause but the last must take the form</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">((<em>key</em> ...) <em>formals</em> <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></pre>
</div>
</div>
<div class="paragraph">
<p>where each <code><em>key</em></code> is a datum distinct from the other keys. The last clause may be in the above form or it may be an <code>else</code> clause of the form</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(else <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></pre>
</div>
</div>
<div class="paragraph">
<p><code><em>expr</em></code> must evaluate to a pair. <code><em>expr</em></code> is evaluated and the car of its value is compared (using <code>eqv?</code>) against the keys of each clause in order. If a clause containing a matching key is found, the variables in <code><em>formals</em></code> are bound to the remaining elements of the list and the expressions <code><em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...</code> are evaluated in sequence. The value of the last expression is returned. The effect is identical to the application of</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(lambda <em>formals</em> <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></pre>
</div>
</div>
<div class="paragraph">
<p>to the cdr of the list.</p>
</div>
<div class="paragraph">
<p>If none of the clauses contains a matching key and an <code>else</code> clause is present, the expressions <code><em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...</code> of the <code>else</code> clause are evaluated in sequence and the value of the last expression is returned.</p>
</div>
<div class="paragraph">
<p>If none of the clauses contains a matching key and no <code>else</code> clause is present, the value is unspecified.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define calc
  (lambda (x)
    (record-case x
      [(add) (x y) (+ x y)]
      [(sub) (x y) (- x y)]
      [(mul) (x y) (* x y)]
      [(div) (x y) (/ x y)]
      [else (assertion-violationf 'calc "invalid expression ~s" x)])))

(calc '(add 3 4)) ⇒ 7
(calc '(div 3 4)) ⇒ 3/4</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_6.2.">Section 6.2. Mapping and Folding</h3>
<div id="control:s7" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(ormap <em>procedure</em> <em>list<sub>1</sub></em> <em>list<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see explanation</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>ormap</code> is identical to the Revised<sup>6</sup> Report <code>exists</code>.</p>
</div>
<div id="control:s8" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(andmap <em>procedure</em> <em>list<sub>1</sub></em> <em>list<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see explanation</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>andmap</code> is identical to the Revised<sup>6</sup> Report <code>for-all</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_6.3.">Section 6.3. Continuations</h3>
<div class="paragraph">
<p><em>Chez Scheme</em> supports one-shot continuations as well as the standard multi-shot continuations obtainable via <code>call/cc</code>. One-shot continuations are continuations that may be invoked at most once, whether explicitly or implicitly. They are obtained with <code>call/1cc</code>.</p>
</div>
<div id="control:s9" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(call/1cc <em>procedure</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>call/1cc</code> obtains its continuation and passes it to <code><em>procedure</em></code>, which should accept one argument. The continuation itself is represented by a procedure. This procedure normally takes one argument but may take an arbitrary number of arguments depending upon whether the context of the call to <code>call/1cc</code> expects multiple return values or not. When this procedure is applied to a value or values, it returns the values to the continuation of the <code>call/1cc</code> application.</p>
</div>
<div class="paragraph">
<p>The continuation obtained by <code>call/1cc</code> is a "one-shot continuation." A one-shot continuation should not be returned to multiple times, either by invoking the continuation or returning normally from <code><em>procedure</em></code> more than once. A one-shot continuation is "promoted" into a normal (multishot) continuation, however, if it is still active when a normal continuation is obtained by <code>call/cc</code>. After a one-shot continuation is promoted into a multishot continuation, it behaves exactly as if it had been obtained via <code>call/cc</code>. This allows <code>call/cc</code> and <code>call/1cc</code> to be used together transparently in many applications.</p>
</div>
<div class="paragraph">
<p>One-shot continuations may be more efficient for some applications than multishot continuations. See the paper "Representing control in the presence of one-shot continuations" <a href="#ref3">[3]</a> for more information about one-shot continuations, including how they are implemented in <em>Chez Scheme</em>.</p>
</div>
<div class="paragraph">
<p>The following examples highlight the similarities and differences between one-shot and normal continuations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define prod
 ; compute the product of the elements of ls, bugging out
 ; with no multiplications if a zero element is found
  (lambda (ls)
    (lambda (k)
      (if (null? ls)
          1
          (if (= (car ls) 0)
              (k 0)
              (* (car ls) ((prod (cdr ls)) k)))))))

(call/cc (prod '(1 2 3 4))) ⇒ 24
(call/1cc (prod '(1 2 3 4))) ⇒ 24

(call/cc (prod '(1 2 3 4 0))) ⇒ 0
(call/1cc (prod '(1 2 3 4 0))) ⇒ 0

(let ([k (call/cc (lambda (x) x))])
  (k (lambda (x) 0))) ⇒ 0

(let ([k (call/1cc (lambda (x) x))])
  (k (lambda (x) 0))) ⇒ <em>exception</em></code></pre>
</div>
</div>
<div id="dynamic-wind" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(dynamic-wind <em>in</em> <em>body</em> <em>out</em>)</code> <a id="control:s11"></a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(dynamic-wind <em>critical?</em> <em>in</em> <em>body</em> <em>out</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>values resulting from the application of <code><em>body</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The first form is identical to the Revised<sup>6</sup> Report <code>dynamic-wind</code>. When the optional <code><em>critical?</em></code> argument is present and non-false, the <code><em>in</em></code> thunk is invoked in a critical section along with the code that records that the body has been entered, and the <code><em>out</em></code> thunk is invoked in a critical section along with the code that records that the body has been exited. Extreme caution must be taken with this form of <code>dynamic-wind</code>, since an error or long-running computation can leave interrupts and automatic garbage collection disabled.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_6.4.">Section 6.4. Engines</h3>
<div class="paragraph">
<p>Engines are a high-level process abstraction supporting <em>timed preemption</em> (<a href="#ref15">[15]</a>,<a href="#ref24">[24]</a>). Engines may be used to simulate multiprocessing, implement operating system kernels, and perform nondeterministic computations.</p>
</div>
<div id="control:s16" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-engine <em>thunk</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>an engine</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An engine is created by passing a thunk (no argument procedure) to <code>make-engine</code>. The body of the thunk is the computation to be performed by the engine. An engine itself is a procedure of three arguments:</p>
</div>
<div id="control:s17" class="dlist">
<dl>
<dt class="hdlist1"><code><em>ticks</em></code></dt>
<dd>
<p>a positive integer that specifies the amount of <em>fuel</em> to be given to the engine. An engine executes until this fuel runs out or until its computation finishes.</p>
</dd>
</dl>
</div>
<div id="control:s18" class="dlist">
<dl>
<dt class="hdlist1"><code><em>complete</em></code></dt>
<dd>
<p>a procedure of one or more arguments that specifies what to do if the computation finishes. Its arguments are the amount of fuel left over and the values produced by the computation.</p>
</dd>
</dl>
</div>
<div id="control:s19" class="dlist">
<dl>
<dt class="hdlist1"><code><em>expire</em></code></dt>
<dd>
<p>a procedure of one argument that specifies what to do if the fuel runs out before the computation finishes. Its argument is a new engine capable of continuing the computation from the point of interruption.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>When an engine is applied to its arguments, it sets up a timer to fire in <code><em>ticks</em></code> time units. (See <code>set-timer</code> on <a href="#desc:set-timer">page 330</a>.) If the engine computation completes before the timer expires, the system invokes <code><em>complete</em></code>, passing it the number of <code><em>ticks</em></code> left over and the values produced by the computation. If, on the other hand, the timer goes off before the engine computation completes, the system creates a new engine from the continuation of the interrupted computation and passes this engine to <code><em>expire</em></code>. <code><em>complete</em></code> and <code><em>expire</em></code> are invoked in the continuation of the engine invocation.</p>
</div>
<div class="paragraph">
<p>An implementation of engines is given in <a href="../../the-scheme-programming-language-4th/en/index.html#section_12.11.">Section 12.11</a> of <em>The Scheme Programming Language, 4th Edition</em>.</p>
</div>
<div class="paragraph">
<p>Do not use the timer interrupt (see <code>set-timer</code>) and engines at the same time, since engines are implemented in terms of the timer.</p>
</div>
<div class="paragraph">
<p>The following example creates an engine from a trivial computation, 3, and gives the engine 10 ticks.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define eng
  (make-engine
    (lambda () 3)))

(eng 10
     (lambda (ticks value) value)
     (lambda (x) x)) ⇒ 3</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is often useful to pass <code>list</code> as the <code><em>complete</em></code> procedure to an engine, causing an engine that completes to return a list whose first element is the ticks remaining and whose remaining elements are the values returned by the computation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define eng
  (make-engine
    (lambda () 3)))

(eng 10
     list
     (lambda (x) x)) ⇒ (9 3)</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the example above, the value is 3 and there are 9 ticks left over, i.e., it takes one unit of fuel to evaluate 3. (The fuel amounts given here are for illustration only. Your mileage may vary.)</p>
</div>
<div class="paragraph">
<p>Typically, the engine computation does not finish in one try. The following example displays the use of an engine to compute the 10th Fibonacci number in steps.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define fibonacci
  (lambda (n)
    (let fib ([i n])
      (cond
        [(= i 0) 0]
        [(= i 1) 1]
        [else (+ (fib (- i 1))
                 (fib (- i 2)))]))))

(define eng
  (make-engine
    (lambda ()
      (fibonacci 10))))

(eng 50
     list
     (lambda (new-eng)
       (set! eng new-eng)
       "expired")) ⇒ "expired"

(eng 50
     list
     (lambda (new-eng)
       (set! eng new-eng)
       "expired")) ⇒ "expired"

(eng 50
     list
     (lambda (new-eng)
       (set! eng new-eng)
       "expired")) ⇒ "expired"

(eng 50
     list
     (lambda (new-eng)
       (set! eng new-eng)
       "expired")) ⇒ (21 55)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each time the engine&#8217;s fuel runs out, the <code><em>expire</em></code> procedure assigns <code>eng</code> to the new engine. The entire computation requires four blocks of 50 ticks to complete; of the last 50 it uses all but 21. Thus, the total amount of fuel used is 179 ticks. This leads to the following procedure, <code>mileage</code>, which "times" a computation using engines:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define mileage
  (lambda (thunk)
    (let loop ([eng (make-engine thunk)] [total-ticks 0])
      (eng 50
           (lambda (ticks . values)
             (+ total-ticks (- 50 ticks)))
           (lambda (new-eng)
             (loop new-eng
                   (+ total-ticks 50)))))))

(mileage (lambda () (fibonacci 10))) ⇒ 179</code></pre>
</div>
</div>
<div class="paragraph">
<p>The choice of 50 for the number of ticks to use each time is arbitrary, of course. It might make more sense to pass a much larger number, say 10000, in order to reduce the number of times the computation is interrupted.</p>
</div>
<div class="paragraph">
<p>The next procedure is similar to <code>mileage</code>, but it returns a list of engines, one for each tick it takes to complete the computation. Each of the engines in the list represents a "snapshot" of the computation, analogous to a single frame of a moving picture. <code>snapshot</code> might be useful for "single stepping" a computation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define snapshot
  (lambda (thunk)
    (let again ([eng (make-engine thunk)])
      (cons eng
            (eng 1 (lambda (t . v) '()) again)))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The recursion embedded in this procedure is rather strange. The complete procedure performs the base case, returning the empty list, and the expire procedure performs the recursion.</p>
</div>
<div class="paragraph">
<p>The next procedure, <code>round-robin</code>, could be the basis for a simple time-sharing operating system. <code>round-robin</code> maintains a queue of processes (a list of engines), cycling through the queue in a <em>round-robin</em> fashion, allowing each process to run for a set amount of time. <code>round-robin</code> returns a list of the values returned by the engine computations in the order that the computations complete. Each computation is assumed to produce exactly one value.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define round-robin
  (lambda (engs)
    (if (null? engs)
        '()
        ((car engs)
         1
         (lambda (ticks value)
           (cons value (round-robin (cdr engs))))
         (lambda (eng)
           (round-robin
             (append (cdr engs) (list eng))))))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since the amount of fuel supplied each time, one tick, is constant, the effect of <code>round-robin</code> is to return a list of the values sorted from the quickest to complete to the slowest to complete. Thus, when we call <code>round-robin</code> on a list of engines, each computing one of the Fibonacci numbers, the output list is sorted with the earlier Fibonacci numbers first, regardless of the order of the input list.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(round-robin
  (map (lambda (x)
         (make-engine
           (lambda ()
             (fibonacci x))))
       '(4 5 2 8 3 7 6 2))) ⇒ (1 1 2 3 5 8 13 21)</code></pre>
</div>
</div>
<div class="paragraph">
<p>More interesting things can happen if the amount of fuel varies each time through the loop. In this case, the computation would be nondeterministic, i.e., the results would vary from call to call.</p>
</div>
<div class="paragraph">
<p>The following syntactic form, <code>por</code> (parallel-or), returns the first of its expressions to complete with a true value. <code>por</code> is implemented with the procedure <code>first-true</code>, which is similar to <code>round-robin</code> but quits when any of the engines completes with a true value. If all of the engines complete, but none with a true value, <code>first-true</code> (and hence <code>por</code>) returns <code>#f</code>. Also, although <code>first-true</code> passes a fixed amount of fuel to each engine, it chooses the next engine to run at random, and is thus nondeterministic.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax por
  (syntax-rules ()
    [(_ x ...)
     (first-true
       (list (make-engine (lambda () x)) ...))]))

(define first-true
  (let ([pick
         (lambda (ls)
           (list-ref ls (random (length ls))))])
    (lambda (engs)
      (if (null? engs)
          #f
          (let ([eng (pick engs)])
            (eng 1
                 (lambda (ticks value)
                   (or value
                       (first-true
                         (remq eng engs))))
                 (lambda (new-eng)
                   (first-true
                     (cons new-eng
                           (remq eng engs))))))))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The list of engines is maintained with <code>pick</code>, which randomly chooses an element of the list, and <code>remq</code>, which removes the chosen engine from the list. Since <code>por</code> is nondeterministic, subsequent uses with the same expressions may not return the same values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(por 1 2 3) ⇒ 2
(por 1 2 3) ⇒ 3
(por 1 2 3) ⇒ 2
(por 1 2 3) ⇒ 1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Furthermore, even if one of the expressions is an infinite loop, <code>por</code> still finishes as long as one of the other expressions completes and returns a true value.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(por (let loop () (loop)) 2) ⇒ 2</code></pre>
</div>
</div>
<div class="paragraph">
<p>With <code>engine-return</code> and <code>engine-block</code>, it is possible to terminate an engine explicitly. <code>engine-return</code> causes the engine to complete, as if the computation had finished. Its arguments are passed to the <code><em>complete</em></code> procedure along with the number of ticks remaining. It is essentially a nonlocal exit from the engine. Similarly, <code>engine-block</code> causes the engine to expire, as if the timer had run out. A new engine is made from the continuation of the call to <code>engine-block</code> and passed to the <code><em>expire</em></code> procedure.</p>
</div>
<div id="control:s27" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(engine-block)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>does not return</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This causes a running engine to stop, create a new engine capable of continuing the computation, and pass the new engine to the original engine&#8217;s third argument (the expire procedure). Any remaining fuel is forfeited.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define eng
  (make-engine
    (lambda ()
      (engine-block)
      "completed")))

(eng 100
     (lambda (ticks value) value)
     (lambda (x)
        (set! eng x)
        "expired")) ⇒ "expired"

(eng 100
     (lambda (ticks value) value)
     (lambda (x)
        (set! eng x)
        "expired")) ⇒ "completed"</code></pre>
</div>
</div>
<div id="control:s28" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(engine-return <em>obj</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>does not return</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This causes a running engine to stop and pass control to the engine&#8217;s <code><em>complete</em></code> argument. The first argument passed to the complete procedure is the amount of fuel remaining, as usual, and the remaining arguments are the objects <code><em>obj</em> ...</code> passed to <code>engine-return</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define eng
  (make-engine
    (lambda ()
      (reverse (engine-return 'a 'b 'c)))))

(eng 100
     (lambda (ticks . values) values)
     (lambda (new-eng) "expired")) ⇒ (a b c)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chp_7">Chapter 7. Operations on Objects</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes operations specific to <em>Chez Scheme</em> on nonnumeric objects, including standard objects such as pairs and numbers and <em>Chez Scheme</em> extensions such as boxes and records. <a href="#chp_8">Chapter 8</a> describes operations on numbers. See <a href="../../the-scheme-programming-language-4th/en/index.html#chp_6">Chapter 6</a> of <em>The Scheme Programming Language, 4th Edition</em> or the Revised<sup>6</sup> Report on Scheme for a description of standard operations on objects.</p>
</div>
<div class="sect2">
<h3 id="section_7.1.">Section 7.1. Missing R6RS Type Predicates</h3>
<div id="objects:s0" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(enum-set? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is an enum set, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This predicate is not defined by the Revised<sup>6</sup> Report, but should be.</p>
</div>
<div id="objects:s1" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-constructor-descriptor? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a record constructor descriptor, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This predicate is not defined by the Revised<sup>6</sup> Report, but should be.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_7.2.">Section 7.2. Pairs and Lists</h3>
<div id="objects:s2" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(atom? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is not a pair, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>atom?</code> is equivalent to <code>(lambda (x) (not (pair? x)))</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(atom? '(a b c)) ⇒ #f
(atom? '(3 . 4)) ⇒ #f
(atom? '()) ⇒ #t
(atom? 3) ⇒ #t</code></pre>
</div>
</div>
<div id="objects:s3" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(list-head <em>list</em> <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of the first <code><em>n</em></code> elements of <code><em>list</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>n</em></code> must be an exact nonnegative integer less than or equal to the length of <code><em>list</em></code>.</p>
</div>
<div class="paragraph">
<p><code>list-head</code> and the standard Scheme procedure <code>list-tail</code> may be used together to split a list into two separate lists. While <code>list-tail</code> performs no allocation but instead returns a sublist of the original list, <code>list-head</code> always returns a copy of the first portion of the list.</p>
</div>
<div class="paragraph">
<p><code>list-head</code> may be defined as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define list-head
  (lambda (ls n)
    (if (= n 0)
        '()
        (cons (car ls) (list-head (cdr ls) (- n 1))))))

(list-head '(a b c) 0) ⇒ ()
(list-head '(a b c) 2) ⇒ (a b)
(list-head '(a b c) 3) ⇒ (a b c)
(list-head '(a b c . d) 2) ⇒ (a b)
(list-head '(a b c . d) 3) ⇒ (a b c)
(list-head '#1=(a . #1#) 5) ⇒ (a a a a a)</code></pre>
</div>
</div>
<div id="objects:s4" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(last-pair <em>list</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the last pair of a <code><em>list</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>list</em></code> must not be empty. <code>last-pair</code> returns the last pair (not the last element) of <code><em>list</em></code>. <code><em>list</em></code> may be an improper list, in which case the last pair is the pair containing the last element and the terminating object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(last-pair '(a b c d)) ⇒ (d)
(last-pair '(a b c . d)) ⇒ (c . d)</code></pre>
</div>
</div>
<div id="objects:s5" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(list-copy <em>list</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a copy of <code><em>list</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>list-copy</code> returns a list <code>equal?</code> to <code><em>list</em></code>, using new pairs to reform the top-level list structure.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(list-copy '(a b c)) ⇒ (a b c)

(let ([ls '(a b c)])
  (equal? ls (list-copy ls))) ⇒ #t

(let ([ls '(a b c)])
  (let ([ls-copy (list-copy ls)])
    (or (eq? ls-copy ls)
        (eq? (cdr ls-copy) (cdr ls))
        (eq? (cddr ls-copy) (cddr ls))))) ⇒ #f</code></pre>
</div>
</div>
<div id="objects:s6" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(list* <em>obj</em> ... <em>final-obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of <code><em>obj</em> ...</code> terminated by <code><em>final-obj</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>list*</code> is identical to the Revised<sup>6</sup> Report <code>cons*</code>.</p>
</div>
<div id="objects:s7" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-list <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-list <em>n</em> <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of <code><em>n</em></code> <code><em>objs</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>n</em></code> must be a nonnegative integer. If <code><em>obj</em></code> is omitted, the elements of the list are unspecified.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(make-list 0 '()) ⇒ ()
(make-list 3 0) ⇒ (0 0 0)
(make-list 2 "hi") ⇒ ("hi" "hi")</code></pre>
</div>
</div>
<div id="objects:s8" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(iota <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of integers from 0 (inclusive) to <code><em>n</em></code> (exclusive)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>n</em></code> must be an exact nonnegative integer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(iota 0) ⇒ ()
(iota 5) ⇒ (0 1 2 3 4)</code></pre>
</div>
</div>
<div id="objects:s9" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(enumerate <em>ls</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of integers from 0 (inclusive) to the length of <code><em>ls</em></code> (exclusive)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(enumerate '()) ⇒ ()
(enumerate '(a b c)) ⇒ (0 1 2)
(let ([ls '(a b c)])
  (map cons ls (enumerate ls))) ⇒ ((a . 0) (b . 1) (c . 2))</code></pre>
</div>
</div>
<div id="objects:s10" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(remq! <em>obj</em> <em>list</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(remv! <em>obj</em> <em>list</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(remove! <em>obj</em> <em>list</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list containing the elements of <code><em>list</em></code> with all occurrences of <code><em>obj</em></code> removed</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These procedures are similar to the Revised<sup>6</sup> Report <code>remq</code>, <code>remv</code>, and <code>remove</code> procedures, except <code>remq!</code>, <code>remv!</code> and <code>remove!</code> use pairs from the input list to build the output list. They perform less allocation but are not necessarily faster than their nondestructive counterparts. Their use can easily lead to confusing or incorrect results if used indiscriminately.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(remq! 'a '(a b a c a d)) ⇒ (b c d)

(remv! #\a '(#\a #\b #\c)) ⇒ (#\b #\c)

(remove! '(c) '((a) (b) (c))) ⇒ ((a) (b))</code></pre>
</div>
</div>
<div id="objects:s11" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(substq <em>new</em> <em>old</em> <em>tree</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(substv <em>new</em> <em>old</em> <em>tree</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(subst <em>new</em> <em>old</em> <em>tree</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(substq! <em>new</em> <em>old</em> <em>tree</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(substv! <em>new</em> <em>old</em> <em>tree</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(subst! <em>new</em> <em>old</em> <em>tree</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a tree with <code><em>new</em></code> substituted for occurrences of <code><em>old</em></code> in <code><em>tree</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These procedures traverse <code><em>tree</em></code>, replacing all objects equivalent to the object <code><em>old</em></code> with the object <code><em>new</em></code>.</p>
</div>
<div class="paragraph">
<p>The equivalence test for <code>substq</code> and <code>substq!</code> is <code>eq?</code>, for <code>substv</code> and <code>substv!</code> is <code>eqv?</code>, and for <code>subst</code> and <code>subst!</code> is <code>equal?</code>.</p>
</div>
<div class="paragraph">
<p><code>substq!</code>, <code>substv!</code>, and <code>subst!</code> perform the substitutions destructively. They perform less allocation but are not necessarily faster than their nondestructive counterparts. Their use can easily lead to confusing or incorrect results if used indiscriminately.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(substq 'a 'b '((b c) b a)) ⇒ ((a c) a a)

(substv 2 1 '((1 . 2) (1 . 4) . 1)) ⇒ ((2 . 2) (2 . 4) . 2)

(subst 'a
       '(a . b)
       '((a . b) (c a . b) . c)) ⇒ (a (c . a) . c)

(let ([tr '((b c) b a)])
  (substq! 'a 'b tr)
  tr) ⇒ ((a c) a a)</code></pre>
</div>
</div>
<div id="objects:s12" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(reverse! <em>list</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list containing the elements of <code><em>list</em></code> in reverse order</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>reverse!</code> destructively reverses <code><em>list</em></code> by reversing its links. Using <code>reverse!</code> in place of <code>reverse</code> reduces allocation but is not necessarily faster than <code>reverse</code>. Its use can easily lead to confusing or incorrect results if used indiscriminately.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(reverse! '()) ⇒ ()
(reverse! '(a b c)) ⇒ (c b a)

(let ([x '(a b c)])
    (reverse! x)
    x) ⇒ (a)

(let ([x '(a b c)])
    (set! x (reverse! x))
    x) ⇒ (c b a)</code></pre>
</div>
</div>
<div id="objects:s13" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(append! <em>list</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the concatenation of the input lists</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Like <code>append</code>, <code>append!</code> returns a new list consisting of the elements of the first list followed by the elements of the second list, the elements of the third list, and so on. Unlike <code>append</code>, <code>append!</code> reuses the pairs in all of the arguments in forming the new list. That is, the last cdr of each list argument but the last is changed to point to the next list argument. If any argument but the last is the empty list, it is essentially ignored. The final argument (which need not be a list) is not altered.</p>
</div>
<div class="paragraph">
<p><code>append!</code> performs less allocation than <code>append</code> but is not necessarily faster. Its use can easily lead to confusing or incorrect results if used indiscriminately.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(append! '(a b) '(c d)) ⇒ (a b c d)

(let ([x '(a b)])
    (append! x '(c d))
    x) ⇒ (a b c d)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_7.3.">Section 7.3. Characters</h3>
<div class="paragraph">
<p><em>Chez Scheme</em> extends the syntax of characters in two ways. First, a <code>#\</code> prefix followed by exactly three octal digits is read as a character whose numeric code is the octal value of the three digits, e.g., <code>#\044</code> is read as <code>#\$</code>. Second, it recognizes several nonstandard named characters: <code>#\rubout</code> (which is the same as <code>#\delete</code>), <code>#\bel</code> (which is the same as <code>#\alarm</code>), <code>#\vt</code> (which is the same as <code>#\vtab</code>), <code>#\nel</code> (the Unicode NEL character), and <code>#\ls</code> (the Unicode LS character). The set of nonstandard character names may be changed via the procedure <code>char-name</code> (<a href="#section_9.14.">Section 9.14</a>).</p>
</div>
<div class="paragraph">
<p>These extensions are disabled in an input stream after <code>#!r6rs</code> has been seen by the reader, unless <code>#!chezscheme</code> has been seen more recently.</p>
</div>
<div id="objects:s15" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(char=? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(char&lt;? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(char&gt;? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(char&lt;=? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(char&gt;=? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(char-ci=? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(char-ci&lt;? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(char-ci&gt;? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(char-ci&lt;=? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(char-ci&gt;=? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the relation holds, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These predicates are identical to the Revised<sup>6</sup> Report counterparts, except they are extended to accept one or more rather than two or more arguments. When passed one argument, each of these predicates returns <code>#t</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(char>? #\a) ⇒ #t
(char&lt;? #\a) ⇒ #t
(char-ci=? #\a) ⇒ #t</code></pre>
</div>
</div>
<div id="objects:s16" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(char- <em>char<sub>1</sub></em> <em>char<sub>2</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the integer difference between <code><em>char<sub>1</sub></em></code> and <code><em>char<sub>2</sub></em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>char-</code> subtracts the integer value of <code><em>char<sub>2</sub></em></code> from the integer value of <code><em>char<sub>1</sub></em></code> and returns the difference. The following examples assume that the integer representation is the ASCII code for the character.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(char- #\f #\e) ⇒ 1

(define digit-value
 ; returns the digit value of the base-r digit c, or #f if c
 ; is not a valid digit
  (lambda (c r)
    (let ([v (cond
               [(char<=? #\0 c #\9) (char- c #\0)]
               [(char<=? #\A c #\Z) (char- c #\7)]
               [(char<=? #\a c #\z) (char- c #\W)]
               [else 36])])
      (and (fx< v r) v))))
(digit-value #\8 10) ⇒ 8
(digit-value #\z 10) ⇒ #f
(digit-value #\z 36) ⇒ 35</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>char-</code> might be defined as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define char-
  (lambda (c1 c2)
    (- (char->integer c1) (char->integer c2))))</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_7.4.">Section 7.4. Strings</h3>
<div class="paragraph">
<p><em>Chez Scheme</em> extends the standard string syntax with two character escapes: <code>\'</code>, which produces the single quote character, and <code>\<em>nnn</em></code>, i.e., backslash followed by 3 octal digits, which produces the character equivalent of the octal value of the 3 digits. These extensions are disabled in an input stream after <code>#!r6rs</code> has been seen by the reader, unless <code>#!chezscheme</code> has been seen more recently.</p>
</div>
<div id="objects:s18" class="paragraph">
<p>All strings are mutable by default, including constants. A program can create immutable strings via <code>string-&gt;immutable-string</code>. Any attempt to modify an immutable string causes an exception to be raised.</p>
</div>
<div class="paragraph">
<p>The length and indices of a string in <em>Chez Scheme</em> are always fixnums.</p>
</div>
<div id="objects:s20" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(string=? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(string&lt;? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(string&gt;? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(string&lt;=? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(string&gt;=? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(string-ci=? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(string-ci&lt;? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(string-ci&gt;? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(string-ci&lt;=? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(string-ci&gt;=? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the relation holds, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These predicates are identical to the Revised<sup>6</sup> Report counterparts, except they are extended to accept one or more rather than two or more arguments. When passed one argument, each of these predicates returns <code>#t</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(string>? "a") ⇒ #t
(string&lt;? "a") ⇒ #t
(string-ci=? "a") ⇒ #t</code></pre>
</div>
</div>
<div id="objects:s21" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(string-copy! <em>src</em> <em>src-start</em> <em>dst</em> <em>dst-start</em> <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>src</em></code> and <code><em>dst</em></code> must be strings, and <code><em>dst</em></code> must be mutable. <code><em>src-start</em></code>, <code><em>dst-start</em></code>, and <code><em>n</em></code> must be exact nonnegative integers. The sum of <code><em>src-start</em></code> and <code><em>n</em></code> must not exceed the length of <code><em>src</em></code>, and the sum of <code><em>dst-start</em></code> and <code><em>n</em></code> must not exceed the length of <code><em>dst</em></code>.</p>
</div>
<div class="paragraph">
<p><code>string-copy!</code> overwrites the <code><em>n</em></code> bytes of <code><em>dst</em></code> starting at <code><em>dst-start</em></code> with the <code><em>n</em></code> bytes of <code><em>dst</em></code> starting at <code><em>src-start</em></code>. This works even if <code><em>dst</em></code> is the same string as <code><em>src</em></code> and the source and destination locations overlap. That is, the destination is filled with the characters that appeared at the source before the operation began.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define s1 "to boldly go")
(define s2 (make-string 10 #\-))

(string-copy! s1 3 s2 1 3)
s2 ⇒ "-bol------"

(string-copy! s1 7 s2 4 2)
s2 ⇒ "-bolly----"

(string-copy! s2 2 s2 5 4)
s2 ⇒ "-bollolly-"</code></pre>
</div>
</div>
<div id="objects:s22" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(substring-fill! <em>string</em> <em>start</em> <em>end</em> <em>char</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>string</em></code> must be mutable. The characters of <code><em>string</em></code> from <code><em>start</em></code> (inclusive) to <code><em>end</em></code> (exclusive) are set to <code><em>char</em></code>. <code><em>start</em></code> and <code><em>end</em></code> must be nonnegative integers; <code><em>start</em></code> must be strictly less than the length of <code><em>string</em></code>, while <code><em>end</em></code> may be less than or equal to the length of <code><em>string</em></code>. If <em>end</em> ≤ <em>start</em>, the string is left unchanged.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([str (string-copy "a tpyo typo")])
  (substring-fill! str 2 6 #\X)
  str) ⇒ "a XXXX typo"</code></pre>
</div>
</div>
<div id="objects:s23" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(string-truncate! <em>string</em> <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code><em>string</em></code> or the empty string</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>string</em></code> must be mutable. <code><em>n</em></code> must be an exact nonnegative fixnum not greater than the length of <code><em>string</em></code>. If <code><em>n</em></code> is zero, <code>string-truncate!</code> returns the empty string. Otherwise, <code><em>string-truncate!</em></code> destructively truncates <code><em>string</em></code> to its first <code><em>n</em></code> characters and returns <code><em>string</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define s (make-string 7 #\$))
(string-truncate! s 0) ⇒ ""
s ⇒ "$$$$$$$"
(string-truncate! s 3) ⇒ "$$$"
s ⇒ "$$$"</code></pre>
</div>
</div>
<div id="objects:s24" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(mutable-string? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a mutable string, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(immutable-string? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is an immutable string, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(mutable-string? (string #\a #\b #\c)) ⇒ #t
(mutable-string? (string->immutable-string "abc")) ⇒ #f
(immutable-string? (string #\a #\b #\c)) ⇒ #f
(immutable-string? (string->immutable-string "abc")) ⇒ #t
(immutable-string? (cons 3 4)) ⇒ #f</code></pre>
</div>
</div>
<div id="objects:s25" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(string-&gt;immutable-string <em>string</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>an immutable string equal to <code><em>string</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="objects:s27" class="paragraph">
<p>The result is <code><em>string</em></code> itself if <code><em>string</em></code> is immutable; otherwise, the result is an immutable string with the same content as <code><em>string</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define s (string->immutable-string (string #\x #\y #\z)))
(string-set! s 0 #\a) ⇒ <em>exception: not mutable</em></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_7.5.">Section 7.5. Vectors</h3>
<div class="paragraph">
<p><em>Chez Scheme</em> extends the syntax of vectors to allow the length of the vector to be specified between the <code>#</code> and open parenthesis, e.g., <code>#3(a b c)</code>. If fewer elements are supplied in the syntax than the specified length, each element after the last printed element is the same as the last printed element. This extension is disabled in an input stream after <code>#!r6rs</code> has been seen by the reader, unless <code>#!chezscheme</code> has been seen more recently.</p>
</div>
<div class="paragraph">
<p>The length and indices of a vector in <em>Chez Scheme</em> are always fixnums.</p>
</div>
<div id="objects:s29" class="paragraph">
<p>All vectors are mutable by default, including constants. A program can create immutable vectors via <code>vector-&gt;immutable-vector</code>. Any attempt to modify an immutable vector causes an exception to be raised.</p>
</div>
<div id="objects:s31" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(vector-copy <em>vector</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a copy of <code><em>vector</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>vector-copy</code> creates a new vector of the same length and contents as <code><em>vector</em></code>. The elements themselves are not copied.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(vector-copy '#(a b c)) ⇒ #(a b c)

(let ([v '#(a b c)])
  (eq? v (vector-copy v))) ⇒ #f</code></pre>
</div>
</div>
<div id="objects:s32" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(vector-set-fixnum! <em>vector</em> <em>n</em> <em>fixnum</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>vector</em></code> must be mutable. <code>vector-set-fixnum!</code> changes the <code><em>n</em></code>th element of <code><em>vector</em></code> to <code><em>fixnum</em></code>. <code><em>n</em></code> must be an exact nonnegative integer strictly less than the length of <code><em>vector</em></code>.</p>
</div>
<div class="paragraph">
<p>It is faster to store a fixnum than an arbitrary value, since for arbitrary values, the system has to record potential assignments from older to younger objects to support generational garbage collection. Care must be taken to ensure that the argument is indeed a fixnum, however; otherwise, the collector may not properly track the assignment. The primitive performs a fixnum check on the argument except at optimization level 3.</p>
</div>
<div class="paragraph">
<p>See also the description of fixnum-only vectors (fxvectors) below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([v (vector 1 2 3 4 5)])
  (vector-set-fixnum! v 2 73)
  v) ⇒ #(1 2 73 4 5)</code></pre>
</div>
</div>
<div id="objects:s33" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(vector-cas! <em>vector</em> <em>n</em> <em>old-obj</em> <em>new-obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>vector</em></code> is changed, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>vector</em></code> must be mutable. <code>vector-cas!</code> atomically changes the <code><em>n</em></code>th element of <code><em>vector</em></code> to <code><em>new-obj</em></code> if the replaced <code><em>n</em></code>th element is <code>eq?</code> to <code><em>old-obj</em></code>. If the <code><em>n</em></code>th element of <code><em>vector</em></code> that would be replaced is not <code>eq?</code> to <code><em>old-obj</em></code>, then <code><em>vector</em></code> is unchanged.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define v (vector 'old0 'old1 'old2))
(vector-cas! v 1 'old1 'new1) ⇒ #t
(vector-ref v 1) ⇒ 'new1
(vector-cas! v 2 'old1 'new2) ⇒ #f
(vector-ref v 2) ⇒ 'old2</code></pre>
</div>
</div>
<div id="objects:s34" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(mutable-vector? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a mutable vector, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(immutable-vector? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is an immutable vector, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(mutable-vector? (vector 1 2 3)) ⇒ #t
(mutable-vector? (vector->immutable-vector (vector 1 2 3))) ⇒ #f
(immutable-vector? (vector 1 2 3)) ⇒ #f
(immutable-vector? (vector->immutable-vector (vector 1 2 3))) ⇒ #t
(immutable-vector? (cons 3 4)) ⇒ #f</code></pre>
</div>
</div>
<div id="objects:s35" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(vector-&gt;immutable-vector <em>vector</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>an immutable vector equal to <code><em>vector</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="objects:s37" class="paragraph">
<p>The result is <code><em>vector</em></code> itself if <code><em>vector</em></code> is immutable; otherwise, the result is an immutable vector with the same content as <code><em>vector</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define v (vector->immutable-vector (vector 1 2 3)))
(vector-set! v 0 0) ⇒ <em>exception: not mutable</em></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_7.6.">Section 7.6. Fixnum-Only Vectors</h3>
<div class="paragraph">
<p>Fixnum-only vectors, or "fxvectors," are like vectors but contain only fixnums. Fxvectors are written with the <code>#vfx</code> prefix in place of the <code>#</code> prefix for vectors, e.g., <code>#vfx(1 2 3)</code> or <code>#10vfx(2)</code>. The fxvector syntax is disabled in an input stream after <code>#!r6rs</code> has been seen by the reader, unless <code>#!chezscheme</code> has been seen more recently.</p>
</div>
<div class="paragraph">
<p>The length and indices of an fxvector are always fixnums.</p>
</div>
<div class="paragraph">
<p>Updating an fxvector is generally less expensive than updating a vector, since for vectors, the system records potential assignments from older to younger objects to support generational garbage collection. The storage management system also takes advantage of the fact that fxvectors contain no pointers to place them in an area of memory that does not have to be traced during collection.</p>
</div>
<div id="objects:s40" class="paragraph">
<p>All fxvectors are mutable by default, including constants. A program can create immutable fxvectors via <code>fxvector-&gt;immutable-fxvector</code>. Any attempt to modify an immutable fxvector causes an exception to be raised.</p>
</div>
<div class="paragraph">
<p>See also <code>vector-set-fixnum!</code> above.</p>
</div>
<div id="objects:s42" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxvector? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is an fxvector, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fxvector? #vfx()) ⇒ #t
(fxvector? #vfx(1 2 3)) ⇒ #t
(fxvector? (fxvector 1 2 3)) ⇒ #t
(fxvector? '#(a b c)) ⇒ #f
(fxvector? '(a b c)) ⇒ #f
(fxvector? "abc") ⇒ #f</code></pre>
</div>
</div>
<div id="objects:s43" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxvector <em>fixnum</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>an fxvector of the fixnums <code><em>fixnum</em> ...</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fxvector) ⇒ #vfx()
(fxvector 1 3 5) ⇒ #vfx(1 3 5)</code></pre>
</div>
</div>
<div id="objects:s44" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-fxvector <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-fxvector <em>n</em> <em>fixnum</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>an fxvector of length <code><em>n</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>n</em></code> must be a fixnum. If <code><em>fixnum</em></code> is supplied, each element of the fxvector is initialized to <code><em>fixnum</em></code>; otherwise, the elements are unspecified.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(make-fxvector 0) ⇒ #vfx()
(make-fxvector 0 7) ⇒ #vfx()
(make-fxvector 5 7) ⇒ #vfx(7 7 7 7 7)</code></pre>
</div>
</div>
<div id="objects:s45" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxvector-length <em>fxvector</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the number of elements in <code><em>fxvector</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fxvector-length #vfx()) ⇒ 0
(fxvector-length #vfx(1 2 3)) ⇒ 3
(fxvector-length #10vfx(1 2 3)) ⇒ 10
(fxvector-length (fxvector 1 2 3 4)) ⇒ 4
(fxvector-length (make-fxvector 300)) ⇒ 300</code></pre>
</div>
</div>
<div id="objects:s46" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxvector-ref <em>fxvector</em> <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the <code><em>n</em></code>th element (zero-based) of <code><em>fxvector</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>n</em></code> must be a nonnegative fixnum strictly less than the length of <code><em>fxvector</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fxvector-ref #vfx(-1 2 4 7) 0) ⇒ -1
(fxvector-ref #vfx(-1 2 4 7) 1) ⇒ 2
(fxvector-ref #vfx(-1 2 4 7) 3) ⇒ 7</code></pre>
</div>
</div>
<div id="objects:s47" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxvector-set! <em>fxvector</em> <em>n</em> <em>fixnum</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>fxvector</em></code> must be mutable. <code><em>n</em></code> must be a nonnegative fixnum strictly less than the length of <code><em>fxvector</em></code>. <code>fxvector-set!</code> changes the <code><em>n</em></code>th element of <code><em>fxvector</em></code> to <code><em>fixnum</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([v (fxvector 1 2 3 4 5)])
  (fxvector-set! v 2 (fx- (fxvector-ref v 2)))
  v) ⇒ #vfx(1 2 -3 4 5)</code></pre>
</div>
</div>
<div id="objects:s48" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxvector-fill! <em>fxvector</em> <em>fixnum</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>fxvector</em></code> must be mutable. <code>fxvector-fill!</code> replaces each element of <code><em>fxvector</em></code> with <code><em>fixnum</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([v (fxvector 1 2 3)])
  (fxvector-fill! v 0)
  v) ⇒ #vfx(0 0 0)</code></pre>
</div>
</div>
<div id="objects:s49" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxvector-&gt;list <em>fxvector</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of the elements of <code><em>fxvector</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fxvector->list (fxvector)) ⇒ ()
(fxvector->list #vfx(7 5 2)) ⇒ (7 5 2)

(let ([v #vfx(1 2 3 4 5)])
  (apply fx* (fxvector->list v))) ⇒ 120</code></pre>
</div>
</div>
<div id="objects:s50" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(list-&gt;fxvector <em>list</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>an fxvector of the elements of <code><em>list</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>list</em></code> must consist entirely of fixnums.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(list->fxvector '()) ⇒ #vfx()
(list->fxvector '(3 5 7)) ⇒ #vfx(3 5 7)

(let ([v #vfx(1 2 3 4 5)])
  (let ([ls (fxvector->list v)])
    (list->fxvector (map fx* ls ls)))) ⇒ #vfx(1 4 9 16 25)</code></pre>
</div>
</div>
<div id="objects:s51" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxvector-copy <em>fxvector</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a copy of <code><em>fxvector</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>fxvector-copy</code> creates a new fxvector with the same length and contents as <code><em>fxvector</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fxvector-copy #vfx(3 4 5)) ⇒ #vfx(3 4 5)

(let ([v #vfx(3 4 5)])
  (eq? v (fxvector-copy v))) ⇒ #f</code></pre>
</div>
</div>
<div id="objects:s52" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(mutable-fxvector? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a mutable fxvector, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(immutable-fxvector? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is an immutable fxvector, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(mutable-fxvector? (fxvector 1 2 3)) ⇒ #t
(mutable-fxvector? (fxvector->immutable-fxvector (fxvector 1 2 3))) ⇒ #f
(immutable-fxvector? (fxvector 1 2 3)) ⇒ #f
(immutable-fxvector? (fxvector->immutable-fxvector (fxvector 1 2 3))) ⇒ #t
(immutable-fxvector? (cons 3 4)) ⇒ #f</code></pre>
</div>
</div>
<div id="objects:s53" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxvector-&gt;immutable-fxvector <em>fxvector</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>either an immutable copy of <code><em>fxvector</em></code> or <code><em>fxvector</em></code> itself</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="objects:s55" class="paragraph">
<p>The result is <code><em>fxvector</em></code> itself if <code><em>fxvector</em></code> is immutable; otherwise, the result is an immutable fxvector with the same content as <code><em>fxvector</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define v (fxvector->immutable-fxvector (fxvector 1 2 3)))
(fxvector-set! v 0 0) ⇒ <em>exception: not mutable</em></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_7.7.">Section 7.7. Bytevectors</h3>
<div class="paragraph">
<p>As with vectors, <em>Chez Scheme</em> extends the syntax of bytevectors to allow the length of the vector to be specified between the <code>#</code> and open parenthesis, e.g., <code>#3vu8(1 105 73)</code>. If fewer elements are supplied in the syntax than the specified length, each element after the last printed element is the same as the last printed element. This extension is disabled in an input stream after <code>#!r6rs</code> has been seen by the reader, unless <code>#!chezscheme</code> has been seen more recently.</p>
</div>
<div class="paragraph">
<p><em>Chez Scheme</em> also extends the set of bytevector primitives, including primitives for loading and storing 3, 5, 6, and 7-byte quantities.</p>
</div>
<div class="paragraph">
<p>The length and indices of a bytevector in <em>Chez Scheme</em> are always fixnums.</p>
</div>
<div id="objects:s57" class="paragraph">
<p>All bytevectors are mutable by default, including constants. A program can create immutable bytevectors via <code>bytevector-&gt;immutable-bytevector</code>. Any attempt to modify an immutable bytevector causes an exception to be raised.</p>
</div>
<div id="objects:s59" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytevector <em>fill</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new bytevector containing <code><em>fill</em> ...</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each <code><em>fill</em></code> value must be an exact integer representing a signed or unsigned 8-bit value, i.e., a value in the range -128 to 255 inclusive. A negative fill value is treated as its two&#8217;s complement equivalent.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(bytevector) ⇒ #vu8()
(bytevector 1 3 5) ⇒ #vu8(1 3 5)
(bytevector -1 -3 -5) ⇒ #vu8(255 253 251)</code></pre>
</div>
</div>
<div id="objects:s60" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytevector-&gt;s8-list <em>bytevector</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new list of the 8-bit signed elements of <code><em>bytevector</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The values in the returned list are exact eight-bit signed integers, i.e., values in the range -128 to 127 inclusive. <code>bytevector-&gt;s8-list</code> is similar to the Revised<sup>6</sup> Report <code>bytevector-&gt;u8-list</code> except the values in the returned list are signed rather than unsigned.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(bytevector->s8-list (make-bytevector 0)) ⇒ ()
(bytevector->s8-list #vu8(1 127 128 255)) ⇒ (1 127 -128 -1)

(let ([v #vu8(1 2 3 255)])
  (apply * (bytevector->s8-list v))) ⇒ -6</code></pre>
</div>
</div>
<div id="objects:s61" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(s8-list-&gt;bytevector <em>list</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new bytevector of the elements of <code><em>list</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>list</em></code> must consist entirely of exact eight-bit signed integers, i.e., values in the range -128 to 127 inclusive. <code>s8-list-&gt;bytevector</code> is similar to the Revised<sup>6</sup> Report procedure <code>u8-list-&gt;bytevector</code>, except the elements of the input list are signed rather than unsigned.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(s8-list->bytevector '()) ⇒ #vu8()
(s8-list->bytevector '(1 127 -128 -1)) ⇒ #vu8(1 127 128 255)

(let ([v #vu8(1 2 3 4 5)])
  (let ([ls (bytevector->s8-list v)])
    (s8-list->bytevector (map - ls)))) ⇒ #vu8(255 254 253 252 251)</code></pre>
</div>
</div>
<div id="objects:s62" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytevector-truncate! <em>bytevector</em> <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code><em>bytevector</em></code> or the empty bytevector</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>bytevector</em></code> must be mutable. <code><em>n</em></code> must be an exact nonnegative fixnum not greater than the length of <code><em>bytevector</em></code>. If <code><em>n</em></code> is zero, <code>bytevector-truncate!</code> returns the empty bytevector. Otherwise, <code><em>bytevector-truncate!</em></code> destructively truncates <code><em>bytevector</em></code> to its first <code><em>n</em></code> bytes and returns <code><em>bytevector</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define bv (make-bytevector 7 19))
(bytevector-truncate! bv 0) ⇒ #vu8()
bv ⇒ #vu8(19 19 19 19 19 19 19)
(bytevector-truncate! bv 3) ⇒ #vu8(19 19 19)
bv ⇒ #vu8(19 19 19)</code></pre>
</div>
</div>
<div id="objects:s63" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytevector-u24-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the 24-bit unsigned integer at index <code><em>n</em></code> (zero-based) of <code><em>bytevector</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytevector-s24-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the 24-bit signed integer at index <code><em>n</em></code> (zero-based) of <code><em>bytevector</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytevector-u40-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the 40-bit unsigned integer at index <code><em>n</em></code> (zero-based) of <code><em>bytevector</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytevector-s40-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the 40-bit signed integer at index <code><em>n</em></code> (zero-based) of <code><em>bytevector</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytevector-u48-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the 48-bit unsigned integer at index <code><em>n</em></code> (zero-based) of <code><em>bytevector</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytevector-s48-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the 48-bit signed integer at index <code><em>n</em></code> (zero-based) of <code><em>bytevector</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytevector-u56-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the 56-bit unsigned integer at index <code><em>n</em></code> (zero-based) of <code><em>bytevector</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytevector-s56-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the 56-bit signed integer at index <code><em>n</em></code> (zero-based) of <code><em>bytevector</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>n</em></code> must be an exact nonnegative integer and indexes the starting byte of the value. The sum of <code><em>n</em></code> and the number of bytes occupied by the value (3 for 24-bit values, 5 for 40-bit values, 6 for 48-bit values, and 7 for 56-bit values) must not exceed the length of <code><em>bytevector</em></code>. <code><em>eness</em></code> must be a valid endianness symbol naming the endianness.</p>
</div>
<div class="paragraph">
<p>The return value is an exact integer in the appropriate range for the number of bytes occupied by the value. Signed values are the equivalent of the stored value treated as a two&#8217;s complement value.</p>
</div>
<div id="objects:s64" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytevector-u24-set! <em>bytevector</em> <em>n</em> <em>u24</em> <em>eness</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytevector-s24-set! <em>bytevector</em> <em>n</em> <em>s24</em> <em>eness</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytevector-u40-set! <em>bytevector</em> <em>n</em> <em>u40</em> <em>eness</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytevector-s40-set! <em>bytevector</em> <em>n</em> <em>s40</em> <em>eness</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytevector-u48-set! <em>bytevector</em> <em>n</em> <em>u48</em> <em>eness</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytevector-s48-set! <em>bytevector</em> <em>n</em> <em>s48</em> <em>eness</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytevector-u56-set! <em>bytevector</em> <em>n</em> <em>u56</em> <em>eness</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytevector-s56-set! <em>bytevector</em> <em>n</em> <em>s56</em> <em>eness</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>bytevector</em></code> must be mutable. <code><em>n</em></code> must be an exact nonnegative integer and indexes the starting byte of the value. The sum of <code><em>n</em></code> and the number of bytes occupied by the value must not exceed the length of <code><em>bytevector</em></code>. <code><em>u24</em></code> must be a 24-bit unsigned value, i.e., a value in the range 0 to 2<sup>24</sup> - 1 inclusive; <code><em>s24</em></code> must be a 24-bit signed value, i.e., a value in the range -2<sup>23</sup> to 2<sup>23</sup> - 1 inclusive; <code><em>u40</em></code> must be a 40-bit unsigned value, i.e., a value in the range 0 to 2<sup>40</sup> - 1 inclusive; <code><em>s40</em></code> must be a 40-bit signed value, i.e., a value in the range -2<sup>39</sup> to 2<sup>39</sup> - 1 inclusive; <code><em>u48</em></code> must be a 48-bit unsigned value, i.e., a value in the range 0 to 2<sup>48</sup> - 1 inclusive; <code><em>s48</em></code> must be a 48-bit signed value, i.e., a value in the range -2<sup>47</sup> to 2<sup>47</sup> - 1 inclusive; <code><em>u56</em></code> must be a 56-bit unsigned value, i.e., a value in the range 0 to 2<sup>56</sup> - 1 inclusive; and <code><em>s56</em></code> must be a 56-bit signed value, i.e., a value in the range -2<sup>55</sup> to 2<sup>55</sup> - 1 inclusive. <code><em>eness</em></code> must be a valid endianness symbol naming the endianness.</p>
</div>
<div class="paragraph">
<p>These procedures store the given value in the 3, 5, 6, or 7 bytes starting at index <code><em>n</em></code> (zero-based) of <code><em>bytevector</em></code>. Negative values are stored as their two&#8217;s complement equivalent.</p>
</div>
<div id="objects:s65" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(mutable-bytevector? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a mutable bytevector, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(immutable-bytevector? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is an immutable bytevector, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(mutable-bytevector? (bytevector 1 2 3)) ⇒ #t
(mutable-bytevector?
  (bytevector->immutable-bytevector (bytevector 1 2 3))) ⇒ #f
(immutable-bytevector? (bytevector 1 2 3)) ⇒ #f
(immutable-bytevector?
  (bytevector->immutable-bytevector (bytevector 1 2 3))) ⇒ #t
(immutable-bytevector? (cons 3 4)) ⇒ #f</code></pre>
</div>
</div>
<div id="objects:s66" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytevector-&gt;immutable-bytevector <em>bytevector</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>an immutable bytevector equal to <code><em>bytevector</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="objects:s68" class="paragraph">
<p>The result is <code><em>bytevector</em></code> itself if <code><em>bytevector</em></code> is immutable; otherwise, the result is an immutable bytevector with the same content as <code><em>bytevector</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define bv (bytevector->immutable-bytevector (bytevector 1 2 3)))
(bytevector-u8-set! bv 0 0) ⇒ <em>exception: not mutable</em></code></pre>
</div>
</div>
<div id="objects:s69" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytevector-compress <em>bytevector</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new bytevector containing compressed content of <code><em>bytevector</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The result is the raw compressed data with a minimal header to record the uncompressed size and the compression mode. The result does not include the header that is written by port-based compression using the <code>compressed</code> option. The compression format is determined by the <code>compress-format</code> parameter, and the compression level is determined by the <code>compress-level</code> parameter.</p>
</div>
<div id="objects:s72" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytevector-uncompress <em>bytevector</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a bytevector containing uncompressed content of <code><em>bytevector</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Uncompresses a <code><em>bytevector</em></code> produced by <code>bytevector-compress</code> to a new bytevector with the same content as the original given to <code>bytevector-compress</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_7.8.">Section 7.8. Boxes</h3>
<div class="paragraph">
<p>Boxes are single-cell objects that are primarily useful for providing an "extra level of indirection." This extra level of indirection is typically used to allow more than one body of code or data structure to share a reference, or pointer, to an object. For example, boxes may be used to implement <em>call-by-reference</em> semantics in an interpreter for a language employing this parameter passing discipline.</p>
</div>
<div class="paragraph">
<p>Boxes are written with the prefix <code>#&amp;</code> (pronounced "hash-ampersand"). For example, <code>#&amp;(a b c)</code> is a box holding the list <code>(a b c)</code>. The box syntax is disabled in an input stream after <code>#!r6rs</code> has been seen by the reader, unless <code>#!chezscheme</code> has been seen more recently.</p>
</div>
<div id="objects:s79" class="paragraph">
<p>All boxes are mutable by default, including constants. A program can create immutable boxes via <code>box-immutable</code>. Any attempt to modify an immutable box causes an exception to be raised.</p>
</div>
<div id="objects:s81" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(box? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a box, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(box? '#&a) ⇒ #t
(box? 'a) ⇒ #f
(box? (box 3)) ⇒ #t</code></pre>
</div>
</div>
<div id="objects:s82" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(box <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new box containing <code><em>obj</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(box 'a) ⇒ #&a
(box (box '(a b c))) ⇒ #&#&(a b c)</code></pre>
</div>
</div>
<div id="objects:s83" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(unbox <em>box</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>contents of <code><em>box</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(unbox #&a) ⇒ a
(unbox #&#&(a b c)) ⇒ #&(a b c)

(let ([b (box "hi")])
  (unbox b)) ⇒ "hi"</code></pre>
</div>
</div>
<div id="objects:s84" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-box! <em>box</em> <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>box</em></code> must be mutable. <code>set-box!</code> sets the contents of <code><em>box</em></code> to <code><em>obj</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([b (box 'x)])
  (set-box! b 'y)
  b) ⇒ #&y

(let ([incr!
       (lambda (x)
         (set-box! x (+ (unbox x) 1)))])
  (let ([b (box 3)])
    (incr! b)
    (unbox b))) ⇒ 4</code></pre>
</div>
</div>
<div id="objects:s85" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(box-cas! <em>box</em> <em>old-obj</em> <em>new-obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>box</em></code> is changed, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>box</em></code> must be mutable. <code>box-cas!</code> atomically changes the content of <code><em>box</em></code> to <code><em>new-obj</em></code> if the replaced content is <code>eq?</code> to <code><em>old-obj</em></code>. If the content of <code><em>box</em></code> that would be replaced is not <code>eq?</code> to <code><em>old-obj</em></code>, then <code><em>box</em></code> is unchanged.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define b (box 'old))
(box-cas! b 'old 'new) ⇒ #t
(unbox b) ⇒ 'new
(box-cas! b 'other 'wrong) ⇒ #f
(unbox b) ⇒ 'new</code></pre>
</div>
</div>
<div id="objects:s86" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(mutable-box? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a mutable box, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(immutable-box? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is an immutable box, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(mutable-box? (box 1)) ⇒ #t
(mutable-box? (box-immutable 1)) ⇒ #f
(immutable-box? (box 1)) ⇒ #f
(immutable-box? (box-immutable 1)) ⇒ #t
(mutable-box? (cons 3 4)) ⇒ #f</code></pre>
</div>
</div>
<div id="objects:s87" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(box-immutable <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new immutable box containing <code><em>obj</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="objects:s89" class="paragraph">
<p>Boxes are typically intended to support shared, mutable structure, so immutable boxes are not often useful.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define b (box-immutable 1))
(set-box! b 0) ⇒ <em>exception: not mutable</em></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_7.9.">Section 7.9. Symbols</h3>
<div class="paragraph">
<p><em>Chez Scheme</em> extends the standard symbol syntax in several ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Symbol names may begin with <code>@</code>, but <code>,@abc</code> is parsed as <code>(unquote-splicing abc)</code>; to produce <code>(unquote @abc)</code> one can type <code>, @abc</code>, <code>, \x40;abc</code>, or <code>,|@abc|</code>.</p>
</li>
<li>
<p>The single-character sequences <code>{</code> and <code>}</code> are read as symbols.</p>
</li>
<li>
<p>A symbol&#8217;s name may begin with any character that might normally start a number, including a digit, <code>.</code>, <code>+</code>, <code>-</code>, as long as the delimited sequence of characters starting with that character cannot be parsed as a number.</p>
</li>
<li>
<p>A symbol whose name contains arbitrary characters may be written by escaping them with <code>\</code> or with <code>|</code>. <code>\</code> is used to escape a single character (except 'x', since <code>\x</code> marks the start of a hex scalar value), whereas <code>|</code> is used to escape the group of characters that follow it up through the matching <code>|</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The printer always prints symbols using the standard R6RS syntax, so that, e.g., <code>@abc</code> prints as <code>\x40;abc</code> and <code>1-</code> prints as <code>\x31;-</code>.</p>
</div>
<div class="paragraph">
<p>Gensyms are printed <code>#{</code> and <code>}</code> brackets that enclose both the "pretty" and "unique" names, e.g., <code>#{g1426 e5g1c94g642dssw-a}</code>. They may also be printed using the pretty name only with the prefix <code>#:</code>, e.g., <code>#:g1426</code>.</p>
</div>
<div class="paragraph">
<p>These extensions are disabled in an input stream after <code>#!r6rs</code> has been seen by the reader, unless <code>#!chezscheme</code> has been seen more recently. <a id="objects:s92"></a></p>
</div>
<div id="desc:gensym" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(gensym)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(gensym <em>pretty-name</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(gensym <em>pretty-name</em> <em>unique-name</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a unique generated symbol</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="objects:s94" class="paragraph">
<p>Each call to <code>gensym</code> returns a unique generated symbol, or <em>gensym</em>. Each generated symbol has two names: a "pretty" name and a "unique" name.</p>
</div>
<div class="paragraph">
<p>In the first form above, the pretty name is formed (lazily---see below) by combining an internal prefix with the value of an internal counter. After each name is formed, the internal counter is incremented. The parameters <code>gensym-prefix</code> and <code>gensym-count</code>, described below, may be used to access and set the internal prefix and counter. By default, the prefix is the single-character string <code>"g"</code>. In the second and third forms, the pretty name of the new gensym is <code><em>pretty-name</em></code>, which must be a string. The pretty name of a gensym is returned by the procedure <code>symbol-&gt;string</code>.</p>
</div>
<div class="paragraph">
<p>In both the first and second forms, the unique name is an automatically generated globally unique name. Globally unique names are constructed (lazily---see below) from the combination of a universally unique identifier and an internal counter. In the third form of gensym, the unique name of the new gensym is <code><em>unique-name</em></code>, which must be a string. The unique name of a gensym may be obtained via the procedure <code>gensym-&gt;unique-string</code>.</p>
</div>
<div class="paragraph">
<p>The unique name allows gensyms to be written in such a way that they can be read back and reliably commonized on input. The syntax for gensyms includes both the pretty name and the unique name, as shown in the example below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(gensym) ⇒ #{g0 bcsfg5eq4e9b3h9o-a}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the parameter <code>print-gensym</code> is set to <code>pretty</code>, the printer prints the pretty name only, with a <code>#:</code> syntax, so</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(parameterize ([print-gensym 'pretty])
  (write (gensym)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>prints <code>#:g0</code>.</p>
</div>
<div class="paragraph">
<p>When the reader sees the <code>#:</code> syntax, it produces a gensym with the given pretty name, but the original unique name is lost.</p>
</div>
<div class="paragraph">
<p>When the parameter is set to <code>#f</code>, the printer prints just the pretty name, so</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(parameterize ([print-gensym #f])
  (write (gensym)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>prints <code>g0</code>. This is useful only when gensyms do not need to be read back in as gensyms.</p>
</div>
<div class="paragraph">
<p>In order to reduce construction and (when threaded) synchronization overhead when gensyms are frequently created but rarely printed or stored in an object file, generated pretty and unique names are created lazily, i.e., not until first requested, either by the printer, fasl writer, or explicitly by one of the procedures <code>symbol-&gt;string</code> or <code>gensym-&gt;unique-string</code>. In addition, a gensym is not placed into the system&#8217;s internal symbol table (the oblist; see <a href="#desc:oblist">page 156</a>) until the unique name is requested. This allows a gensym to be reclaimed by the storage manager if no references to the gensym exist and no unique name exists by which to access it, even if it has a top-level binding or a nonempty property list.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define x (gensym))
x                         ⇒ #{g2 bcsfg5eq4e9b3h9o-c}
(symbol->string x)        ⇒ "g2"
(gensym->unique-string x) ⇒ "bcsfg5eq4e9b3h9o-c"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Gensyms subsume the notion of <em>uninterned symbols</em> supported by earlier versions of <em>Chez Scheme</em>. Similarly, the predicate <code>uninterned-symbol?</code> has been replaced by <code>gensym?</code>.</p>
</div>
<div id="objects:s100" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>gensym-prefix</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>gensym-count</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="objects:s101" class="paragraph">
<p>The parameters <code>gensym-prefix</code> and <code>gensym-count</code> are used to access and set the internal prefix and counter from which the pretty name of a gensym is generated when <code>gensym</code> is not given an explicit string argument. <code>gensym-prefix</code> defaults to the string <code>"g"</code> and may be set to any object. <code>gensym-count</code> starts at 0 and may be set to any nonnegative integer.</p>
</div>
<div class="paragraph">
<p>As described above, <em>Chez Scheme</em> delays the creation of the pretty name until the name is first requested by the printer or by an explicit call to <code>symbol-&gt;string</code>. These parameters are not consulted until that time; setting them when <code>gensym</code> is called thus has no effect on the generated name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([x (parameterize ([gensym-prefix "genny"]
                        [gensym-count 17]
                        [print-gensym 'pretty])
           (gensym))])
  (format "~s" x))                       ⇒ "#{g4 bcsfg5eq4e9b3h9o-e}"
(let ([x (gensym)])
  (parameterize ([gensym-prefix "genny"]
                 [gensym-count 17]
                 [print-gensym #f])
    (format "~s" (gensym))))             ⇒ "genny17"</code></pre>
</div>
</div>
<div id="objects:s102" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(gensym-&gt;unique-string <em>gensym</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the unique name of <code><em>gensym</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(gensym->unique-string (gensym)) ⇒ "bd3kufa7ypjcuvut-g"</code></pre>
</div>
</div>
<div id="objects:s103" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(gensym? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is gensym, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(gensym? (string->symbol "z")) ⇒ #f
(gensym? (gensym "z")) ⇒ #t
(gensym? 'a) ⇒ #f
(gensym? 3) ⇒ #f
(gensym? (gensym)) ⇒ #t
(gensym? '#{g2 bcsfg5eq4e9b3h9o-c}) ⇒ #t</code></pre>
</div>
</div>
<div id="property-lists" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(putprop <em>symbol</em> <em>key</em> <em>value</em>)</code> <a id="objects:s104"></a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Chez Scheme</em> associates a <em>property list</em> with each symbol, allowing multiple <code><em>key-value</em></code> pairs to be stored directly with the symbol. New key-value pairs may be placed in the property list or retrieved in a manner analogous to the use of association lists, using the procedures <code>putprop</code> and <code>getprop</code>. Property lists are often used to store information related to the symbol itself. For example, a natural language program might use symbols to represent words, using their property lists to store information about use and meaning.</p>
</div>
<div class="paragraph">
<p><code>putprop</code> associates <code><em>value</em></code> with <code><em>key</em></code> on the property list of <code><em>symbol</em></code>. <code><em>key</em></code> and <code><em>value</em></code> may be any types of object, although <code><em>key</em></code> is typically a symbol.</p>
</div>
<div class="paragraph">
<p><code>putprop</code> may be used to establish a new property or to change an existing property.</p>
</div>
<div class="paragraph">
<p>See the examples under <code>getprop</code> below.</p>
</div>
<div id="objects:s106" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(getprop <em>symbol</em> <em>key</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(getprop <em>symbol</em> <em>key</em> <em>default</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the value associated with <code><em>key</em></code> on the property list of <code><em>symbol</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="objects:s107" class="paragraph">
<p><code>getprop</code> searches the property list of <code><em>symbol</em></code> for a key identical to <code><em>key</em></code> (in the sense of <code>eq?</code>), and returns the value associated with this key, if any. If no value is associated with <code><em>key</em></code> on the property list of <code><em>symbol</em></code>, <code>getprop</code> returns <code><em>default</em></code>, or <code>#f</code> if the <code><em>default</em></code> argument is not supplied.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(putprop 'fred 'species 'snurd)
(putprop 'fred 'age 4)
(putprop 'fred 'colors '(black white))

(getprop 'fred 'species) ⇒ snurd
(getprop 'fred 'colors) ⇒ (black white)
(getprop 'fred 'nonkey) ⇒ #f
(getprop 'fred 'nonkey 'unknown) ⇒ unknown

(putprop 'fred 'species #f)
(getprop 'fred 'species 'unknown) ⇒ #f</code></pre>
</div>
</div>
<div id="objects:s108" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(remprop <em>symbol</em> <em>key</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>remprop</code> removes the property with key <code><em>key</em></code> from the property list of <code><em>symbol</em></code>, if such a property exists.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(putprop 'fred 'species 'snurd)
(getprop 'fred 'species) ⇒ snurd

(remprop 'fred 'species)
(getprop 'fred 'species 'unknown) ⇒ unknown</code></pre>
</div>
</div>
<div id="objects:s110" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(property-list <em>symbol</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a copy of the internal property list for <code><em>symbol</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A property list is a list of alternating keys and values, i.e., <code>(<em>key</em> <em>value</em> ...)</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(putprop 'fred 'species 'snurd)
(putprop 'fred 'colors '(black white))
(property-list 'fred) ⇒ (colors (black white) species snurd)</code></pre>
</div>
</div>
<div id="desc:oblist" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(oblist)</code> <a id="objects:s111"></a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of interned symbols</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The system maintains an internal symbol table used to insure that any two occurrences of the same symbol name resolve to the same symbol object. The <code>oblist</code> procedure returns a list of the symbols currently in this symbol table.</p>
</div>
<div class="paragraph">
<p>The list of interned symbols grows when a new symbol is introduced into the system or when the unique name of a gensym (see <a href="#desc:gensym">page 152</a>) is requested. It shrinks when the garbage collector determines that it is safe to discard a symbol. It is safe to discard a symbol only if the symbol is not accessible except through the oblist, has no top-level binding, and has no properties on its property list.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(if (memq 'tiger (oblist)) 'yes 'no) ⇒ yes
(equal? (oblist) (oblist)) ⇒ #t
(= (length (oblist)) (length (oblist))) ⇒ #t <em>or</em> #f</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first example above follows from the property that all interned symbols are in the oblist from the time they are read, which happens prior to evaluation. The second example follows from the fact that no symbols can be removed from the oblist while references to those symbols exist, in this case, within the list returned by the first call to <code>oblist</code> (whichever call is performed first). The expression in the third example can return <code>#f</code> only if a garbage collection occurs sometime between the two calls to <code>oblist</code>, and only if one or more symbols are removed from the oblist by that collection.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_7.10.">Section 7.10. Void</h3>
<div class="paragraph">
<p>Many Scheme operations return an unspecified result. <em>Chez Scheme</em> typically returns a special <em>void</em> object when the value returned by an operation is unspecified. The <em>Chez Scheme</em> void object is not meant to be used as a datum, and consequently does not have a reader syntax. As for other objects without a reader syntax, such as procedures and ports, <em>Chez Scheme</em> output procedures print the void object using a nonreadable representation, i.e., <code>#&lt;void&gt;</code>. Since the void object should be returned only by operations that do not have "interesting" values, the default waiter printer (see <code>waiter-write</code>) suppresses the printing of the void object. <code>set!</code>, <code>set-car!</code>, <code>load</code>, and <code>write</code> are examples of <em>Chez Scheme</em> operations that return the void object.</p>
</div>
<div id="objects:s112" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(void)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the void object</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>void</code> is a procedure of no arguments that returns the void object. It can be used to force expressions that are used for effect or whose values are otherwise unspecified to evaluate to a consistent, trivial value. Since most <em>Chez Scheme</em> operations that are used for effect return the void object, however, it is rarely necessary to explicitly invoke the <code>void</code> procedure.</p>
</div>
<div class="paragraph">
<p>Since the void object is used explicitly as an "unspecified" value, it is a bad idea to use it for any other purpose or to count on any given expression evaluating to the void object.</p>
</div>
<div class="paragraph">
<p>The default waiter printer suppresses the void object; that is, nothing is printed for expressions that evaluate to the void object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(eq? (void) #f) ⇒ #f
(eq? (void) #t) ⇒ #f
(eq? (void) '()) ⇒ #f</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_7.11.">Section 7.11. Sorting</h3>
<div id="objects:s113" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(sort <em>predicate</em> <em>list</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(sort! <em>predicate</em> <em>list</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list containing the elements of <code><em>list</em></code> sorted according to <code><em>predicate</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>sort</code> is identical to the Revised<sup>6</sup> Report <code>list-sort</code>, and <code>sort!</code> is a destructive version of <code>sort</code>, i.e., it reuses pairs from the input list to form the output list.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(sort < '(3 4 2 1 2 5)) ⇒ (1 2 2 3 4 5)
(sort! < '(3 4 2 1 2 5)) ⇒ (1 2 2 3 4 5)</code></pre>
</div>
</div>
<div id="objects:s114" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(merge <em>predicate</em> <em>list<sub>1</sub></em> <em>list<sub>2</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(merge! <em>predicate</em> <em>list<sub>1</sub></em> <em>list<sub>2</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code><em>list<sub>1</sub></em></code> merged with <code><em>list<sub>2</sub></em></code> in the order specified by <code><em>predicate</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>predicate</em></code> should be a procedure that expects two arguments and returns <code>#t</code> if its first argument must precede its second in the merged list. It should not have any side effects. That is, if <code><em>predicate</em></code> is applied to two objects <code><em>x</em></code> and <code><em>y</em></code>, where <code><em>x</em></code> is taken from the second list and <code><em>y</em></code> is taken from the first list, it should return true only if <code><em>x</em></code> should appear before <code><em>y</em></code> in the output list. If this constraint is met, <code>merge</code> and <code>merge!</code> are stable, in that items from <code><em>list<sub>1</sub></em></code> are placed in front of equivalent items from <code><em>list<sub>2</sub></em></code> in the output list. Duplicate elements are included in the merged list.</p>
</div>
<div class="paragraph">
<p><code>merge!</code> combines the lists destructively, using pairs from the input lists to form the output list.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(merge char&lt;?
       '(#\a #\c)
       '(#\b #\c #\d)) ⇒ (#\a #\b #\c #\c #\d)
(merge <
       '(1/2 2/3 3/4)
       '(0.5 0.6 0.7)) ⇒ (1/2 0.5 0.6 2/3 0.7 3/4)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_7.12.">Section 7.12. Hashtables</h3>
<div class="paragraph">
<p><em>Chez Scheme</em> provides several extensions to the hashtable mechanism, including a mechanism for directly accessing a key, value pair in a hashtable, support for weak eq and eqv hashtables, and a set of procedures specialized to eq and symbol hashtables.</p>
</div>
<div id="objects:s115" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(hashtable-cell <em>hashtable</em> <em>key</em> <em>default</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a pair (see below)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>hashtable</em></code> must be a hashtable. <code><em>key</em></code> and <code><em>default</em></code> may be any Scheme values.</p>
</div>
<div class="paragraph">
<p>If no value is associated with <code><em>key</em></code> in <code><em>hashtable</em></code>, <code>hashtable-cell</code> modifies <code><em>hashtable</em></code> to associate <code><em>key</em></code> with <code><em>default</em></code>. It returns a pair whose car is <code><em>key</em></code> and whose cdr is the associated value. Changing the cdr of this pair effectively updates the table to associate <code><em>key</em></code> with a new value. The <code><em>key</em></code> in the car field should not be changed. The advantage of this procedure over the Revised<sup>6</sup> Report procedures for manipulating hashtable entries is that the value associated with a key may be read or written many times with only a single hashtable lookup.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ht (make-eq-hashtable))
(define v (vector 'a 'b 'c))
(define cell (hashtable-cell ht v 3))
cell ⇒ (#(a b c) . 3)
(hashtable-ref ht v 0) ⇒ 3
(set-cdr! cell 4)
(hashtable-ref ht v 0) ⇒ 4</code></pre>
</div>
</div>
<div id="objects:s116" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(hashtable-keys <em>hashtable</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(hashtable-keys <em>hashtable</em> <em>size</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a vector containing the keys in <code><em>hashtable</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Identitcal to the Revised<sup>6</sup> Report counterpart, but allowing an optional <code><em>size</em></code> argument. If <code><em>size</em></code> is specified, then it must be an exact, nonnegative integer, and the result vector contains no more than <code><em>size</em></code> elements. Different calls to <code>hashtable-keys</code> with a <code><em>size</em></code> less than <code>(hashtable-size <em>hashtable</em>)</code> may return different subsets of <code><em>hashtable</em></code>'s keys.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ht (make-eq-hashtable))
(hashtable-set! ht 'a "one")
(hashtable-set! ht 'b "two")
(hashtable-set! ht 'c "three")
(hashtable-keys ht) ⇒ #(a b c) <em>or any permutation</em>
(hashtable-keys ht 1) ⇒ #(a) <em>or</em> #(b) <em>or</em> #(c)</code></pre>
</div>
</div>
<div id="objects:s117" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(hashtable-values <em>hashtable</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(hashtable-values <em>hashtable</em> <em>size</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a vector containing the values in <code><em>hashtable</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each value is the value of one of the keys in <code><em>hashtable</em></code>. Duplicate values are not removed. The values may appear in any order in the returned vector. If <code><em>size</em></code> is specified, then it must be an exact, nonnegative integer, and the result vector contains no more than <code><em>size</em></code> elements. Different calls to <code>hashtable-values</code> with a <code><em>size</em></code> less than <code>(hashtable-size <em>hashtable</em>)</code> may return different subsets of <code><em>hashtable</em></code>'s values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ht (make-eq-hashtable))
(define p1 (cons 'a 'b))
(define p2 (cons 'a 'b))
(hashtable-set! ht p1 "one")
(hashtable-set! ht p2 "two")
(hashtable-set! ht 'q "two")
(hashtable-values ht) ⇒ #("one" "two" "two") <em>or any permutation</em>
(hashtable-values ht 1) ⇒ #("one") <em>or</em> #("two")</code></pre>
</div>
</div>
<div class="paragraph">
<p>This procedure is equivalent to calling <code>hashtable-entries</code> and returning only the second result, but it is more efficient since the separate vector of keys need not be created.</p>
</div>
<div id="objects:s118" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(hashtable-entries <em>hashtable</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(hashtable-entries <em>hashtable</em> <em>size</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>two vectors containing the keys and values in <code><em>hashtable</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Identitcal to the Revised<sup>6</sup> Report counterpart, but allowing an optional <code><em>size</em></code> argument. If <code><em>size</em></code> is specified, then it must be an exact, nonnegative integer, and the result vectors contain no more than <code><em>size</em></code> elements. Different calls to <code>hashtable-entries</code> with a <code><em>size</em></code> less than <code>(hashtable-size <em>hashtable</em>)</code> may return different subsets of <code><em>hashtable</em></code>'s entries.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ht (make-eq-hashtable))
(hashtable-set! ht 'a "one")
(hashtable-set! ht 'b "two")
(hashtable-entries ht) ⇒ #(a b) #("one" "two") <em>or the other permutation</em>
(hashtable-entries ht 1) ⇒ #(a) #("one") <em>or</em> #(b) #("two")</code></pre>
</div>
</div>
<div id="objects:s119" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(hashtable-cells <em>hashtable</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(hashtable-cells <em>hashtable</em> <em>size</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a vector of up to <code><em>size</em></code> elements containing the cells of <code><em>hashtable</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each element of the result vector is the value of one of the cells in <code><em>hashtable</em></code>. The cells may appear in any order in the returned vector. If <code><em>size</em></code> is specified, then it must be an exact, nonnegative integer, and the result vector contains no more than <code><em>size</em></code> cells. If <code><em>size</em></code> is not specified, then the result vector has <code>(hashtable-size <em>hashtable</em>)</code> elements. Different calls to <code>hashtable-cells</code> with a <code><em>size</em></code> less than <code>(hashtable-size <em>hashtable</em>)</code> may return different subsets of <code><em>hashtable</em></code>'s cells.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ht (make-eqv-hashtable))
(hashtable-set! ht 1 'one)
(hashtable-set! ht 2 'two)
(hashtable-cells ht) ⇒ #((1 . one) (2 . two)) <em>or</em> #((2 . two) (1 . one))
(hashtable-cells ht 1) ⇒ #((1 . one)) <em>or</em> #((2 . two))
(hashtable-cells ht 0) ⇒ #()</code></pre>
</div>
</div>
<div id="objects:s120" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-weak-eq-hashtable)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-weak-eq-hashtable <em>size</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-weak-eqv-hashtable)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-weak-eqv-hashtable <em>size</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new weak eq hashtable</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These procedures are like the Revised<sup>6</sup> Report procedures <code>make-eq-hashtable</code> and <code>make-eqv-hashtable</code> except the keys of the hashtable are held weakly, i.e., they are not protected from the garbage collector. Keys reclaimed by the garbage collector are removed from the table, and their associated values are dropped the next time the table is modified, if not sooner.</p>
</div>
<div class="paragraph">
<p>Values in the hashtable are referenced normally as long as the key is not reclaimed, since keys are paired values using weak pairs. Consequently, if a value in the hashtable refers to its own key, then garbage collection is prevented from reclaiming the key. See <code>make-ephemeron-eq-hashtable</code> and <code>make-ephemeron-eqv-hashtable</code>.</p>
</div>
<div class="paragraph">
<p>A copy of a weak eq or eqv hashtable created by <code>hashtable-copy</code> is also weak. If the copy is immutable, inaccessible keys may still be dropped from the hashtable, even though the contents of the table is otherwise unchanging. The effect of this can be observed via <code>hashtable-keys</code> and <code>hashtable-entries</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ht1 (make-weak-eq-hashtable))
(define ht2 (make-weak-eq-hashtable 32))</code></pre>
</div>
</div>
<div id="objects:s121" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-ephemeron-eq-hashtable)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-ephemeron-eq-hashtable <em>size</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-ephemeron-eqv-hashtable)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-ephemeron-eqv-hashtable <em>size</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new ephemeron eq hashtable</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These procedures are like <code>make-weak-eq-hashtable</code> and <code>make-weak-eqv-hashtable</code>, but a value in the hashtable can refer to a key in the hashtable (directly or indirectly) without preventing garbage collection from reclaiming the key, because keys are paired with values using ephemeron pairs.</p>
</div>
<div class="paragraph">
<p>A copy of an ephemeron eq or eqv hashtable created by <code>hashtable-copy</code> is also an ephemeron table, and an inaccesible key can be dropped from an immutable ephemeron hashtable in the same way as for an immutable weak hashtable.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ht1 (make-ephemeron-eq-hashtable))
(define ht2 (make-ephemeron-eq-hashtable 32))</code></pre>
</div>
</div>
<div id="objects:s122" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(hashtable-weak? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a weak eq or eqv hashtable, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ht1 (make-weak-eq-hashtable))
(define ht2 (hashtable-copy ht1))
(hashtable-weak? ht2) ⇒ #t</code></pre>
</div>
</div>
<div id="objects:s123" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(hashtable-ephemeron? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is an ephemeron eq or eqv hashtable, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ht1 (make-ephemeron-eq-hashtable))
(define ht2 (hashtable-copy ht1))
(hashtable-ephemeron? ht2) ⇒ #t</code></pre>
</div>
</div>
<div id="objects:s124" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(eq-hashtable? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is an eq hashtable, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(eq-hashtable? (make-eq-hashtable)) ⇒ #t
(eq-hashtable? '(not a hash table)) ⇒ #f</code></pre>
</div>
</div>
<div id="objects:s125" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(eq-hashtable-weak? <em>hashtable</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>hashtable</em></code> is weak, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>hashtable</em></code> must be an eq hashtable.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(eq-hashtable-weak? (make-eq-hashtable)) ⇒ #f
(eq-hashtable-weak? (make-weak-eq-hashtable)) ⇒ #t</code></pre>
</div>
</div>
<div id="objects:s126" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(eq-hashtable-ephemeron? <em>hashtable</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>hashtable</em></code> uses ephemeron pairs, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>hashtable</em></code> must be an eq hashtable.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(eq-hashtable-ephemeron? (make-eq-hashtable)) ⇒ #f
(eq-hashtable-ephemeron? (make-ephemeron-eq-hashtable)) ⇒ #t</code></pre>
</div>
</div>
<div id="objects:s127" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(eq-hashtable-set! <em>hashtable</em> <em>key</em> <em>value</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>hashtable</em></code> must be a mutable eq hashtable. <code><em>key</em></code> and <code><em>value</em></code> may be any Scheme values.</p>
</div>
<div class="paragraph">
<p><code>eq-hashtable-set!</code> associates the value <code><em>value</em></code> with the key <code><em>key</em></code> in <code><em>hashtable</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ht (make-eq-hashtable))
(eq-hashtable-set! ht 'a 73)</code></pre>
</div>
</div>
<div id="objects:s128" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(eq-hashtable-ref <em>hashtable</em> <em>key</em> <em>default</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>hashtable</em></code> must be an eq hashtable. <code><em>key</em></code> and <code><em>default</em></code> may be any Scheme values.</p>
</div>
<div class="paragraph">
<p><code>eq-hashtable-ref</code> returns the value associated with <code><em>key</em></code> in <code><em>hashtable</em></code>. If no value is associated with <code><em>key</em></code> in <code><em>hashtable</em></code>, <code>eq-hashtable-ref</code> returns <code><em>default</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ht (make-eq-hashtable))
(define p1 (cons 'a 'b))
(define p2 (cons 'a 'b))
(eq-hashtable-set! ht p1 73)
(eq-hashtable-ref ht p1 55) ⇒ 73
(eq-hashtable-ref ht p2 55) ⇒ 55</code></pre>
</div>
</div>
<div id="objects:s129" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(eq-hashtable-contains? <em>hashtable</em> <em>key</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if an association for <code><em>key</em></code> exists in <code><em>hashtable</em></code>, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>hashtable</em></code> must be an eq hashtable. <code><em>key</em></code> may be any Scheme value.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ht (make-eq-hashtable))
(define p1 (cons 'a 'b))
(define p2 (cons 'a 'b))
(eq-hashtable-set! ht p1 73)
(eq-hashtable-contains? ht p1) ⇒ #t
(eq-hashtable-contains? ht p2) ⇒ #f</code></pre>
</div>
</div>
<div id="objects:s130" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(eq-hashtable-update! <em>hashtable</em> <em>key</em> <em>procedure</em> <em>default</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>hashtable</em></code> must be a mutable eq hashtable. <code><em>key</em></code> and <code><em>default</em></code> may be any Scheme values. <code><em>procedure</em></code> should accept one argument, should return one value, and should not modify <code><em>hashtable</em></code>.</p>
</div>
<div class="paragraph">
<p><code>eq-hashtable-update!</code> applies <code><em>procedure</em></code> to the value associated with <code><em>key</em></code> in <code><em>hashtable</em></code>, or to <code><em>default</em></code> if no value is associated with <code><em>key</em></code> in <code><em>hashtable</em></code>. If <code><em>procedure</em></code> returns, <code>eq-hashtable-update!</code> associates <code><em>key</em></code> with the value returned by <code><em>procedure</em></code>, replacing the old association, if any.</p>
</div>
<div class="paragraph">
<p>A version of <code>eq-hashtable-update!</code> that does not verify that it receives arguments of the proper type might be defined as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define eq-hashtable-update!
  (lambda (ht key proc value)
    (eq-hashtable-set! ht key
      (proc (eq-hashtable-ref ht key value)))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>An implementation may, however, be able to implement <code>eq-hashtable-update!</code> more efficiently by avoiding multiple hash computations and hashtable lookups.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ht (make-eq-hashtable))
(eq-hashtable-update! ht 'a
  (lambda (x) (* x 2))
  55)
(eq-hashtable-ref ht 'a 0) ⇒ 110
(eq-hashtable-update! ht 'a
  (lambda (x) (* x 2))
  0)
(eq-hashtable-ref ht 'a 0) ⇒ 220</code></pre>
</div>
</div>
<div id="objects:s131" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(eq-hashtable-cell <em>hashtable</em> <em>key</em> <em>default</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a pair (see below)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>hashtable</em></code> must be an eq hashtable. <code><em>key</em></code> and <code><em>default</em></code> may be any Scheme values.</p>
</div>
<div class="paragraph">
<p>If no value is associated with <code><em>key</em></code> in <code><em>hashtable</em></code>, <code>eq-hashtable-cell</code> modifies <code><em>hashtable</em></code> to associate <code><em>key</em></code> with <code><em>default</em></code>. It returns a pair whose car is <code><em>key</em></code> and whose cdr is the associated value. Changing the cdr of this pair effectively updates the table to associate <code><em>key</em></code> with a new value. The <code><em>key</em></code> should not be changed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ht (make-eq-hashtable))
(define v (vector 'a 'b 'c))
(define cell (eq-hashtable-cell ht v 3))
cell ⇒ (#(a b c) . 3)
(eq-hashtable-ref ht v 0) ⇒ 3
(set-cdr! cell 4)
(eq-hashtable-ref ht v 0) ⇒ 4</code></pre>
</div>
</div>
<div id="objects:s132" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(eq-hashtable-delete! <em>hashtable</em> <em>key</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>hashtable</em></code> must be a mutable eq hashtable. <code><em>key</em></code> may be any Scheme value.</p>
</div>
<div class="paragraph">
<p><code>eq-hashtable-delete!</code> drops any association for <code><em>key</em></code> from <code><em>hashtable</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ht (make-eq-hashtable))
(define p1 (cons 'a 'b))
(define p2 (cons 'a 'b))
(eq-hashtable-set! ht p1 73)
(eq-hashtable-contains? ht p1) ⇒ #t
(eq-hashtable-delete! ht p1)
(eq-hashtable-contains? ht p1) ⇒ #f
(eq-hashtable-contains? ht p2) ⇒ #f
(eq-hashtable-delete! ht p2)</code></pre>
</div>
</div>
<div id="objects:s133" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(symbol-hashtable? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is an eq hashtable, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(symbol-hashtable? (make-hashtable symbol-hash eq?)) ⇒ #t
(symbol-hashtable? (make-eq-hashtable)) ⇒ #f</code></pre>
</div>
</div>
<div id="objects:s134" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(symbol-hashtable-set! <em>hashtable</em> <em>key</em> <em>value</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>hashtable</em></code> must be a mutable symbol hashtable. (A symbol hashtable is a hashtable created with hash function <code>symbol-hash</code> and equivalence function <code>eq?</code>, <code>eqv?</code>, <code>equal?</code>, or <code>symbol=?</code>.) <code><em>key</em></code> must be a symbol, and <code><em>value</em></code> may be any Scheme value.</p>
</div>
<div class="paragraph">
<p><code>symbol-hashtable-set!</code> associates the value <code><em>value</em></code> with the key <code><em>key</em></code> in <code><em>hashtable</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ht (make-hashtable symbol-hash eq?))
(symbol-hashtable-ref ht 'a #f) ⇒ #f
(symbol-hashtable-set! ht 'a 73)
(symbol-hashtable-ref ht 'a #f) ⇒ 73</code></pre>
</div>
</div>
<div id="objects:s135" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(symbol-hashtable-ref <em>hashtable</em> <em>key</em> <em>default</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>hashtable</em></code> must be a symbol hashtable. (A symbol hashtable is a hashtable created with hash function <code>symbol-hash</code> and equivalence function <code>eq?</code>, <code>eqv?</code>, <code>equal?</code>, or <code>symbol=?</code>.) <code><em>key</em></code> must be a symbol, and <code><em>default</em></code> may be any Scheme value.</p>
</div>
<div class="paragraph">
<p><code>symbol-hashtable-ref</code> returns the value associated with <code><em>key</em></code> in <code><em>hashtable</em></code>. If no value is associated with <code><em>key</em></code> in <code><em>hashtable</em></code>, <code>symbol-hashtable-ref</code> returns <code><em>default</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ht (make-hashtable symbol-hash eq?))
(define k1 'abcd)
(define k2 'not-abcd)
(symbol-hashtable-set! ht k1 "hi")
(symbol-hashtable-ref ht k1 "bye") ⇒ "hi"
(symbol-hashtable-ref ht k2 "bye") ⇒ "bye"</code></pre>
</div>
</div>
<div id="objects:s136" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(symbol-hashtable-contains? <em>hashtable</em> <em>key</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if an association for <code><em>key</em></code> exists in <code><em>hashtable</em></code>, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>hashtable</em></code> must be a symbol hashtable. (A symbol hashtable is a hashtable created with hash function <code>symbol-hash</code> and equivalence function <code>eq?</code>, <code>eqv?</code>, <code>equal?</code>, or <code>symbol=?</code>.) <code><em>key</em></code> must be a symbol.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ht (make-hashtable symbol-hash eq?))
(define k1 'abcd)
(define k2 'not-abcd)
(symbol-hashtable-set! ht k1 "hi")
(symbol-hashtable-contains? ht k1) ⇒ #t
(symbol-hashtable-contains? ht k2 ) ⇒ #f</code></pre>
</div>
</div>
<div id="objects:s137" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(symbol-hashtable-update! <em>hashtable</em> <em>key</em> <em>procedure</em> <em>default</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>hashtable</em></code> must be a mutable symbol hashtable. (A symbol hashtable is a hashtable created with hash function <code>symbol-hash</code> and equivalence function <code>eq?</code>, <code>eqv?</code>, <code>equal?</code>, or <code>symbol=?</code>.) <code><em>key</em></code> must be a symbol, and <code><em>default</em></code> may be any Scheme value. <code><em>procedure</em></code> should accept one argument, should return one value, and should not modify <code><em>hashtable</em></code>.</p>
</div>
<div class="paragraph">
<p><code>symbol-hashtable-update!</code> applies <code><em>procedure</em></code> to the value associated with <code><em>key</em></code> in <code><em>hashtable</em></code>, or to <code><em>default</em></code> if no value is associated with <code><em>key</em></code> in <code><em>hashtable</em></code>. If <code><em>procedure</em></code> returns, <code>symbol-hashtable-update!</code> associates <code><em>key</em></code> with the value returned by <code><em>procedure</em></code>, replacing the old association, if any.</p>
</div>
<div class="paragraph">
<p>A version of <code>symbol-hashtable-update!</code> that does not verify that it receives arguments of the proper type might be defined as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define symbol-hashtable-update!
  (lambda (ht key proc value)
    (symbol-hashtable-set! ht key
      (proc (symbol-hashtable-ref ht key value)))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>An implementation may, however, be able to implement <code>symbol-hashtable-update!</code> more efficiently by avoiding multiple hash computations and hashtable lookups.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ht (make-hashtable symbol-hash eq?))
(symbol-hashtable-update! ht 'a
  (lambda (x) (* x 2))
  55)
(symbol-hashtable-ref ht 'a 0) ⇒ 110
(symbol-hashtable-update! ht 'a
  (lambda (x) (* x 2))
  0)
(symbol-hashtable-ref ht 'a 0) ⇒ 220</code></pre>
</div>
</div>
<div id="objects:s138" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(symbol-hashtable-cell <em>hashtable</em> <em>key</em> <em>default</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a pair (see below)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>hashtable</em></code> must be a mutable symbol hashtable. (A symbol hashtable is a hashtable created with hash function <code>symbol-hash</code> and equivalence function <code>eq?</code>, <code>eqv?</code>, <code>equal?</code>, or <code>symbol=?</code>.) <code><em>key</em></code> must be a symbol, and <code><em>default</em></code> may be any Scheme value.</p>
</div>
<div class="paragraph">
<p>If no value is associated with <code><em>key</em></code> in <code><em>hashtable</em></code>, <code>symbol-hashtable-cell</code> modifies <code><em>hashtable</em></code> to associate <code><em>key</em></code> with <code><em>default</em></code>. It returns a pair whose car is <code><em>key</em></code> and whose cdr is the associated value. Changing the cdr of this pair effectively updates the table to associate <code><em>key</em></code> with a new value. The <code><em>key</em></code> should not be changed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ht (make-hashtable symbol-hash eq?))
(define k 'a-key)
(define cell (symbol-hashtable-cell ht k 3))
cell ⇒ (a-key . 3)
(symbol-hashtable-ref ht k 0) ⇒ 3
(set-cdr! cell 4)
(symbol-hashtable-ref ht k 0) ⇒ 4</code></pre>
</div>
</div>
<div id="objects:s139" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(symbol-hashtable-delete! <em>hashtable</em> <em>key</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>hashtable</em></code> must be a mutable symbol hashtable. (A symbol hashtable is a hashtable created with hash function <code>symbol-hash</code> and equivalence function <code>eq?</code>, <code>eqv?</code>, <code>equal?</code>, or <code>symbol=?</code>.) <code><em>key</em></code> must be a symbol.</p>
</div>
<div class="paragraph">
<p><code>symbol-hashtable-delete!</code> drops any association for <code><em>key</em></code> from <code><em>hashtable</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ht (make-hashtable symbol-hash eq?))
(define k1 (gensym))
(define k2 (gensym))
(symbol-hashtable-set! ht k1 73)
(symbol-hashtable-contains? ht k1) ⇒ #t
(symbol-hashtable-delete! ht k1)
(symbol-hashtable-contains? ht k1) ⇒ #f
(symbol-hashtable-contains? ht k2) ⇒ #f
(symbol-hashtable-delete! ht k2)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_7.13.">Section 7.13. Record Types</h3>
<div id="objects:s141" class="paragraph">
<p>Chez Scheme extends the Revised<sup>6</sup> Report&#8217;s <code>define-record-type</code> syntax in one way, which is that it allows a generative record type to be declared explicitly as such (in a double-negative sort of way) by including a <code>nongenerative</code> clause with <code>#f</code> as the uid, i.e.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(nongenerative #f)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This can be used in conjunction with the parameter <code>require-nongenerative-clause</code> to catch the accidental use of generative record types while avoiding spurious errors for record types that must be generative. Generative record types are rarely needed and are generally less efficient since a run-time representation of the type is created each time the <code>define-record-clause</code> is evaluated, rather than once at compile (expansion) time.</p>
</div>
<div id="objects:s142" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>require-nongenerative-clause</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This parameter holds a boolean value that determines whether <code>define-record-type</code> requires a nongenerative clause. The default value is <code>#f</code>. The lead-in above describes why one might want to set this to <code>#t</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_7.14.">Section 7.14. Record Equality and Hashing</h3>
<div id="objects:s145" class="paragraph">
<p>By default, the <code>equal?</code> primitive compares record instances using <code>eq?</code>, i.e., it distinguishes non-eq? instances even if they are of the same type and have equal contents. A program can override this behavior for instances of a record type (and its subtypes that do not have their own equality procedures) by using <code>record-type-equal-procedure</code> to associate an equality procedure with the record-type descriptor (<code><em>rtd</em></code>) that describes the record type.</p>
</div>
<div class="paragraph">
<p>When comparing two eq? instances, <code>equal?</code> always returns <code>#t</code>. When comparing two non-eq? instances that share an equality procedure <code><em>equal-proc</em></code>, <code>equal?</code> uses <code><em>equal-proc</em></code> to compare the instances. Two instances <code><em>x</em></code> and <code><em>y</em></code> share an equality procedure if they inherit an equality procedure from the same point in the inheritance chain, i.e., if <code>(record-equal-procedure <em>x</em> <em>y</em>)</code> returns a procedure (<code><em>equal-proc</em></code>) rather than <code>#f</code>. <code><em>equal?</em></code> passes <code><em>equal-proc</em></code> three arguments: the two instances plus a <code><em>eql?</em></code> procedure that should be used for recursive comparison of values within the two instances. Use of <code><em>eql?</em></code> for recursive comparison is necessary to allow comparison of potentially cyclic structure. When comparing two non-eq? instances that do not share an equality procedure, <code>equal?</code> returns <code>#f</code>.</p>
</div>
<div class="paragraph">
<p>A default equality procedure to be used for all record types (including opaque types) can be specified via the parameter <code>default-record-equal-procedure</code>. The default equality procedure is used only if neither instance&#8217;s type has or inherits a type-specific record equality procedure.</p>
</div>
<div id="objects:s151" class="paragraph">
<p>Similarly, when the <code>equal-hash</code> primitive hashes a record instance, it defaults to a value that is independent of the record type and contents of the instance. A program can override this behavior for instances of a record type by using <code>record-type-hash-procedure</code> to associate a hash procedure with the record-type descriptor (<code><em>rtd</em></code>) that describes the record type. The procedure <code>record-hash-procedure</code> can be used to find the hash procedure for a given record instance, following the inheritance chain. <code><em>equal-hash</em></code> passes the hash procedure two arguments: the instance plus a <code><em>hash</em></code> procedure that should be used for recursive hashing of values within the instance. Use of <code><em>hash</em></code> for recursive hashing is necessary to allow hashing of potentially cyclic structure and to make the hashing of shared structure more efficient.</p>
</div>
<div class="paragraph">
<p>A default hash procedure to be used for all record types (including opaque types) can be specified via the parameter <code>default-record-hash-procedure</code>. The default hash procedure is used only if an instance&#8217;s type does not have or inherit a type-specific hash procedure.</p>
</div>
<div class="paragraph">
<p>The following example illustrates the setting of equality and hash procedures.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-record-type marble
  (nongenerative)
  (fields color quality))

(record-type-equal-procedure (record-type-descriptor marble)) ⇒ #f
(equal? (make-marble 'blue 'medium) (make-marble 'blue 'medium)) ⇒ #f
(equal? (make-marble 'blue 'medium) (make-marble 'blue 'high)) ⇒ #f

; Treat marbles as equal when they have the same color
(record-type-equal-procedure (record-type-descriptor marble)
  (lambda (m1 m2 eql?)
    (eql? (marble-color m1) (marble-color m2))))
(record-type-hash-procedure (record-type-descriptor marble)
  (lambda (m hash)
    (hash (marble-color m))))

(equal? (make-marble 'blue 'medium) (make-marble 'blue 'high)) ⇒ #t
(equal? (make-marble 'red 'high) (make-marble 'blue 'high)) ⇒ #f

(define ht (make-hashtable equal-hash equal?))
(hashtable-set! ht (make-marble 'blue 'medium) "glass")
(hashtable-ref ht (make-marble 'blue 'high) #f) ⇒ "glass"

(define-record-type shooter
  (nongenerative)
  (parent marble)
  (fields size))

(equal? (make-marble 'blue 'medium) (make-shooter 'blue 'large 17)) ⇒ #t
(equal? (make-shooter 'blue 'large 17) (make-marble 'blue 'medium)) ⇒ #t
(hashtable-ref ht (make-shooter 'blue 'high 17) #f) ⇒ "glass"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example illustrates the application of equality and hash procedures to cyclic record structures.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-record-type node
  (nongenerative)
  (fields (mutable left) (mutable right)))

(record-type-equal-procedure (record-type-descriptor node)
  (lambda (x y e?)
    (and
      (e? (node-left x) (node-left y))
      (e? (node-right x) (node-right y)))))
(record-type-hash-procedure (record-type-descriptor node)
  (lambda (x hash)
    (+ (hash (node-left x)) (hash (node-right x)) 23)))

(define graph1
  (let ([x (make-node "a" (make-node #f "b"))])
    (node-left-set! (node-right x) x)
    x))
(define graph2
  (let ([x (make-node "a" (make-node (make-node "a" #f) "b"))])
    (node-right-set! (node-left (node-right x)) (node-right x))
    x))
(define graph3
  (let ([x (make-node "a" (make-node #f "c"))])
    (node-left-set! (node-right x) x)
    x))

(equal? graph1 graph2) ⇒ #t
(equal? graph1 graph3) ⇒ #f
(equal? graph2 graph3) ⇒ #f

(define h (make-hashtable equal-hash equal?))
(hashtable-set! h graph1 #t)
(hashtable-ref h graph1 #f) ⇒ #t
(hashtable-ref h graph2 #f) ⇒ #t
(hashtable-ref h graph3 #f) ⇒ #f</code></pre>
</div>
</div>
<div id="objects:s156" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-type-equal-procedure <em>rtd</em> <em>equal-proc</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-type-equal-procedure <em>rtd</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>equality procedure associated with <code><em>rtd</em></code>, if any, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the first form, <code><em>equal-proc</em></code> must be a procedure or <code>#f</code>. If <code><em>equal-proc</em></code> is a procedure, a new association between <code><em>rtd</em></code> and <code><em>equal-proc</em></code> is established, replacing any existing such association. If <code><em>equal-proc</em></code> is <code>#f</code>, any existing association between <code><em>rtd</em></code> and an equality procedure is dropped.</p>
</div>
<div class="paragraph">
<p>In the second form, <code>record-type-equal-procedure</code> returns the equality procedure associated with <code><em>rtd</em></code>, if any, otherwise <code>#f</code>.</p>
</div>
<div class="paragraph">
<p>When changing a record type&#8217;s equality procedure, the record type&#8217;s hash procedure, if any, should be updated if necessary to maintain the property that it produces the same hash value for any two instances the equality procedure considers equal.</p>
</div>
<div id="objects:s157" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-equal-procedure <em>record<sub>1</sub></em> <em>record<sub>2</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the shared equality procedure for <code><em>record<sub>1</sub></em></code> and <code><em>record<sub>2</sub></em></code>, if there is one, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>record-equal-procedure</code> traverses the inheritance chains for both record instances in an attempt to find the most specific type for each that is associated with an equality procedure, if any. If such type is found and is the same for both instances, the equality procedure associated with the type is returned. Otherwise, <code>#f</code> is returned.</p>
</div>
<div id="objects:s158" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-type-hash-procedure <em>rtd</em> <em>hash-proc</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-type-hash-procedure <em>rtd</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>hash procedure associated with <code><em>rtd</em></code>, if any, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the first form, <code><em>hash-proc</em></code> must be a procedure or <code>#f</code>. If <code><em>hash-proc</em></code> is a procedure, a new association between <code><em>rtd</em></code> and <code><em>hash-proc</em></code> is established, replacing any existing such association. If <code><em>hash-proc</em></code> is <code>#f</code>, any existing association between <code><em>rtd</em></code> and a hash procedure is dropped.</p>
</div>
<div class="paragraph">
<p>In the second form, <code>record-type-hash-procedure</code> returns the hash procedure associated with <code><em>rtd</em></code>, if any, otherwise <code>#f</code>.</p>
</div>
<div class="paragraph">
<p>The procedure <code><em>hash-proc</em></code> should accept two arguments, the instance for which it should compute a hash value and a hash procedure to use to compute hash values for arbitrary fields of the instance, and it return a nonnegative exact integer. A record type&#8217;s hash procedure should produce the same hash value for any two instances the record type&#8217;s equality procedure considers equal.</p>
</div>
<div id="objects:s159" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-hash-procedure <em>record</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the hash procedure for <code><em>record</em></code>, if there is one, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>record-hash-procedure</code> traverses the inheritance chain for the record instance in an attempt to find the most specific type that is associated with a hash procedure, if any. If such type is found, the hash procedure associated with the type is returned. Otherwise, <code>#f</code> is returned.</p>
</div>
<div id="objects:s160" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>default-record-equal-procedure</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This parameter determines how two record instances are compared by <code>equal?</code> if neither has a type-specific equality procedure. When the parameter has the value <code>#f</code> (the default), <code>equal?</code> compares the instances with <code>eq?</code>, i.e., there is no attempt at determining structural equivalence. Otherwise, the parameter&#8217;s value must be a procedure, and <code>equal?</code> invokes that procedure to compare the instances, passing it three arguments: the two instances and a procedure that should be used to recursively compare arbitrary values within the instances.</p>
</div>
<div id="objects:s161" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>default-record-hash-procedure</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This parameter determines the hash procedure used when <code>equal-hash</code> is called on a record instance and the instance does not have a type-specific hash procedure. When the parameter has the value <code>#f</code> (the default), <code>equal-hash</code> returns a value that is independent of the record type and contents of the instance. Otherwise, the parameter&#8217;s value must be a procedure, and <code>equal-hash</code> invokes the procedure to compute the instance&#8217;s hash value, passing it the record instance and a procedure to invoke to recursively compute hash values for arbitrary values contained within the record. The procedure should return a nonnegative exact integer, and the return value should be the same for any two instances the default equal procedure considers equivalent.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_7.15.">Section 7.15. Legacy Record Types</h3>
<div id="objects:s164" class="paragraph">
<p>In addition to the Revised<sup>6</sup> Report record-type creation and definition mechanisms, which are described in <a href="../../the-scheme-programming-language-4th/en/index.html#chp_9">Chapter 9</a> of <em>The Scheme Programming Language, 4th Edition</em>, <em>Chez Scheme</em> continues to support pre-R6RS mechanisms for creating new data types, or <em>record types</em>, with fixed sets of named fields. Many of the procedures described in this section are available only when imported from the <code>(chezscheme csv7)</code> library.</p>
</div>
<div class="paragraph">
<p>Code intended to be portable should use the R6RS mechanism instead.</p>
</div>
<div class="paragraph">
<p>Records may be defined via the <code>define-record</code> syntactic form or via the <code>make-record-type</code> procedure. The underlying representation of records and record-type descriptors is the same for the Revised<sup>6</sup> Report mechanism and the alternative mechanism. Record types created by one can be used as parent record types for the other via the procedural mechanisms, though not via the syntactic mechanisms.</p>
</div>
<div class="paragraph">
<p>The syntactic (<code>define-record</code>) interface is the most commonly used interface. Each <code>define-record</code> form defines a constructor procedure for records of the new type, a type predicate that returns true only for records of the new type, an access procedure for each field, and an assignment procedure for each mutable field. For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-record point (x y))</code></pre>
</div>
</div>
<div class="paragraph">
<p>creates a new <code>point</code> record type with two fields, <code>x</code> and <code>y</code>, and defines the following procedures:</p>
</div>
<table class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-point <em>x</em> <em>y</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">constructor</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(point? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">predicate</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(point-x <em>p</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">accessor for field <code>x</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(point-y <em>p</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">accessor for field <code>y</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-point-x! <em>p</em> <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mutator for field <code>x</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-point-y! <em>p</em> <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mutator for field <code>y</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The names of these procedures follow a regular naming convention by default, but the programmer can override the defaults if desired. <code>define-record</code> allows the programmer to control which fields are arguments to the generated constructor procedure and which are explicitly initialized by the constructor procedure. Fields are mutable by default, but may be declared immutable. Fields can generally contain any Scheme value, but the internal representation of each field may be specified, which places implicit constraints on the type of value that may be stored there. These customization options are covered in the formal description of <code>define-record</code> later in this section.</p>
</div>
<div class="paragraph">
<p>The procedural (<code>make-record-type</code>) interface may be used to implement interpreters that must handle <code>define-record</code> forms. Each call to <code>make-record-type</code> returns a <em>record-type descriptor</em> representing the record type. Using this record-type descriptor, programs may generate constructors, type predicates, field accessors, and field mutators dynamically. The following code demonstrates how the procedural interface might be used to create a similar <code>point</code> record type and associated definitions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define point (make-record-type "point" '(x y)))
(define make-point (record-constructor point))
(define point? (record-predicate point))
(define point-x (record-field-accessor point 'x))
(define point-y (record-field-accessor point 'y))
(define set-point-x! (record-field-mutator point 'x))
(define set-point-y! (record-field-mutator point 'y))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The procedural interface is more flexible than the syntactic interface, but this flexibility can lead to less readable programs and compromises the compiler&#8217;s ability to generate efficient code. Programmers should use the syntactic interface whenever it suffices.</p>
</div>
<div class="paragraph">
<p>A record-type descriptor may also be extracted from an instance of a record type, whether the record type was produced by <code>define-record</code> or <code>make-record-type</code>, and the extracted descriptor may also be used to produce constructors, predicates, accessors, and mutators, with a few limitations noted in the description of <code>record-type-descriptor</code> below. This is a powerful feature that permits the coding of portable printers and object inspectors. For example, the printer employs this feature in its default record printer, and the inspector uses it to allow inspection and mutation of system- and user-defined records during debugging.</p>
</div>
<div id="objects:s166" class="paragraph">
<p>A parent record may be specified in the <code>define-record</code> syntax or as an optional argument to <code>make-record-type</code>. A new record inherits the parent record&#8217;s fields, and each instance of the new record type is considered to be an instance of the parent type as well, so that accessors and mutators for the parent type may be used on instances of the new type.</p>
</div>
<div id="objects:s168" class="paragraph">
<p>Record type definitions may be classified as either generative or nongenerative. A new type results for each <em>generative</em> record definition, while only one type results for all occurrences of a given <em>nongenerative</em> record definition. This distinction is important semantically since record accessors and setters are applicable only to objects with the same type.</p>
</div>
<div class="paragraph">
<p>Syntactic (<code>define-record</code>) record definitions are <em>expand-time generative</em> by default, which means that a new record is created when the code is expanded. Expansion happens once for each form prior to compilation or interpretation, as when it is entered interactively, loaded from source, or compiled by <code>compile-file</code>. As a result, multiple evaluations of a single <code>define-record</code> form, e.g., in the body of a procedure called multiple times, always produce the same record type.</p>
</div>
<div class="paragraph">
<p>Separate <code>define-record</code> forms usually produce different types, even if the forms are textually identical. The only exception occurs when the name of a record is specified as a generated symbol, or <em>gensym</em> (<a href="#desc:gensym">page 152</a>). Multiple copies of a record definition whose name is given by a gensym always produce the same record type; i.e., such definitions are nongenerative. Each copy of the record definition must contain the same fields and field modifiers in the same order; an exception is raised with condition-type <code>&amp;assertion</code> when two differing record types with the same generated name are loaded into the same Scheme process.</p>
</div>
<div class="paragraph">
<p>Procedural (<code>make-record-type</code>) record definitions are <em>run-time generative</em> by default. That is, each call to <code>make-record-type</code> usually produces a new record type. As with the syntactic interface, the only exception occurs when the name of the record is specified as a gensym, in which case the record type is fully nongenerative.</p>
</div>
<div class="paragraph">
<p>By default, a record is printed with the syntax</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">#[<em>type-name</em> <em>field</em> ...]</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code><em>field</em> ...</code> are the printed representations of the contents of the fields of the record, and <code><em>type-name</em></code> is a generated symbol, or <em>gensym</em> (<a href="#desc:gensym">page 152</a>), that uniquely identifies the record type. For nongenerative records, <code><em>type-name</em></code> is the gensym provided by the program. Otherwise, it is a gensym whose "pretty" name (<a href="#desc:gensym">page 152</a>) is the name given to the record by <code>define-record</code> or <code>make-record-type</code>.</p>
</div>
<div class="paragraph">
<p>The default printing of records of a given type may be overridden with <code>record-writer</code>.</p>
</div>
<div class="paragraph">
<p>The default syntax may be used as input to the reader as well, as long as the corresponding record type has already been defined in the Scheme session in which the read occurs. The parameter <code>record-reader</code> may be used to specify a different name to be recognized by the reader in place of the generated name. Specifying a different name in this manner also changes the name used when the record is printed. This reader extension is disabled in an input stream after <code>#!r6rs</code> has been seen by the reader, unless <code>#!chezscheme</code> has been seen more recently.</p>
</div>
<div class="paragraph">
<p>The mark (<code>#<em>n</em>=</code>) and reference (<code>#<em>n</em>#</code>) syntaxes may be used within the record syntax, with the result of creating shared or cyclic structure as desired. All cycles must be resolvable, however, without mutation of an immutable record field. That is, any cycle must contain at least one pointer through a mutable field, whether it is a mutable record field or a mutable field of a built-in object type such as a pair or vector.</p>
</div>
<div class="paragraph">
<p>When the parameter <code>print-record</code> is set to <code>#f</code>, records are printed using the simpler syntax</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">#&lt;record of type <em>name</em>&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code><em>name</em></code> is the "pretty" name of the record (not the full gensym) or the reader name first assigned to the record type.</p>
</div>
<div id="objects:s172" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(define-record <em>name</em> (<em>fld<sub>1</sub></em> ...) ((<em>fld<sub>2</sub></em> <em>init</em>) ...) (<em>opt</em> ...))</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(define-record <em>name</em> <em>parent</em> (<em>fld<sub>1</sub></em> ...) ((<em>fld<sub>2</sub></em> <em>init</em>) ...) (<em>opt</em> ...))</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A <code>define-record</code> form is a definition and may appear anywhere and only where other definitions may appear.</p>
</div>
<div class="paragraph">
<p><code>define-record</code> creates a new record type containing a specified set of named fields and defines a set of procedures for creating and manipulating instances of the record type.</p>
</div>
<div class="paragraph">
<p><code><em>name</em></code> must be an identifier. If <code><em>name</em></code> is a generated symbol (gensym), the record definition is <em>nongenerative</em>, otherwise it is <em>expand-time generative</em>. (See the discussion of generativity earlier in this section.)</p>
</div>
<div class="paragraph">
<p>Each <code><em>fld</em></code> must be an identifier <code><em>field-name</em></code>, or it must take the form</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(<em>class</em> <em>type</em> <em>field-name</em>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code><em>class</em></code> and <code><em>type</em></code> are optional and <code><em>field-name</em></code> is an identifier. <code><em>class</em></code>, if present, must be the keyword <code>immutable</code> or the keyword <code>mutable</code>. If the <code>immutable</code> class specifier is present, the field is immutable; otherwise, the field is mutable. <code><em>type</em></code>, if present, specifies how the field is represented, as described below.</p>
</div>
<table id="record-field-types" class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ptr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">any Scheme object</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scheme-object</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">same as <code>ptr</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a C <code>int</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>unsigned</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a C <code>unsigned int</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>short</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a C <code>short</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>unsigned-short</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a C <code>unsigned short</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a C <code>long</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>unsigned-long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a C <code>unsigned long</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>iptr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a signed integer the size of a <code>ptr</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>uptr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">an unsigned integer the size of a <code>ptr</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>float</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a C <code>float</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>double</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a C <code>double</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>integer-8</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">an eight-bit signed integer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>unsigned-8</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">an eight-bit unsigned integer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>integer-16</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a 16-bit signed integer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>unsigned-16</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a 16-bit unsigned integer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>integer-32</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a 32-bit signed integer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>unsigned-32</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a 32-bit unsigned integer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>integer-64</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a 64-bit signed integer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>unsigned-64</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a 64-bit unsigned integer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>single-float</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a 32-bit single floating point number</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>double-float</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a 64-bit double floating point number</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If a type is specified, the field can contain objects only of the specified type. If no type is specified, the field is of type <code>ptr</code>, meaning that it can contain any Scheme object.</p>
</div>
<div class="paragraph">
<p>The field identifiers name the fields of the record. The values of the <em>n</em> fields described by <code><em>fld<sub>1</sub></em> ...</code> are specified by the <em>n</em> arguments to the generated constructor procedure. The values of the remaining fields, <code><em>fld<sub>2</sub></em> ...</code>, are given by the corresponding expressions, <code><em>init</em> ...</code>. Each <code><em>init</em></code> is evaluated within the scope of the set of field names given by <code><em>fld<sub>1</sub></em> ...</code> and each field in <code><em>fld<sub>2</sub></em> ...</code> that precedes it, as if within a <code>let*</code> expression. Each of these field names is bound to the value of the corresponding field during initialization.</p>
</div>
<div id="objects:s174" class="paragraph">
<p>If <code><em>parent</em></code> is present, the record type named by <code><em>parent</em></code> is the parent of the record. The new record type inherits each of the parent record&#8217;s fields, and records of the new type are considered records of the parent type. If <code><em>parent</em></code> is not present, the parent record type is a base record type with no fields.</p>
</div>
<div class="paragraph">
<p>The following procedures are defined by <code>define-record</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a constructor procedure whose name is <code>make-<em>name</em></code>,</p>
</li>
<li>
<p>a type predicate whose name is <code><em>name</em>?</code>,</p>
</li>
<li>
<p>an access procedure whose name is <code><em>name</em>-<em>fieldname</em></code> for each noninherited field, and</p>
</li>
<li>
<p>an assignment procedure whose name is <code>set-<em>name</em>-<em>fieldname</em>!</code> for each noninherited mutable field.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If no parent record type is specified, the constructor behaves as if defined as</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define make-<em>name</em>
  (lambda (<em>id<sub>1</sub></em> ...)
    (let* ([<em>id<sub>2</sub></em> <em>init</em>] ...)
      <em>body</em>)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code><em>id<sub>1</sub></em> ...</code> are the names of the fields defined by <code><em>fld<sub>1</sub></em> ...</code>, <code><em>id<sub>2</sub></em> ...</code> are the names of the fields defined by <code><em>fld<sub>2</sub></em> ...</code>, and <code><em>body</em></code> builds the record from the values of the identifiers <code><em>id<sub>1</sub></em> ...</code> and <code><em>id<sub>2</sub></em> ...</code>.</p>
</div>
<div class="paragraph">
<p>If a parent record type is specified, the parent arguments appear first, and the parent fields are inserted into the record before the child fields.</p>
</div>
<div class="paragraph">
<p>The options <code><em>opt</em> ...</code> control the selection of names of the generated constructor, predicate, accessors, and mutators.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(constructor <em>id</em>)
(predicate <em>id</em>)
(prefix <em>string</em>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The option <code>(constructor <em>id</em>)</code> causes the generated constructor&#8217;s name to be <code><em>id</em></code> rather than <code>make-<em>name</em></code>. The option <code>(predicate <em>id</em>)</code> likewise causes the generated predicate&#8217;s name to be <code><em>id</em></code> rather than <code><em>name</em>?</code>. The option <code>(prefix <em>string</em>)</code> determines the prefix to be used in the generated accessor and mutator names in place of <code><em>name</em>-</code>.</p>
</div>
<div class="paragraph">
<p>If no options are needed, the third subexpression, <code>(<em>opt</em> ...)</code>, may be omitted. If no options and no fields other than those initialized by the arguments to the constructor procedure are needed, both the second and third subexpressions may be omitted. If options are specified, the second subexpression must be present, even if it contains no field specifiers.</p>
</div>
<div class="paragraph">
<p>Here is a simple example with no inheritance and no options.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-record marble (color quality))
(define x (make-marble 'blue 'medium))
(marble? x) ⇒ #t
(pair? x) ⇒ #f
(vector? x) ⇒ #f
(marble-color x) ⇒ blue
(marble-quality x) ⇒ medium
(set-marble-quality! x 'low)
(marble-quality x) ⇒ low

(define-record marble ((immutable color) (mutable quality))
  (((mutable shape) (if (eq? quality 'high) 'round 'unknown))))
(marble-shape (make-marble 'blue 'high)) ⇒ round
(marble-shape (make-marble 'blue 'low)) ⇒ unknown
(define x (make-marble 'blue 'high))
(set-marble-quality! x 'low)
(marble-shape x) ⇒ round
(set-marble-shape! x 'half-round)
(marble-shape x) ⇒ half-round</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example illustrates inheritance.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-record shape (x y))
(define-record point shape ())
(define-record circle shape (radius))

(define a (make-point 7 -3))
(shape? a) ⇒ #t
(point? a) ⇒ #t
(circle? a) ⇒ #f

(shape-x a) ⇒ 7
(set-shape-y! a (- (shape-y a) 1))
(shape-y a) ⇒ -4

(define b (make-circle 7 -3 1))
(shape? b) ⇒ #t
(point? b) ⇒ #f
(circle? b) ⇒ #t

(circle-radius b) ⇒ 1
(circle-radius a) ⇒ <em>exception: not of type circle</em>

(define c (make-shape 0 0))
(shape? c) ⇒ #t
(point? c) ⇒ #f
(circle? c) ⇒ #f</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example demonstrates the use of options:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-record pair (car cdr)
  ()
  ((constructor cons)
   (prefix "")))

(define x (cons 'a 'b))
(car x) ⇒ a
(cdr x) ⇒ b
(pair? x) ⇒ #t

(pair? '(a b c)) ⇒ #f
x ⇒ #[#{pair bdhavk1bwafxyss1-a} a b]</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example illustrates the use a specified reader name, immutable fields, and the graph mark and reference syntax.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-record triple ((immutable x1) (mutable x2) (immutable x3)))
(record-reader 'triple (type-descriptor triple))

(let ([t '#[triple #1=(1 2) (3 4) #1#]])
  (eq? (triple-x1 t) (triple-x3 t))) ⇒ #t
(let ([x '(#1=(1 2) . #[triple #1# b c])])
  (eq? (car x) (triple-x1 (cdr x)))) ⇒ #t
(let ([t #[triple #1# (3 4) #1=(1 2)]])
  (eq? (triple-x1 t) (triple-x3 t))) ⇒ #t
(let ([t '#1=#[triple a #1# c]])
  (eq? t (triple-x2 t))) ⇒ #t
(let ([t '#1=(#[triple #1# b #1#])])
  (and (eq? t (triple-x1 (car t)))
       (eq? t (triple-x1 (car t))))) ⇒ #t</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cycles established with the mark and reference syntax can be resolved only if a mutable record field or mutable location of some other object is involved the cycle, as in the last two examples above. An exception is raised with condition type <code>&amp;lexical</code> if only immutable fields are involved.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">'#1=#[triple #1# (3 4) #1#] ⇒ <em>exception</em></code></pre>
</div>
</div>
<div id="objects:s175" class="paragraph">
<p>The following example demonstrates the use of nongenerative record definitions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(module A (point-disp)
  (define-record #{point bdhavk1bwafxyss1-b} (x y))
  (define square (lambda (x) (* x x)))
  (define point-disp
    (lambda (p1 p2)
      (sqrt (+ (square (- (point-x p1) (point-x p2)))
               (square (- (point-y p1) (point-y p2))))))))

(module B (base-disp)
  (define-record #{point bdhavk1bwafxyss1-b} (x y))
  (import A)
  (define base-disp
    (lambda (p)
      (point-disp (make-point 0 0) p))))

(let ()
  (import B)
  (define-record #{point bdhavk1bwafxyss1-b} (x y))
  (base-disp (make-point 3 4))) ⇒ 5</code></pre>
</div>
</div>
<div class="paragraph">
<p>This works even if the different program components are loaded from different source files or are compiled separately and loaded from different object files.</p>
</div>
<div id="objects:s176" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>predicate</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>prefix</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>constructor</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="objects:s178" class="paragraph">
<p>These identifiers are auxiliary keywords for <code>define-record</code>. It is a syntax violation to reference these identifiers except in contexts where they are recognized as auxiliary keywords. <code>mutable</code> and <code>immutable</code> are also auxiliary keywords for <code>define-record</code>, shared with the Revised<sup>6</sup> Report <code>define-record-type</code>.</p>
</div>
<div id="objects:s179" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(type-descriptor <em>name</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the record-type descriptor associated with <code><em>name</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>name</em></code> must name a record type defined by <code>define-record</code> or <code>define-record-type</code>.</p>
</div>
<div class="paragraph">
<p>This form is equivalent to the Revised<sup>6</sup> Report <code>record-type-descriptor</code> form.</p>
</div>
<div class="paragraph">
<p>The record-type descriptor is useful for overriding the default read and write syntax using <code>record-reader</code> and <code>record-writer</code> and may also be used with the procedural interface routines described later in this section.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-record frob ())
(type-descriptor frob) ⇒ #&lt;record type frob&gt;</code></pre>
</div>
</div>
<div id="objects:s180" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-reader <em>name</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the record-type descriptor associated with <code><em>name</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-reader <em>rtd</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the first name associated with <code><em>rtd</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-reader <em>name</em> <em>rtd</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-reader <em>name</em> #f)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-reader <em>rtd</em> #f)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>name</em></code> must be a symbol, and <code><em>rtd</em></code> must be a record-type descriptor.</p>
</div>
<div class="paragraph">
<p>With one argument, <code>record-reader</code> is used to retrieve the record type associated with a name or name associated with a record type. If no association has been created, <code>record-reader</code> returns <code>#f</code></p>
</div>
<div class="paragraph">
<p>With arguments <code><em>name</em></code> and <code><em>rtd</em></code>, <code>record-reader</code> registers <code><em>rtd</em></code> as the record-type descriptor to be used whenever the <code>read</code> procedure encounters a record named by <code><em>name</em></code> and printed in the default record syntax.</p>
</div>
<div class="paragraph">
<p>With arguments <code><em>name</em></code> and <code>#f</code>, <code>record-reader</code> removes any association for <code><em>name</em></code> to a record-type descriptor. Similarly, with arguments <code><em>rtd</em></code> and <code>#f</code>, <code>record-reader</code> removes any association for <code><em>rtd</em></code> to a name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-record marble (color quality))
(define m (make-marble 'blue 'perfect))
m ⇒ #[#{marble bdhavk1bwafxyss1-c} blue perfect]

(record-reader (type-descriptor marble)) ⇒ #f
(record-reader 'marble) ⇒ #f

(record-reader 'marble (type-descriptor marble))
(marble-color '#[marble red miserable]) ⇒ red

(record-reader (type-descriptor marble)) ⇒ marble
(record-reader 'marble) ⇒ #&lt;record type marble&gt;

(record-reader (type-descriptor marble) #f)
(record-reader (type-descriptor marble)) ⇒ #f
(record-reader 'marble) ⇒ #f

(record-reader 'marble (type-descriptor marble))
(record-reader 'marble #f)
(record-reader (type-descriptor marble)) ⇒ #f
(record-reader 'marble) ⇒ #f</code></pre>
</div>
</div>
<div class="paragraph">
<p>The introduction of a record reader also changes the default printing of records. The printer always chooses the reader name first assigned to the record, if any, in place of the unique record name, as this continuation of the example above demonstrates.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(record-reader 'marble (type-descriptor marble))
(make-marble 'pink 'splendid) ⇒ #[marble pink splendid]</code></pre>
</div>
</div>
<div id="objects:s181" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-writer <em>rtd</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the record writer associated with <code><em>rtd</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-writer <em>rtd</em> <em>procedure</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>rtd</em></code> must be a record-type descriptor, and <code><em>procedure</em></code> should accept three arguments, as described below.</p>
</div>
<div class="paragraph">
<p>When passed only one argument, <code>record-writer</code> returns the record writer associated with <code><em>rtd</em></code>, which is initially the default record writer for all records. The default print method prints all records in a uniform syntax that includes the generated name for the record and the values of each of the fields, as described in the introduction to this section.</p>
</div>
<div class="paragraph">
<p>When passed two arguments, <code>record-writer</code> establishes a new association between <code><em>rtd</em></code> and <code><em>procedure</em></code> so that <code><em>procedure</em></code> will be used by the printer in place of the default printer for records of the given type. The printer passes <code><em>procedure</em></code> three arguments: the record <code><em>r</em></code>, a port <code><em>p</em></code>, and a procedure <code><em>wr</em></code> that should be used to write out the values of arbitrary Scheme objects that the print method chooses to include in the printed representation of the record, e.g., values of the record&#8217;s fields.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-record marble (color quality))
(define m (make-marble 'blue 'medium))

m ⇒ #[#{marble bdhavk1bwafxyss1-d} blue medium]

(record-writer (type-descriptor marble)
  (lambda (r p wr)
    (display "#<" p)
    (wr (marble-quality r) p)
    (display " quality " p)
    (wr (marble-color r) p)
    (display " marble>" p)))

m ⇒ #&lt;medium quality blue marble&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The record writer is used only when <code>print-record</code> is true (the default). When the parameter <code>print-record</code> is set to <code>#f</code>, records are printed using a compressed syntax that identifies only the type of record.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(parameterize ([print-record #f])
  (format "~s" m)) ⇒ "#&lt;record of type marble&gt;"</code></pre>
</div>
</div>
<div class="paragraph">
<p>A print method may be called more than once during the printing of a single record to support cycle detection and graph printing (see <code>print-graph</code>), so print methods that perform side effects other than printing to the given port are discouraged. Whenever a print method is called more than once during the printing of a single record, in all but one call, a generic "bit sink" port is used to suppress output automatically so that only one copy of the object appears on the actual port. In order to avoid confusing the cycle detection and graph printing algorithms, a print method should always produce the same printed representation for each object. Furthermore, a print method should normally use the supplied procedure <code><em>wr</em></code> to print subobjects, though atomic values, such as strings or numbers, may be printed by direct calls to <code>display</code> or <code>write</code> or by other means.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ()
  (define-record ref () ((contents 'nothing)))
  (record-writer (type-descriptor ref)
    (lambda (r p wr)
      (display "<" p)
      (wr (ref-contents r) p)
      (display ">" p)))
  (let ([ref-lexive (make-ref)])
    (set-ref-contents! ref-lexive ref-lexive)
    ref-lexive)) ⇒ #0=&lt;#0#&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Print methods need not be concerned with handling nonfalse values of the parameters <code>print-level</code>. The printer handles <code>print-level</code> automatically even when user-defined print procedures are used. Since records typically contain a small, fixed number of fields, it is usually possible to ignore nonfalse values of <code>print-length</code> as well.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(print-level 3)
(let ()
  (define-record ref () ((contents 'nothing)))
  (record-writer (type-descriptor ref)
    (lambda (r p wr)
      (display "<" p)
      (wr (ref-contents r) p)
      (display ">" p)))
  (let ([ref-lexive (make-ref)])
    (set-ref-contents! ref-lexive ref-lexive)
    ref-lexive)) ⇒ &lt;&lt;&lt;&lt;#[...]&gt;&gt;&gt;&gt;</code></pre>
</div>
</div>
<div id="objects:s185" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>print-record</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This parameter controls the printing of records. If set to true (the default) the record writer associated with a record type is used to print records of that type. If set to false, all records are printed with the syntax <code>#&lt;record of type <em>name</em>&gt;</code>, where <code><em>name</em></code> is the name of the record type as returned by <code>record-type-name</code>.</p>
</div>
<div id="objects:s186" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-record-type <em>type-name</em> <em>fields</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-record-type <em>parent-rtd</em> <em>type-name</em> <em>fields</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a record-type descriptor for a new record type</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>make-record-type</code> creates a new data type and returns a record-type descriptor, a value representing the new data type. The new type is disjoint from all others.</p>
</div>
<div class="paragraph">
<p>If present, <code><em>parent-rtd</em></code> must be a record-type descriptor.</p>
</div>
<div class="paragraph">
<p><code><em>type-name</em></code> must be a string or gensym. If <code><em>type-name</em></code> is a string, a new record type is generated. If <code><em>type-name</em></code> is a gensym, a new record type is generated only if one with the same gensym has not already been defined. If one has already been defined, the parent and fields must be identical to those of the existing record type, and the existing record type is used. If the parent and fields are not identical, an exception is raised with condition-type <code>&amp;assertion</code>.</p>
</div>
<div class="paragraph">
<p><code><em>fields</em></code> must be a list of field descriptors, each of which describes one field of instances of the new record type. A field descriptor is either a symbol or a list in the following form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(<em>class</em> <em>type</em> <em>field-name</em>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code><em>class</em></code> and <code><em>type</em></code> are optional. <code><em>field-name</em></code> must be a symbol. <code><em>class</em></code>, if present, must be the symbol <code>immutable</code> or the symbol <code>mutable</code>. If the <code>immutable</code> class-specifier is present, the field is immutable; otherwise, the field is mutable. <code><em>type</em></code>, if present, specifies how the field is represented. The types are the same as those given in the description of <code>define-record</code> on <a href="#record-field-types">page 175</a>.</p>
</div>
<div class="paragraph">
<p>If a type is specified, the field can contain objects only of the specified type. If no type is specified, the field is of type <code>ptr</code>, meaning that it can contain any Scheme object.</p>
</div>
<div class="paragraph">
<p>The behavior of a program that modifies the string <code><em>type-name</em></code> or the list <code><em>fields</em></code> or any of its sublists is unspecified.</p>
</div>
<div class="paragraph">
<p>The record-type descriptor may be passed as an argument to any of the Revised<sup>6</sup> Report procedures</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>record-constructor</code>,</p>
</li>
<li>
<p><code>record-predicate</code>,</p>
</li>
<li>
<p><code>record-accessor</code>, and</p>
</li>
<li>
<p><code>record-mutator</code>,</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>or to the <em>Chez Scheme</em> variants</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>record-constructor</code>,</p>
</li>
<li>
<p><code>record-field-accessor</code>, and</p>
</li>
<li>
<p><code>record-field-mutator</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>to obtain procedures for creating and manipulating records of the new type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define marble
  (make-record-type "marble"
    '(color quality)
    (lambda (r p wr)
      (display "#<" p)
      (wr (marble-quality r) p)
      (display " quality " p)
      (wr (marble-color r) p)
      (display " marble>" p))))
(define make-marble
  (record-constructor marble))
(define marble?
  (record-predicate marble))
(define marble-color
  (record-field-accessor marble 'color))
(define marble-quality
  (record-field-accessor marble 'quality))
(define set-marble-quality!
  (record-field-mutator marble 'quality))
(define x (make-marble 'blue 'high))
(marble? x) ⇒ #t
(marble-quality x) ⇒ high
(set-marble-quality! x 'low)
(marble-quality x) ⇒ low
x ⇒ #&lt;low quality blue marble&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The order in which the fields appear in <code><em>fields</em></code> is important. While field names are generally distinct, it is permissible for one field name to be the same as another in the list of fields or the same as an inherited name. In this case, field ordinals must be used to select fields in calls to <code>record-field-accessor</code> and <code>record-field-mutator</code>. Ordinals range from zero through one less than the number of fields. Parent fields come first, if any, followed by the fields in <code><em>fields</em></code>, in the order given.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define r1 (make-record-type "r1" '(t t)))
(define r2 (make-record-type r1 "r2" '(t)))
(define r3 (make-record-type r2 "r3" '(t t t)))

(define x ((record-constructor r3) 'a 'b 'c 'd 'e 'f))
((record-field-accessor r3 0) x) ⇒ a
((record-field-accessor r3 2) x) ⇒ c
((record-field-accessor r3 4) x) ⇒ e
((record-field-accessor r3 't) x) ⇒ <em>unspecified</em></code></pre>
</div>
</div>
<div id="objects:s189" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-constructor <em>rcd</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-constructor <em>rtd</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a constructor for records of the type represented by <code><em>rtd</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Like the Revised<sup>6</sup> Report version of this procedure, this procedure may be passed a record-constructor descriptor, <code><em>rcd</em></code>, which determines the behavior of the constructor. It may also be passed a record-type descriptor, <code><em>rtd</em></code>, in which case the constructor accepts as many arguments as there are fields in the record; these arguments are the initial values of the fields in the order given when the record-type descriptor was created.</p>
</div>
<div id="objects:s190" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-field-accessor <em>rtd</em> <em>field-id</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>an accessor for the identified field</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme csv7)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>rtd</em></code> must be a record-type descriptor, <code><em>field-id</em></code> must be a symbol or field ordinal, i.e., a nonnegative exact integer less than the number of fields of the given record type. The specified field must be accessible.</p>
</div>
<div class="paragraph">
<p>The generated accessor expects one argument, which must be a record of the type represented by <code><em>rtd</em></code>. It returns the contents of the specified field of the record.</p>
</div>
<div id="objects:s191" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-field-accessible? <em>rtd</em> <em>field-id</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the specified field is accessible, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme csv7)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>rtd</em></code> must be a record-type descriptor, <code><em>field-id</em></code> must be a symbol or field ordinal, i.e., a nonnegative exact integer less than the number of fields of the given record type.</p>
</div>
<div class="paragraph">
<p>The compiler is free to eliminate a record field if it can prove that the field is not accessed. In making this determination, the compiler is free to ignore the possibility that an accessor might be created from a record-type descriptor obtained by calling <code>record-type-descriptor</code> on an instance of the record type.</p>
</div>
<div id="objects:s192" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-field-mutator <em>rtd</em> <em>field-id</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a mutator for the identified field</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme csv7)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>rtd</em></code> must be a record-type descriptor, <code><em>field-id</em></code> must be a symbol or field ordinal, i.e., a nonnegative exact integer less than the number of fields of the given record type. The specified field must be mutable.</p>
</div>
<div class="paragraph">
<p>The mutator expects two arguments, <code><em>r</em></code> and <code><em>obj</em></code>. <code><em>r</em></code> must be a record of the type represented by <code><em>rtd</em></code>. <code><em>obj</em></code> must be a value that is compatible with the type declared for the specified field when the record-type descriptor was created. <code><em>obj</em></code> is stored in the specified field of the record.</p>
</div>
<div id="objects:s193" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-field-mutable? <em>rtd</em> <em>field-id</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the specified field is mutable, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme csv7)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>rtd</em></code> must be a record-type descriptor, <code><em>field-id</em></code> must be a symbol or field ordinal, i.e., a nonnegative exact integer less than the number of fields of the given record type.</p>
</div>
<div class="paragraph">
<p>Any field declared immutable is immutable. In addition, the compiler is free to treat a field as immutable if it can prove that the field is never assigned. In making this determination, the compiler is free to ignore the possibility that a mutator might be created from a record-type descriptor obtained by calling <code>record-type-descriptor</code> on an instance of the record type.</p>
</div>
<div id="objects:s194" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-type-name <em>rtd</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the name of the record-type represented by <code><em>rtd</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme csv7)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>rtd</em></code> must be a record-type descriptor.</p>
</div>
<div class="paragraph">
<p>The name is a always a string. If a gensym is provided as the record-type name in a <code>define-record</code> form or <code>make-record-type</code> call, the result is the "pretty" name of the gensym (see <a href="#section_7.9.">Section 7.9</a>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(record-type-name (make-record-type "empty" '())) ⇒ "empty"

(define-record #{point bdhavk1bwafxyss1-b} (x y))
(define p (type-descriptor #{point bdhavk1bwafxyss1-b}))
(record-type-name p) ⇒ "point"</code></pre>
</div>
</div>
<div id="objects:s195" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-type-symbol <em>rtd</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the generated symbol associated with <code><em>rtd</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme csv7)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>rtd</em></code> must be a record-type descriptor.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define e (make-record-type "empty" '()))
(record-type-symbol e) ⇒ #{empty bdhavk1bwafxyss1-e}

(define-record #{point bdhavk1bwafxyss1-b} (x y))
(define p (type-descriptor #{point bdhavk1bwafxyss1-b}))
(record-type-symbol p) ⇒ #{point bdhavk1bwafxyss1-b}</code></pre>
</div>
</div>
<div id="objects:s196" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-type-field-names <em>rtd</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of field names of the type represented by <code><em>rtd</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme csv7)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>rtd</em></code> must be a record-type descriptor. The field names are symbols.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-record triple ((immutable x1) (mutable x2) (immutable x3)))
(record-type-field-names (type-descriptor triple)) ⇒ (x1 x2 x3)</code></pre>
</div>
</div>
<div id="objects:s197" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-type-field-decls <em>rtd</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of field declarations of the type represented by <code><em>rtd</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme csv7)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>rtd</em></code> must be a record-type descriptor. Each field declaration has the following form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(<em>class</em> <em>type</em> <em>field-name</em>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code><em>class</em></code>, <code><em>type</em></code>, and <code><em>field-name</em></code> are as described under <code>make-record-type</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-record shape (x y))
(define-record circle shape (radius))

(record-type-field-decls
  (type-descriptor circle)) ⇒ ((mutable ptr x)
                                (mutable ptr y)
                                (mutable ptr radius))</code></pre>
</div>
</div>
<div id="objects:s198" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a record, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record? <em>obj</em> <em>rtd</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a record of the given type, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If present, <code><em>rtd</em></code> must be a record-type descriptor.</p>
</div>
<div class="paragraph">
<p>A record is "of the given type" if it is an instance of the record type or one of its ancestors. The predicate generated by <code>record-predicate</code> for a record-type descriptor <code><em>rtd</em></code> is equivalent to the following.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(lambda (x) (record? x <em>rtd</em>))</code></pre>
</div>
</div>
<div id="objects:s199" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(record-type-descriptor <em>rec</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the record-type descriptor of <code><em>rec</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme csv7)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>rec</em></code> must be a record. This procedure is intended for use in the definition of portable printers and debuggers. For records created with <code>make-record-type</code>, it may not be the same as the descriptor returned by <code>make-record-type</code>. See the comments about field accessibility and mutability under <code>record-field-accessible?</code> and <code>record-field-mutable?</code> above.</p>
</div>
<div class="paragraph">
<p>This procedure is equivalent to the Revised<sup>6</sup> Report <code>record-rtd</code> procedure.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define rtd (make-record-type "frob" '(blit blat)))
rtd ⇒ #&lt;record type frob&gt;
(define x ((record-constructor rtd) 1 2))
(record-type-descriptor x) ⇒ #&lt;record type frob&gt;
(eq? (record-type-descriptor x) rtd) ⇒ <em>unspecified</em></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_7.16.">Section 7.16. Procedures</h3>
<div id="objects:s200" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(procedure-arity-mask <em>proc</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>an exact integer bitmask identifying the accepted argument counts of <code><em>proc</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The bitmask is represented as two&#8217;s complement number with the bit at each index <code><em>n</em></code> set if and only if <code><em>proc</em></code> accepts <code><em>n</em></code> arguments.</p>
</div>
<div class="paragraph">
<p>The two&#8217;s complement encoding implies that if <code><em>proc</em></code> accepts <code><em>n</em></code> or more arguments, the encoding is a negative number, since all the bits from <code><em>n</em></code> and up are set. For example, if <code><em>proc</em></code> accepts any number of arguments, the two&#8217;s complement encoding of all bits set is <code>-1</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(procedure-arity-mask (lambda () 'none)) ⇒ 1
(procedure-arity-mask car) ⇒ 2
(procedure-arity-mask (case-lambda [() 'none] [(x) x])) ⇒ 3
(procedure-arity-mask (lambda x x)) ⇒ -1
(procedure-arity-mask (case-lambda [() 'none] [(x y . z) x])) ⇒ -3
(procedure-arity-mask (case-lambda)) ⇒ 0
(logbit? 1 (procedure-arity-mask pair?)) ⇒ #t
(logbit? 2 (procedure-arity-mask pair?)) ⇒ #f
(logbit? 2 (procedure-arity-mask cons)) ⇒ #t</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chp_8">Chapter 8. Numeric Operations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes <em>Chez Scheme</em> extensions to the standard set of operations on numbers. See <a href="../../the-scheme-programming-language-4th/en/index.html#chp_6">Chapter 6</a> of <em>The Scheme Programming Language, 4th Edition</em> or the Revised<sup>6</sup> Report on Scheme for a description of standard operations on numbers.</p>
</div>
<div class="paragraph">
<p><em>Chez Scheme</em> supports the full set of Scheme numeric datatypes, including exact and inexact integer, rational, real, and complex numbers. A variety of representations are used to support these datatypes:</p>
</div>
<div id="numeric:s0" class="dlist">
<dl>
<dt class="hdlist1">Fixnums</dt>
<dd>
<p>represent exact integers in the fixnum range (see <code>most-negative-fixnum</code> and <code>most-positive-fixnum</code>). The length of a string, vector, or fxvector is constrained to be a fixnum.</p>
</dd>
</dl>
</div>
<div id="numeric:s1" class="dlist">
<dl>
<dt class="hdlist1">Bignums</dt>
<dd>
<p>represent arbitrary-precision exact integers outside of the fixnum range.</p>
</dd>
</dl>
</div>
<div id="numeric:s2" class="dlist">
<dl>
<dt class="hdlist1">Ratnums</dt>
<dd>
<p>represent arbitrary-precision exact rational numbers. Each ratnum contains an exact integer (fixnum or bignum) numerator and an exact integer denominator. Ratios are always reduced to lowest terms and never have a denominator of one or a numerator of zero.</p>
</dd>
</dl>
</div>
<div id="numeric:s3" class="dlist">
<dl>
<dt class="hdlist1">Flonums</dt>
<dd>
<p>represent inexact real numbers. Flonums are IEEE 64-bit floating-point numbers. (Since flonums cannot represent irrational numbers, all inexact real numbers are actually rational, although they may approximate irrational quantities.)</p>
</dd>
</dl>
</div>
<div id="numeric:s4" class="dlist">
<dl>
<dt class="hdlist1">Exact complexnums</dt>
<dd>
<p>represent exact complex numbers. Each exact complexnum contains an exact rational (fixnum, bignum, or ratnum) real part and an exact rational imaginary part.</p>
</dd>
</dl>
</div>
<div id="numeric:s5" class="dlist">
<dl>
<dt class="hdlist1">Inexact complexnums</dt>
<dd>
<p>represent inexact complex numbers. Each inexact complexnum contains a flonum real part and a flonum imaginary part.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Most numbers can be represented in only one way; however, real numbers are sometimes represented as inexact complex numbers with imaginary component equal to zero.</p>
</div>
<div class="paragraph">
<p><em>Chez Scheme</em> extends the syntax of numbers with arbitrary radixes from two through 36, nondecimal floating-point and scientific notation, and printed representations for IEEE infinities and NANs. (NAN stands for "not-a-number.")</p>
</div>
<div class="paragraph">
<p>Arbitrary radixes are specified with the prefix <code>#<em>n</em>r</code>, where <code><em>n</em></code> ranges from 2 through 36. Digits beyond 9 are specified with the letters (in either upper or lower case) <code>a</code> through <code>z</code>. For example, <code>#2r101</code> is 5<sub>10</sub>, and <code>#36rZ</code> is 35<sub>10</sub>.</p>
</div>
<div class="paragraph">
<p>For higher radixes, an ambiguity arises between the interpretation of certain letters, e.g., <code>e</code>, as digits or exponent specifiers; in such cases, the letter is assumed to be a digit. For example, the <code>e</code> in <code>#x3.2e5</code> is interpreted as a digit, not as an exponent marker, whereas in <code>3.2e5</code> it is treated as an exponent marker.</p>
</div>
<div class="paragraph">
<p>IEEE infinities are printed as <code>+inf.0</code> and <code>-inf.0</code>, while IEEE NANs are printed as <code>+nan.0</code> or <code>-nan.0</code>. (+nan.0 is used on output for all NANs.)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(/ 1.0 0.0) ⇒ +inf.0
(/ 1.0 -0.0) ⇒ -inf.0
(/ 0.0 0.0) ⇒ +nan.0
(/ +inf.0 -inf.0) ⇒ +nan.0</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first section of this chapter describes type-specific numeric type predicates. Sections <a href="#section_8.2.">8.2</a> through <a href="#section_8.4.">8.4</a> describe fast, type-specific numeric operations on fixnums, flonums, and inexact complex numbers (flonums and/or inexact complexnums). The fixnum-specific versions should be used only when the programmer is certain that the operands and results (where appropriate) will be fixnums, i.e., integers in the range <code>(most-negative-fixnum)</code> to <code>(most-positive-fixnum)</code>, inclusive. The flonum-specific versions should be used only when the inputs and outputs (where appropriate) are certain to be flonums. The mixed flonum/complexnum versions should be used only when the inputs are certain to be either flonums or inexact complexnums. <a href="#section_8.5.">Section 8.5</a> describes operations, both arbitrary precision and fixnum-specific, that allow exact integers to be treated as sets or sequences of bits. Random number generation is covered <a href="#section_8.6.">Section 8.6</a>, and miscellaneous numeric operations are covered in the <a href="#section_8.7.">Section 8.7</a>.</p>
</div>
<div class="sect2">
<h3 id="section_8.1.">Section 8.1. Numeric Type Predicates</h3>
<div class="paragraph">
<p>The Revised<sup>6</sup> Report distinguishes two types of special numeric objects: fixnums and flonums. <em>Chez Scheme</em> additionally distinguishes <em>bignums</em> (exact integers outside of the fixnum range) and <em>ratnums</em> (ratios of exact integers). It also provides a predicate for recognizing <em>cflonums</em>, which are flonums or inexact complex numbers.</p>
</div>
<div id="numeric:s11" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bignum? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a bignum, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(bignum? 0) ⇒ #f
(bignum? (most-positive-fixnum)) ⇒ #f
(bignum? (most-negative-fixnum)) ⇒ #f
(bignum? (* (most-positive-fixnum) 2)) ⇒ #t
(bignum? 3/4) ⇒ #f
(bignum? 'a) ⇒ #f</code></pre>
</div>
</div>
<div id="numeric:s12" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(ratnum? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a ratnum, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(ratnum? 0) ⇒ #f
(ratnum? (* (most-positive-fixnum) 2)) ⇒ #f
(ratnum? 3/4) ⇒ #t
(ratnum? -10/2) ⇒ #f
(ratnum? -11/2) ⇒ #t
(ratnum? 'a) ⇒ #f</code></pre>
</div>
</div>
<div id="numeric:s13" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(cflonum? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is an inexact complexnum or flonum, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(cflonum? 0) ⇒ #f
(cflonum? 0.0) ⇒ #t
(cflonum? 3+4i) ⇒ #f
(cflonum? 3.0+4i) ⇒ #t
(cflonum? +i) ⇒ #f
(cflonum? +1.0i) ⇒ #t</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_8.2.">Section 8.2. Fixnum Operations</h3>
<div class="paragraph">
<p>Fixnum-specific procedures normally check their inputs and outputs (where appropriate), but at optimization level 3 the compiler generates, in most cases, code that does not perform these checks.</p>
</div>
<div id="numeric:s14" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(most-positive-fixnum)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the most positive fixnum supported by the system</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(most-negative-fixnum)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the most negative fixnum supported by the system</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These procedures are identical to the Revised<sup>6</sup> Report <code>greatest-fixnum</code> and <code>least-fixnum</code> procedures.</p>
</div>
<div id="numeric:s15" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fx= <em>fixnum<sub>1</sub></em> <em>fixnum<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fx&lt; <em>fixnum<sub>1</sub></em> <em>fixnum<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fx&gt; <em>fixnum<sub>1</sub></em> <em>fixnum<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fx&lt;= <em>fixnum<sub>1</sub></em> <em>fixnum<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fx&gt;= <em>fixnum<sub>1</sub></em> <em>fixnum<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the relation holds, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The predicate <code>fx=</code> returns <code>#t</code> if its arguments are equal. The predicate <code>fx&lt;</code> returns <code>#t</code> if its arguments are monotonically increasing, i.e., each argument is greater than the preceding ones, while <code>fx&gt;</code> returns <code>#t</code> if its arguments are monotonically decreasing. The predicate <code>fx&lt;=</code> returns <code>#t</code> if its arguments are monotonically nondecreasing, i.e., each argument is not less than the preceding ones, while <code>fx&gt;=</code> returns <code>#t</code> if its arguments are monotonically nonincreasing. When passed only one argument, each of these predicates returns <code>#t</code>.</p>
</div>
<div class="paragraph">
<p>These procedures are similar to the Revised<sup>6</sup> Report procedures <code>fx=?</code>, <code>fx&lt;?</code>, <code>fx&gt;?</code>, <code>fx&lt;=?</code>, and <code>fx&gt;=?</code> except that the Revised<sup>6</sup> Report procedures require two or more arguments, and their names have the &#8220;?&#8221; suffix.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fx= 0) ⇒ #t
(fx= 0 0) ⇒ #t
(fx< (most-negative-fixnum) 0 (most-positive-fixnum)) ⇒ #t
(let ([x 3]) (fx<= 0 x 9)) ⇒ #t
(fx<= 0 3 3) ⇒ #t
(fx>= 0 0 (most-negative-fixnum)) ⇒ #t</code></pre>
</div>
</div>
<div id="numeric:s16" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxnonpositive? <em>fixnum</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>fixnum</em></code> is not greater than zero, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxnonnegative? <em>fixnum</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>fixnum</em></code> is not less than zero, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>fxnonpositive?</code> is equivalent to <code>(lambda (x) (fx&lt;= x 0))</code>, and <code>fxnonnegative?</code> is equivalent to <code>(lambda (x) (fx&gt;= x 0))</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fxnonpositive? 128) ⇒ #f
(fxnonpositive? 0) ⇒ #t
(fxnonpositive? -1) ⇒ #t

(fxnonnegative? -65) ⇒ #f
(fxnonnegative? 0) ⇒ #t
(fxnonnegative? 1) ⇒ #t</code></pre>
</div>
</div>
<div id="numeric:s17" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fx+ <em>fixnum</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the sum of the arguments <code><em>fixnum</em> ...</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When called with no arguments, <code>fx+</code> returns <code>0</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fx+) ⇒ 0
(fx+ 1 2) ⇒ 3
(fx+ 3 4 5) ⇒ 12
(apply fx+ '(1 2 3 4 5)) ⇒ 15</code></pre>
</div>
</div>
<div id="numeric:s18" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fx- <em>fixnum<sub>1</sub></em> <em>fixnum<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a fixnum</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When called with one argument, <code>fx-</code> returns the negative of <code><em>fixnum<sub>1</sub></em></code>. Thus, <code>(fx- <em>fixnum<sub>1</sub></em>)</code> is an idiom for <code>(fx- 0 <em>fixnum<sub>1</sub></em>)</code>.</p>
</div>
<div class="paragraph">
<p>When called with two or more arguments, <code>fx-</code> returns the result of subtracting the sum of the numbers <code><em>fixnum<sub>2</sub></em> ...</code> from <code><em>fixnum<sub>1</sub></em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fx- 3) ⇒ -3
(fx- 4 3) ⇒ 1
(fx- 4 3 2 1) ⇒ -2</code></pre>
</div>
</div>
<div id="numeric:s19" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fx* <em>fixnum</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the product of the arguments <code><em>fixnum</em> ...</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When called with no arguments, <code>fx*</code> returns <code>1</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fx*) ⇒ 1
(fx* 1 2) ⇒ 2
(fx* 3 -4 5) ⇒ -60
(apply fx* '(1 -2 3 -4 5)) ⇒ 120</code></pre>
</div>
</div>
<div id="numeric:s20" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fx/ <em>fixnum<sub>1</sub></em> <em>fixnum<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see explanation</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When called with one argument, <code>fx/</code> returns the reciprocal of <code><em>fixnum<sub>1</sub></em></code>. That is, <code>(fx/ <em>fixnum<sub>1</sub></em>)</code> is an idiom for <code>(fx/ 1 <em>fixnum<sub>1</sub></em>)</code>.</p>
</div>
<div class="paragraph">
<p>When called with two or more arguments, <code>fx/</code> returns the result of dividing <code><em>fixnum<sub>1</sub></em></code> by the product of the remaining arguments <code><em>fixnum<sub>2</sub></em> ...</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fx/ 1) ⇒ 1
(fx/ -17) ⇒ 0
(fx/ 8 -2) ⇒ -4
(fx/ -9 2) ⇒ -4
(fx/ 60 5 3 2) ⇒ 2</code></pre>
</div>
</div>
<div id="numeric:s21" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fx1+ <em>fixnum</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fx1- <em>fixnum</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code><em>fixnum</em></code> plus 1 or <code><em>fixnum</em></code> minus 1</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define fxplus
  (lambda (x y)
    (if (fxzero? x)
        y
        (fxplus (fx1- x) (fx1+ y)))))

(fxplus 7 8) ⇒ 15</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>fx1+</code> and <code>fx1-</code> can be defined as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define fx1+ (lambda (x) (fx+ x 1)))
(define fx1- (lambda (x) (fx- x 1)))</code></pre>
</div>
</div>
<div id="numeric:s22" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxquotient <em>fixnum<sub>1</sub></em> <em>fixnum<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see explanation</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>fxquotient</code> is identical to <code>fx/</code>. See the description of <code>fx/</code> above.</p>
</div>
<div id="numeric:s23" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxremainder <em>fixnum<sub>1</sub></em> <em>fixnum<sub>2</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the fixnum remainder of <code><em>fixnum<sub>1</sub></em></code> divided by <code><em>fixnum<sub>2</sub></em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The result of <code>fxremainder</code> has the same sign as <code><em>fixnum<sub>1</sub></em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fxremainder 16 4) ⇒ 0
(fxremainder 5 2) ⇒ 1
(fxremainder -45 7) ⇒ -3
(fxremainder 10 -3) ⇒ 1
(fxremainder -17 -9) ⇒ -8</code></pre>
</div>
</div>
<div id="numeric:s24" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxmodulo <em>fixnum<sub>1</sub></em> <em>fixnum<sub>2</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the fixnum modulus of <code><em>fixnum<sub>1</sub></em></code> and <code><em>fixnum<sub>2</sub></em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The result of <code>fxmodulo</code> has the same sign as <code><em>fixnum<sub>2</sub></em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fxmodulo 16 4) ⇒ 0
(fxmodulo 5 2) ⇒ 1
(fxmodulo -45 7) ⇒ 4
(fxmodulo 10 -3) ⇒ -2
(fxmodulo -17 -9) ⇒ -8</code></pre>
</div>
</div>
<div id="numeric:s25" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxabs <em>fixnum</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the absolute value of <code><em>fixnum</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fxabs 1) ⇒ 1
(fxabs -1) ⇒ 1
(fxabs 0) ⇒ 0</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_8.3.">Section 8.3. Flonum Operations</h3>
<div class="paragraph">
<p>Inexact real numbers are normally represented by <code><em>flonums</em></code>. A flonum is a single 64-bit double-precision floating point number. This section describes operations on flonums, most of which accept flonum arguments and return flonum values. In most cases, the operations are inline-coded or coded as machine language subroutines at optimize-level 3 with no argument type checking; full type checking is performed at lower optimize levels. Flonum-specific procedure names begin with the prefix &#8220;fl&#8221; to set them apart from their generic counterparts.</p>
</div>
<div class="paragraph">
<p>Inexact real numbers may also be represented by inexact complexnums with imaginary parts equal to zero, which cannot be used as input to the flonum-specific operators. Such numbers are produced, however, only from operations involving complex numbers with nonzero imaginary parts, by explicit calls to <code>fl-make-rectangular</code>, <code>make-rectangular</code>, or <code>make-polar</code>, or by numeric input in either polar or rectangular format.</p>
</div>
<div id="numeric:s26" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(flonum-&gt;fixnum <em>flonum</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the fixnum representation of <code><em>flonum</em></code>, truncated</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The truncated value of <code><em>flonum</em></code> must fall within the fixnum range. <code>flonum-&gt;fixnum</code> is a restricted version of <code>exact</code>, which converts any numeric representation to its exact equivalent.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(flonum->fixnum 0.0) ⇒ 0
(flonum->fixnum 3.9) ⇒ 3
(flonum->fixnum -2.2) ⇒ -2</code></pre>
</div>
</div>
<div id="numeric:s28" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fl= <em>flonum<sub>1</sub></em> <em>flonum<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fl&lt; <em>flonum<sub>1</sub></em> <em>flonum<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fl&gt; <em>flonum<sub>1</sub></em> <em>flonum<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fl&lt;= <em>flonum<sub>1</sub></em> <em>flonum<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fl&gt;= <em>flonum<sub>1</sub></em> <em>flonum<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the relation holds, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The predicate <code>fl=</code> returns <code>#t</code> if its arguments are equal. The predicate <code>fl&lt;</code> returns <code>#t</code> if its arguments are monotonically increasing, i.e., each argument is greater than the preceding ones, while <code>fl&gt;</code> returns <code>#t</code> if its arguments are monotonically decreasing. The predicate <code>fl&lt;=</code> returns <code>#t</code> if its arguments are monotonically nondecreasing, i.e., each argument is not less than the preceding ones, while <code>fl&gt;=</code> returns <code>#t</code> if its arguments are monotonically nonincreasing. When passed only one argument, each of these predicates returns <code>#t</code>.</p>
</div>
<div class="paragraph">
<p>IEEE NANs are not comparable, i.e., comparisons involving NANs always return <code>#f</code>.</p>
</div>
<div class="paragraph">
<p>These procedures are similar to the Revised<sup>6</sup> Report procedures <code>fl=?</code>, <code>fl&lt;?</code>, <code>fl&gt;?</code>, <code>fl&lt;=?</code>, and <code>fl&gt;=?</code> except that the Revised<sup>6</sup> Report procedures require two or more arguments, and their names have the &#8220;?&#8221; suffix.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fl= 0.0) ⇒ #t
(fl= 0.0 0.0) ⇒ #t
(fl< -1.0 0.0 1.0) ⇒ #t
(fl> -1.0 0.0 1.0) ⇒ #f
(fl<= 0.0 3.0 3.0) ⇒ #t
(fl>= 4.0 3.0 3.0) ⇒ #t
(fl< 7.0 +inf.0) ⇒ #t
(fl= +nan.0 0.0) ⇒ #f
(fl= +nan.0 +nan.0) ⇒ #f
(fl< +nan.0 +nan.0) ⇒ #f
(fl> +nan.0 +nan.0) ⇒ #f</code></pre>
</div>
</div>
<div id="numeric:s29" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(flnonpositive? <em>fl</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>fl</em></code> is not greater than zero, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(flnonnegative? <em>fl</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>fl</em></code> is not less than zero, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>flnonpositive?</code> is equivalent to <code>(lambda (x) (fl&lt;= x 0.0))</code>, and <code>flnonnegative?</code> is equivalent to <code>(lambda (x) (fl&gt;= x 0.0))</code>.</p>
</div>
<div class="paragraph">
<p>Even if the flonum representation distinguishes -0.0 from +0.0, both are considered nonpositive and nonnegative.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(flnonpositive? 128.0) ⇒ #f
(flnonpositive? 0.0) ⇒ #t
(flnonpositive? -0.0) ⇒ #t
(flnonpositive? -1.0) ⇒ #t

(flnonnegative? -65.0) ⇒ #f
(flnonnegative? 0.0) ⇒ #t
(flnonnegative? -0.0) ⇒ #t
(flnonnegative? 1.0) ⇒ #t

(flnonnegative? +nan.0) ⇒ #f
(flnonpositive? +nan.0) ⇒ #f

(flnonnegative? +inf.0) ⇒ #t
(flnonnegative? -inf.0) ⇒ #f</code></pre>
</div>
</div>
<div id="numeric:s30" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(decode-float <em>x</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>x</em></code> must be a flonum. <code>decode-float</code> returns a vector with three integer elements, <code><em>m</em></code>, <code><em>e</em></code>, and <code><em>s</em></code>, such that <em>x</em> = <em>sm</em>2<sup>e</sup>. It is useful primarily in the printing of floating-point numbers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(decode-float 1.0) ⇒ #(4503599627370496 -52 1)
(decode-float -1.0) ⇒ #(4503599627370496 -52 -1)

(define slow-identity
  (lambda (x)
    (inexact
      (let ([v (decode-float x)])
        (let ([m (vector-ref v 0)]
              [e (vector-ref v 1)]
              [s (vector-ref v 2)])
          (* s m (expt 2 e)))))))

(slow-identity 1.0) ⇒ 1.0
(slow-identity -1e20) ⇒ -1e20</code></pre>
</div>
</div>
<div id="numeric:s31" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fllp <em>flonum</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>fllp</code> returns the 12-bit integer consisting of the exponent plus highest order represented bit of a flonum (ieee 64-bit floating-point number). It can be used to compute a fast approximation of the logarithm of the number.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fllp 0.0) ⇒ 0
(fllp 1.0) ⇒ 2046
(fllp -1.0) ⇒ 2046

(fllp 1.5) ⇒ 2047

(fllp +inf.0) ⇒ 4094
(fllp -inf.0) ⇒ 4094

(fllp #b1.0e-1111111111) ⇒ 1
(fllp #b1.0e-10000000000) ⇒ 0</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_8.4.">Section 8.4. Inexact Complex Operations</h3>
<div class="paragraph">
<p>The procedures described in this section provide mechanisms for creating and operating on inexact complex numbers. Inexact complex numbers with nonzero imaginary parts are represented as <em>inexact complexnums</em>. An inexact complexnum contains two 64-bit double-precision floating point numbers. Inexact complex numbers with imaginary parts equal to zero (in other words, inexact real numbers) may be represented as either inexact complexnums or flonums. The operations described in this section accept any mix of inexact complexnum and flonum arguments (collectively, "cflonums").</p>
</div>
<div class="paragraph">
<p>In most cases, the operations are performed with minimal type checking at optimize-level 3; full type checking is performed at lower optimize levels. Inexact complex procedure names begin with the prefix "<code>cfl</code>" to set them apart from their generic counterparts.</p>
</div>
<div id="numeric:s35" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fl-make-rectangular <em>flonum<sub>1</sub></em> <em>flonum<sub>2</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>an inexact complexnum</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The inexact complexnum produced by fl-make-rectangular has real part equal to <code><em>flonum<sub>1</sub></em></code> and imaginary part equal to <code><em>flonum<sub>2</sub></em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fl-make-rectangular 2.0 -3.0) ⇒ 2.0-3.0i
(fl-make-rectangular 2.0 0.0) ⇒ 2.0+0.0i
(fl-make-rectangular 2.0 -0.0) ⇒ 2.0-0.0i</code></pre>
</div>
</div>
<div id="numeric:s36" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(cfl-real-part <em>cflonum</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the real part of <code><em>cflonum</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(cfl-imag-part <em>cflonum</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the imaginary part of <code><em>cflonum</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(cfl-real-part 2.0-3.0i) ⇒ 2.0
(cfl-imag-part 2.0-3.0i) ⇒ -3.0
(cfl-imag-part 2.0-0.0i) ⇒ -0.0
(cfl-imag-part 2.0-inf.0i) ⇒ -inf.0</code></pre>
</div>
</div>
<div id="numeric:s37" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(cfl= <em>cflonum</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if its arguments are equal, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(cfl= 7.0+0.0i 7.0) ⇒ #t
(cfl= 1.0+2.0i 1.0+2.0i) ⇒ #t
(cfl= 1.0+2.0i 1.0-2.0i) ⇒ #f</code></pre>
</div>
</div>
<div id="numeric:s38" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(cfl+ <em>cflonum</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(cfl* <em>cflonum</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(cfl- <em>cflonum<sub>1</sub></em> <em>cflonum<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(cfl/ <em>cflonum<sub>1</sub></em> <em>cflonum<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a cflonum</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These procedures compute the sum, difference, product, or quotient of inexact complex quantities, whether these quantities are represented by flonums or inexact complexnums. For example, if <code>cfl+</code> receives two flonum arguments <em>a</em> and <em>b</em>, it returns the sum <em>a</em> + <em>b</em>; in this case, it behaves the same as <code>fl+</code>. With two inexact complexnum arguments <em>a</em> + <em>bi</em> and <em>c</em> + <em>di</em>, it returns the sum (<em>a</em> + <em>c</em>) + (<em>b</em> + <em>d</em>)<em>i</em>. If one argument is a flonum <em>a</em> and the other an inexact complexnum <em>c</em> + <em>di</em>, <code>cfl+</code> returns (<em>a</em> + <em>c</em>) + <em>di</em>.</p>
</div>
<div class="paragraph">
<p>When passed zero arguments, <code>cfl+</code> returns 0.0 and <code>cfl*</code> returns 1.0. When passed one argument, <code>cfl-</code> returns the additive inverse of the argument, and <code>cfl/</code> returns the multiplicative inverse of the argument. When passed three or more arguments, <code>cfl-</code> returns the difference between its first and the sum of its remaining arguments, and <code>cfl/</code> returns the quotient of its first and the product of its remaining arguments.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(cfl+) ⇒ 0.0
(cfl*) ⇒ 1.0
(cfl- 5.0+1.0i) ⇒ -5.0-1.0i
(cfl/ 2.0+2.0i) ⇒ 0.25-0.25i

(cfl+ 1.0+2.2i -3.7+5.3i) ⇒ -2.7+7.5i
(cfl+ 1.0 -5.3) ⇒ -4.3
(cfl+ 1.0 2.0 -5.3i) ⇒ 3.0-5.3i
(cfl- 1.0+2.5i -3.7) ⇒ 4.7+2.5i
(cfl* 1.0+2.0i 3.0+4.0i) ⇒ -5.0+10.0i
(cfl/ -5.0+10.0i 1.0+2.0i 2.0) ⇒ 1.5+2.0i</code></pre>
</div>
</div>
<div id="numeric:s39" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(cfl-conjugate <em>cflonum</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>complex conjugate of <code><em>cflonum</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The procedure <code>cfl-conjugate</code>, when passed an inexact complex argument <em>a</em> + <em>bi</em>, returns its complex conjugate <em>a</em> + (-<em>b</em>)<em>i</em>.</p>
</div>
<div class="paragraph">
<p>See also <code>conjugate</code>, which is a generic version of this operator that returns the complex conjugate of any valid representation for a complex number.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(cfl-conjugate 3.0) ⇒ 3.0
(cfl-conjugate 3.0+4.0i) ⇒ 3.0-4.0i
(cfl-conjugate 1e-20-2e-30i) ⇒ 1e-20+2e-30i</code></pre>
</div>
</div>
<div id="numeric:s41" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(cfl-magnitude-squared <em>cflonum</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>magnitude of <code><em>cflonum</em></code> squared</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The procedure <code>cfl-magnitude-squared</code>, when passed an inexact complex argument <em>a</em> + <em>bi</em> returns a flonum representing the magnitude of the argument squared, i.e., <em>a</em><sup>2</sup> + <em>b</em><sup>2</sup>.</p>
</div>
<div class="paragraph">
<p>See also <code>magnitude-squared</code>, which is a generic version of this operator that returns the magnitude squared of any valid representation for a complex number. Both operations are similar to the <code>magnitude</code> procedure, which returns the magnitude, <em>sqrt</em>(<em>a</em><sup>2</sup> + <em>b</em><sup>2</sup>), of its generic complex argument.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(cfl-magnitude-squared 3.0) ⇒ 9.0
(cfl-magnitude-squared 3.0-4.0i) ⇒ 25.0</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_8.5.">Section 8.5. Bitwise and Logical Operators</h3>
<div class="paragraph">
<p><em>Chez Scheme</em> provides a set of logical operators that allow exact integers (fixnums and bignums) to be treated as sets or sequences of bits. These operators include <code>logand</code> (bitwise logical <code>and</code>), <code>logior</code> (bitwise logical <code>or</code>), <code>logxor</code> (bitwise logical exclusive <code>or</code>), <code>lognot</code> (bitwise logical <code>not</code>), <code>logtest</code> (test multiple bits), <code>logbit?</code> (test single bit), <code>logbit0</code> (reset single bit), <code>logbit1</code> (set single bit), and <code>ash</code> (arithmetic shift). Each of these operators treats its arguments as two&#8217;s complement integers, regardless of the underlying representation. This treatment can be exploited to represent infinite sets: a negative number represents an infinite number of one bits beyond the leftmost zero, and a nonnegative number represents an infinite number of zero bits beyond the leftmost one bit.</p>
</div>
<div class="paragraph">
<p>Fixnum equivalents of the logical operators are provided, as <code>fxlogand</code>, <code>fxlogior</code>, <code>fxlogxor</code>, <code>fxlognot</code>, <code>fxlogtest</code>, <code>fxlogbit?</code>, <code>fxlogbit0</code>, and <code>fxlogbit1</code>. Three separate fixnum operators are provided for shifting: <code>fxsll</code> (shift-left logical), <code>fxsrl</code> (shift-right logical), <code>fxsra</code> (shift-right arithmetic). Logical and arithmetic shifts differ only for right shifts. Shift-right logical shifts in zero bits on the left end, and shift-right arithmetic replicates the sign bit.</p>
</div>
<div class="paragraph">
<p>Logical shifts do not make sense for arbitrary-precision integers, since these have no "left end" into which bits must be shifted.</p>
</div>
<div id="numeric:s44" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(logand <em>int</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the logical "and" of the arguments <code><em>int</em> ...</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The arguments must be exact integers (fixnums or bignums) and are treated as two&#8217;s complement integers, regardless of the underlying representation. With no arguments, <code>logand</code> returns -1, i.e., all bits set.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(logand) ⇒ -1
(logand 15) ⇒ 15
(logand -1 -1) ⇒ -1
(logand -1 0) ⇒ 0
(logand 5 3) ⇒ 1
(logand #x173C8D95 7) ⇒ 5
(logand #x173C8D95 -8) ⇒ #x173C8D90
(logand #b1100 #b1111 #b1101) ⇒ #b1100</code></pre>
</div>
</div>
<div id="numeric:s45" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(logior <em>int</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(logor <em>int</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the logical "or" of the arguments <code><em>int</em> ...</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The arguments must be exact integers (fixnums or bignums) and are treated as two&#8217;s complement integers, regardless of the underlying representation. With no arguments, <code>logior</code> returns 0, i.e., all bits reset.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(logior) ⇒ 0
(logior 15) ⇒ 15
(logior -1 -1) ⇒ -1
(logior -1 0) ⇒ -1
(logior 5 3) ⇒ 7
(logior #b111000 #b101010) ⇒ #b111010
(logior #b1000 #b0100 #b0010) ⇒ #b1110
(apply logior '(1 2 4 8 16)) ⇒ 31</code></pre>
</div>
</div>
<div id="numeric:s46" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(logxor <em>int</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the logical "exclusive or" of the arguments <code><em>int</em> ...</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The arguments must be exact integers (fixnums or bignums) and are treated as two&#8217;s complement integers, regardless of the underlying representation. With no arguments, <code>logxor</code> returns 0, i.e., all bits reset.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(logxor) ⇒ 0
(logxor 15) ⇒ 15
(logxor -1 -1) ⇒ 0
(logxor -1 0) ⇒ -1
(logxor 5 3) ⇒ 6
(logxor #b111000 #b101010) ⇒ #b010010
(logxor #b1100 #b0100 #b0110) ⇒ #b1110</code></pre>
</div>
</div>
<div id="numeric:s47" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(lognot <em>int</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the logical "not" of <code><em>int</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The argument must be an exact integer (fixnum or bignum) and is treated as a two&#8217;s complement integer, regardless of the underlying representation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(lognot -1) ⇒ 0
(lognot 0) ⇒ -1
(lognot 7) ⇒ -8
(lognot -8) ⇒ 7</code></pre>
</div>
</div>
<div id="numeric:s48" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(logbit? <em>index</em> <em>int</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the specified bit is set, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>index</em></code> must be a nonnegative exact integer. <code><em>int</em></code> must be an exact integer (fixnum or bignum) and is treated as a two&#8217;s complement integer, regardless of the underlying representation.</p>
</div>
<div class="paragraph">
<p><code>logbit?</code> returns <code>#t</code> if the bit at index <code><em>index</em></code> of <code><em>int</em></code> is set (one) and <code>#f</code> otherwise. The index is zero-based, counting from the lowest-order toward higher-order bits. There is no upper limit on the index; for nonnegative values of <code><em>int</em></code>, the bits above the highest order set bit are all considered to be zero, and for negative values, the bits above the highest order reset bit are all considered to be one.</p>
</div>
<div class="paragraph">
<p><code>logbit?</code> is equivalent to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(lambda (k n) (not (zero? (logand n (ash 1 k)))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>but more efficient.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(logbit? 0 #b1110) ⇒ #f
(logbit? 1 #b1110) ⇒ #t
(logbit? 2 #b1110) ⇒ #t
(logbit? 3 #b1110) ⇒ #t
(logbit? 4 #b1110) ⇒ #f
(logbit? 100 #b1110) ⇒ #f

(logbit? 0 -6) ⇒ #f  ; <em>the two's complement of</em> -6 <em>is</em> 1...1010
(logbit? 1 -6) ⇒ #t
(logbit? 2 -6) ⇒ #f
(logbit? 3 -6) ⇒ #t
(logbit? 100 -6) ⇒ #t

(logbit? (random 1000000) 0) ⇒ #f
(logbit? (random 1000000) -1) ⇒ #t

(logbit? 20000 (ash 1 20000)) ⇒ #t</code></pre>
</div>
</div>
<div id="numeric:s49" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(logtest <em>int<sub>1</sub></em> <em>int<sub>2</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if any common bits are set, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The arguments must be exact integers (fixnums or bignums) and are treated as two&#8217;s complement integers, regardless of the underlying representation.</p>
</div>
<div class="paragraph">
<p><code>logtest</code> returns <code>#t</code> if any bit set in one argument is also set in the other. It returns <code>#f</code> if the two arguments have no set bits in common.</p>
</div>
<div class="paragraph">
<p><code>logtest</code> is equivalent to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(lambda (n1 n2) (not (zero? (logand n1 n2))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>but more efficient.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(logtest #b10001 #b1110) ⇒ #f
(logtest #b10101 #b1110) ⇒ #t
(logtest #b111000 #b110111) ⇒ #t

(logtest #b101 -6) ⇒ #f  ; <em>the two's complement of</em> -6 <em>is</em> 1...1010
(logtest #b1000 -6) ⇒ #t
(logtest 100 -6) ⇒ #t

(logtest (+ (random 1000000) 1) 0) ⇒ #f
(logtest (+ (random 1000000) 1) -1) ⇒ #t

(logtest (ash #b101 20000) (ash #b111 20000)) ⇒ #t</code></pre>
</div>
</div>
<div id="numeric:s50" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(logbit0 <em>index</em> <em>int</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the result of clearing bit <code><em>index</em></code> of <code><em>int</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>index</em></code> must be a nonnegative exact integer. <code><em>int</em></code> must be an exact integer (fixnum or bignum) and is treated as a two&#8217;s complement integer, regardless of the underlying representation.</p>
</div>
<div class="paragraph">
<p>The index is zero-based, counting from the lowest-order toward higher-order bits. As with <code>logbit?</code>, there is no upper limit on the index.</p>
</div>
<div class="paragraph">
<p><code>logbit0</code> is equivalent to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(lambda (i n) (logand (lognot (ash 1 i)) n))</code></pre>
</div>
</div>
<div class="paragraph">
<p>but more efficient.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(logbit0 3 #b10101010) ⇒ #b10100010
(logbit0 4 #b10101010) ⇒ #b10101010
(logbit0 0 -1) ⇒ -2</code></pre>
</div>
</div>
<div id="numeric:s51" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(logbit1 <em>index</em> <em>int</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the result of setting bit <code><em>index</em></code> of <code><em>int</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>index</em></code> must be a nonnegative exact integer. <code><em>int</em></code> must be an exact integer (fixnum or bignum) and is treated as a two&#8217;s complement integer, regardless of the underlying representation.</p>
</div>
<div class="paragraph">
<p>The index is zero-based, counting from the lowest-order toward higher-order bits. As with <code>logbit?</code>, there is no upper limit on the index.</p>
</div>
<div class="paragraph">
<p><code>logbit1</code> is equivalent to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(lambda (i n) (logor (ash 1 i) n))</code></pre>
</div>
</div>
<div class="paragraph">
<p>but more efficient.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(logbit1 3 #b10101010) ⇒ #b10101010
(logbit1 4 #b10101010) ⇒ #b10111010
(logbit1 4 0) ⇒ #b10000
(logbit1 0 -2) ⇒ -1</code></pre>
</div>
</div>
<div id="numeric:s52" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(ash <em>int</em> <em>count</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code><em>int</em></code> shifted left arithmetically by <code><em>count</em></code>.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Both arguments must be exact integers. The first argument is treated as a two&#8217;s complement integer, regardless of the underlying representation. If <code><em>count</em></code> is negative, <code><em>int</em></code> is shifted right by -<code><em>count</em></code> bits.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(ash 8 0) ⇒ 8
(ash 8 2) ⇒ 32
(ash 8 -2) ⇒ 2
(ash -1 2) ⇒ -4
(ash -1 -2) ⇒ -1</code></pre>
</div>
</div>
<div id="numeric:s53" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxlogand <em>fixnum</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the logical "and" of the arguments <code><em>fixnum</em> ...</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The arguments are treated as two&#8217;s complement integers, regardless of the underlying representation. With no arguments, <code>fxlogand</code> returns -1, i.e., all bits set.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fxlogand) ⇒ -1
(fxlogand 15) ⇒ 15
(fxlogand -1 -1) ⇒ -1
(fxlogand -1 0) ⇒ 0
(fxlogand 5 3) ⇒ 1
(fxlogand #b111000 #b101010) ⇒ #b101000
(fxlogand #b1100 #b1111 #b1101) ⇒ #b1100</code></pre>
</div>
</div>
<div id="numeric:s54" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxlogior <em>fixnum</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxlogor <em>fixnum</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the logical "or" of the arguments <code><em>fixnum</em> ...</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The arguments are treated as two&#8217;s complement integers, regardless of the underlying representation. With no arguments, <code>fxlogior</code> returns 0, i.e., all bits reset.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fxlogior) ⇒ 0
(fxlogior 15) ⇒ 15
(fxlogior -1 -1) ⇒ -1
(fxlogior -1 0) ⇒ -1
(fxlogior #b111000 #b101010) ⇒ #b111010
(fxlogior #b1000 #b0100 #b0010) ⇒ #b1110
(apply fxlogior '(1 2 4 8 16)) ⇒ 31</code></pre>
</div>
</div>
<div id="numeric:s55" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxlogxor <em>fixnum</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the logical "exclusive or" of the arguments <code><em>fixnum</em> ...</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The arguments are treated as two&#8217;s complement integers, regardless of the underlying representation. With no arguments, <code>fxlogxor</code> returns 0, i.e., all bits reset.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fxlogxor) ⇒ 0
(fxlogxor 15) ⇒ 15
(fxlogxor -1 -1) ⇒ 0
(fxlogxor -1 0) ⇒ -1
(fxlogxor 5 3) ⇒ 6
(fxlogxor #b111000 #b101010) ⇒ #b010010
(fxlogxor #b1100 #b0100 #b0110) ⇒ #b1110</code></pre>
</div>
</div>
<div id="numeric:s56" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxlognot <em>fixnum</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the logical "not" of <code><em>fixnum</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The argument is treated as a two&#8217;s complement integer, regardless of the underlying representation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fxlognot -1) ⇒ 0
(fxlognot 0) ⇒ -1
(fxlognot 1) ⇒ -2
(fxlognot -2) ⇒ 1</code></pre>
</div>
</div>
<div id="numeric:s57" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxlogbit? <em>index</em> <em>fixnum</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the specified bit is set, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>index</em></code> must be a nonnegative fixnum. <code><em>fixnum</em></code> is treated as a two&#8217;s complement integer, regardless of the underlying representation.</p>
</div>
<div class="paragraph">
<p><code>fxlogbit?</code> returns <code>#t</code> if the bit at index <code><em>index</em></code> of <code><em>fixnum</em></code> is set (one) and <code>#f</code> otherwise. The index is zero-based, counting from the lowest-order toward higher-order bits. The index is limited only by the fixnum range; for nonnegative values of <code><em>fixnum</em></code>, the bits above the highest order set bit are all considered to be zero, and for negative values, the bits above the highest order reset bit are all considered to be one.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fxlogbit? 0 #b1110) ⇒ #f
(fxlogbit? 1 #b1110) ⇒ #t
(fxlogbit? 2 #b1110) ⇒ #t
(fxlogbit? 3 #b1110) ⇒ #t
(fxlogbit? 4 #b1110) ⇒ #f
(fxlogbit? 100 #b1110) ⇒ #f

(fxlogbit? 0 -6) ⇒ #f  ; <em>the two's complement of</em> -6 <em>is</em> 1...1010
(fxlogbit? 1 -6) ⇒ #t
(fxlogbit? 2 -6) ⇒ #f
(fxlogbit? 3 -6) ⇒ #t
(fxlogbit? 100 -6) ⇒ #t

(fxlogbit? (random 1000000) 0) ⇒ #f
(fxlogbit? (random 1000000) -1) ⇒ #t</code></pre>
</div>
</div>
<div id="numeric:s58" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxlogtest <em>fixnum<sub>1</sub></em> <em>fixnum<sub>2</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if any common bits are set, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The arguments are treated as two&#8217;s complement integers, regardless of the underlying representation.</p>
</div>
<div class="paragraph">
<p><code>fxlogtest</code> returns <code>#t</code> if any bit set in one argument is also set in the other. It returns <code>#f</code> if the two arguments have no set bits in common.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fxlogtest #b10001 #b1110) ⇒ #f
(fxlogtest #b10101 #b1110) ⇒ #t
(fxlogtest #b111000 #b110111) ⇒ #t

(fxlogtest #b101 -6) ⇒ #f  ; <em>the two's complement of</em> -6 <em>is</em> 1...1010
(fxlogtest #b1000 -6) ⇒ #t
(fxlogtest 100 -6) ⇒ #t

(fxlogtest (+ (random 1000000) 1) 0) ⇒ #f
(fxlogtest (+ (random 1000000) 1) -1) ⇒ #t</code></pre>
</div>
</div>
<div id="numeric:s59" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxlogbit0 <em>index</em> <em>fixnum</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the result of clearing bit <code><em>index</em></code> of <code><em>fixnum</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>fixnum</em></code> is treated as a two&#8217;s complement integer, regardless of the underlying representation. <code><em>index</em></code> must be nonnegative and less than the number of bits in a fixnum, excluding the sign bit, i.e., less than <code>(integer-length (most-positive-fixnum))</code>. The index is zero-based, counting from the lowest-order toward higher-order bits.</p>
</div>
<div class="paragraph">
<p><code>fxlogbit0</code> is equivalent to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(lambda (i n) (fxlogand (fxlognot (fxsll 1 i)) n))</code></pre>
</div>
</div>
<div class="paragraph">
<p>but more efficient.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fxlogbit0 3 #b10101010) ⇒ #b10100010
(fxlogbit0 4 #b10101010) ⇒ #b10101010
(fxlogbit0 0 -1) ⇒ -2</code></pre>
</div>
</div>
<div id="numeric:s60" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxlogbit1 <em>index</em> <em>fixnum</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the result of setting bit <code><em>index</em></code> of <code><em>fixnum</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>fixnum</em></code> is treated as a two&#8217;s complement integer, regardless of the underlying representation. <code><em>index</em></code> must be nonnegative and less than the number of bits in a fixnum, excluding the sign bit, i.e., less than <code>(integer-length (most-positive-fixnum))</code>. The index is zero-based, counting from the lowest-order toward higher-order bits.</p>
</div>
<div class="paragraph">
<p><code>fxlogbit1</code> is equivalent to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(lambda (i n) (fxlogor (fxsll 1 i) n))</code></pre>
</div>
</div>
<div class="paragraph">
<p>but more efficient.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fxlogbit1 3 #b10101010) ⇒ #b10101010
(fxlogbit1 4 #b10101010) ⇒ #b10111010
(fxlogbit1 4 0) ⇒ #b10000
(fxlogbit1 0 -2) ⇒ -1</code></pre>
</div>
</div>
<div id="numeric:s61" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxsll <em>fixnum</em> <em>count</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code><em>fixnum</em></code> shifted left by <code><em>count</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>fixnum</em></code> is treated as a two&#8217;s complement integer, regardless of the underlying representation. <code><em>count</em></code> must be nonnegative and not more than the number of bits in a fixnum, i.e., <code>(+ (integer-length (most-positive-fixnum)) 1)</code>. An exception is raised with condition-type <code>&amp;implementation-restriction</code> if the result cannot be represented as a fixnum.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fxsll 1 2) ⇒ 4
(fxsll -1 2) ⇒ -4</code></pre>
</div>
</div>
<div id="numeric:s62" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxsrl <em>fixnum</em> <em>count</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code><em>fixnum</em></code> logically shifted right by <code><em>count</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>fixnum</em></code> is treated as a two&#8217;s complement integer, regardless of the underlying representation. <code><em>count</em></code> must be nonnegative and not more than the number of bits in a fixnum, i.e., <code>(+ (integer-length (most-positive-fixnum)) 1)</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fxsrl 4 2) ⇒ 1
(= (fxsrl -1 1) (most-positive-fixnum)) ⇒ #t</code></pre>
</div>
</div>
<div id="numeric:s63" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fxsra <em>fixnum</em> <em>count</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code><em>fixnum</em></code> arithmetically shifted right by <code><em>count</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>fixnum</em></code> is treated as a two&#8217;s complement integer, regardless of the underlying representation. <code><em>count</em></code> must be nonnegative and not more than the number of bits in a fixnum, i.e., <code>(+ (integer-length (most-positive-fixnum)) 1)</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fxsra 64 3) ⇒ 8
(fxsra -1 1) ⇒ -1
(fxsra -64 3) ⇒ -8</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_8.6.">Section 8.6. Random Number Generation</h3>
<div id="numeric:s64" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(random <em>real</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a nonnegative pseudo-random number less than <code><em>real</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>real</em></code> must be a positive integer or positive inexact real number.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(random 1) ⇒ 0
(random 1029384535235) ⇒ 1029384535001, <em>every</em> <em>now</em> <em>and</em> <em>then</em>
(random 1.0) ⇒ 0.5, <em>every</em> <em>now</em> <em>and</em> <em>then</em></code></pre>
</div>
</div>
<div id="numeric:s65" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>random-seed</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The random number generator allows the current random seed to be obtained and modified via the parameter <code>random-seed</code>.</p>
</div>
<div class="paragraph">
<p>When called without arguments, <code>random-seed</code> returns the current random seed. When called with one argument, which must be a nonnegative exact integer ranging from 1 through 2<sup>32</sup> - 1, <code>random-seed</code> sets the current random seed to the argument.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([s (random-seed)])
  (let ([r1 (random 1.0)])
    (random-seed s)
    (eqv? (random 1.0) r1))) ⇒ #t</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_8.7.">Section 8.7. Miscellaneous Numeric Operations</h3>
<div id="numeric:s67" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(= <em>num<sub>1</sub></em> <em>num<sub>2</sub></em> <em>num<sub>3</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(&lt; <em>real<sub>1</sub></em> <em>real<sub>2</sub></em> <em>real<sub>3</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(&gt; <em>real<sub>1</sub></em> <em>real<sub>2</sub></em> <em>real<sub>3</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(&lt;= <em>real<sub>1</sub></em> <em>real<sub>2</sub></em> <em>real<sub>3</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(&gt;= <em>real<sub>1</sub></em> <em>real<sub>2</sub></em> <em>real<sub>3</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the relation holds, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These predicates are identical to the Revised<sup>6</sup> Report counterparts, except they are extended to accept one or more rather than two or more arguments. When passed one argument, each of these predicates returns <code>#t</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(> 3/4) ⇒ #t
(< 3/4) ⇒ #t
(= 3/4) ⇒ #t</code></pre>
</div>
</div>
<div id="numeric:s68" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(1+ <em>num</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(add1 <em>num</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(1- <em>num</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(-1+ <em>num</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(sub1 <em>num</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code><em>num</em></code> plus 1 or <code><em>num</em></code> minus 1</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>1+</code> and <code>add1</code> are equivalent to <code>(lambda (x) (+ x 1))</code>; <code>1-</code>, <code>-1+</code>, and <code>sub1</code> are equivalent to <code>(lambda (x) (- x 1))</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define plus
 ; x should be a nonnegative integer
  (lambda (x y)
    (if (zero? x)
        y
        (plus (1- x) (1+ y)))))

(plus 7 8) ⇒ 15

(define double
 ; x should be a nonnegative integer
  (lambda (x)
    (if (zero? x)
        0
        (add1 (add1 (double (sub1 x)))))))

(double 7) ⇒ 14</code></pre>
</div>
</div>
<div id="numeric:s69" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(expt-mod <em>int<sub>1</sub></em> <em>int<sub>2</sub></em> <em>int<sub>3</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code><em>int<sub>1</sub></em></code> raised to the <code><em>int<sub>2</sub></em></code> power, modulo <code><em>int<sub>3</sub></em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>int<sub>1</sub></em></code>, <code><em>int<sub>2</sub></em></code> and <code><em>int<sub>3</sub></em></code> must be nonnegative integers. <code>expt-mod</code> performs its computation in such a way that the intermediate results are never much larger than <code><em>int<sub>3</sub></em></code>. This means that when <code><em>int<sub>2</sub></em></code> is large, <code>expt-mod</code> is more efficient than the equivalent procedure <code>(lambda (x y z) (modulo (expt x y) z))</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(expt-mod 2 4 3) ⇒ 1
(expt-mod 2 76543 76543) ⇒ 2</code></pre>
</div>
</div>
<div id="numeric:s70" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(isqrt <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the integer square root of <code><em>n</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>n</em></code> must be a nonnegative integer. The integer square root of <em>n</em> is defined to be \(\lfloor \sqrt{n} \rfloor\).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(isqrt 0) ⇒ 0
(isqrt 16) ⇒ 4
(isqrt 16.0) ⇒ 4.0
(isqrt 20) ⇒ 4
(isqrt 20.0) ⇒ 4.0
(isqrt (* 2 (expt 10 20))) ⇒ 14142135623</code></pre>
</div>
</div>
<div id="numeric:s71" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(integer-length <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The procedure <code>integer-length</code> returns the length in bits of the smallest two&#8217;s complement representation for <code><em>n</em></code>, with an assumed leading 1 (sign) bit for negative numbers. For zero, <code>integer-length</code> returns 0.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(integer-length 0) ⇒ 0
(integer-length 1) ⇒ 1
(integer-length 2) ⇒ 2
(integer-length 3) ⇒ 2
(integer-length 4) ⇒ 3
(integer-length #b10000000) ⇒ 8
(integer-length #b11111111) ⇒ 8
(integer-length -1) ⇒ 0
(integer-length -2) ⇒ 1
(integer-length -3) ⇒ 2
(integer-length -4) ⇒ 2</code></pre>
</div>
</div>
<div id="numeric:s72" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(nonpositive? <em>real</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>real</em></code> is not greater than zero, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>nonpositive?</code> is equivalent to <code>(lambda (x) (&lt;= x 0))</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(nonpositive? 128) ⇒ #f
(nonpositive? 0.0) ⇒ #t
(nonpositive? 1.8e-15) ⇒ #f
(nonpositive? -2/3) ⇒ #t</code></pre>
</div>
</div>
<div id="numeric:s73" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(nonnegative? <em>real</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>real</em></code> is not less than zero, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>nonnegative?</code> is equivalent to <code>(lambda (x) (&gt;= x 0))</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(nonnegative? -65) ⇒ #f
(nonnegative? 0) ⇒ #t
(nonnegative? -0.0121) ⇒ #f
(nonnegative? 15/16) ⇒ #t</code></pre>
</div>
</div>
<div id="numeric:s74" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(conjugate <em>num</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>complex conjugate of <code><em>num</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The procedure <code>conjugate</code>, when passed a complex argument <em>a</em> + <em>bi</em>, returns its complex conjugate <em>a</em> + (-<em>b</em>)<em>i</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(conjugate 3.0+4.0i) ⇒ 3.0-4.0i
(conjugate 1e-20-2e-30i) ⇒ 1e-20+2e-30i
(conjugate 3) ⇒ 3</code></pre>
</div>
</div>
<div id="numeric:s75" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(magnitude-squared <em>num</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>magnitude of <code><em>num</em></code> squared</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The procedure <code>magnitude-squared</code>, when passed a complex argument <em>a</em> + <em>bi</em> returns its magnitude squared, i.e., <em>a</em><sup>2</sup> + <em>b</em><sup>2</sup>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(magnitude-squared 3.0-4.0i) ⇒ 25.0
(magnitude-squared 3.0) ⇒ 9.0</code></pre>
</div>
</div>
<div id="numeric:s76" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(sinh <em>num</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(cosh <em>num</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(tanh <em>num</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the hyperbolic sine, cosine, or tangent of <code><em>num</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(sinh 0.0) ⇒ 0.0
(cosh 0.0) ⇒ 1.0
(tanh -0.0) ⇒ -0.0</code></pre>
</div>
</div>
<div id="numeric:s77" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(asinh <em>num</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(acosh <em>num</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(atanh <em>num</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the hyperbolic arc sine, arc cosine, or arc tangent of <code><em>num</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(acosh 0.0) ⇒ 0.0+1.5707963267948966i
(acosh 1.0) ⇒ 0.0
(atanh -1.0) ⇒ -inf.0</code></pre>
</div>
</div>
<div id="numeric:s78" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(string-&gt;number <em>string</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(string-&gt;number <em>string</em> <em>radix</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the number represented by <code><em>string</em></code>, or <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure is identical to the Revised<sup>6</sup> Report version except that <code>radix</code> may be any exact integer between 2 and 36, inclusive. The Revised<sup>6</sup> Report version requires radix to be in the set {2,8,10,16}.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(string->number "211012" 3) ⇒ 559
(string->number "tobeornottobe" 36) ⇒ 140613689159812836698</code></pre>
</div>
</div>
<div id="numeric:s79" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(number-&gt;string <em>num</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(number-&gt;string <em>num</em> <em>radix</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(number-&gt;string <em>num</em> <em>radix</em> <em>precision</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>an external representation of <code><em>num</em></code> as a string</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure is identical to the Revised<sup>6</sup> Report version except that <code>radix</code> may be any exact integer between 2 and 36, inclusive. The Revised<sup>6</sup> Report version requires radix to be in the set {2,8,10,16}.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(number->string 10000 4) ⇒ "2130100"
(number->string 10000 27) ⇒ "DJA"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chp_9">Chapter 9. Input/Output Operations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes <em>Chez Scheme</em>'s generic port facility, operations on ports, and various <em>Chez Scheme</em> extensions to the standard set of input/output operations. See <a href="../../the-scheme-programming-language-4th/en/index.html#chp_7">Chapter 7</a> of <em>The Scheme Programming Language, 4th Edition</em> or the Revised<sup>6</sup> Report on Scheme for a description of standard input/output operations. Definitions of a few sample generic ports are given in <a href="#section_9.17.">Section 9.17</a>.</p>
</div>
<div class="paragraph">
<p><em>Chez Scheme</em> closes file ports automatically after they become inaccessible to the program or when the Scheme program exits, but it is best to close ports explicitly whenever possible.</p>
</div>
<div class="sect2">
<h3 id="section_9.1.">Section 9.1. Generic Ports</h3>
<div class="paragraph">
<p><em>Chez Scheme</em>'s "generic port" facility allows the programmer to add new types of textual ports with arbitrary input/output semantics. It may be used, for example, to define any of the built-in Common Lisp <a href="#ref30">[30]</a> stream types, i.e., synonym streams, broadcast streams, concatenated streams, two-way streams, echo streams, and string streams. It may also be used to define more exotic ports, such as ports that represent windows on a bit-mapped display or ports that represent processes connected to the current process via pipes or sockets.</p>
</div>
<div class="paragraph">
<p>Each port has an associated <em>port handler</em>. A port handler is a procedure that accepts messages in an object-oriented style. Each message corresponds to one of the low-level Scheme operations on ports, such as <code>read-char</code> and <code>close-input-port</code> (but not <code>read</code>, which is defined in terms of the lower-level operations). Most of these operations simply call the handler immediately with the corresponding message.</p>
</div>
<div class="paragraph">
<p>Standard messages adhere to the following conventions: the message name is the first argument to the handler. It is always a symbol, and it is always the name of a primitive Scheme operation on ports. The additional arguments are the same as the arguments to the primitive procedure and occur in the same order. (The port argument to some of the primitive procedures is optional; in the case of the messages passed to a handler, the port argument is always supplied.) The following messages are defined for built-in ports:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">block-read <em>port</em> <em>string</em> <em>count</em>
block-write <em>port</em> <em>string</em> <em>count</em>
char-ready? <em>port</em>
clear-input-port <em>port</em>
clear-output-port <em>port</em>
close-port <em>port</em>
file-position <em>port</em>
file-position <em>port</em> <em>position</em>
file-length <em>port</em>
flush-output-port <em>port</em>
peek-char <em>port</em>
port-name <em>port</em>
read-char <em>port</em>
unread-char <em>char</em> <em>port</em>
write-char <em>char</em> <em>port</em></code></pre>
</div>
</div>
<div class="paragraph">
<p>Additional messages may be accepted by user-defined ports.</p>
</div>
<div class="paragraph">
<p><em>Chez Scheme</em> input and output is normally buffered for efficiency. To support buffering, each input port contains an input buffer and each output port contains an output buffer. Bidirectional ports, ports that are both input ports and output ports, contain both input and output buffers. Input is not buffered if the input buffer is the empty string, and output is not buffered if the output buffer is the empty string. In the case of unbuffered input and output, calls to <code>read-char</code>, <code>write-char</code>, and similar messages cause the handler to be invoked immediately with the corresponding message. For buffered input and output, calls to these procedures cause the buffer to be updated, and the handler is not called under normal circumstances until the buffer becomes empty (for input) or full (for output). Handlers for buffered ports must <code><em>not</em></code> count on the buffer being empty or full when <code>read-char</code>, <code>write-char</code>, and similar messages are received, however, due to the possibility that (a) the handler is invoked through some other mechanism, or (b) the call to the handler is interrupted.</p>
</div>
<div class="paragraph">
<p>In the presence of keyboard, timer, and other interrupts, it is possible for a call to a port handler to be interrupted or for the handler itself to be interrupted. If the port is accessible outside of the interrupted code, there is a possibility that the interrupt handler will cause input or output to be performed on the port. This is one reason, as stated above, that port handlers must not count on the input buffer being empty or output buffer being full when a <code>read-char</code>, <code>write-char</code>, or similar message is received. In addition, port handlers may need to manipulate the buffers only with interrupts disabled (using <code>with-interrupts-disabled</code>).</p>
</div>
<div class="paragraph">
<p>Generic ports are created via one of the port construction procedures <code>make-input-port</code>, <code>make-output-port</code>, and <code>make-input/output-port</code> defined later in this chapter. Ports have seven accessible fields:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code><em>handler</em></code></dt>
<dd>
<p>accessed with <code>port-handler</code>;</p>
</dd>
<dt class="hdlist1"><code><em>output-buffer</em></code></dt>
<dd>
<p>accessed with <code>port-output-buffer</code>,</p>
</dd>
<dt class="hdlist1"><code><em>output-size</em></code></dt>
<dd>
<p>accessed with <code>port-output-size</code>,</p>
</dd>
<dt class="hdlist1"><code><em>output-index</em></code></dt>
<dd>
<p>accessed with <code>port-output-index</code>,</p>
</dd>
<dt class="hdlist1"><code><em>input-buffer</em></code></dt>
<dd>
<p>accessed with <code>port-input-buffer</code>,</p>
</dd>
<dt class="hdlist1"><code><em>input-size</em></code></dt>
<dd>
<p>accessed with <code>port-input-size</code>, and</p>
</dd>
<dt class="hdlist1"><code><em>input-index</em></code></dt>
<dd>
<p>accessed with <code>port-input-index</code>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The output-size and output-index fields are valid only for output ports, and the input-size and input-index fields are valid only for input ports. The output and input size and index fields may be updated as well using the corresponding "<code>set-<em>field</em>!</code>" procedure.</p>
</div>
<div class="paragraph">
<p>A port&#8217;s output size determines how much of the port&#8217;s output buffer is actually available for writing by <code>write-char</code>. The output size is often the same as the string length of the port&#8217;s output buffer, but it can be set to less (but no less than zero) at the discretion of the programmer. The output index determines to which position in the port&#8217;s buffer the next character will be written. The output index should be between 0 and the output size, inclusive. If no output has occurred since the buffer was last flushed, the output index should be 0. If the index is less than the size, <code>write-char</code> stores its character argument into the specified character position within the buffer and increments the index. If the index is equal to the size, <code>write-char</code> leaves the fields of the port unchanged and invokes the handler.</p>
</div>
<div class="paragraph">
<p>A port&#8217;s input size determines how much of the port&#8217;s input buffer is actually available for reading by <code>read-char</code>. A port&#8217;s input size and input index are constrained in the same manner as output size and index, i.e., the input size must be between 0 and the string length of the input buffer (inclusive), and the input index must be between 0 and the input size (inclusive). Often, the input size is less than the length of the input buffer because there are fewer characters available to read than would fit in the buffer. The input index determines from which position in the input buffer the next character will be read. If the index is less than the size, <code>read-char</code> extracts the character in this position, increments the index, and returns the character. If the index is equal to the size, <code>read-char</code> leaves the fields of the port unchanged and invokes the handler.</p>
</div>
<div class="paragraph">
<p>The operation of <code>peek-char</code> is similar to that of <code>read-char</code>, except that it does not increment the input index. <code>unread-char</code> decrements the input index if it is greater than 0, otherwise it invokes the handler. <code>char-ready?</code> returns <code>#t</code> if the input index is less than the input size, otherwise it invokes the handler.</p>
</div>
<div class="paragraph">
<p>Although the fields shown and discussed above are logically present in a port, actual implementation details may differ. The current <em>Chez Scheme</em> implementation uses a different representation that allows <code>read-char</code>, <code>write-char</code>, and similar operations to be open-coded with minimal overhead. The access and assignment operators perform the conversion between the actual representation and the one shown above.</p>
</div>
<div class="paragraph">
<p>Port handlers receiving a message must return a value appropriate for the corresponding operation. For example, a handler receiving a <code>read-char</code> message must return a character or eof object (if it returns). For operations that return unspecified values, such as <code>close-port</code>, the handler is not required to return any particular value.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_9.2.">Section 9.2. File Options</h3>
<div class="paragraph">
<p>The Revised<sup>6</sup> Report requires that the universe of a file-options enumeration set must include <code>no-create</code>, <code>no-fail</code>, and <code>no-truncate</code>, whose meanings are described within the description of the <code>file-options</code> syntax in <a href="../../the-scheme-programming-language-4th/en/index.html#section_7.2.">Section 7.2</a> of <em>The Scheme Programming Language, 4th Edition</em>. <em>Chez Scheme</em> defines a number of additional file options:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code><em>compressed</em></code></dt>
<dd>
<p>An output file should be compressed when written; and a compressed input file should be decompressed when read. The compression format for output is determined by the <code>compress-format</code> parameter, while the compression format on input is inferred. The compression level, which is relevant only for output, is determined by the <code>compress-level</code> parameter.</p>
</dd>
<dt class="hdlist1"><code><em>replace</em></code></dt>
<dd>
<p>For output files only, replace (remove and recreate) the existing file if it exists.</p>
</dd>
<dt class="hdlist1"><code><em>exclusive</em></code></dt>
<dd>
<p>For output files only, lock the file for exclusive access. On some systems the lock is advisory, i.e., it inhibits access by other processes only if they also attempt to open exclusively.</p>
</dd>
<dt class="hdlist1"><code><em>append</em></code></dt>
<dd>
<p>For output files only, position the output port at the end of the file before each write so that output to the port is always appended to the file.</p>
</dd>
<dt class="hdlist1"><code><em>perm-set-user-id</em></code></dt>
<dd>
<p>For newly created output files under Unix-based systems only, set user-id bit.</p>
</dd>
<dt class="hdlist1"><code><em>perm-set-group-id</em></code></dt>
<dd>
<p>For newly created output files under Unix-based systems only, set group-id bit.</p>
</dd>
<dt class="hdlist1"><code><em>perm-sticky</em></code></dt>
<dd>
<p>For newly created output files under Unix-based systems only, set sticky bit.</p>
</dd>
<dt class="hdlist1"><code><em>perm-no-user-read</em></code></dt>
<dd>
<p>For newly created output files under Unix-based systems only, do not set user read bit. (User read bit is set by default, unless masked by the process umask.)</p>
</dd>
<dt class="hdlist1"><code><em>perm-no-user-write</em></code></dt>
<dd>
<p>For newly created output files under Unix-based systems only, do not set user write bit. (User write bit is set by default, unless masked by the process umask.)</p>
</dd>
<dt class="hdlist1"><code><em>perm-user-execute</em></code></dt>
<dd>
<p>For newly created output files under Unix-based systems only, set user execute bit unless masked by process umask. (User execute bit is not set by default.)</p>
</dd>
<dt class="hdlist1"><code><em>perm-no-group-read</em></code></dt>
<dd>
<p>For newly created output files under Unix-based systems only, do not set group read bit. (Group read bit is set by default, unless masked by the process umask.)</p>
</dd>
<dt class="hdlist1"><code><em>perm-no-group-write</em></code></dt>
<dd>
<p>For newly created output files under Unix-based systems only, do not set group write bit. (Group write bit is set by default, unless masked by the process umask.)</p>
</dd>
<dt class="hdlist1"><code><em>perm-group-execute</em></code></dt>
<dd>
<p>For newly created output files under Unix-based systems only, set group execute bit unless masked by process umask. (Group execute bit is not set by default.)</p>
</dd>
<dt class="hdlist1"><code><em>perm-no-other-read</em></code></dt>
<dd>
<p>For newly created output files under Unix-based systems only, do not set other read bit. (Other read bit is set by default, unless masked by the process umask.)</p>
</dd>
<dt class="hdlist1"><code><em>perm-no-other-write</em></code></dt>
<dd>
<p>For newly created output files under Unix-based systems only, do not set other write bit. (Other write bit is set by default, unless masked by the process umask.)</p>
</dd>
<dt class="hdlist1"><code><em>perm-other-execute</em></code></dt>
<dd>
<p>For newly created output files under Unix-based systems only, set other execute bit unless masked by process umask. (Other execute bit is not set by default.)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="section_9.3.">Section 9.3. Transcoders</h3>
<div class="paragraph">
<p>The language of the Revised<sup>6</sup> Report provides three built-in codecs: a latin-1 codec, a utf-8 codec, and a utf-16 codec. <em>Chez Scheme</em> provides three additional codecs: a utf-16le codec, utf-16be codec, and an "iconv" codec for non-Unicode character sets. It also provides an alternative to the standard utf-16 codec that defaults to little-endian format rather than the default big-endian format. This section describes these codecs, plus a <code>current-transcoder</code> parameter that allows the programmer to determine the transcoder used for a textual port whenever the transcoder is implicit, as for <code>open-input-file</code> or <code>load</code>, along with the predicate <code>transcoder?</code>, which should be standard but is not.</p>
</div>
<div id="io:s9" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(utf-16-codec)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(utf-16-codec <em>endianness</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(utf-16le-codec)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(utf-16be-codec)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a codec</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>endianness</em></code> must be the symbol <code>big</code> or the symbol <code>little</code>.</p>
</div>
<div class="paragraph">
<p>The codec returned by <code>utf-16-codec</code> can be used to create and process data written UTF-16 format. When called without the <code><em>endianness</em></code> argument or with <code><em>endianness</em></code> <code>big</code>, <code>utf-16-codec</code> returns a codec for standard UTF-16 data, i.e., one that defaults to big-endian format if no byte-order mark (BOM) is found.</p>
</div>
<div class="paragraph">
<p>When output is transcoded with a transcoder based on this codec, a BOM is emitted just before the first character written, and each character is written as a UTF-16 character in big-endian format. For input, a BOM is looked for at the start of the input and, if present, controls the byte order of the remaining UTF-16 characters. If no BOM is present, big-endian order is assumed. For input-output ports, the BOM is not emitted if the file is read before written, and a BOM is not looked for if the file is written before read.</p>
</div>
<div class="paragraph">
<p>For textual ports created via <code>transcoded-port</code>, a BOM written or read via the transcoder appears at the beginning of the underlying data stream or file only if the binary port passed to <code>transcoded-port</code> is positioned at the start of the data stream or file. When the transcoder can determine this is the case, it sets a flag that causes <code>set-port-position!</code>) to position the port beyond the BOM if an attempt is made to reposition the port to the start of the data stream or file, so that the BOM is preserved.</p>
</div>
<div class="paragraph">
<p>When called with <code><em>endianness</em></code> <code>little</code>, <code>utf-16-codec</code> returns a codec that defaults to the little-endian format both for reading and for writing. For output-only streams or input/output streams that are written before read, the result is standard UTF-16, with a BOM that specifies little-endian format followed by characters in little-endian byte order. For input-only streams or input/output streams that are read before written, this codec allows programs to read from input streams that either begin with a BOM or are encoded in UTF-16LE format. This is particularly useful for handling files that might have been produced by older Windows applications that claim to produce UTF-16 files but actually produce UTF-16LE files.</p>
</div>
<div class="paragraph">
<p>The Revised<sup>6</sup> Report version of <code>utf-16-codec</code> lacks the optional <code><em>endianness</em></code> argument.</p>
</div>
<div class="paragraph">
<p>The codecs returned by <code>utf-16le-codec</code> and <code>utf-16be-codec</code> are used to read and write data in the UTF-16LE and UTF-16BE formats, i.e., UTF-16 with little-endian or big-endian byte order and no BOM. For output, these codecs are useful for controlling whether and where the BOM is emitted, since no BOM is emitted implicitly and a BOM can be emitted explicitly as an ordinary character. For input, these codecs are useful for processing files known to be in little-endian or big-endian format with no BOM.</p>
</div>
<div id="io:s10" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(iconv-codec <em>code-page</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a codec</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>code-page</em></code> must be a string and should identify a codec accepted by the <code>iconv</code> library installed on the target machine. The codec returned by this procedure can be used to convert from the non-Unicode single- and multiple-byte character sets supported by <code>iconv</code>. When used in the input direction, the codec converts byte sequences into Scheme strings, and when used in the output direction, it converts Scheme strings to byte sequences.</p>
</div>
<div class="paragraph">
<p>The set of supported code pages depends on the version of <code>iconv</code> available; consult the <code>iconv</code> documentation or use the shell command <code>iconv --list</code> to obtain a list of supported code pages.</p>
</div>
<div class="paragraph">
<p>While the Windows operating system does not supply an <code>iconv</code> library, it is possible to use <code>iconv-codec</code> on Windows systems by supplying an <code>iconv</code> dynamic-link library (named <code>iconv.dll</code>, <code>libiconv.dll</code>, or <code>libiconv-2.dll</code>) that provides Posix-conformant <code>iconv_open</code>, <code>iconv</code>, and <code>iconv_close</code> entry points either under those names or under the alternative names <code>libiconv_open</code>, <code>libiconv</code>, and <code>libiconv_close</code>. The dll must be located in a standard location for dlls or in the current directory of the process the first time <code>iconv-codec</code> is called.</p>
</div>
<div id="io:s11" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>current-transcoder</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The transcoder value of the <code>current-transcoder</code> parameter is used whenever a textual file is opened with an implicit transcoder, e.g., by <code>open-input-file</code> and other convenience I/O procedures, <code>compile-file</code> <code>include</code>, <code>load</code>, and <code>pretty-file</code>. Its initial value is the value of the <code>native-transcoder</code> procedure.</p>
</div>
<div id="io:s12" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(transcoder? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a transcoder, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="section_9.4.">Section 9.4. Port Operations</h3>
<div class="paragraph">
<p>The procedures used to create, access, and alter ports directly are described in this section. Also described are several nonstandard operations on ports.</p>
</div>
<div class="paragraph">
<p>Unless otherwise specified, procedures requiring either input ports or output ports as arguments accept input/output ports as well, i.e., an input/output port is both an input port and an output port.</p>
</div>
<div id="io:s13" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-input-port <em>handler</em> <em>input-buffer</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-output-port <em>handler</em> <em>output-buffer</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-input/output-port <em>handler</em> <em>input-buffer</em> <em>output-buffer</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new textual port</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>handler</em></code> must be a procedure, and <code><em>input-buffer</em></code> and <code><em>output-buffer</em></code> must be strings. Each procedure creates a generic port. The handler associated with the port is <code><em>handler</em></code>, the input buffer is <code><em>input-buffer</em></code>, and the output buffer is <code><em>output-buffer</em></code>. For <code>make-input-port</code>, the output buffer is undefined, and for <code>make-output-port</code>, the input buffer is undefined.</p>
</div>
<div class="paragraph">
<p>The input size of an input or input/output port is initialized to the string length of the input buffer, and the input index is set to 0. The output size and index of an output or input/output port are initialized similarly.</p>
</div>
<div class="paragraph">
<p>The length of an input or output buffer may be zero, in which case buffering is effectively disabled.</p>
</div>
<div id="io:s15" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(port-handler <em>port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a procedure</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For generic ports, <code>port-handler</code> returns the handler passed to one of the generic port creation procedures described above. For ports created by <code>open-input-file</code> and similar procedures, <code>port-handler</code> returns an internal handler that may be invoked in the same manner as any other handler.</p>
</div>
<div id="io:s16" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(port-input-buffer <em>input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(port-input-size <em>input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(port-input-index <em>input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(textual-port-input-buffer <em>textual-input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(textual-port-input-size <em>textual-input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(textual-port-input-index <em>textual-input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(binary-port-input-buffer <em>binary-input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(binary-port-input-size <em>binary-input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(binary-port-input-index <em>binary-input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These procedures return the input buffer, size, or index of the input port. The variants specialized to textual or binary ports are slightly more efficient than their generic counterparts.</p>
</div>
<div id="io:s17" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-port-input-index! <em>input-port</em> <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-port-input-size! <em>input-port</em> <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-port-input-buffer! <em>input-port</em> <em>x</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-textual-port-input-index! <em>textual-input-port</em> <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-textual-port-input-size! <em>textual-input-port</em> <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-textual-port-input-buffer! <em>textual-input-port</em> <em>string</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-binary-port-input-index! <em>binary-input-port</em> <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-binary-port-input-size! <em>binary-input-port</em> <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-binary-port-input-buffer! <em>binary-input-port</em> <em>bytevector</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The procedure <code>set-port-input-index!</code> sets the input index field of <code><em>input-port</em></code> to <em>n</em>, which must be a nonnegative integer less than or equal to the port&#8217;s input size.</p>
</div>
<div class="paragraph">
<p>The procedure <code>set-port-input-size!</code> sets the input size field of <code><em>input-port</em></code> to <em>n</em>, which must be a nonnegative integer less than or equal to the string length of the port&#8217;s input buffer. It also sets the input index to 0.</p>
</div>
<div class="paragraph">
<p>The procedure <code>set-port-input-buffer!</code> sets the input buffer field of <code><em>input-port</em></code> to <em>x</em>, which must be a string for textual ports and a bytevector for binary ports. It also sets the input size to the length of the string or bytevector and the input index to 0.</p>
</div>
<div class="paragraph">
<p>The variants specialized to textual or binary ports are slightly more efficient than their generic counterparts.</p>
</div>
<div id="io:s18" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(port-input-count <em>input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(textual-port-input-count <em>textual-input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(binary-port-input-count <em>binary-input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These procedures return an exact integer representing the number of characters or bytes left to be read from the port&#8217;s input buffer, i.e., the difference between the buffer size and index.</p>
</div>
<div class="paragraph">
<p>The variants specialized to textual or binary ports are slightly more efficient than their generic counterpart.</p>
</div>
<div id="io:s19" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(port-input-empty? <em>input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the port&#8217;s input buffer contains no more data, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure determines whether the port&#8217;s input count is zero without computing or returning the actual count.</p>
</div>
<div id="io:s20" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(port-output-buffer <em>output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(port-output-size <em>output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(port-output-index <em>output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(textual-port-output-buffer <em>output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(textual-port-output-size <em>output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(textual-port-output-index <em>output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(binary-port-output-buffer <em>output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(binary-port-output-size <em>output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(binary-port-output-index <em>output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These procedures return the output buffer, size, or index of the output port. The variants specialized to textual or binary ports are slightly more efficient than their generic counterparts.</p>
</div>
<div id="io:s21" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-port-output-index! <em>output-port</em> <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-port-output-size! <em>output-port</em> <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-port-output-buffer! <em>output-port</em> <em>x</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-textual-port-output-index! <em>textual-output-port</em> <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-textual-port-output-size! <em>textual-output-port</em> <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-textual-port-output-buffer! <em>textual-output-port</em> <em>string</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-binary-port-output-index! <em>output-port</em> <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-binary-port-output-size! <em>output-port</em> <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-binary-port-output-buffer! <em>binary-output-port</em> <em>bytevector</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The procedure <code>set-port-output-index!</code> sets the output index field of the output port to <em>n</em>, which must be a nonnegative integer less than or equal to the port&#8217;s output size.</p>
</div>
<div class="paragraph">
<p>The procedure <code>set-port-output-size!</code> sets the output size field of the output port to <em>n</em>, which must be a nonnegative integer less than or equal to the string length of the port&#8217;s output buffer. It also sets the output index to 0.</p>
</div>
<div class="paragraph">
<p>The procedure <code>set-port-output-buffer!</code> sets the output buffer field of <code><em>output-port</em></code> to <em>x</em>, which must be a string for textual ports and a bytevector for binary ports. It also sets the output size to the length of the string or bytevector and the output index to 0.</p>
</div>
<div class="paragraph">
<p>The variants specialized to textual or binary ports are slightly more efficient than their generic counterparts.</p>
</div>
<div id="io:s22" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(port-output-count <em>output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(textual-port-output-count <em>textual-output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(binary-port-output-count <em>binary-output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These procedures return an exact integer representing the amount of space in characters or bytes available to be written in the port&#8217;s output buffer, i.e., the difference between the buffer size and index.</p>
</div>
<div class="paragraph">
<p>The variants specialized to textual or binary ports are slightly more efficient than their generic counterpart.</p>
</div>
<div id="io:s23" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(port-output-full? <em>output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the port&#8217;s input buffer has no more room, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure determines whether the port&#8217;s output count is zero without computing or returning the actual count.</p>
</div>
<div id="io:s24" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(mark-port-closed! <em>port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure directly marks the port closed so that no further input or output operations are allowed on it. It is typically used by handlers upon receipt of a <code>close-port</code> message.</p>
</div>
<div id="io:s25" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(port-closed? <em>port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>port</em></code> is closed, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([p (open-output-string)])
  (port-closed? p)) ⇒ #f

(let ([p (open-output-string)])
  (close-port p)
  (port-closed? p)) ⇒ #t</code></pre>
</div>
</div>
<div id="desc:set-port-bol" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-port-bol! <em>output-port</em> <em>obj</em>)</code> <a id="io:s26"></a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When <code><em>obj</em></code> is <code>#f</code>, the port&#8217;s beginning-of-line (BOL) flag is cleared; otherwise, the port&#8217;s BOL flag is set.</p>
</div>
<div class="paragraph">
<p>The BOL flag is consulted by <code>fresh-line</code> (<a href="#desc:fresh-line">page 243</a>) to determine if it needs to emit a newline. This flag is maintained automatically for file output ports, string output ports, and transcript ports. The flag is set for newly created file and string output ports, except for file output ports created with the <code>append</code> option, for which the flag is reset. The BOL flag is clear for newly created generic ports and never set automatically, but may be set explicitly using <code>set-port-bol!</code>. The port is always flushed immediately before the flag is consulted, so it need not be maintained on a per-character basis for buffered ports.</p>
</div>
<div id="io:s27" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(port-bol? <em>port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>port</em></code>'s BOL flag is set, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="io:s28" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-port-eof! <em>input-port</em> <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When <code><em>obj</em></code> is not <code>#f</code>, <code>set-port-eof!</code> marks <code><em>input-port</em></code> so that, once its buffer is empty, the port is treated as if it were at eof even if more data is available in the underlying byte or character stream. Once this artificial eof has been read, the eof mark is cleared, making any additional data in the stream available beyond the eof. This feature can be used by a generic port to simulate a stream consisting of multiple input files.</p>
</div>
<div class="paragraph">
<p>When <code><em>obj</em></code> is <code>#f</code>, the eof mark is cleared.</p>
</div>
<div class="paragraph">
<p>The following example assumes /dev/zero provides an infinite stream of zero bytes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define p
  (parameterize ([file-buffer-size 3])
    (open-file-input-port "/dev/zero")))
(set-port-eof! p #t)
(get-u8 p) ⇒ #!eof
(get-u8 p) ⇒ 0
(set-port-eof! p #t)
(get-u8 p) ⇒ 0
(get-u8 p) ⇒ 0
(get-u8 p) ⇒ #!eof
(get-u8 p) ⇒ 0</code></pre>
</div>
</div>
<div id="io:s29" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(port-name <em>port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the name associated with <code><em>port</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The name may be any object but is usually a string or <code>#f</code> (denoting no name). For file ports, the name is typically a string naming the file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([p (open-input-file "myfile.ss")])
  (port-name p)) ⇒ "myfile.ss"

(let ([p (open-output-string)])
  (port-name p)) ⇒ "string"</code></pre>
</div>
</div>
<div id="io:s30" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-port-name! <em>port</em> <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure sets <code><em>port</em></code>'s name to <code><em>obj</em></code>, which should be a string or <code>#f</code> (denoting no name).</p>
</div>
<div id="io:s31" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(port-length <em>port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(file-length <em>port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the length of the file or other object to which <code><em>port</em></code> refers</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(port-has-port-length? <em>port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the port supports <code>port-length</code>, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A port may allow the length of the underlying stream of characters or bytes to be determined. If so, the procedure <code>port-has-port-length?</code> returns <code>#t</code> and <code>port-length</code> returns the current length. For binary ports, the length is always an exact nonnegative integer byte count. For textual ports, the representation of a length is unspecified; it may not be an exact nonnegative integer and, even if it is, it may not represent either a byte or character count. The length may be used at some later time to reset the length if the port supports <code>set-port-length!</code>. If <code>port-length</code> is called on a port that does not support it, an exception with condition type <code>&amp;assertion</code> is raised.</p>
</div>
<div class="paragraph">
<p>File lengths beyond 2<sup>32</sup> might not be reported property for compressed files on 32-bit versions of the system.</p>
</div>
<div class="paragraph">
<p><code>file-length</code> is identical to <code>port-length</code>.</p>
</div>
<div id="io:s32" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-port-length! <em>port</em> <em>len</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(port-has-set-port-length!? <em>port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the port supports <code>set-port-length!</code>, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A port may allow the length of the underlying stream of characters or bytes to be set, i.e., extended or truncated. If so, the procedure <code>port-has-set-port-length!?</code> returns <code>#t</code> and <code>set-port-length!</code> changes the length. For binary ports, the length <code><em>len</em></code> must be an exact nonnegative integer byte count. For textual ports, the representation of a length is unspecified, as described in the entry for <code>port-length</code> above, but <code><em>len</em></code> must be an appropriate length for the textual port, which is usually guaranteed to be the case only if it was obtained from a call to <code>port-length</code> on the same port. If <code>set-port-length!</code> is called on a port that does not support it, an exception with condition type <code>&amp;assertion</code> is raised.</p>
</div>
<div class="paragraph">
<p>It is not possible to set the length of a port opened with compression to an arbitrary position, and the result of an attempt to set the length of a compressed file beyond 2<sup>32</sup> on 32-bit versions of the system is undefined.</p>
</div>
<div id="io:s33" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(port-nonblocking? <em>port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the port is in nonblocking mode, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(port-has-port-nonblocking?? <em>port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the port supports <code>port-nonblocking?</code>, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A port may allow the nonblocking status of the port to be determined. If so, the procedure <code>port-has-port-nonblocking??</code> returns <code>#t</code> and <code>port-nonblocking?</code> returns a boolean value reflecting whether the port is in nonblocking mode.</p>
</div>
<div id="io:s34" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-port-nonblocking! <em>port</em> <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(port-has-set-port-nonblocking!? <em>port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the port supports <code>set-port-nonblocking!</code>, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A port may allow reads or writes to be performed in a "nonblocking" fashion. If so, the procedure <code>port-has-set-port-nonblocking!?</code> returns <code>#t</code> and <code>set-port-nonblocking!</code> sets the port to nonblocking mode (if <code><em>obj</em></code> is a true value) or blocking mode (if <code><em>obj</em></code> is <code>#f</code>). If <code>set-port-nonblocking!</code> is called on a port that does not support it, an exception with condition type <code>&amp;assertion</code> is raised.</p>
</div>
<div class="paragraph">
<p>Ports created by the standard Revised<sup>6</sup> port opening procedures are initially set in blocking mode by default. The same is true for most of the procedures described in this document. A generic port based on a nonblocking source may be nonblocking initially. A port returned by <code>open-fd-input-port</code>, <code>open-fd-output-port</code>, or <code>open-fd-input/output-port</code> is initially in nonblocking mode if the file-descriptor passed in is in nonblocking mode. Similarly, a port returned by <code>standard-input-port</code>, <code>standard-output-port</code>, or <code>standard-error-port</code> is initially in nonblocking mode if the underlying stdin, stdout, or stderr file descriptor is in nonblocking mode.</p>
</div>
<div class="paragraph">
<p>Although <code>get-bytevector-some</code> and <code>get-string-some</code> normally cannot return an empty bytevector or empty string, they can if the port is in nonblocking mode and no input is available. Also, <code>get-bytevector-some!</code> and <code>get-string-some!</code> may not read any data if the port is in nonblocking mode and no data is available. Similarly, <code>put-bytevector-some</code> and <code>put-string-some</code> may not write any data if the port is in nonblocking mode and no room is available.</p>
</div>
<div class="paragraph">
<p>Nonblocking mode is not supported under Windows.</p>
</div>
<div id="io:s35" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(file-position <em>port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(file-position <em>port</em> <em>pos</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When the second argument is omitted, this procedure behaves like the R6RS <code>port-position</code> procedure, and when present, like the R6RS <code>set-port-position!</code> procedure.</p>
</div>
<div class="paragraph">
<p>For compressed files opened with the <code>compressed</code> flag, <code>file-position</code> returns the position in the uncompressed stream of data. Changing the position of a compressed input file opened with the <code>compressed</code> flag generally requires rewinding and rereading the file and might thus be slow. The position of a compressed output file opened with the <code>compressed</code> flag can be moved forward only; this is accomplished by writing a (compressed) sequence of zeros. File positions beyond 2<sup>32</sup> might not be reported property for compressed files on 32-bit versions of the system.</p>
</div>
<div id="io:s36" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(clear-input-port)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(clear-input-port <em>input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code><em>input-port</em></code> is not supplied, it defaults to the current input port. This procedure discards any data in the buffer associated with <code><em>input-port</em></code>. This may be necessary, for example, to clear any type-ahead from the keyboard in preparation for an urgent query.</p>
</div>
<div id="io:s37" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(clear-output-port)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(clear-output-port <em>output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code><em>output-port</em></code> is not supplied, it defaults to the current output port. This procedure discards any data in the buffer associated with <code><em>output-port</em></code>. This may be necessary, for example, to clear any pending output on an interactive port in preparation for an urgent message.</p>
</div>
<div id="io:s38" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(flush-output-port)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(flush-output-port <em>output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code><em>output-port</em></code> is not supplied, it defaults to the current output port. This procedure forces any data in the buffer associated with <code><em>output-port</em></code> to be printed immediately. The console output port is automatically flushed after a newline and before input from the console input port; all ports are automatically flushed when they are closed. <code>flush-output-port</code> may be necessary, however, to force a message without a newline to be sent to the console output port or to force output to appear on a file without delay.</p>
</div>
<div id="io:s39" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(port-file-compressed! <em>port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>port</em></code> must be an input or an output port, but not an input/output port. It must be a file port pointing to a regular file, i.e., a file on disk rather than, e.g., a socket. The port can be a binary or textual port. If the port is an output port, subsequent output sent to the port will be compressed. If the port is an input port, subsequent input will be decompressed if and only if the port is currently pointing at compressed data. The compression format for output is determined by the <code>compress-format</code> parameter, while the compression format on input is inferred. The compression level, which is relevant only for output, is determined by the <code>compress-level</code> parameter. This procedure has no effect if the port is already set for compression.</p>
</div>
<div id="io:s42" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>compress-format</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>compress-format</code> determines the compression algorithm and format used for output. Currently, the possible values of the parameter are the symbols <code>lz4</code> (the default) and <code>gzip</code>.</p>
</div>
<div class="paragraph">
<p>The <code>lz4</code> format uses the LZ4 compression library developed by Yann Collet. It is therefore compatible with the <code>lz4</code> program, which means that <code>lz4</code> may be used to uncompress files produced by <em>Chez Scheme</em> and visa versa.</p>
</div>
<div class="paragraph">
<p>The <code>gzip</code> format uses the zlib compression library developed by Jean-loup Gailly and Mark Adler. It is therefore compatible with the <code>gzip</code> program, which means that <code>gzip</code> may be used to uncompress files produced by <em>Chez Scheme</em> and visa versa.</p>
</div>
<div class="paragraph">
<p>Reading <code>lz4</code>-compressed data tends to be much faster than reading <code>gzip</code>-compressed data, while <code>gzip</code>-compressed data tends to be significantly smaller.</p>
</div>
<div id="io:s43" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>compress-level</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>compress-level</code> determines the amount of effort spent on compression and is thus relevant only for output. It can be set to one of the symbols <code>minimum</code>, <code>low</code>, <code>medium</code>, <code>high</code>, or <code>maximum</code>, which are listed in order from shortest to longest expected compression time and least to greatest expected effectiveness. Its default value is <code>medium</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_9.5.">Section 9.5. String Ports</h3>
<div class="paragraph">
<p>String ports allow the creation and manipulation of strings via port operations. The procedure <code>open-input-string</code> converts a string into a textual input port, allowing the characters in the string to be read in sequence via input operations such as <code>read-char</code> or <code>read</code>. The procedure <code>open-output-string</code> allows new strings to be built up with output operations such as <code>write-char</code> and <code>write</code>.</p>
</div>
<div class="paragraph">
<p>While string ports could be defined as generic ports, they are instead supported as primitive by the implementation.</p>
</div>
<div id="io:s44" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(open-input-string <em>string</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new string input port</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A string input port is similar to a file input port, except that characters and objects drawn from the port come from <code><em>string</em></code> rather than from a file.</p>
</div>
<div class="paragraph">
<p>A string port is at "end of file" when the port reaches the end of the string. It is not necessary to close a string port, although it is okay to do so.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([p (open-input-string "hi mom!")])
  (let ([x (read p)])
    (list x (read p)))) ⇒ (hi mom!)</code></pre>
</div>
</div>
<div id="io:s46" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(with-input-from-string <em>string</em> <em>thunk</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the values returned by <code><em>thunk</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>thunk</em></code> must be a procedure and should accept zero arguments. <code>with-input-from-string</code> parameterizes the current input port to be the result of opening <code><em>string</em></code> for input during the application of <code><em>thunk</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(with-input-from-string "(cons 3 4)"
  (lambda ()
    (eval (read)))) ⇒ (3 . 4)</code></pre>
</div>
</div>
<div id="io:s47" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(open-output-string)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new string output port</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A string output port is similar to a file output port, except that characters and objects written to the port are placed in a string (which grows as needed) rather than to a file. The string built by writing to a string output port may be obtained with <code>get-output-string</code>. See the example given for <code>get-output-string</code> below. It is not necessary to close a string port, although it is okay to do so.</p>
</div>
<div id="io:s49" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(get-output-string <em>string-output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the string associated with <code><em>string-output-port</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>string-output-port</em></code> must be an port returned by <code>open-output-string</code>.</p>
</div>
<div class="paragraph">
<p>As a side effect, <code>get-output-string</code> resets <code><em>string-output-port</em></code> so that subsequent output to <code><em>string-output-port</em></code> is placed into a fresh string.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([p (open-output-string)])
  (write 'hi p)
  (write-char #\space p)
  (write 'mom! p)
  (get-output-string p)) ⇒ "hi mom!"</code></pre>
</div>
</div>
<div class="paragraph">
<p>An implementation of <code>format</code> (<a href="#section_9.13.">Section 9.13</a>) might be written using string-output ports to produce string output.</p>
</div>
<div id="io:s50" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(with-output-to-string <em>thunk</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a string containing the output</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>thunk</em></code> must be a procedure and should accept zero arguments. <code>with-output-to-string</code> parameterizes the current output port to a new string output port during the application of <code><em>thunk</em></code>. If <code><em>thunk</em></code> returns, the string associated with the new string output port is returned, as with <code>get-output-string</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(with-output-to-string
  (lambda ()
    (display "Once upon a time ...")
    (newline))) ⇒ "Once upon a time ...\n"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_9.6.">Section 9.6. File Ports</h3>
<div id="io:s51" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>file-buffer-size</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>file-buffer-size</code> is a parameter that determines the size of each buffer created when the buffer mode is not <code>none</code> for a port created by one of the file open operations, e.g., <code>open-input-file</code> or <code>open-file-output-port</code>. When called with no arguments, the parameter returns the current buffer size. When called with a positive fixnum <code><em>k</em></code>, it sets the current buffer size to <code><em>k</em></code>.</p>
</div>
<div id="io:s52" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(file-port? <em>port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>port</em></code> is a file port, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A file port is any port based directly on an O/S file descriptor, e.g., one created by <code>open-file-input-port</code>, <code>open-output-port</code>, <code>open-fd-input-port</code>, etc., but not a string, bytevector, or custom port.</p>
</div>
<div id="io:s53" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(port-file-descriptor <em>port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the file descriptor associated with <code><em>port</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>port</em></code> must be a file port, i.e., a port for which <code><em>file-port?</em></code> returns <code>#t</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_9.7.">Section 9.7. Custom Ports</h3>
<div id="io:s54" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>custom-port-buffer-size</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>custom-port-buffer-size</code> is a parameter that determines the sizes of the buffers associated with newly created custom ports. When called with no arguments, the parameter returns the current buffer size. When called with a positive fixnum <code><em>k</em></code>, it sets the current buffer size to <code><em>k</em></code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_9.8.">Section 9.8. Input Operations</h3>
<div id="io:s55" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>console-input-port</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>console-input-port</code> is a parameter that determines the input port used by the waiter and interactive debugger. When called with no arguments, it returns the console input port. When called with one argument, which must be a textual input port, it changes the value of the console input port. The initial value of this parameter is a port tied to the standard input (stdin) stream of the Scheme process.</p>
</div>
<div id="io:s56" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>current-input-port</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>current-input-port</code> is a parameter that determines the default port argument for most input procedures, including <code>read-char</code>, <code>peek-char</code>, and <code>read</code>, When called with no arguments, <code>current-input-port</code> returns the current input port. When called with one argument, which must be a textual input port, it changes the value of the current input port. The Revised<sup>6</sup> Report version of <code>current-input-port</code> accepts only zero arguments, i.e., it cannot be used to change the current input port. The initial value of this parameter is the same port as the initial value of <code>console-input-port</code>.</p>
</div>
<div id="io:s57" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(open-input-file <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(open-input-file <em>path</em> <em>options</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new input port</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. <code>open-input-file</code> opens a textual input port for the file named by <code><em>path</em></code>. An exception is raised with condition type <code>&amp;i/o-filename</code> if the file does not exist or cannot be opened for input.</p>
</div>
<div class="paragraph">
<p><code><em>options</em></code>, if present, is a symbolic option name or option list. Possible symbolic option names are <code>compressed</code>, <code>uncompressed</code>, <code>buffered</code>, and <code>unbuffered</code>. An option list is a list containing zero or more symbolic option names.</p>
</div>
<div class="paragraph">
<p>The mutually exclusive <code>compressed</code> and <code>uncompressed</code> options determine whether the input file should be decompressed if it is compressed (where the compression format is inferred). (See <code>open-output-file</code>.) The default is <code>uncompressed</code>, so the <code>uncompressed</code> option is useful only as documentation.</p>
</div>
<div class="paragraph">
<p>The mutually exclusive <code>buffered</code> and <code>unbuffered</code> options determine whether input is buffered. When input is buffered, it is read in large blocks and buffered internally for efficiency to reduce the number of operating system requests. When the <code>unbuffered</code> option is specified, input is unbuffered, but not fully, since one character of buffering is required to support <code>peek-char</code> and <code>unread-char</code>. Input is buffered by default, so the <code>buffered</code> option is useful only as documentation.</p>
</div>
<div class="paragraph">
<p>For example, the call</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(open-input-file "frob" '(compressed))</code></pre>
</div>
</div>
<div class="paragraph">
<p>opens the file frob with decompression enabled.</p>
</div>
<div class="paragraph">
<p>The Revised<sup>6</sup> Report version of <code>open-input-file</code> does not support the optional <code><em>options</em></code> argument.</p>
</div>
<div id="io:s58" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(call-with-input-file <em>path</em> <em>procedure</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(call-with-input-file <em>path</em> <em>procedure</em> <em>options</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the values returned by <code><em>procedure</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. <code><em>procedure</em></code> should accept one argument.</p>
</div>
<div class="paragraph">
<p><code>call-with-input-file</code> creates a new input port for the file named by <code><em>path</em></code>, as if with <code>open-input-file</code>, and passes this port to <code><em>procedure</em></code>. If <code><em>procedure</em></code> returns normally, <code>call-with-input-file</code> closes the input port and returns the values returned by <code><em>procedure</em></code>.</p>
</div>
<div class="paragraph">
<p><code>call-with-input-file</code> does not automatically close the input port if a continuation created outside of <code><em>procedure</em></code> is invoked, since it is possible that another continuation created inside of <code><em>procedure</em></code> will be invoked at a later time, returning control to <code><em>procedure</em></code>. If <code><em>procedure</em></code> does not return, an implementation is free to close the input port only if it can prove that the input port is no longer accessible. As shown in <a href="../../the-scheme-programming-language-4th/en/index.html#section_5.6.">Section 5.6</a> of <em>The Scheme Programming Language, 4th Edition</em>, <code>dynamic-wind</code> may be used to ensure that the port is closed if a continuation created outside of <code><em>procedure</em></code> is invoked.</p>
</div>
<div class="paragraph">
<p>See <code>open-input-file</code> above for a description of the optional <code><em>options</em></code> argument.</p>
</div>
<div class="paragraph">
<p>The Revised<sup>6</sup> Report version of <code>call-with-input-file</code> does not support the optional <code><em>input</em></code> argument.</p>
</div>
<div id="io:s59" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(with-input-from-file <em>path</em> <em>thunk</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(with-input-from-file <em>path</em> <em>thunk</em> <em>options</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the values returned by <code><em>thunk</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. <code><em>thunk</em></code> must be a procedure and should accept zero arguments.</p>
</div>
<div class="paragraph">
<p><code>with-input-from-file</code> temporarily changes the current input port to be the result of opening the file named by <code><em>path</em></code>, as if with <code>open-input-file</code>, during the application of <code><em>thunk</em></code>. If <code><em>thunk</em></code> returns, the port is closed and the current input port is restored to its old value.</p>
</div>
<div class="paragraph">
<p>The behavior of <code>with-input-from-file</code> is unspecified if a continuation created outside of <code><em>thunk</em></code> is invoked before <code><em>thunk</em></code> returns. An implementation may close the port and restore the current input port to its old value---but it may not.</p>
</div>
<div class="paragraph">
<p>See <code>open-input-file</code> above for a description of the optional <code><em>options</em></code> argument.</p>
</div>
<div class="paragraph">
<p>The Revised<sup>6</sup> Report version of <code>with-input-from-file</code> does not support the optional <code><em>options</em></code> argument.</p>
</div>
<div id="io:s60" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(open-fd-input-port <em>fd</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(open-fd-input-port <em>fd</em> <em>b-mode</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(open-fd-input-port <em>fd</em> <em>b-mode</em> <em>?transcoder</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new input port for the file descriptor <code><em>fd</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>fd</em></code> must be a nonnegative exact integer and should be a valid open file descriptor. If <code><em>?transcoder</em></code> is present and not <code>#f</code>, it must be a transcoder, and this procedure returns a textual input port whose transcoder is <code><em>?transcoder</em></code>. Otherwise, this procedure returns a binary input port. See the lead-in to <a href="../../the-scheme-programming-language-4th/en/index.html#section_7.2.">Section 7.2</a> of <em>The Scheme Programming Language, 4th Edition</em> for a description of the constraints on and effects of the other arguments.</p>
</div>
<div class="paragraph">
<p>The file descriptor is closed when the port is closed.</p>
</div>
<div id="io:s61" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(standard-input-port)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(standard-input-port <em>b-mode</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(standard-input-port <em>b-mode</em> <em>?transcoder</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new input port connected to the process&#8217;s standard input</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code><em>?transcoder</em></code> is present and not <code>#f</code>, it must be a transcoder, and this procedure returns a textual input port whose transcoder is <code><em>?transcoder</em></code>. Otherwise, this procedure returns a binary input port. The buffer mode <code><em>b-mode</em></code> defaults to <code>block</code>.</p>
</div>
<div class="paragraph">
<p>The Revised<sup>6</sup> Report version of this procedure does not accept the optional <code><em>b-mode</em></code> and <code><em>?transcoder</em></code> arguments, which limits it to an implementation-dependent buffering mode (<code>block</code> in <em>Chez Scheme</em>) and binary output.</p>
</div>
<div id="io:s62" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(get-string-some <em>textual-input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a nonempty string or the eof object</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code><em>textual-input-port</em></code> is at end of file, the eof object is returned. Otherwise, <code>get-string-some</code> reads (as if with <code>get-u8</code>) at least one character and possibly more, and returns a string containing these characters. The port&#8217;s position is advanced past the characters read. The maximum number of characters read by this operation is implementation-dependent.</p>
</div>
<div class="paragraph">
<p>An exception to the "at least one character" guarantee occurs if the port is in nonblocking mode (see <code>set-port-nonblocking!</code>) and no input is ready. In this case, an empty string is returned.</p>
</div>
<div id="io:s63" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(get-string-some! <em>textual-input-port</em> <em>string</em> <em>start</em> <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the count of characters read, as an exact nonnegative integer, or the eof object</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>start</em></code> and <code><em>n</em></code> must be exact nonnegative integers, and the sum of <code><em>start</em></code> and <code><em>n</em></code> must not exceed the length of <code><em>string</em></code>.</p>
</div>
<div class="paragraph">
<p>If <code><em>n</em></code> is 0, this procedure returns zero without attempting to read from <code><em>textual-input-port</em></code> and without modifying <code><em>string</em></code>.</p>
</div>
<div class="paragraph">
<p>Otherwise, if <code><em>textual-input-port</em></code> is at end of file, this procedure returns the eof object, except it returns zero when the port is in nonblocking mode (see <code>set-port-nonblocking!</code>) and the port cannot be determined to be at end of file without blocking. In either case, <code><em>string</em></code> is not modified.</p>
</div>
<div class="paragraph">
<p>Otherwise, this procedure reads (as if with <code>get-char</code>) up to <code><em>n</em></code> characters from the port, stores the characters in consecutive locations of <code><em>string</em></code> starting at <code><em>start</em></code>, advances the port&#8217;s position just past the characters read, and returns the count of characters read.</p>
</div>
<div class="paragraph">
<p>If the port is in nonblocking mode, this procedure reads no more than it can without blocking and thus might read zero characters; otherwise, it reads at least one character but no more than are available when the first character becomes available.</p>
</div>
<div id="io:s64" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(get-bytevector-some! <em>binary-input-port</em> <em>bytevector</em> <em>start</em> <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the count of bytes read, as an exact nonnegative integer, or the eof object</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>start</em></code> and <code><em>n</em></code> must be exact nonnegative integers, and the sum of <code><em>start</em></code> and <code><em>n</em></code> must not exceed the length of <code><em>bytevector</em></code>.</p>
</div>
<div class="paragraph">
<p>If <code><em>n</em></code> is 0, this procedure returns zero without attempting to read from <code><em>binary-input-port</em></code> and without modifying <code><em>bytevector</em></code>.</p>
</div>
<div class="paragraph">
<p>Otherwise, if <code><em>binary-input-port</em></code> is at end of file, this procedure returns the eof object, except it returns zero when the port is in nonblocking mode (see <code>set-port-nonblocking!</code>) and the port cannot be determined to be at end of file without blocking. In either case, <code><em>bytevector</em></code> is not modified.</p>
</div>
<div class="paragraph">
<p>Otherwise, this procedure reads (as if with <code>get-u8</code>) up to <code><em>n</em></code> bytes from the port, stores the bytes in consecutive locations of <code><em>bytevector</em></code> starting at <code><em>start</em></code>, advances the port&#8217;s position just past the bytes read, and returns the count of bytes read.</p>
</div>
<div class="paragraph">
<p>If the port is in nonblocking mode, this procedure reads no more than it can without blocking and thus might read zero bytes; otherwise, it reads at least one byte but no more than are available when the first byte becomes available.</p>
</div>
<div id="io:s65" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(unread-char <em>char</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(unread-char <em>char</em> <em>textual-input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(unget-char <em>textual-input-port</em> <em>char</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For <code>unread-char</code>, if <code><em>textual-input-port</em></code> is not supplied, it defaults to the current input port. These procedures "unread" the last character read from <code>textual-input-port</code>. <code><em>char</em></code> may or may not be ignored, depending upon the implementation. In any case, <code><em>char</em></code> should be last character read from the port. A character should not be unread twice on the same port without an intervening call to <code>read-char</code> or <code>get-char</code>.</p>
</div>
<div class="paragraph">
<p><code>unread-char</code> and <code>unget-char</code> are provided for applications requiring one character of lookahead and may be used in place of, or even in combination with, <code>peek-char</code> or <code>lookahead-char</code>. One character of lookahead is required in the procedure <code>read-word</code>, which is defined below in terms of <code>unread-char</code>. <code>read-word</code> returns the next word from a textual input port as a string, where a word is defined to be a sequence of alphabetic characters. Since it does not know until it reads one character too many that it has read the entire word, <code>read-word</code> uses <code>unread-char</code> to return the character to the input port.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define read-word
  (lambda (p)
    (list->string
      (let f ([c (read-char p)])
        (cond
          [(eof-object? c) '()]
          [(char-alphabetic? c)
           (cons c (f (read-char p)))]
          [else
           (unread-char c p)
           '()])))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the alternate version below, <code>peek-char</code> is used instead of <code>unread-char</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define read-word
  (lambda (p)
    (list->string
      (let f ([c (peek-char p)])
        (cond
          [(eof-object? c) '()]
          [(char-alphabetic? c)
           (read-char p)
           (cons c (f (peek-char p)))]
          [else '()])))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The advantage of <code>unread-char</code> in this situation is that only one call to <code>unread-char</code> per word is required, whereas one call to <code>peek-char</code> is required for each character in the word plus the first character beyond. In many cases, <code>unread-char</code> and <code>unget-char</code> do not enjoy this advantage, and <code>peek-char</code> or <code>lookahead-char</code> should be used instead.</p>
</div>
<div id="io:s66" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(unget-u8 <em>binary-input-port</em> <em>octet</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedures "unreads" the last byte read from <code>binary-input-port</code>. <code><em>octet</em></code> may or may not be ignored, depending upon the implementation. In any case, <code><em>octet</em></code> should be last byte read from the port. A byte should not be unread twice on the same port without an intervening call to <code>get-u8</code>.</p>
</div>
<div id="io:s67" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(input-port-ready? <em>input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if data is available on <code><em>input-port</em></code>, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>input-port-ready?</code> allows a program to check to see if input is available on a textual or binary input port without hanging. If input is available or the port is at end of file, <code>input-port-ready?</code> returns <code>#t</code>. If it cannot determine from the port whether input is ready, <code>input-port-ready?</code> raises an exception with condition type <code>&amp;i/o-read-error</code>. Otherwise, it returns <code>#f</code>.</p>
</div>
<div id="io:s68" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(char-ready?)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(char-ready? <em>textual-input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if a character is available on <code><em>textual-input-port</em></code>, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code><em>textual-input-port</em></code> is not supplied, it defaults to the current input port. <code>char-ready?</code> is like <code>input-port-ready?</code> except it is restricted to textual input ports.</p>
</div>
<div id="io:s69" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(block-read <em>textual-input-port</em> <em>string</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(block-read <em>textual-input-port</em> <em>string</em> <em>count</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>count</em></code> must be a nonnegative fixnum less than or equal to the length of <code><em>string</em></code>. If not provided, it defaults to the length of <code><em>string</em></code>.</p>
</div>
<div class="paragraph">
<p>If <code><em>textual-input-port</em></code> is at end-of-file, an eof object is returned. Otherwise, <code><em>string</em></code> is filled with as many characters as are available for reading from <code><em>textual-input-port</em></code> up to <code><em>count</em></code>, and the number of characters placed in the string is returned.</p>
</div>
<div class="paragraph">
<p>If <code><em>textual-input-port</em></code> is buffered and the buffer is nonempty, the buffered input or a portion thereof is returned; otherwise <code>block-read</code> bypasses the buffer entirely.</p>
</div>
<div id="io:s70" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(read-token)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(read-token <em>textual-input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(read-token <em>textual-input-port</em> <em>sfd</em> <em>bfp</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>sfd</em></code> must be a source-file descriptor. <code><em>bfp</em></code> must be an exact nonnegative integer and should be the character position of the next character to be read from <code><em>textual-input-port</em></code>.</p>
</div>
<div class="paragraph">
<p>Parsing of a Scheme datum is conceptually performed in two steps. First, the sequence of characters that form the datum are grouped into <code>tokens</code>, such as symbols, numbers, left parentheses, and double quotes. During this first step, whitespace and comments are discarded. Second, these tokens are grouped into data.</p>
</div>
<div class="paragraph">
<p><code>read</code> performs both of these steps and creates an internal representation of each datum it parses. <code>read-token</code> may be used to perform the first step only, one token at a time. <code>read-token</code> is intended to be used by editors and program formatters that must be able to parse a program or datum without actually reading it.</p>
</div>
<div class="paragraph">
<p>If <code><em>textual-input-port</em></code> is not supplied, it defaults to the current input port. One token is read from the input port and returned as four values:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code><em>type</em></code></dt>
<dd>
<p>a symbol describing the type of token read,</p>
</dd>
<dt class="hdlist1"><code><em>value</em></code></dt>
<dd>
<p>the token value,</p>
</dd>
<dt class="hdlist1"><code><em>start</em></code></dt>
<dd>
<p>the position of the first character of the token, relative to the starting position of the input port (or <code>#f</code>, if the position cannot be determined), and</p>
</dd>
<dt class="hdlist1"><code><em>end</em></code></dt>
<dd>
<p>the first position beyond the token, relative to the starting position of the input port (or <code>#f</code>, if the position cannot be determined).</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The input port is left pointing to the first character position beyond the token.</p>
</div>
<div class="paragraph">
<p>When the token type fully specifies the token, <code>read-token</code> returns <code>#f</code> for the value. The token types are listed below with the corresponding <code><em>value</em></code> in parentheses.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>atomic</code></dt>
<dd>
<p>(<code><em>atom</em></code>) an atomic value, i.e., a symbol, boolean, number, character, <code>#!eof</code>, or <code>#!bwp</code></p>
</dd>
<dt class="hdlist1"><code>box</code></dt>
<dd>
<p>(<code>#f</code>) box prefix, i.e., <code>#&amp;</code></p>
</dd>
<dt class="hdlist1"><code>dot</code></dt>
<dd>
<p>(<code>#f</code>) dotted pair separator, i.e., <code>.</code></p>
</dd>
<dt class="hdlist1"><code>eof</code></dt>
<dd>
<p>(<code>#!eof</code>) end of file</p>
</dd>
<dt class="hdlist1"><code>fasl</code></dt>
<dd>
<p>(<code>#f</code>) fasl prefix, i.e., <code>#@</code></p>
</dd>
<dt class="hdlist1"><code>insert</code></dt>
<dd>
<p>(<code><em>n</em></code>) graph reference, i.e., <code>#<em>n</em>#</code></p>
</dd>
<dt class="hdlist1"><code>lbrack</code></dt>
<dd>
<p>(<code>#f</code>) open square bracket</p>
</dd>
<dt class="hdlist1"><code>lparen</code></dt>
<dd>
<p>(<code>#f</code>) open parenthesis</p>
</dd>
<dt class="hdlist1"><code>mark</code></dt>
<dd>
<p>(<code><em>n</em></code>) graph mark, i.e., <code>#<em>n</em>=</code></p>
</dd>
<dt class="hdlist1"><code>quote</code></dt>
<dd>
<p>(<code>quote</code>, <code>quasiquote</code>, <code>syntax</code>, <code>unquote</code>, <code>unquote-splicing</code>, or <code>datum-comment</code>) an abbreviation mark, e.g., <code>'</code> or <code>,@</code> or datum-comment prefix</p>
</dd>
<dt class="hdlist1"><code>rbrack</code></dt>
<dd>
<p>(<code>#f</code>) close square bracket</p>
</dd>
<dt class="hdlist1"><code>record-brack</code></dt>
<dd>
<p>(<code>#f</code>) record open bracket, i.e., <code>#[</code></p>
</dd>
<dt class="hdlist1"><code>rparen</code></dt>
<dd>
<p>(<code>#f</code>) close parenthesis</p>
</dd>
<dt class="hdlist1"><code>vfxnparen</code></dt>
<dd>
<p>(<code><em>n</em></code>) fxvector prefix, i.e., <code>#<em>n</em>vfx(</code></p>
</dd>
<dt class="hdlist1"><code>vfxparen</code></dt>
<dd>
<p>(<code>#f</code>) fxvector prefix, i.e., <code>#vfx(</code></p>
</dd>
<dt class="hdlist1"><code>vnparen</code></dt>
<dd>
<p>(<code><em>n</em></code>) vector prefix, i.e., <code>#<em>n</em>(</code></p>
</dd>
<dt class="hdlist1"><code>vparen</code></dt>
<dd>
<p>(<code>#f</code>) vector prefix, i.e., <code>#(</code></p>
</dd>
<dt class="hdlist1"><code>vu8nparen</code></dt>
<dd>
<p>(<code><em>n</em></code>) bytevector prefix, i.e., <code>#<em>n</em>vu8(</code></p>
</dd>
<dt class="hdlist1"><code>vu8paren</code></dt>
<dd>
<p>(<code>#f</code>) bytevector prefix, i.e., <code>#vu8(</code></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The set of token types is likely to change in future releases of the system; check the release notes for details on such changes.</p>
</div>
<div class="paragraph">
<p>Specifying <code><em>sfd</em></code> and <code><em>bfp</em></code> improves the quality of error messages, guarantees <code><em>start</em></code> and <code><em>end</em></code> can be determined, and eliminates the overhead of asking for a file position on each call to <code>read-token</code>. In most cases, <code><em>bfp</em></code> should be 0 for the first call to <code>read-token</code> at the start of a file, and it should be the fourth return value (<code><em>end</em></code>) of the preceding call to <code>read-token</code> for each subsequent call. This protocol is necessary to handle files containing multiple-byte characters, since file positions do not necessarily correspond to character positions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define s (open-input-string "(a b c)"))
(read-token s) ⇒ lparen
                   #f
                   0
                   1
(define s (open-input-string "abc 123"))
(read-token s) ⇒ atomic
                   abc
                   0
                   3
(define s (open-input-string ""))
(read-token s) ⇒ eof
                   #!eof
                   0
                   0
(define s (open-input-string "#7=#7#"))
(read-token s) ⇒ mark
                   7
                   0
                   3
(read-token s) ⇒ insert
                   7
                   3
                   6</code></pre>
</div>
</div>
<div class="paragraph">
<p>The information <code>read-token</code> returns is not always sufficient for reconstituting the exact sequence of characters that make up a token. For example, <code>1.0</code> and <code>1e0</code> both return <code><em>type</em></code> <code>atomic</code> with <code><em>value</em></code> <code>1.0</code>. The exact sequence of characters may be obtained only by repositioning the port and reading a block of characters of the appropriate length, using the relative positions given by <code><em>start</em></code> and <code><em>end</em></code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_9.9.">Section 9.9. Output Operations</h3>
<div id="io:s71" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>console-output-port</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>console-output-port</code> is a parameter that determines the output port used by the waiter and interactive debugger. When called with no arguments, it returns the console output port. When called with one argument, which must be a textual output port, it changes the value of the console output port. The initial value of this parameter is a port tied to the standard output (stdout) stream of the Scheme process.</p>
</div>
<div id="io:s72" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>current-output-port</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>current-output-port</code> is a parameter that determines the default port argument for most output procedures, including <code>write-char</code>, <code>newline</code>, <code>write</code>, <code>display</code>, and <code>pretty-print</code>. When called with no arguments, <code>current-output-port</code> returns the current output port. When called with one argument, which must be a textual output port, it changes the value of the current output port. The Revised<sup>6</sup> Report version of <code>current-output-port</code> accepts only zero arguments, i.e., it cannot be used to change the current output port. The initial value of this parameter is the same port as the initial value of <code>console-output-port</code>.</p>
</div>
<div id="io:s73" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>console-error-port</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>console-error-port</code> is a parameter that can be used to set or obtain the console error port, which determines the port to which conditions and other messages are printed by the default exception handler. When called with no arguments, <code>console-error-port</code> returns the console error port. When called with one argument, which must be a textual output port, it changes the value of the console error port.</p>
</div>
<div class="paragraph">
<p>If the system determines that the standard output (stdout) and standard error (stderr) streams refer to the same file, socket, pipe, virtual terminal, device, etc., this parameter is initially set to the same value as the parameter <code>console-output-port</code>. Otherwise, this parameter is initially set to a different port tied to the standard error (stderr) stream of the Scheme process.</p>
</div>
<div id="io:s74" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>current-error-port</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>current-error-port</code> is a parameter that can be used to set or obtain the current error port. When called with no arguments, <code>current-error-port</code> returns the current error port. When called with one argument, which must be a textual output port, it changes the value of the current error port. The Revised<sup>6</sup> Report version of <code>current-error-port</code> accepts only zero arguments, i.e., it cannot be used to change the current error port. The initial value of this parameter is the same port as the initial value of <code>console-error-port</code>.</p>
</div>
<div id="io:s75" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(open-output-file <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(open-output-file <em>path</em> <em>options</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new output port</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. <code>open-output-file</code> opens a textual output port for the file named by <code><em>path</em></code>.</p>
</div>
<div class="paragraph">
<p><code><em>options</em></code>, if present, is a symbolic option name or option list. Possible symbolic option names are <code>error</code>, <code>truncate</code>, <code>replace</code>, <code>append</code>, <code>compressed</code>, <code>uncompressed</code>, <code>buffered</code>, <code>unbuffered</code>, <code>exclusive</code>, and <code>nonexclusive</code>. An option list is a list containing zero or more symbolic option names and possibly the two-element option <code>mode <em>mode</em></code>.</p>
</div>
<div class="paragraph">
<p>The mutually exclusive <code>error</code>, <code>truncate</code>, <code>replace</code>, and <code>append</code> options are used to direct what happens when the file to be opened already exists.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>error</code></dt>
<dd>
<p>An exception is raised with condition-type <code>&amp;i/o-filename</code>.</p>
</dd>
<dt class="hdlist1"><code>replace</code></dt>
<dd>
<p>The existing file is deleted before the new file is opened.</p>
</dd>
<dt class="hdlist1"><code>truncate</code></dt>
<dd>
<p>The existing file is opened and truncated to zero length.</p>
</dd>
<dt class="hdlist1"><code>append</code></dt>
<dd>
<p>The existing file is opened and the output port is positioned at the end of the file before each write so that output to the port is always appended to the file.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The default behavior is to raise an exception.</p>
</div>
<div class="paragraph">
<p>The mutually exclusive <code>compressed</code> and <code>uncompressed</code> options determine whether the output file is to be compressed. The compression format and level are determined by the <code>compress-format</code> and <code>compress-level</code> parameters. Files are uncompressed by default, so the <code>uncompressed</code> option is useful only as documentation.</p>
</div>
<div class="paragraph">
<p>The mutually exclusive <code>buffered</code> and <code>unbuffered</code> options determine whether output is buffered. Unbuffered output is sent immediately to the file, whereas buffered output not written until the port&#8217;s output buffer is filled or the port is flushed (via <code>flush-output-port</code>) or closed (via <code>flush-output-port</code> or by the storage management system when the port becomes inaccessible). Output is buffered by default for efficiency, so the <code>buffered</code> option is useful only as documentation.</p>
</div>
<div class="paragraph">
<p>The mutually exclusive <code>exclusive</code> and <code>nonexclusive</code> options determine whether access to the file is "exclusive." When the exclusive option is specified, the file is locked until the port is closed to prevent access by other processes. On some systems the lock is advisory, i.e., it inhibits access by other processes only if they also attempt to open exclusively. Nonexclusive access is the default, so the <code>nonexclusive</code> option is useful only as documentation.</p>
</div>
<div class="paragraph">
<p>The <code>mode</code> option determines the permission bits on Unix systems when the file is created by the operation, subject to the process umask. The subsequent element in the options list must be an exact integer specifying the permissions in the manner of the Unix <code>open</code> function. The mode option is ignored under Windows.</p>
</div>
<div class="paragraph">
<p>For example, the call</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(open-output-file "frob" '(compressed truncate mode #o644))</code></pre>
</div>
</div>
<div class="paragraph">
<p>opens the file frob with compression enabled. If frob already exists it is truncated. On Unix-based systems, if frob does not already exist, the permission bits on the newly created file are set to logical and of <code>#o644</code> and the process&#8217;s umask.</p>
</div>
<div class="paragraph">
<p>The Revised<sup>6</sup> Report version of <code>open-output-file</code> does not support the optional <code><em>options</em></code> argument.</p>
</div>
<div id="io:s78" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(call-with-output-file <em>path</em> <em>procedure</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(call-with-output-file <em>path</em> <em>procedure</em> <em>options</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the values returned by <code><em>procedure</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. <code><em>procedure</em></code> should accept one argument.</p>
</div>
<div class="paragraph">
<p><code>call-with-output-file</code> creates a new output port for the file named by <code><em>path</em></code>, as if with <code>open-output-file</code>, and passes this port to <code><em>procedure</em></code>. If <code><em>procedure</em></code> returns, <code>call-with-output-file</code> closes the output port and returns the values returned by <code><em>procedure</em></code>.</p>
</div>
<div class="paragraph">
<p><code>call-with-output-file</code> does not automatically close the output port if a continuation created outside of <code><em>procedure</em></code> is invoked, since it is possible that another continuation created inside of <code><em>procedure</em></code> will be invoked at a later time, returning control to <code><em>procedure</em></code>. If <code><em>procedure</em></code> does not return, an implementation is free to close the output port only if it can prove that the output port is no longer accessible. As shown in <a href="../../the-scheme-programming-language-4th/en/index.html#section_5.6.">Section 5.6</a> of <em>The Scheme Programming Language, 4th Edition</em>, <code>dynamic-wind</code> may be used to ensure that the port is closed if a continuation created outside of <code><em>procedure</em></code> is invoked.</p>
</div>
<div class="paragraph">
<p>See <code>open-output-file</code> above for a description of the optional <code><em>options</em></code> argument.</p>
</div>
<div class="paragraph">
<p>The Revised<sup>6</sup> Report version of <code>call-with-output-file</code> does not support the optional <code><em>options</em></code> argument.</p>
</div>
<div id="io:s79" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(with-output-to-file <em>path</em> <em>thunk</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(with-output-to-file <em>path</em> <em>thunk</em> <em>options</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the value returned by <code><em>thunk</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. <code><em>thunk</em></code> must be a procedure and should accept zero arguments.</p>
</div>
<div class="paragraph">
<p><code>with-output-to-file</code> temporarily rebinds the current output port to be the result of opening the file named by <code><em>path</em></code>, as if with <code>open-output-file</code>, during the application of <code><em>thunk</em></code>. If <code><em>thunk</em></code> returns, the port is closed and the current output port is restored to its old value.</p>
</div>
<div class="paragraph">
<p>The behavior of <code>with-output-to-file</code> is unspecified if a continuation created outside of <code><em>thunk</em></code> is invoked before <code><em>thunk</em></code> returns. An implementation may close the port and restore the current output port to its old value---but it may not.</p>
</div>
<div class="paragraph">
<p>See <code>open-output-file</code> above for a description of the optional <code><em>options</em></code> argument.</p>
</div>
<div class="paragraph">
<p>The Revised<sup>6</sup> Report version of <code>with-output-to-file</code> does not support the optional <code><em>options</em></code> argument.</p>
</div>
<div id="io:s80" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(open-fd-output-port <em>fd</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(open-fd-output-port <em>fd</em> <em>b-mode</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(open-fd-output-port <em>fd</em> <em>b-mode</em> <em>?transcoder</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new output port for the file descriptor <code><em>fd</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>fd</em></code> must be a nonnegative exact integer and should be a valid open file descriptor. If <code><em>?transcoder</em></code> is present and not <code>#f</code>, it must be a transcoder, and this procedure returns a textual output port whose transcoder is <code><em>?transcoder</em></code>. Otherwise, this procedure returns a binary output port. See the lead-in to <a href="../../the-scheme-programming-language-4th/en/index.html#section_7.2.">Section 7.2</a> of <em>The Scheme Programming Language, 4th Edition</em> for a description of the constraints on and effects of the other arguments.</p>
</div>
<div class="paragraph">
<p>The file descriptor is closed when the port is closed.</p>
</div>
<div id="io:s81" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(standard-output-port)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(standard-output-port <em>b-mode</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(standard-output-port <em>b-mode</em> <em>?transcoder</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new output port connected to the process&#8217;s standard output</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code><em>?transcoder</em></code> is present and not <code>#f</code>, it must be a transcoder, and this procedure returns a textual output port whose transcoder is <code><em>?transcoder</em></code>. Otherwise, this procedure returns a binary output port. The buffer mode <code><em>b-mode</em></code> defaults to <code>line</code>, which differs from <code>block</code> in <em>Chez Scheme</em> only for textual output ports.</p>
</div>
<div class="paragraph">
<p>The Revised<sup>6</sup> Report version of this procedure does not accept the optional <code><em>b-mode</em></code> and <code><em>?transcoder</em></code> arguments, which limits it to an implementation-dependent buffering mode (<code>line</code> in <em>Chez Scheme</em>) and binary output.</p>
</div>
<div id="io:s82" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(standard-error-port)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(standard-error-port <em>b-mode</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(standard-error-port <em>b-mode</em> <em>?transcoder</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new output port connected to the process&#8217;s standard error</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code><em>?transcoder</em></code> is present and not <code>#f</code>, it must be a transcoder, and this procedure returns a textual output port whose transcoder is <code><em>?transcoder</em></code>. Otherwise, this procedure returns a binary output port. The buffer mode <code><em>b-mode</em></code> defaults to <code>none</code>. See the lead-in to <a href="../../the-scheme-programming-language-4th/en/index.html#section_7.2.">Section 7.2</a> of <em>The Scheme Programming Language, 4th Edition</em> for a description of the constraints on and effects of the other arguments.</p>
</div>
<div class="paragraph">
<p>The Revised<sup>6</sup> Report version of this procedure does not accept the optional <code><em>b-mode</em></code> and <code><em>?transcoder</em></code> arguments, which limits it to an implementation-dependent buffering mode (<code>none</code> in <em>Chez Scheme</em>) and binary output.</p>
</div>
<div id="io:s83" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(put-bytevector-some <em>binary-output-port</em> <em>bytevector</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(put-bytevector-some <em>binary-output-port</em> <em>bytevector</em> <em>start</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(put-bytevector-some <em>binary-output-port</em> <em>bytevector</em> <em>start</em> <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the number of bytes written</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>start</em></code> and <code><em>n</em></code> must be nonnegative exact integers, and the sum of <code><em>start</em></code> and <code><em>n</em></code> must not exceed the length of <code><em>bytevector</em></code>. If not supplied, <code><em>start</em></code> defaults to zero and <code><em>n</em></code> defaults to the difference between the length of <code><em>bytevector</em></code> and <code><em>start</em></code>.</p>
</div>
<div class="paragraph">
<p>This procedure normally writes the <code><em>n</em></code> bytes of <code><em>bytevector</em></code> starting at <code><em>start</em></code> to the port and advances the its position past the end of the bytes written. If the port is in nonblocking mode (see <code>set-port-nonblocking!</code>), however, the number of bytes written may be less than <code><em>n</em></code>, if the system would have to block to write more bytes.</p>
</div>
<div id="io:s84" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(put-string-some <em>textual-output-port</em> <em>string</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(put-string-some <em>textual-output-port</em> <em>string</em> <em>start</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(put-string-some <em>textual-output-port</em> <em>string</em> <em>start</em> <em>n</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the number of characters written</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>start</em></code> and <code><em>n</em></code> must be nonnegative exact integers, and the sum of <code><em>start</em></code> and <code><em>n</em></code> must not exceed the length of <code><em>string</em></code>. If not supplied, <code><em>start</em></code> defaults to zero and <code><em>n</em></code> defaults to the difference between the length of <code><em>string</em></code> and <code><em>start</em></code>.</p>
</div>
<div class="paragraph">
<p>This procedure normally writes the <code><em>n</em></code> characters of <code><em>string</em></code> starting at <code><em>start</em></code> to the port and advances the its position past the end of the characters written. If the port is in nonblocking mode (see <code>set-port-nonblocking!</code>), however, the number of characters written may be less than <code><em>n</em></code>, if the system would have to block to write more characters.</p>
</div>
<div id="io:s85" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(display-string <em>string</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(display-string <em>string</em> <em>textual-output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>display-string</code> writes the characters contained within <code><em>string</em></code> to <code><em>textual-output-port</em></code> or to the current-output port if <code>textual-output-port</code> is not specified. The enclosing string quotes are not printed, and special characters within the string are not escaped. <code>display-string</code> is a more efficient alternative to <code>display</code> for displaying strings.</p>
</div>
<div id="io:s86" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(block-write <em>textual-output-port</em> <em>string</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(block-write <em>textual-output-port</em> <em>string</em> <em>count</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>count</em></code> must be a nonnegative fixnum less than or equal to the length of <code><em>string</em></code>. If not provided, it defaults to the length of <code><em>string</em></code>.</p>
</div>
<div class="paragraph">
<p><code>block-write</code> writes the first <code><em>count</em></code> characters of <code><em>string</em></code> to <code><em>textual-output-port</em></code>. If the port is buffered and the buffer is nonempty, the buffer is flushed before the contents of <code><em>string</em></code> are written. In any case, the contents of <code><em>string</em></code> are written immediately, without passing through the buffer.</p>
</div>
<div id="io:s87" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(truncate-port <em>output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(truncate-port <em>output-port</em> <em>pos</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(truncate-file <em>output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(truncate-file <em>output-port</em> <em>pos</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>truncate-port</code> and <code>truncate-file</code> are identical.</p>
</div>
<div class="paragraph">
<p><code><em>pos</em></code> must be an exact nonnegative integer. It defaults to 0.</p>
</div>
<div class="paragraph">
<p>These procedures truncate the file or other object associated with <code><em>output-port</em></code> to <code><em>pos</em></code> and repositions the port to that position, i.e., it combines the functionality of <code>set-port-length!</code> and <code>set-port-position!</code> and can be called on a port only if <code>port-has-set-port-length!?</code> and <code>port-has-set-port-position!?</code> are both true of the port. <a id="io:s88"></a></p>
</div>
<div id="desc:fresh-line" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fresh-line)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fresh-line <em>textual-output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code><em>textual-output-port</em></code> is not supplied, it defaults to the current output port.</p>
</div>
<div class="paragraph">
<p>This procedure behaves like <code>newline</code>, i.e., sends a newline character to <code><em>textual-output-port</em></code>, unless it can determine that the port is already positioned at the start of a line. It does this by flushing the port and consulting the "beginning-of-line" (BOL) flag associated with the port. (See page <a href="#desc:set-port-bol">222</a>.)</p>
</div>
</div>
<div class="sect2">
<h3 id="section_9.10.">Section 9.10. Input/Output Operations</h3>
<div id="io:s89" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(open-input-output-file <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(open-input-output-file <em>path</em> <em>options</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new input-output port</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. <code>open-input-output-file</code> opens a textual input-output port for the file named by <code><em>path</em></code>.</p>
</div>
<div class="paragraph">
<p>The port may be used to read from or write to the named file. The file is created if it does not already exist.</p>
</div>
<div class="paragraph">
<p><code><em>options</em></code>, if present, is a symbolic option name or option list. Possible symbolic option names are <code>buffered</code>, <code>unbuffered</code>, <code>exclusive</code>, and <code>nonexclusive</code>. An option list is a list containing zero or more symbolic option names and possibly the two-element option <code>mode <em>mode</em></code>. See the description of <code>open-output-file</code> for an explanation of these options.</p>
</div>
<div class="paragraph">
<p>Input/output files are usually closed using <code>close-port</code> but may also be closed with either <code>close-input-port</code> or <code>close-output-port</code>.</p>
</div>
<div id="io:s90" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(open-fd-input/output-port <em>fd</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(open-fd-input/output-port <em>fd</em> <em>b-mode</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(open-fd-input/output-port <em>fd</em> <em>b-mode</em> <em>?transcoder</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new input/output port for the file descriptor <code><em>fd</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>fd</em></code> must be a nonnegative exact integer and should be a valid open file descriptor. If <code><em>?transcoder</em></code> is present and not <code>#f</code>, it must be a transcoder, and this procedure returns a textual input/output port whose transcoder is <code><em>?transcoder</em></code>. Otherwise, this procedure returns a binary input/output port. See the lead-in to <a href="../../the-scheme-programming-language-4th/en/index.html#section_7.2.">Section 7.2</a> of <em>The Scheme Programming Language, 4th Edition</em> for a description of the constraints on and effects of the other arguments.</p>
</div>
<div class="paragraph">
<p>The file descriptor is closed when the port is closed.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_9.11.">Section 9.11. Non-Unicode Bytevector/String Conversions</h3>
<div class="paragraph">
<p>The procedures described in this section convert bytevectors containing single- and multiple-byte sequences in non-Unicode character sets to and from Scheme strings. They are available only under Windows. Under other operating systems, and when an <code>iconv</code> DLL is available under Windows, <code>bytevector-&gt;string</code> and <code>string-&gt;bytevector</code> can be used with a transcoder based on a codec constructed via <code>iconv-codec</code> to achieve the same results, with more control over the handling of invalid characters and line endings.</p>
</div>
<div id="io:s92" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(multibyte-&gt;string <em>code-page</em> <em>bytevector</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a string containing the characters encoded in <code><em>bytevector</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(string-&gt;multibyte <em>code-page</em> <em>string</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a bytevector containing the encodings of the characters in <code><em>string</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These procedures are available only under Windows. The procedure <code>multibyte-&gt;string</code> is a wrapper for the Windows API <code>MultiByteToWideChar</code> function, and <code>string-&gt;multibyte</code> is a wrapper for the Windows API <code>WideCharToMultiByte</code> function.</p>
</div>
<div class="paragraph">
<p><code><em>code-page</em></code> declares the encoding of the byte sequences in the input or output bytevectors. It must be an exact nonnegative integer identifying a code page or one of the symbols <code>cp-acp</code>, <code>cp-maccp</code>, <code>cp-oemcp</code>, <code>cp-symbol</code>, <code>cp-thread-acp</code>, <code>cp-utf7</code>, or <code>cp-utf8</code>, which have the same meanings as the API function meanings for the like-named constants.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_9.12.">Section 9.12. Pretty Printing</h3>
<div class="paragraph">
<p>The pretty printer is a version of the <code>write</code> procedure that produces more human-readable output via introduced whitespace, i.e., line breaks and indentation. The pretty printer is the default printer used by the read-eval-print loop (waiter) to print the output(s) of each evaluated form. The pretty printer may also be invoked explicitly by calling the procedure <code>pretty-print</code>.</p>
</div>
<div class="paragraph">
<p>The pretty printer&#8217;s operation can be controlled via the <code>pretty-format</code> procedure described later in this section, which allows the programmer to specify how specific forms are to be printed, various pretty-printer controls, also described later in this section, and also by the generic input/output controls described in <a href="#section_9.14.">Section 9.14</a>.</p>
</div>
<div id="io:s93" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(pretty-print <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(pretty-print <em>obj</em> <em>textual-output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code><em>textual-output-port</em></code> is not supplied, it defaults to the current output port.</p>
</div>
<div class="paragraph">
<p><code>pretty-print</code> is similar to <code>write</code> except that it uses any number of spaces and newlines in order to print <code><em>obj</em></code> in a style that is pleasing to look at and which shows the nesting level via indentation. For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(pretty-print '(define factorial (lambda (n) (let fact ((i n) (a 1))
  (if (= i 0) a (fact (- i 1) (* a i)))))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>might produce</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define factorial
  (lambda (n)
    (let fact ([i n] [a 1])
      (if (= i 0) a (fact (- i 1) (* a i))))))</code></pre>
</div>
</div>
<div id="io:s94" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(pretty-file <em>ifn</em> <em>ofn</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>ifn</em></code> and <code><em>ofn</em></code> must be strings. <code>pretty-file</code> reads each object in turn from the file named by <code><em>ifn</em></code> and pretty prints the object to the file named by <code><em>ofn</em></code>. Comments present in the input are discarded by the reader and so do not appear in the output file. If the file named by <code><em>ofn</em></code> already exists, it is replaced.</p>
</div>
<div id="io:s95" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(pretty-format <em>sym</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(pretty-format <em>sym</em> <em>fmt</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, the pretty printer uses a generic algorithm for printing each form. This procedure is used to override this default and guide the pretty-printers treatment of specific forms. The symbol <code><em>sym</em></code> names a syntactic form or procedure. With just one argument, <code>pretty-format</code> returns the current format associated with <code><em>sym</em></code>, or <code>#f</code> if no format is associated with <code><em>sym</em></code>.</p>
</div>
<div class="paragraph">
<p>In the two-argument case, the format <code><em>fmt</em></code> is associated with <code><em>sym</em></code> for future invocations of the pretty printer. <code><em>fmt</em></code> must be in the formatting language described below.</p>
</div>
<table class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;fmt&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8594;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(quote <em>symbol</em>)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">|<code>var</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">|<code><em>symbol</em></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">|<code>(read-macro <em>string</em> <em>symbol</em>)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">|<code>(meta)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">|<code>(bracket . <em>fmt-tail</em>)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">|<code>(alt <em>fmt</em> <em>fmt</em>*)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">|<code><em>fmt-tail</em></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>fmt-tail</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8594;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">|<code>(<em>tab</em> <em>fmt</em> ...)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">|<code>(<em>fmt</em> <em>tab</em> ...)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">|<code>(<em>tab</em> <em>fmt</em> . <em>fmt-tail</em>)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">|<code>(<em>fmt</em> ...)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">|<code>(<em>fmt</em> . <em>fmt-tail</em>)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">|<code>(fill <em>tab</em> <em>fmt</em> ...)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>tab</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8594;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>int</em></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">|<code>#f</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Some of the format forms are used for matching when there are multiple alternatives, while others are used for matching and control indentation or printing. A description of each <code><em>fmt</em></code> is given below.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>(quote <em>symbol</em>)</code></dt>
<dd>
<p>This matches only the symbol <code><em>symbol</em></code>.</p>
</dd>
<dt class="hdlist1"><code>var</code></dt>
<dd>
<p>This matches any symbol.</p>
</dd>
<dt class="hdlist1"><code><em>symbol</em></code></dt>
<dd>
<p>This matches any input.</p>
</dd>
<dt class="hdlist1"><code>(read-macro <em>string</em> <em>symbol</em>)</code></dt>
<dd>
<p>This is used for read macros like <code>quote</code> and <code><em>syntax</em></code>. It matches any input of the form (<code><em>symbol</em></code> <code><em>subform</em></code>). For forms that match, the pretty printer prints <code><em>string</em></code> immediately followed by <code><em>subform</em></code>.</p>
</dd>
<dt class="hdlist1"><code>(meta)</code></dt>
<dd>
<p>This is a special case used for the <code>meta</code> keyword (<a href="#section_11.8.">Section 11.8</a>) which is used as a keyword prefix of another form.</p>
</dd>
<dt class="hdlist1"><code>(alt <em>fmt</em> <em>fmt</em>*)</code></dt>
<dd>
<p>This compares the input against the specified formats and uses the one that is the closest match. Most often, one of the formats will match exactly, but in other cases, as when input is malformed or appears in abstract form in the template of a syntactic abstraction, none of the formats will match exactly.</p>
</dd>
<dt class="hdlist1"><code>(bracket . <em>fmt-tail</em>)</code></dt>
<dd>
<p>This matches any list-structured input and prints the input enclosed in square brackets, i.e., <code>[</code> and <code>]</code>, rather than parentheses.</p>
</dd>
<dt class="hdlist1"><code><em>fmt-tail</em></code></dt>
<dd>
<p>This matches any list-structured input.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Indentation of list-structured forms is determined via the <code><em>fmt-tail</em></code> specifier used to the last two cases above. A description of each <code><em>fmt-tail</em></code> is given below.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>()</code></dt>
<dd>
<p>This matches an empty list tail.</p>
</dd>
<dt class="hdlist1"><code>(<em>tab</em> <em>fmt</em> ...)</code></dt>
<dd>
<p>This matches the tail of any proper list; if the tail is nonempty and the list does not fit entirely on the current line, a line break is inserted before the first subform of the tail and <code><em>tab</em></code> (see below) determines the amount by which this and all subsequent subforms are indented.</p>
</dd>
<dt class="hdlist1"><code>(<em>fmt</em> <em>tab</em> ...)</code></dt>
<dd>
<p>This matches the tail of any proper list; if the tail is nonempty and the list does not fit entirely on the current line, a line break is inserted after the first subform of the tail and <code><em>tab</em></code> (see below) determines the amount by which all subsequent subforms are indented.</p>
</dd>
<dt class="hdlist1"><code>(<em>tab</em> <em>fmt</em> . <em>fmt-tail</em>)</code></dt>
<dd>
<p>This matches a nonempty tail if the tail of the tail matches <code><em>fmt-tail</em></code>. If the list does not fit entirely on the current line, a line break is inserted before the first subform of the tail and <code><em>tab</em></code> (see below) determines the amount by which the subform is indented.</p>
</dd>
<dt class="hdlist1"><code>(<em>fmt</em> ...)</code></dt>
<dd>
<p>This matches the tail of any proper list and specified that no line breaks are to be inserted before or after the current or subsequent subforms.</p>
</dd>
<dt class="hdlist1"><code>(<em>fmt</em> . <em>fmt-tail</em>)</code></dt>
<dd>
<p>This matches a nonempty tail if the tail of the tail matches <code><em>fmt-tail</em></code> and specifies that no line break is to be inserted before or after the current subform.</p>
</dd>
<dt class="hdlist1"><code>(fill <em>tab</em> <em>fmt</em> ...)</code></dt>
<dd>
<p>This matches the tail of any proper list and invokes a fill mode in which the forms are packed with as many as will fit on each line.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>A <code><em>tab</em></code> determines the amount by which a list subform is indented. If <code><em>tab</em></code> is a nonnegative exact integer <code><em>int</em></code>, the subform is indented <code><em>int</em></code> spaces in from the character position just after the opening parenthesis or bracket of the parent form. If <code><em>tab</em></code> is <code>#f</code>, the standard indentation is used. The standard indentation can be determined or changed via the parameter <code>pretty-standard-indent</code>, which is described later in this section.</p>
</div>
<div class="paragraph">
<p>In cases where a format is given that doesn&#8217;t quite match, the pretty printer tries to use the given format as far as it can. For example, if a format matches a list-structured form with a specific number of subforms, but more or fewer subform are given, the pretty printer will discard or replicate subform formats as necessary.</p>
</div>
<div class="paragraph">
<p>Here is an example showing the formatting of <code><em>let</em></code> might be specified.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(pretty-format 'let
  '(alt (let ([bracket var x] 0 ...) #f e #f e ...)
        (let var ([bracket var x] 0 ...) #f e #f e ...)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since <code>let</code> comes in two forms, named and unnamed, two alternatives are specified. In either case, the <code>bracket</code> <code><em>fmt</em></code> is used to enclose the bindings in square brackets, with all bindings after the first appearing just below the first (and just after the enclosing opening parenthesis), if they don&#8217;t all fit on one line. Each body form is indented by the standard indentation.</p>
</div>
<div id="io:s98" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>pretty-line-length</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>pretty-one-line-limit</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of each of these parameters must be a positive fixnum.</p>
</div>
<div class="paragraph">
<p>The parameters <code>pretty-line-length</code> and <code>pretty-one-line-limit</code> control the output produced by <code>pretty-print</code>. <code>pretty-line-length</code> determines after which character position (starting from the first) on a line the pretty printer attempts to cut off output. This is a soft limit only; if necessary, the pretty-printer will go beyond <code>pretty-line-length</code>.</p>
</div>
<div class="paragraph">
<p><code>pretty-one-line-limit</code> is similar to <code>pretty-line-length</code>, except that it is relative to the first nonblank position on each line of output. It is also a soft limit.</p>
</div>
<div id="io:s100" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>pretty-initial-indent</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of this parameter must be a nonnegative fixnum.</p>
</div>
<div class="paragraph">
<p>The parameter <code>pretty-initial-indent</code> is used to tell <code>pretty-print</code> where on an output line it has been called. If <code>pretty-initial-indent</code> is zero (the default), <code>pretty-print</code> assumes that the first line of output it produces will start at the beginning of the line. If set to a nonzero value <code><em>n</em></code>, <code>pretty-print</code> assumes that the first line will appear at character position <code><em>n</em></code> and will adjust its printing of subsequent lines.</p>
</div>
<div id="io:s102" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>pretty-standard-indent</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of this parameter must be a nonnegative fixnum.</p>
</div>
<div class="paragraph">
<p>This determines the amount by which <code>pretty-print</code> indents subexpressions of most forms, such as <code>let</code> expressions, from the form&#8217;s keyword or first subexpression.</p>
</div>
<div id="io:s103" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>pretty-maximum-lines</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The parameter <code>pretty-maximum-lines</code> controls how many lines <code>pretty-print</code> prints when it is called. If set to <code>#f</code> (the default), no limit is imposed; if set to a nonnegative fixnum <code><em>n</em></code>, at most <code><em>n</em></code> lines are printed.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_9.13.">Section 9.13. Formatted Output</h3>
<div id="io:s104" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(format <em>format-string</em> <em>obj</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(format #f <em>format-string</em> <em>obj</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(format #t <em>format-string</em> <em>obj</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(format <em>textual-output-port</em> <em>format-string</em> <em>obj</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="io:s105" class="paragraph">
<p>When the first argument to format is a string or <code>#f</code> (first and second forms above), <code>format</code> constructs an output string from <code><em>format-string</em></code> and the objects <code><em>obj</em> ...</code>. Characters are copied from <code><em>format-string</em></code> to the output string from left to right, until <code><em>format-string</em></code> is exhausted. The format string may contain one or more <code><em>format directives</em></code>, which are multi-character sequences prefixed by a tilde ( <code>~</code> ). Each directive is replaced by some other text, often involving one or more of the <code><em>obj</em> ...</code> arguments, as determined by the semantics of the directive.</p>
</div>
<div class="paragraph">
<p>When the first argument is <code>#t</code>, output is sent to the current output port instead, as with <code>printf</code>. When the first argument is a port, output is sent to that port, as with <code>fprintf</code>. <code>printf</code> and <code>fprintf</code> are described later in this section.</p>
</div>
<div class="paragraph">
<p><em>Chez Scheme</em>'s implementation of <code>format</code> supports all of the Common Lisp <a href="#ref30">[30]</a> format directives except for those specific to the Common Lisp pretty printer. Please consult a Common Lisp reference or the <a href="http://www.lispworks.com/documentation/HyperSpec/Front/index.htm">Common Lisp Hyperspec</a>, for complete documentation. A few of the most useful directives are described below.</p>
</div>
<div class="paragraph">
<p>Absent any format directives, <code>format</code> simply displays its string argument.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(format "hi there") ⇒ "hi there"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>~s</code> directive is replaced by the printed representation of the next <code><em>obj</em></code>, which may be any object, in machine-readable format, as with <code>write</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(format "hi ~s" 'mom) ⇒ "hi mom"
(format "hi ~s" "mom") ⇒ "hi \"mom\""
(format "hi ~s~s" 'mom #\!) ⇒ "hi mom#\\!"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The general form of a <code>~s</code> directive is actually <code>~<em>mincol</em>,<em>colinc</em>,<em>minpad</em>,<em>padchar</em>s</code>, and the <code>s</code> can be preceded by an at sign ( <code>@</code> ) modifier. These additional parameters are used to control padding in the output, with at least <code><em>minpad</em></code> copies of <code><em>padchar</em></code> plus an integer multiple of <code><em>colinc</em></code> copies of <code><em>padchar</em></code> to make the total width, including the written object, <code><em>mincol</em></code> characters wide. The padding is placed on the left if the <code><em>@</em></code> modifier is present, otherwise on the right. <code><em>mincol</em></code> and <code><em>minpad</em></code> default to 0, <code><em>colinc</em></code> defaults to 1, and <code><em>padchar</em></code> defaults to space. If specified, <code><em>padchar</em></code> is prefixed by a single quote mark.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(format "~10s" 'hello) ⇒ "hello     "
(format "~10@s" 'hello) ⇒ "     hello"
(format "~10,,,'*@s" 'hello) ⇒ "*****hello"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>~a</code> directive is similar, but prints the object as with <code>display</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(format "hi ~s~s" "mom" #\!) ⇒ "hi \"mom\"#\\!"
(format "hi ~a~a" "mom" #\!) ⇒ "hi mom!"</code></pre>
</div>
</div>
<div class="paragraph">
<p>A tilde may be inserted into the output with <code>~~</code>, and a newline may be inserted with <code>~%</code> (or embedded in the string with <code>\n</code>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(format "~~line one,~%line two.~~") ⇒ "~line one,\nline two.~"
(format "~~line one,\nline two.~~") ⇒ "~line one,\nline two.~"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Real numbers may be printed in floating-point notation with <code>~f</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(format "~f" 3.14159) ⇒ 3.14159</code></pre>
</div>
</div>
<div class="paragraph">
<p>Exact numbers may printed as well as inexact numbers in this manner; they are simply converted to inexact first as if with <code>exact-&gt;inexact</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(format "~f" 1/3) ⇒ "0.3333333333333333"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The general form is actually <code>~<em>w</em>,<em>d</em>,<em>k</em>,<em>overflowchar</em>,<em>padchar</em>f</code>. If specified, <code><em>w</em></code> determines the overall width of the output, and <code><em>d</em></code> the number of digits to the right of the decimal point. <code><em>padchar</em></code>, which defaults to space, is the pad character used if padding is needed. Padding is always inserted on the left. The number is scaled by 10<sup>k</sup> when printed; <code><em>k</em></code> defaults to zero. The entire <code><em>w</em></code>-character field is filled with copies of <code><em>overflowchar</em></code> if <code><em>overflowchar</em></code> is specified and the number cannot be printed in <code><em>w</em></code> characters. <code><em>k</em></code> defaults to 1 If an <code>@</code> modifier is present, a plus sign is printed before the number for nonnegative inputs; otherwise, a sign is printed only if the number is negative.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(format "~,3f" 3.14159) ⇒ "3.142"
(format "~10f" 3.14159) ⇒ "   3.14159"
(format "~10,,,'#f" 1e20) ⇒ "##########"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Real numbers may also be printed with <code>~e</code> for scientific notation or with <code>~g</code>, which uses either floating-point or scientific notation based on the size of the input.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(format "~e" 1e23) ⇒ "1.0e+23"
(format "~g" 1e23) ⇒ "1.0e+23"</code></pre>
</div>
</div>
<div class="paragraph">
<p>A real number may also be printed with <code>~$</code>, which uses monetary notation defaulting to two digits to the right of the decimal point.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(format "$~$" (* 39.95 1.06)) ⇒ "$42.35"
(format "~$USD" 1/3) ⇒ "0.33USD"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Words can be pluralized automatically using <code>p</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(format "~s bear~:p in ~s den~:p" 10 1) ⇒ "10 bears in 1 den"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Numbers may be printed out in words or roman numerals using variations on <code>~r</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(format "~r" 2599) ⇒  "two thousand five hundred ninety-nine"
(format "~:r" 99) ⇒  "ninety-ninth"
(format "~@r" 2599) ⇒ "MMDXCIX"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Case conversions can be performed by bracketing a portion of the format string with the <code>~@(</code> and <code>~)</code> directives.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(format "~@(~r~)" 2599) ⇒  "Two thousand five hundred ninety-nine"
(format "~@:(~a~)" "Ouch!") ⇒  "OUCH!"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Some of the directives shown above have more options and parameters, and there are other directives as well, including directives for conditionals, iteration, indirection, and justification. Again, please consult a Common Lisp reference for complete documentation.</p>
</div>
<div class="paragraph">
<p>An implementation of a greatly simplified version of <code>format</code> appears in <a href="../../the-scheme-programming-language-4th/en/index.html#section_12.6.">Section 12.6</a> of <em>The Scheme Programming Language, 4th Edition</em>.</p>
</div>
<div id="io:s106" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(printf <em>format-string</em> <em>obj</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fprintf <em>textual-output-port</em> <em>format-string</em> <em>obj</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These procedures are simple wrappers for <code>format</code>. <code>printf</code> prints the formatted output to the current output, as with a first-argument of <code>#t</code> to <code>format</code>, and <code>fprintf</code> prints the formatted output to the <code><em>textual-output-port</em></code>, as when the first argument to <code>format</code> is a port.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_9.14.">Section 9.14. Input/Output Control Operations</h3>
<div class="paragraph">
<p>The I/O control operations described in this section are used to control how the reader reads and printer writes, displays, or pretty-prints characters, symbols, gensyms, numbers, vectors, long or deeply nested lists or vectors, and graph-structured objects. <a id="io:s107"></a></p>
</div>
<div id="desc:char-name" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(char-name <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(char-name <em>name</em> <em>char</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>char-name</code> is used to associate names (symbols) with characters or to retrieve the most recently associated name or character for a given character or name. A name can map to only one character, but more than one name can map to the same character. The name most recently associated with a character determines how that character prints, and each name associated with a character may be used after the <code>#\</code> character prefix to name that character on input.</p>
</div>
<div class="paragraph">
<p>Character associations created by <code>char-name</code> are ignored by the printer unless the parameter <code>print-char-name</code> is set to a true value. The reader recognizes character names established by <code>char-name</code> except after <code>#!r6rs</code>, which is implied within a library or R6RS top-level program.</p>
</div>
<div class="paragraph">
<p>In the one-argument form, <code><em>obj</em></code> must be a symbol or character. If it is a symbol and a character is associated with the symbol, <code>char-name</code> returns that character. If it is a symbol and no character is associated with the symbol, <code>char-name</code> returns <code>#f</code>. Similarly, if <code><em>obj</em></code> is a character, <code>char-name</code> returns the most recently associated symbol for the character or <code>#f</code> if no name is associated with the character. For example, with the default set of character names:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(char-name #\space) ⇒ space
(char-name 'space) ⇒ #\space
(char-name 'nochar) ⇒ #f
(char-name #\a) ⇒ #f</code></pre>
</div>
</div>
<div class="paragraph">
<p>When passed two arguments, <code><em>name</em></code> is added to the set of names associated with <code><em>char</em></code>, and any other association for <code><em>name</em></code> is dropped. <code><em>char</em></code> may be <code>#f</code>, in which case any other association for <code><em>name</em></code> is dropped and no new association is formed. In either case, any other names associated with <code><em>char</em></code> remain associated with <code><em>char</em></code>.</p>
</div>
<div class="paragraph">
<p>The following interactive session demonstrates the use of <code>char-name</code> to establish and remove associations between characters and names, including the association of more than one name with a character.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(print-char-name #t)
(char-name 'etx) ⇒ #f
(char-name 'etx #\x3)
(char-name 'etx) ⇒ #\etx
(char-name #\x3) ⇒ etx
#\etx ⇒ #\etx
(eq? #\etx #\x3) ⇒ #t
#!r6rs #\etx ⇒ <em>exception: invalid character name etx</em>
#!chezscheme #\etx ⇒ #\etx
(char-name 'etx #\space)
(char-name #\x3) ⇒ #f
(char-name 'etx) ⇒ #\etx
#\space ⇒ #\etx
(char-name 'etx #f)
#\etx ⇒ <em>exception: invalid character name etx</em>
#\space ⇒ #\space</code></pre>
</div>
</div>
<div class="paragraph">
<p>(When using the expression editor, it is necessary to type Control-J to force the editor to read the erroneous <code>#\etx</code> input on the two inputs above that result in read errors, since typing Enter causes the expression editor to read the input only if the input is well-formed.)</p>
</div>
<div class="paragraph">
<p>The reader does not recognize hex scalar value escapes in character names, as it does in symbols, so <code>#\new\x6c;ine</code> is not equivalent to <code>#\newline</code>. In general, programmers should avoid the use of character name symbols that cannot be entered without the use of hex scalar value escapes or other symbol-name escape mechanisms, since such character names will not be readable.</p>
</div>
<div id="io:s108" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>print-char-name</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When <code>print-char-name</code> is set to <code>#f</code> (the default), associations created by <code>char-name</code> are ignored by <code>write</code>, <code>put-datum</code>, <code>pretty-print</code>, and the <code>format</code> "<code>~s</code>" directive. Otherwise, these procedures use the names established by <code>char-name</code> when printing character objects.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(char-name 'etx #\x3)
(format "~s" #\x3) ⇒ "#\\x3"
(parameterize ([print-char-name #t])
  (format "~s" #\x3)) ⇒ "#\\etx"</code></pre>
</div>
</div>
<div id="io:s109" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>case-sensitive</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>case-sensitive</code> parameter determines whether the reader is case-sensitive with respect to symbol and character names. When set to true (the default, as required by the Revised<sup>6</sup> Report) the case of alphabetic characters within symbol names is significant. When set to <code>#f</code>, case is insignificant. More precisely, when set to <code>#f</code>, symbol and character names are folded (as if by <code>string-foldcase</code>); otherwise, they are left as they appear in the input.</p>
</div>
<div class="paragraph">
<p>The value of the <code>case-sensitive</code> matters only if neither <code>#!fold-case</code> nor <code>#!no-fold-case</code> has appeared previously in the same input stream. That is, symbol and character name are folded if <code>#!fold-case</code> has been seen. They are not folded if <code>#!no-fold-case</code> has been seen. If neither has been seen, they are folded if and only if <code>(case-sensitive)</code> is <code>#f</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(case-sensitive) ⇒ #t
(eq? 'abc 'ABC) ⇒ #f
'ABC ⇒ ABC
(case-sensitive #f)
'ABC ⇒ abc
(eq? 'abc 'ABC) ⇒ #t</code></pre>
</div>
</div>
<div id="io:s110" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>print-graph</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When <code>print-graph</code> is set to a true value, <code>write</code> and <code>pretty-print</code> locate and print objects with shared structure, including cycles, in a notation that may be read subsequently with <code>read</code>. This notation employs the syntax "<code>#<em>n</em>=<em>obj</em></code>," where <code><em>n</em></code> is a nonnegative integer and <code><em>obj</em></code> is the printed representation of an object, to label the first occurrence of <code><em>obj</em></code> in the output. The syntax "<code>#<em>n</em>#</code>" is used to refer to the object labeled by <code><em>n</em></code> thereafter in the output. <code>print-graph</code> is set to <code>#f</code> by default.</p>
</div>
<div class="paragraph">
<p>If graph printing is not enabled, the settings of <code>print-length</code> and <code>print-level</code> are insufficient to force finite output, and <code>write</code> or <code>pretty-print</code> detects a cycle in an object it is given to print, a warning is issued (an exception with condition type <code>&amp;warning</code> is raised) and the object is printed as if <code>print-graph</code> were enabled.</p>
</div>
<div class="paragraph">
<p>Since objects printed through the <code>~s</code> option in the format control strings of <code>format</code>, <code>printf</code>, and <code>fprintf</code> are printed as with <code>write</code>, the printing of such objects is also affected by <code>print-graph</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(parameterize ([print-graph #t])
  (let ([x (list 'a 'b)])
    (format "~s" (list x x)))) ⇒ "(#0=(a b) #0#)"

(parameterize ([print-graph #t])
  (let ([x (list 'a 'b)])
    (set-car! x x)
    (set-cdr! x x)
    (format "~s" x))) ⇒ "#0=(#0# . #0#)"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The graph syntax is understood by the procedure <code>read</code>, allowing graph structures to be printed and read consistently.</p>
</div>
<div id="io:s114" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>print-level</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>print-length</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These parameters can be used to limit the extent to which nested or multiple-element structures are printed. When called without arguments, <code>print-level</code> returns the current print level and <code>print-length</code> returns the current print length. When called with one argument, which must be a nonnegative fixnum or <code>#f</code>, <code>print-level</code> sets the current print level and <code>print-length</code> sets the current print length to the argument.</p>
</div>
<div class="paragraph">
<p>When <code>print-level</code> is set to a nonnegative integer <code><em>n</em></code>, <code>write</code> and <code>pretty-print</code> traverse only <code><em>n</em></code> levels deep into nested structures. If a structure being printed exceeds <code><em>n</em></code> levels of nesting, the substructure beyond that point is replaced in the output by an ellipsis ( <code>...</code> ). <code>print-level</code> is set to <code>#f</code> by default, which places no limit on the number of levels printed.</p>
</div>
<div class="paragraph">
<p>When <code>print-length</code> is set to a nonnegative integer <code><em>n</em></code>, the procedures <code>write</code> and <code>pretty-print</code> print only <code><em>n</em></code> elements of a list or vector, replacing the remainder of the list or vector with an ellipsis ( <code>...</code> ). <code>print-length</code> is set to <code>#f</code> by default, which places no limit on the number of elements printed.</p>
</div>
<div class="paragraph">
<p>Since objects printed through the <code>~s</code> option in the format control strings of <code>format</code>, <code>printf</code>, and <code>fprintf</code> are printed as with <code>write</code>, the printing of such objects is also affected by <code>print-level</code> and <code>print-length</code>.</p>
</div>
<div class="paragraph">
<p>The parameters <code>print-level</code> and <code>print-length</code> are useful for controlling the volume of output in contexts where only a small portion of the output is needed to identify the object being printed. They are also useful in situations where circular structures may be printed (see also <code>print-graph</code>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(format "~s" '((((a) b) c) d e f g)) ⇒ "((((a) b) c) d e f g)"

(parameterize ([print-level 2])
  (format "~s" '((((a) b) c) d e f g))) ⇒ "(((...) c) d e f g)"

(parameterize ([print-length 3])
  (format "~s" '((((a) b) c) d e f g))) ⇒ "((((a) b) c) d e ...)"

(parameterize ([print-level 2]
               [print-length 3])
  (format "~s" '((((a) b) c) d e f g))) ⇒ "(((...) c) d e ...)"</code></pre>
</div>
</div>
<div id="io:s119" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>print-radix</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>print-radix</code> parameter determines the radix in which numbers are printed by <code>write</code>, <code>pretty-print</code>, and <code>display</code>. Its value should be an integer between 2 and 36, inclusive. Its default value is 10.</p>
</div>
<div class="paragraph">
<p>When the value of <code>print-radix</code> is not 10, <code>write</code> and <code>pretty-print</code> print a radix prefix before the number (<code>#b</code> for radix 2, <code>#o</code> for radix 8, <code>#x</code> for radix 16, and <code>#<em>n</em>r</code> for any other radix <code><em>n</em></code>).</p>
</div>
<div class="paragraph">
<p>Since objects printed through the <code>~s</code> and <code>~a</code> options in the format control strings of <code>format</code>, <code>printf</code>, and <code>fprintf</code> are printed as with <code>write</code> and <code>display</code>, the printing of such objects is also affected by <code>print-radix</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(format "~s" 11242957) ⇒ "11242957"

(parameterize ([print-radix 16])
  (format "~s" 11242957)) ⇒ "#xAB8DCD"

(parameterize ([print-radix 16])
  (format "~a" 11242957)) ⇒ "AB8DCD"</code></pre>
</div>
</div>
<div id="io:s120" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>print-gensym</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="io:s122" class="paragraph">
<p>When <code>print-gensym</code> is set to <code>#t</code> (the default) gensyms are printed with an extended symbol syntax that includes both the pretty name and the unique name of the gensym: <code>#{<em>pretty-name</em> <em>unique-name</em>}</code>. When set to <code>pretty</code>, the pretty name only is shown, with the prefix <code>#:</code>. When set to <code>pretty/suffix</code>, the printer prints the gensym&#8217;s "pretty" name along with a suffix based on the gensym&#8217;s "unique" name, separated by a dot ( "." ). If the gensym&#8217;s unique name is generated automatically during the current session, the suffix is that portion of the unique name that is not common to all gensyms created during the current session. Otherwise, the suffix is the entire unique name. When set to <code>#f</code>, the pretty name only is shown, with no prefix.</p>
</div>
<div class="paragraph">
<p>Since objects printed through the <code>~s</code> option in the format control strings of <code>format</code>, <code>printf</code>, <code>errorf</code>, etc., are printed as with <code>write</code>, the printing of such objects is also affected by <code>print-gensym</code>.</p>
</div>
<div class="paragraph">
<p>When printing an object that may contain more than one occurrence of a gensym and <code>print-graph</code> is set to <code>pretty</code> or <code>#f</code>, it is useful to set <code>print-graph</code> to <code>#t</code> so that multiple occurrences of the same gensym are marked as identical in the output.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([g (gensym)])
  (format "~s" g)) ⇒ "#{g0 bdids2xl6v49vgwe-a}"

(let ([g (gensym)])
  (parameterize ([print-gensym 'pretty])
    (format "~s" g))) ⇒ "#:g1

(let ([g (gensym)])
  (parameterize ([print-gensym #f])
    (format "~s" g))) ⇒ "g2"

(let ([g (gensym)])
  (parameterize ([print-graph #t] [print-gensym 'pretty])
    (format "~s" (list g g)))) ⇒ "(#0=#:g3 #0#)"

(let ([g1 (gensym "x")]
      [g2 (gensym "x")]
      [g3 (gensym "y")])
  (parameterize ([print-gensym 'pretty/suffix])
    (format "~s ~s ~s" g1 g2 g3))) ⇒ "x.1 x.2 y.3"</code></pre>
</div>
</div>
<div id="io:s125" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>print-brackets</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When <code>print-brackets</code> is set to a true value, the pretty printer (see <code>pretty-print</code>) uses square brackets rather than parentheses around certain subexpressions of common control structures, e.g., around <code>let</code> bindings and <code>cond</code> clauses. <code>print-brackets</code> is set to <code>#t</code> by default.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([p (open-output-string)])
  (pretty-print '(let ([x 3]) x) p) ⇒ "(let ([x 3]) x)
  (get-output-string p))             "

(parameterize ([print-brackets #f])
  (let ([p (open-output-string)])
    (pretty-print '(let ([x 3]) x) p) ⇒ "(let ((x 3)) x)
    (get-output-string p)))            "</code></pre>
</div>
</div>
<div id="io:s127" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>print-extended-identifiers</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Chez Scheme extends the syntax of identifiers as described in <a href="#section_1.1.">Section 1.1</a>, except within a set of forms prefixed by <code>#!r6rs</code> (which is implied by in a library or top-level program).</p>
</div>
<div class="paragraph">
<p>When this parameter is set to false (the default), identifiers in the extended set are printed with hex scalar value escapes as necessary to conform to the R6RS syntax for identifiers. When this parameter is set to a true value, identifiers in the extended set are printed without the escapes. Identifiers whose names fall outside of both syntaxes are printed with the escapes regardless of the setting of this parameter.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(parameterize ([print-extended-identifiers #f])
  (printf "~s\n~s\n"
    '(1+ --- { } .xyz)
    (string->symbol "123")))</code></pre>
</div>
</div>
<div class="paragraph">
<p>prints</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(\x31;+ \x2D;-- \x7B; \x7D; \x2E;xyz)
\x31;23</code></pre>
</div>
</div>
<div class="paragraph">
<p>while</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(parameterize ([print-extended-identifiers #t])
  (printf "~s\n~s\n"
    '(1+ --- { } .xyz)
    (string->symbol "123")))</code></pre>
</div>
</div>
<div class="paragraph">
<p>prints</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(1+ --- { } .xyz)
\x31;23</code></pre>
</div>
</div>
<div id="io:s128" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>print-vector-length</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When <code>print-vector-length</code> is set to a true value, <code>write</code>, <code>put-datum</code>, and <code>pretty-print</code> includes the length for all vectors between the "<code>#</code>" and open parenthesis, all bytevectors between the "<code>#vu8</code>" and open parenthesis, and all fxvectors between the "<code>#vfx</code>" and open parenthesis. This parameter is set to <code>#f</code> by default.</p>
</div>
<div id="io:s129" class="paragraph">
<p>When <code>print-vector-length</code> is set to a true value, <code>write</code>, <code>put-datum</code>, and <code>pretty-print</code> also suppress duplicated trailing elements in the vector to reduce the amount of output. This form is also recognized by the reader.</p>
</div>
<div class="paragraph">
<p>Since objects printed through the <code>~s</code> option in the format control strings of <code>format</code>, <code>printf</code>, and <code>fprintf</code> are printed as with <code>write</code>, the printing of such objects is also affected by the setting of <code>print-vector-length</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(format "~s" (vector 'a 'b 'c 'c 'c)) ⇒ "#(a b c c c)"

(parameterize ([print-vector-length #t])
  (format "~s" (vector 'a 'b 'c 'c 'c))) ⇒ "#5(a b c)"

(parameterize ([print-vector-length #t])
  (format "~s" (bytevector 1 2 3 4 4 4))) ⇒ "#6vu8(1 2 3 4)"

(parameterize ([print-vector-length #t])
  (format "~s" (fxvector 1 2 3 4 4 4))) ⇒ "#6vfx(1 2 3 4)"</code></pre>
</div>
</div>
<div id="io:s130" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>print-precision</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When <code>print-precision</code> is set to <code>#f</code> (the default), <code>write</code>, <code>put-datum</code>, <code>pretty-print</code>, and the <code>format</code> "<code>~s</code>" directive do not include the vertical-bar "mantissa-width" syntax after each floating-point number. When set to a nonnegative exact integer, the mantissa width is included, as per the precision argument to <code>number-&gt;string</code>.</p>
</div>
<div id="io:s131" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>print-unicode</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When <code>print-unicode</code> is set to <code>#f</code>, <code>write</code>, <code>put-datum</code>, <code>pretty-print</code>, and the <code>format</code> "<code>~s</code>" directive display Unicode characters with encodings 80<sub>16</sub> (128) and above that appear within character objects, symbols, and strings using hexadecimal character escapes. When set to a true value (the default), they are displayed like other printing characters, as if by <code>put-char</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(format "~s" #\x3bb) ⇒ "#\\λ"
(parameterize ([print-unicode #f])
  (format "~s" #\x3bb)) ⇒ "#\\x3BB"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_9.15.">Section 9.15. Fasl Output</h3>
<div id="io:s132" class="paragraph">
<p>The procedures <code>write</code> and <code>pretty-print</code> print objects in a human readable format. For objects with external datum representations, the output produced by <code>write</code> and <code>pretty-print</code> is also machine-readable with <code>read</code>. Objects with external datum representations include pairs, symbols, vectors, strings, numbers, characters, booleans, and records but not procedures and ports.</p>
</div>
<div class="paragraph">
<p>An alternative <em>fast loading</em>, or <em>fasl</em>, format may be used for objects with external datum representations. The fasl format is not human readable, but it is machine readable and both more compact and more quickly processed by <code>read</code>. This format is always used for compiled code generated by <code>compile-file</code>, but it may also be used for data that needs to be written and read quickly, such as small databases encoded with Scheme data structures.</p>
</div>
<div class="paragraph">
<p>Objects are printed in fasl format with <code>fasl-write</code>. Because the fasl format is a binary format, fasl output must be written to a binary port. For this reason, it is not possible to include data written in fasl format with textual data in the same file, as was the case in earlier versions of <em>Chez Scheme</em>. Similarly, the (textual) reader does not handle objects written in fasl format; the procedure <code>fasl-read</code>, which requires a binary input port, must be used instead.</p>
</div>
<div id="io:s133" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fasl-write <em>obj</em> <em>binary-output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>fasl-write</code> writes the fasl representation of <code><em>obj</em></code> to <code><em>binary-output-port</em></code>. An exception is raised with condition-type <code>&amp;assertion</code> if <code><em>obj</em></code> or any portion of <code><em>obj</em></code> has no external fasl representation, e.g., if <code><em>obj</em></code> is or contains a procedure.</p>
</div>
<div class="paragraph">
<p>The fasl representation of <code><em>obj</em></code> is compressed if the parameter <code>fasl-compressed</code>, described below, is set to <code>#t</code>, its default value. For this reason, <code><em>binary-output-port</em></code> generally should not be opened with the compressed option. A warning is issued (an exception with condition type <code>&amp;warning</code> is raised) on the first attempt to write fasl objects to or read fasl objects from a compressed file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define bop (open-file-output-port "tmp.fsl"))
(fasl-write '(a b c) bop)
(close-port bop)

(define bip (open-file-input-port "tmp.fsl"))
(fasl-read bip) ⇒ (a b c)
(fasl-read bip) ⇒ #!eof
(close-port bip)</code></pre>
</div>
</div>
<div id="io:s134" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fasl-read <em>binary-input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fasl-read <em>binary-input-port situation</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If present, <code><em>situation</em></code> must be one of the symbols <code>load</code>, <code>visit</code>, or <code>revisit</code>. It defaults to <code>load</code>.</p>
</div>
<div class="paragraph">
<p><code>fasl-read</code> reads one object from <code><em>binary-input-port</em></code>, which must be positioned at the front of an object written in fasl format. <code>fasl-read</code> returns the eof object if the file is positioned at the end of file. If the situation is <code>visit</code>, <code>fasl-read</code> skips over any revisit (run-time-only) objects, and if the situation is <code>revisit</code>, <code>fasl-read</code> skips over any visit (compile-time-only) objects. It doesn&#8217;t skip any if the situation is <code>load</code>. Similarly, objects marked as both visit and revisit (e.g., object code corresponding to source code within an <code>eval-when</code> form with situation <code>load</code> or situations <code>visit</code> and <code>revisit</code>) are never skipped.</p>
</div>
<div class="paragraph">
<p><code>fasl-read</code> automatically decompresses the representation of each fasl object written in compressed format by <code>fasl-write</code>. Thus, <code><em>binary-input-port</em></code> generally should not be opened with the compressed option. A warning is issued (an exception with condition type <code>&amp;warning</code> is raised) on the first attempt to write fasl objects to or read fasl objects from a compressed file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define bop (open-file-output-port "tmp.fsl"))
(fasl-write '(a b c) bop)
(close-port bop)

(define bip (open-file-input-port "tmp.fsl"))
(fasl-read bip) ⇒ (a b c)
(fasl-read bip) ⇒ #!eof
(close-port bip)</code></pre>
</div>
</div>
<div id="io:s135" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>fasl-compressed</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When this parameter is set to its default value, <code>#t</code>, <code>fasl-write</code> compresses the representation of each object as it writes it, often resulting in substantially smaller output but possibly taking more time to write and read. The compression format and level are determined by the <code>compress-format</code> and <code>compress-level</code> parameters.</p>
</div>
<div id="io:s138" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fasl-file <em>ifn</em> <em>ofn</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>ifn</em></code> and <code><em>ofn</em></code> must be strings. <code>fasl-file</code> may be used to convert a file in human-readable format into an equivalent file written in fasl format. <code>fasl-file</code> reads each object in turn from the file named by <code><em>ifn</em></code> and writes the fasl format for the object onto the file named by <code><em>ofn</em></code>. If the file named by <code><em>ofn</em></code> already exists, it is replaced.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_9.16.">Section 9.16. File System Interface</h3>
<div class="paragraph">
<p>This section describes operations on files, directories, and pathnames.</p>
</div>
<div id="io:s139" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>current-directory</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>cd</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When invoked without arguments, <code>current-directory</code> returns a string representing the current working directory. Otherwise, the current working directory is changed to the directory specified by the argument, which must be a string representing a valid directory pathname.</p>
</div>
<div class="paragraph">
<p><code>cd</code> is bound to the same parameter.</p>
</div>
<div id="io:s140" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(directory-list <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of file names</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. The return value is a list of strings representing the names of files found in the directory named by <code><em>path</em></code>. <code>directory-list</code> raises an exception with condition type <code>&amp;i/o-filename</code> if <code><em>path</em></code> does not name a directory or if the process cannot list the directory.</p>
</div>
<div id="io:s141" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(file-exists? <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(file-exists? <em>path</em> <em>follow?</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the file named by <code><em>path</em></code> exists, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. If the optional <code><em>follow?</em></code> argument is true (the default), <code>file-exists?</code> follows symbolic links; otherwise it does not. Thus, <code>file-exists?</code> will return <code>#f</code> when handed the pathname of a broken symbolic link unless <code><em>follow?</em></code> is provided and is <code>#f</code>.</p>
</div>
<div class="paragraph">
<p>The Revised<sup>6</sup> Report <code>file-exists?</code> does not accept the optional <code><em>follow?</em></code> argument. Whether it follows symbolic links is unspecified.</p>
</div>
<div id="io:s142" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(file-regular? <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(file-regular? <em>path</em> <em>follow?</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the file named by <code><em>path</em></code> is a regular file, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. If the optional <code><em>follow?</em></code> argument is true (the default), <code>file-regular?</code> follows symbolic links; otherwise it does not.</p>
</div>
<div id="io:s143" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(file-directory? <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(file-directory? <em>path</em> <em>follow?</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the file named by <code><em>path</em></code> is a directory, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. If the optional <code><em>follow?</em></code> argument is true (the default), this procedure follows symbolic links; otherwise it does not.</p>
</div>
<div id="io:s144" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(file-symbolic-link? <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the file named by <code><em>path</em></code> is a symbolic link, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. <code>file-symbolic-link?</code> never follows symbolic links in making its determination.</p>
</div>
<div id="io:s145" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(file-access-time <em>path/port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(file-access-time <em>path/port</em> <em>follow?</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the access time of the specified file</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(file-change-time <em>path/port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(file-change-time <em>path/port</em> <em>follow?</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the change time of the specified file</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(file-modification-time <em>path/port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(file-modification-time <em>path/port</em> <em>follow?</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the modification time of the specified file</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path/port</em></code> must be a string or port. If <code><em>path/port</em></code> is a string, the time returned is for the file named by the string, and the optional <code><em>follow?</em></code> argument determines whether symbolic links are followed. If <code><em>follow?</em></code> is true (the default), this procedure follows symbolic links; otherwise it does not. If <code><em>path/port</em></code> is a port, it must be a file port, and the time returned is for the associated file. In this case, <code><em>follow?</em></code> is ignored.</p>
</div>
<div class="paragraph">
<p>The returned times are represented as time objects (<a href="#section_12.10.">Section 12.10</a>).</p>
</div>
<div id="io:s146" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(mkdir <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(mkdir <em>path</em> <em>mode</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. <code><em>mode</em></code> must be a fixnum.</p>
</div>
<div class="paragraph">
<p><code>mkdir</code> creates a directory with the name given by <code><em>path</em></code>. All <code><em>path</em></code> path components leading up to the last must already exist. If the optional <code><em>mode</em></code> argument is present, it overrides the default permissions for the new directory. Under Windows, the <code><em>mode</em></code> argument is ignored.</p>
</div>
<div class="paragraph">
<p><code>mkdir</code> raises an exception with condition type <code>&amp;i/o-filename</code> if the directory cannot be created.</p>
</div>
<div id="io:s147" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(delete-file <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(delete-file <em>path</em> <em>error?</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. <code>delete-file</code> removes the file named by <code><em>path</em></code>. If the optional <code><em>error?</em></code> argument is <code>#f</code> (the default), <code>delete-file</code> returns a boolean value: <code>#t</code> if the operation is successful and <code>#f</code> if it is not. Otherwise, <code>delete-file</code> returns an unspecified value if the operation is successful and raises an exception with condition type <code>&amp;i/o-filename</code> if it is not.</p>
</div>
<div class="paragraph">
<p>The Revised<sup>6</sup> Report <code>delete-file</code> does not accept the optional <code><em>error?</em></code> argument but behaves as if <code><em>error?</em></code> is true.</p>
</div>
<div id="io:s148" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(delete-directory <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(delete-directory <em>path</em> <em>error?</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. <code>delete-directory</code> removes the directory named by <code><em>path</em></code>. If the optional <code><em>error?</em></code> argument is <code>#f</code> (the default), <code>delete-directory</code> returns a boolean value: <code>#t</code> if the operation is successful and <code>#f</code> if it is not. Otherwise, <code>delete-directory</code> returns an unspecified value if the operation is successful and raises an exception with condition type <code>&amp;i/o-filename</code> if it is not. The behavior is unspecified if the directory is not empty, but on most systems the operations will not succeed.</p>
</div>
<div id="io:s149" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(rename-file <em>old-pathname</em> <em>new-pathname</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>old-pathname</em></code> and <code><em>new-pathname</em></code> must be strings. <code>rename-file</code> changes the name of the file named by <code><em>old-pathname</em></code> to <code><em>new-pathname</em></code>. If the file does not exist or cannot be renamed, an exception is raised with condition type <code>&amp;i/o-filename</code>.</p>
</div>
<div id="io:s150" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(chmod <em>path</em> <em>mode</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. <code><em>mode</em></code> must be a fixnum.</p>
</div>
<div class="paragraph">
<p><code>chmod</code> sets the permissions on the file named by <code><em>path</em></code> to <code><em>mode</em></code>. Bits 0, 1, and 2 of <code><em>mode</em></code> are the execute, write, and read permission bits for users other than the file&#8217;s owner who are not in the file&#8217;s group. Bits 3-5 are the execute, write, and read permission bits for users other than the file&#8217;s owner but in the file&#8217;s group. Bits 6-8 are the execute, write, and read permission bits for the file&#8217;s owner. Bits 7-9 are the Unix sticky, set-group-id, and set-user-id bits. Under Windows, all but the user "write" bit are ignored. If the file does not exist or the permissions cannot be changed, an exception is raised with condition type <code>&amp;i/o-filename</code>.</p>
</div>
<div id="io:s151" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(get-mode <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(get-mode <em>path</em> <em>follow?</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the current permissions mode for <code><em>path</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. <code>get-mode</code> retrieves the permissions on the file named by <code><em>path</em></code> and returns them as a fixnum in the same form as the <code><em>mode</em></code> argument to <code>chmod</code>. If the optional <code><em>follow?</em></code> argument is true (the default), this procedure follows symbolic links; otherwise it does not.</p>
</div>
<div id="io:s152" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(directory-separator? <em>char</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>char</em></code> is a directory separator, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The character <code>#\/</code> is a directory separator on all current machine types, and <code>#\\</code> is a directory separator under Windows.</p>
</div>
<div id="io:s153" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(directory-separator)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the preferred directory separator</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The preferred directory separator is <code>#\\</code> for Windows and <code>#\/</code> for other systems.</p>
</div>
<div id="io:s154" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(path-first <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(path-rest <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(path-last <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(path-parent <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(path-extension <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(path-root <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the specified component of <code><em>path</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(path-absolute? <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>path</em></code> is absolute, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. The return value is also a (possibly empty) string.</p>
</div>
<div class="paragraph">
<p>The path first component is the first directory in the path, or the empty string if the path consists only of a single filename. The path rest component is the portion of the path that does not include the path first component or the directory separator (if any) that separates it from the rest of the path. The path last component is the last (filename) portion of <code><em>path</em></code>. The path parent component is the portion of <code><em>path</em></code> that does not include the path last component, if any, or the directory separator that separates it from the rest of the path.</p>
</div>
<div class="paragraph">
<p>If the first component of the path names a root directory (including drives and shares under Windows), home directory (e.g., <code>~/abc</code> or <code>~user/abc</code>), the current directory (<code>.</code>), or the parent directory (<code>..</code>), <code>path-first</code> returns that component. For paths that consist only of such a directory, both <code>path-first</code> and <code>path-parent</code> act as identity procedures, while <code>path-rest</code> and <code>path-last</code> return the empty string.</p>
</div>
<div class="paragraph">
<p>The path extension component is the portion of <code><em>path</em></code> that follows the last dot (period) in the last component of a path name. The path root component is the portion of <code><em>path</em></code> that does not include the extension, if any, or the dot that precedes it.</p>
</div>
<div class="paragraph">
<p>If the first component names a root directory (including drives and shares under Windows) or home directory, <code>path-absolute?</code> returns <code>#t</code>. Otherwise, <code>path-absolute?</code> returns <code>#f</code>.</p>
</div>
<div class="paragraph">
<p>The tables below identify the components for several example paths, with underscores representing empty strings.</p>
</div>
<table class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">abs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">first</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">parent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">last</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">root</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ext</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>a</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#f</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>a</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>a</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>a</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>a/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#f</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>a</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>a</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>a/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>a/b</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#f</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>a</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>b</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>a</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>b</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>a/b</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>a/b.c</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#f</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>a</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>b.c</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>a</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>b.c</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>a/b</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#t</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/a/b.c</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#t</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>a/b.c</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/a</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>b.c</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/a/b</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>~/a/b.c</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#t</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>~</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>a/b.c</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>~/a</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>b.c</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>~/a/b</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>~u/a/b.c</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#t</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>~u</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>a/b.c</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>~u/a</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>b.c</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>~u/a/b</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>../..</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#f</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>..</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>..</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>..</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>..</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>../..</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The second table shows the components when Windows drives and shares are involved.</p>
</div>
<table class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">abs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">first</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">parent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">last</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">root</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ext</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c:</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#f</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c:</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c:</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c:</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c:/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#t</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c:/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c:/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c:/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c:a/b</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#f</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c:</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>a/b</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c:a</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>b</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c:a/b</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>//s/a/b.c</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#t</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>//s</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>a/b.c</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>//s/a</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>b.c</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>//s/a/b</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>//s.com</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#t</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>//s.com</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>//s.com</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>//s.com</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following procedure can be used to reproduce the tables above.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define print-table
  (lambda path*
    (define print-row
      (lambda (abs? path first rest parent last root extension)
        (printf "~a~11t~a~17t~a~28t~a~39t~a~50t~a~61t~a~73t~a\n"
          abs? path first rest parent last root extension)))
    (print-row "path" "abs" "first" "rest" "parent" "last" "root" "ext")
    (for-each
      (lambda (path)
        (define uscore (lambda (s) (if (eqv? s "") "_" s)))
        (apply print-row path
          (map (lambda (s) (if (eqv? s "") "_" s))
               (list (path-absolute? path) (path-first path)
                 (path-rest path) (path-parent path) (path-last path)
                 (path-root path) (path-extension path)))))
      path*)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, the first table can be produced with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(print-table "a" "a/" "a/b" "a/b.c" "/" "/a/b.c" "~/a/b.c"
  "~u/a/b.c" "../..")</code></pre>
</div>
</div>
<div class="paragraph">
<p>while the second can be produced (under Windows) with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(print-table "c:" "c:/" "c:a/b" "//s/a/b.c" "//s.com")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_9.17.">Section 9.17. Generic Port Examples</h3>
<div class="paragraph">
<p>This section presents the definitions for three types of generic ports: two-way ports, transcript ports, and process ports.</p>
</div>
<div class="paragraph">
<p><strong>Two-way ports.</strong>  The first example defines <code>make-two-way-port</code>, which constructs a textual input/output port from a given pair of textual input and output ports. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ip (open-input-string "this is the input"))
(define op (open-output-string))
(define p (make-two-way-port ip op))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The port returned by <code>make-two-way-port</code> is both an input and an output port, and it is also a textual port:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(port? p) ⇒ #t
(input-port? p) ⇒ #t
(output-port? p) ⇒ #t
(textual-port? p) ⇒ #t</code></pre>
</div>
</div>
<div class="paragraph">
<p>Items read from a two-way port come from the constituent input port, and items written to a two-way port go to the constituent output port:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(read p) ⇒ this
(write 'hello p)
(get-output-string op) ⇒ hello</code></pre>
</div>
</div>
<div class="paragraph">
<p>The definition of <code>make-two-way-port</code> is straightforward. To keep the example simple, no local buffering is performed, although it would be more efficient to do so.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define make-two-way-port
  (lambda (ip op)
    (define handler
      (lambda (msg . args)
        (record-case (cons msg args)
          [block-read (p s n) (block-read ip s n)]
          [block-write (p s n) (block-write op s n)]
          [char-ready? (p) (char-ready? ip)]
          [clear-input-port (p) (clear-input-port ip)]
          [clear-output-port (p) (clear-output-port op)]
          [close-port (p) (mark-port-closed! p)]
          [flush-output-port (p) (flush-output-port op)]
          [file-position (p . pos) (apply file-position ip pos)]
          [file-length (p) (file-length ip)]
          [peek-char (p) (peek-char ip)]
          [port-name (p) "two-way"]
          [read-char (p) (read-char ip)]
          [unread-char (c p) (unread-char c ip)]
          [write-char (c p) (write-char c op)]
          [else (assertion-violationf 'two-way-port
                  "operation ~s not handled"
                  msg)])))
    (make-input/output-port handler "" "")))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Most of the messages are passed directly to one of the constituent ports. Exceptions are <code>close-port</code>, which is handled directly by marking the port closed, <code>port-name</code>, which is also handled directly. <code>file-position</code> and <code>file-length</code> are rather arbitrarily passed off to the input port.</p>
</div>
<div class="paragraph">
<p><strong>Transcript ports.</strong>  The next example defines <code>make-transcript-port</code>, which constructs a textual input/output port from three ports: a textual input port <code><em>ip</em></code> and two textual output ports, <code><em>op</em></code> and <code><em>tp</em></code>. Input read from a transcript port comes from <code><em>ip</em></code>, and output written to a transcript port goes to <code><em>op</em></code>. In this manner, transcript ports are similar to two-way ports. Unlike two-way ports, input from <code><em>ip</em></code> and output to <code><em>op</em></code> is also written to <code><em>tp</em></code>, so that <code><em>tp</em></code> reflects both input from <code><em>ip</em></code> and output to <code><em>op</em></code>.</p>
</div>
<div class="paragraph">
<p>Transcript ports may be used to define the Scheme procedures <code>transcript-on</code> and <code>transcript-off</code>, or the <em>Chez Scheme</em> procedure <code>transcript-cafe</code>. For example, here is a definition of <code>transcript-cafe</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define transcript-cafe
  (lambda (pathname)
    (let ([tp (open-output-file pathname 'replace)])
      (let ([p (make-transcript-port
                 (console-input-port)
                 (console-output-port)
                 tp)])
       ; set both console and current ports so that
       ; the waiter and read/write will be in sync
        (parameterize ([console-input-port p]
                       [console-output-port p]
                       [current-input-port p]
                       [current-output-port p])
          (let-values ([vals (new-cafe)])
            (close-port p)
            (close-port tp)
            (apply values vals)))))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The implementation of transcript ports is significantly more complex than the implementation of two-way ports defined above, primarily because it buffers input and output locally. Local buffering is needed to allow the transcript file to reflect accurately the actual input and output performed in the presence of <code>unread-char</code>, <code>clear-output-port</code>, and <code>clear-input-port</code>. Here is the code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define make-transcript-port
  (lambda (ip op tp)
    (define (handler msg . args)
      (record-case (cons msg args)
        [block-read (p str cnt)
         (with-interrupts-disabled
           (let ([b (port-input-buffer p)]
                 [i (port-input-index p)]
                 [s (port-input-size p)])
             (if (< i s)
                 (let ([cnt (fxmin cnt (fx- s i))])
                   (do ([i i (fx+ i 1)]
                        [j 0 (fx+ j 1)])
                       ((fx= j cnt)
                        (set-port-input-index! p i)
                        cnt)
                       (string-set! str j (string-ref b i))))
                 (let ([cnt (block-read ip str cnt)])
                   (unless (eof-object? cnt)
                     (block-write tp str cnt))
                   cnt))))]
        [char-ready? (p)
         (or (< (port-input-index p) (port-input-size p))
             (char-ready? ip))]
        [clear-input-port (p)
         ; set size to zero rather than index to size
         ; in order to invalidate unread-char
         (set-port-input-size! p 0)]
        [clear-output-port (p)
         (set-port-output-index! p 0)]
        [close-port (p)
         (with-interrupts-disabled
           (flush-output-port p)
           (set-port-output-size! p 0)
           (set-port-input-size! p 0)
           (mark-port-closed! p))]
        [file-position (p . pos)
         (if (null? pos)
             (most-negative-fixnum)
             (assertion-violationf 'transcript-port "cannot reposition"))]
        [flush-output-port (p)
         (with-interrupts-disabled
           (let ([b (port-output-buffer p)]
                 [i (port-output-index p)])
             (unless (fx= i 0)
               (block-write op b i)
               (block-write tp b i)
               (set-port-output-index! p 0)
               (set-port-bol! p
                 (char=? (string-ref b (fx- i 1)) #\newline))))
           (flush-output-port op)
           (flush-output-port tp))]
        [peek-char (p)
         (with-interrupts-disabled
           (let ([b (port-input-buffer p)]
                 [i (port-input-index p)]
                 [s (port-input-size p)])
             (if (fx< i s)
                 (string-ref b i)
                 (begin
                   (flush-output-port p)
                   (let ([s (block-read ip b)])
                     (if (eof-object? s)
                         s
                         (begin
                           (block-write tp b s)
                           (set-port-input-size! p s)
                           (string-ref b 0))))))))]
        [port-name (p) "transcript"]
        [constituent-ports (p) (values ip op tp)]
        [read-char (p)
         (with-interrupts-disabled
           (let ([c (peek-char p)])
             (unless (eof-object? c)
               (set-port-input-index! p
                 (fx+ (port-input-index p) 1)))
             c))]
        [unread-char (c p)
         (with-interrupts-disabled
           (let ([b (port-input-buffer p)]
                 [i (port-input-index p)]
                 [s (port-input-size p)])
             (when (fx= i 0)
               (assertion-violationf 'unread-char
                 "tried to unread too far on ~s"
                 p))
             (set-port-input-index! p (fx- i 1))
             ; following could be skipped; it's supposed
             ; to be the same character anyway
             (string-set! b (fx- i 1) c)))]
        [write-char (c p)
         (with-interrupts-disabled
           (let ([b (port-output-buffer p)]
                 [i (port-output-index p)]
                 [s (port-output-size p)])
             (string-set! b i c)
            ; could check here to be sure that we really
            ; need to flush; we may end up here even if
            ; the buffer isn't full
             (block-write op b (fx+ i 1))
             (block-write tp b (fx+ i 1))
             (set-port-output-index! p 0)
             (set-port-bol! p (char=? c #\newline))))]
        [block-write (p str cnt)
         (with-interrupts-disabled
          ; flush buffered data
           (let ([b (port-output-buffer p)]
                 [i (port-output-index p)])
             (unless (fx= i 0)
               (block-write op b i)
               (block-write tp b i)
               (set-port-output-index! p 0)
               (set-port-bol! p (char=? (string-ref b (fx- i 1)) #\newline))))
          ; write new data
           (unless (fx= cnt 0)
             (block-write op str cnt)
             (block-write tp str cnt)
             (set-port-bol! p
               (char=? (string-ref str (fx- cnt 1)) #\newline))))]
        [else (assertion-violationf 'transcript-port
                "operation ~s not handled"
                msg)]))
    (let ([ib (make-string 1024)] [ob (make-string 1024)])
      (let ([p (make-input/output-port handler ib ob)])
        (set-port-input-size! p 0)
        (set-port-output-size! p (fx- (string-length ob) 1))
        p))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The chosen length of both the input and output ports is the same; this is not necessary. They could have different lengths, or one could be buffered locally and the other not buffered locally. Local buffering could be disabled effectively by providing zero-length buffers.</p>
</div>
<div class="paragraph">
<p>After we create the port, the input size is set to zero since there is not yet any data to be read. The port output size is set to one less than the length of the buffer. This is done so that <code>write-char</code> always has one character position left over into which to write its character argument. Although this is not necessary, it does simplify the code somewhat while allowing the buffer to be flushed as soon as the last character is available.</p>
</div>
<div class="paragraph">
<p>Block reads and writes are performed on the constituent ports for efficiency and (in the case of writes) to ensure that the operations are performed immediately.</p>
</div>
<div class="paragraph">
<p>The call to <code>flush-output-port</code> in the handling of <code>read-char</code> insures that all output written to <code>op</code> appears before input is read from <code>ip</code>. Since <code>block-read</code> is typically used to support higher-level operations that are performing their own buffering, or for direct input and output in support of I/O-intensive applications, the flush call has been omitted from that part of the handler.</p>
</div>
<div class="paragraph">
<p>Critical sections are used whenever the handler manipulates one of the buffers, to protect against untimely interrupts that could lead to reentry into the handler. The critical sections are unnecessary if no such reentry is possible, i.e., if only one "thread" of the computation can have access to the port.</p>
</div>
<div class="paragraph">
<p><strong>Process ports.</strong> The final example demonstrates how to incorporate the socket interface defined in <a href="#section_4.9.">Section 4.9</a> into a generic port that allows transparent communication with subprocesses via normal Scheme input/output operations.</p>
</div>
<div class="paragraph">
<p>A process port is created with <code>open-process</code>, which accepts a shell command as a string. <code>open-process</code> sets up a socket, forks a child process, sets up two-way communication via the socket, and invokes the command in a subprocess.</p>
</div>
<div class="paragraph">
<p>The sample session below demonstrates the use of <code>open-process</code>, running and communicating with another Scheme process started with the "<code>-q</code>" switch to suppress the greeting and prompts.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (define p (open-process "exec scheme -q"))
> (define s (make-string 1000 #\nul))
> (pretty-print '(+ 3 4) p)
> (read p)
7
> (pretty-print '(define (f x) (if (= x 0) 1 (* x (f (- x 1))))) p)
> (pretty-print '(f 10) p)
> (read p)
3628800
> (pretty-print '(exit) p)
> (read p)
#!eof
> (close-port p)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since process ports, like transcript ports, are two-way, the implementation is somewhat similar. The main difference is that a transcript port reads from and writes to its subordinate ports, whereas a process port reads from and writes to a socket. When a process port is opened, the socket is created and subprocess invoked, and when the port is closed, the socket is closed and the subprocess is terminated.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define open-process
  (lambda (command)
    (define handler
      (lambda (pid socket)
        (define (flush-output who p)
          (let ([i (port-output-index p)])
            (when (fx> i 0)
              (check who (c-write socket (port-output-buffer p) i))
              (set-port-output-index! p 0))))
        (lambda (msg . args)
          (record-case (cons msg args)
            [block-read (p str cnt)
             (with-interrupts-disabled
               (let ([b (port-input-buffer p)]
                     [i (port-input-index p)]
                     [s (port-input-size p)])
                 (if (< i s)
                     (let ([cnt (fxmin cnt (fx- s i))])
                       (do ([i i (fx+ i 1)]
                            [j 0 (fx+ j 1)])
                          ((fx= j cnt)
                           (set-port-input-index! p i)
                           cnt)
                          (string-set! str j (string-ref b i))))
                     (begin
                       (flush-output 'block-read p)
                       (let ([n (check 'block-read
                                  (c-read socket str cnt))])
                         (if (fx= n 0)
                             #!eof
                             n))))))]
            [char-ready? (p)
             (or (< (port-input-index p) (port-input-size p))
                 (bytes-ready? socket))]
            [clear-input-port (p)
             ; set size to zero rather than index to size
             ; in order to invalidate unread-char
             (set-port-input-size! p 0)]
            [clear-output-port (p) (set-port-output-index! p 0)]
            [close-port (p)
             (with-interrupts-disabled
               (flush-output 'close-port p)
               (set-port-output-size! p 0)
               (set-port-input-size! p 0)
               (mark-port-closed! p)
               (terminate-process pid))]
            [file-length (p) 0]
            [file-position (p . pos)
             (if (null? pos)
                 (most-negative-fixnum)
                 (assertion-violationf 'process-port "cannot reposition"))]
            [flush-output-port (p)
             (with-interrupts-disabled
               (flush-output 'flush-output-port p))]
            [peek-char (p)
             (with-interrupts-disabled
               (let ([b (port-input-buffer p)]
                     [i (port-input-index p)]
                     [s (port-input-size p)])
                 (if (fx< i s)
                     (string-ref b i)
                     (begin
                       (flush-output 'peek-char p)
                       (let ([s (check 'peek-char
                                  (c-read socket b (string-length b)))])
                         (if (fx= s 0)
                             #!eof
                             (begin (set-port-input-size! p s)
                                    (string-ref b 0))))))))]
            [port-name (p) "process"]
            [read-char (p)
             (with-interrupts-disabled
               (let ([b (port-input-buffer p)]
                     [i (port-input-index p)]
                     [s (port-input-size p)])
                 (if (fx< i s)
                     (begin
                       (set-port-input-index! p (fx+ i 1))
                       (string-ref b i))
                     (begin
                       (flush-output 'peek-char p)
                       (let ([s (check 'read-char
                                  (c-read socket b (string-length b)))])
                         (if (fx= s 0)
                             #!eof
                             (begin (set-port-input-size! p s)
                                    (set-port-input-index! p 1)
                                    (string-ref b 0))))))))]
            [unread-char (c p)
             (with-interrupts-disabled
               (let ([b (port-input-buffer p)]
                     [i (port-input-index p)]
                     [s (port-input-size p)])
                 (when (fx= i 0)
                   (assertion-violationf 'unread-char
                     "tried to unread too far on ~s"
                     p))
                 (set-port-input-index! p (fx- i 1))
                ; following could be skipped; supposed to be
                ; same character
                 (string-set! b (fx- i 1) c)))]
            [write-char (c p)
             (with-interrupts-disabled
               (let ([b (port-output-buffer p)]
                     [i (port-output-index p)]
                     [s (port-output-size p)])
                 (string-set! b i c)
                 (check 'write-char (c-write socket b (fx+ i 1)))
                 (set-port-output-index! p 0)))]
            [block-write (p str cnt)
             (with-interrupts-disabled
              ; flush buffered data
               (flush-output 'block-write p)
              ; write new data
               (check 'block-write (c-write socket str cnt)))]
            [else
             (assertion-violationf 'process-port
               "operation ~s not handled"
               msg)]))))
    (let* ([server-socket-name (tmpnam 0)]
           [server-socket (setup-server-socket server-socket-name)])
      (dofork
        (lambda () ; child
          (check 'close (close server-socket))
          (let ([sock (setup-client-socket server-socket-name)])
            (dodup 0 sock)
            (dodup 1 sock))
          (check 'execl (execl4 "/bin/sh" "/bin/sh" "-c" command))
          (assertion-violationf 'open-process "subprocess exec failed"))
        (lambda (pid) ; parent
          (let ([sock (accept-socket server-socket)])
            (check 'close (close server-socket))
            (let ([ib (make-string 1024)] [ob (make-string 1024)])
              (let ([p (make-input/output-port
                         (handler pid sock)
                         ib ob)])
                (set-port-input-size! p 0)
                (set-port-output-size! p (fx- (string-length ob) 1))
                p))))))))</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chp_10">Chapter 10. Libraries and Top-level Programs</h2>
<div class="sectionbody">
<div id="libraries:s1" class="paragraph">
<p>The Revised<sup>6</sup> Report describes two units of portable code: libraries and top-level programs. A library is a named collection of bindings with a declared set of explicitly exported bindings, a declared set of imported libraries, and a body that initializes its bindings. A top-level program is a stand-alone program with a declared set of imported libraries and a body that is run when the top-level program is run. The bindings in a library are created and its initialization code run only if the library is used, directly or indirectly, by a top-level program.</p>
</div>
<div id="libraries:s2" class="paragraph">
<p>The <code>import</code> declarations appearing within libraries and top-level programs serve two purposes: first, they cause the imported libraries to be loaded, and second, they cause the bindings of the imported libraries to become visible in the importing library or top-level program. Libraries are typically stored in the file system, with one library per file, and the library name typically identifies the file-system path to the library, possibly relative to a default or programmer-specified set of library locations. The exact mechanism by which top-level programs are run and libraries are loaded is implementation-dependent.</p>
</div>
<div class="paragraph">
<p>This chapter describes the mechanisms by which libraries and programs are loaded in <em>Chez Scheme</em> along with various features for controlling and tracking this process. It also describes the set of built-in libraries and syntactic forms for defining new libraries and top-level programs outside of a library or top-level program file.</p>
</div>
<div class="sect2">
<h3 id="section_10.1.">Section 10.1. Built-in Libraries</h3>
<div class="paragraph">
<p>In addition to the RNRS libraries mandated by the Revised<sup>6</sup> Report:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(rnrs base (6))
(rnrs arithmetic bitwise (6))
(rnrs arithmetic fixnums (6))
(rnrs arithmetic flonums (6))
(rnrs bytevectors (6))
(rnrs conditions (6))
(rnrs control (6))
(rnrs enums (6))
(rnrs eval (6))
(rnrs exceptions (6))
(rnrs files (6))
(rnrs hashtables (6))
(rnrs io ports (6))
(rnrs io simple (6))
(rnrs lists (6))
(rnrs mutable-pairs (6))
(rnrs mutable-strings (6))
(rnrs programs (6))
(rnrs r5rs (6))
(rnrs records procedural (6))
(rnrs records syntactic (6))
(rnrs records inspection (6))
(rnrs sorting (6))
(rnrs syntax-case (6))
(rnrs unicode (6))</code></pre>
</div>
</div>
<div id="libraries:s6" class="paragraph">
<p><em>Chez Scheme</em> also provides two additional libraries: <code>(chezscheme)</code> and <code>(chezscheme csv7)</code>. The former can also be referenced as <code>(scheme)</code> and the latter can also be referenced as <code>(scheme csv7)</code>.</p>
</div>
<div class="paragraph">
<p>The <code>(chezscheme)</code> library exports bindings for every identifier whose binding is described in this document, including those for keywords like <code>lambda</code>, auxiliary keywords like <code>else</code>, module names like <code>scheme</code>, and procedure names like <code>cons</code>. In most cases where an identifier exported from the <code>(chezscheme)</code> library corresponds to an identifier exported from one of the RNRS libraries, the bindings are identical. In some cases, however, the <code>(chezscheme)</code> bindings extend the <code>rnrs</code> bindings in some way. For example, the <code>(chezscheme)</code> <code>syntax-rules</code> form allows its clauses to have fenders (<a href="#section_11.2.">Section 11.2</a>), while the <code>(rnrs)</code> <code>syntax-rules</code> form does not. Similarly, the <code>(chezscheme)</code> <code>current-input-port</code> procedure accepts an optional <code><em>port</em></code> argument that, when specified, sets the current input port to <code><em>port</em></code> (<a href="#section_9.8.">Section 9.8</a>), while the <code>(rnrs)</code> <code>current-input-port</code> procedure does not. When the <code>(chezscheme)</code> library extends an RNRS binding in some way, the <code>(chezscheme)</code> library also exports the RNRS version, with the name prefixed by <code>r6rs:</code>, e.g., <code>r6rs:syntax-rules</code> or <code>r6rs:current-input-port</code>.</p>
</div>
<div class="paragraph">
<p>The <code>(chezscheme csv7)</code> Version 7 backward compatibility library contains bindings for a set of syntactic forms and procedures whose syntax or semantics directly conflicts with the RNRS bindings for the same identifiers. The following identifiers are exported from <code>(chezscheme csv7)</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">record-field-accessible?
record-field-accessor
record-field-mutable?
record-field-mutator
record-type-descriptor
record-type-field-decls
record-type-field-names
record-type-name
record-type-symbol</code></pre>
</div>
</div>
<div class="paragraph">
<p>The bindings of this library should be used only for old code; new code should use the RNRS variants. Each of these is also available in the <code>(chezscheme)</code> library with the prefix <code>csv7:</code>, e.g., <code>csv7:record-type-name</code>.</p>
</div>
<div class="paragraph">
<p>The interaction environment in which code outside of a library or RNRS top-level program is scoped contains all of the bindings of the <code>(chezscheme)</code> library, as described in <a href="#section_2.3.">Section 2.3</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_10.2.">Section 10.2. Running Top-level Programs</h3>
<div id="libraries:s9" class="paragraph">
<p>A top-level program must reside in its own file, which may have any name and may reside anywhere in the file system. A top-level program residing in a file is run by one of three mechanisms: the <code>scheme-script</code> command, the <code>--program</code> command-line argument, or the <code>load-program</code> procedure.</p>
</div>
<div class="paragraph">
<p>The <code>scheme-script</code> command is used as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">scheme-script <em>program-filename</em> <em>arg</em> ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>It may also be run implicitly on Unix-based systems by placing the line</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">#! /usr/bin/env scheme-script</code></pre>
</div>
</div>
<div class="paragraph">
<p>at the front of the file containing the top-level program, making the top-level program file executable, and executing the file. This line may be replaced with</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">#! /usr/bin/scheme-script</code></pre>
</div>
</div>
<div class="paragraph">
<p>with <code>/usr/bin</code> replaced by the absolute path to the directory containing <code>scheme-script</code> if it is not in <code>/usr/bin</code>. The first form is recommended in the nonnormative appendices to the Revised<sup>6</sup> Report <a href="#ref29">[29]</a>, and works wherever <code>scheme-script</code> appears in the path.</p>
</div>
<div class="paragraph">
<p>The <code>--program</code> command is used similarly with the <code>scheme</code> or <code>petite</code> executables, either by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">scheme --program <em>program-filename</em> <em>arg</em> ...
petite --program <em>program-filename</em> <em>arg</em> ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>or by including</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">#! /usr/bin/scheme --script</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">#! /usr/bin/petite --script</code></pre>
</div>
</div>
<div class="paragraph">
<p>at the front of the top-level program file, making the file executable, and executing the file. Again, <code>/usr/bin</code> should be replaced with the absolute path to the actual directory in which <code>scheme</code> and/or <code>petite</code> resides, if not <code>/usr/bin</code>.</p>
</div>
<div class="paragraph">
<p>The <code>load-program</code> procedure, described in <a href="#section_12.4.">Section 12.4</a>, is used like <code>load</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(load-program <em>string</em>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code><em>string</em></code> names the file in which the top-level program resides.</p>
</div>
<div class="paragraph">
<p>Regardless of the mechanism used, if the opening line is in one of the forms described above, or more generally, consists of <code>#!</code> followed by a space or a forward slash, the opening line is not considered part of the program and is ignored once the Scheme system starts up and begins to run the program. Thus, the line may be present even in a file loaded by <code>load-program</code>. In fact, <code>load-program</code> is ultimately used by the other two mechanisms described above, via the value of the <code>scheme-program</code> parameter described in <a href="#section_12.8.">Section 12.8</a>, and it is <code>load-program</code> that scans past the <code>#!</code> line, if present, before evaluating the program.</p>
</div>
<div class="paragraph">
<p>A top-level program may be compiled with the <code>compile-program</code> procedure described in <a href="#section_12.4.">Section 12.4</a>. <code>compile-program</code> copies the <code>#!</code> line from the source file to the object file, followed by a compiled version of the source code. Any libraries upon which the top-level program depends, other than built-in libraries, must be compiled first via <code>compile-file</code> or <code>compile-library</code>. This can be done manually or by setting the parameter <code>compile-imported-libraries</code> to <code>#t</code> before compiling the program. The program must be recompiled if any of the libraries upon which it depends are recompiled. A compiled top-level program can be run just like a source top-level program via each of the mechanisms described above.</p>
</div>
<div class="paragraph">
<p>In <em>Chez Scheme</em>, a library may also be defined in the REPL or placed in a file to be loaded via <code>load</code> or <code>load-library</code>. The syntax for a library is the same whether the library is placed in its own file and implicitly loaded via <code>import</code>, entered into the REPL, or placed in a file along with other top-level expressions to be evaluated by <code>load</code>. A top-level program may also be defined in the REPL or placed in a file to be loaded via <code>load</code>, but in this case, the syntax is slightly different. In the language of the Revised<sup>6</sup> Report, a top-level program is merely an unwrapped sequence of subforms consisting of an <code>import</code> form and a body, delimited only by the boundaries of the file in which it resides. In order for a top-level program to be entered in the REPL or placed in a file to be evaluated by <code>load</code>, <em>Chez Scheme</em> allows top-level programs to be enclosed in a <code>top-level-program</code> form.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_10.3.">Section 10.3. Library and Top-level Program Forms</h3>
<div id="libraries:s13" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(library <em>name</em> <em>exports</em> <em>imports</em> <em>library-body</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>library</code> form defines a new library with the specified name, exports, imports, and body. Details on the syntax and semantics of the library form are given in <a href="#section_10.3.">Section 10.3</a> of <em>The Scheme Programming Language, 4th Edition</em> and in the Revised<sup>6</sup> Report.</p>
</div>
<div class="paragraph">
<p>Only one version of a library can be loaded at any given time, and an exception is raised if a library is implicitly loaded via <code>import</code> when another version of the library has already been loaded. <em>Chez Scheme</em> permits a different version of the library, or a new instance of the same version, to be entered explicitly into the REPL or loaded explicitly from a file, to facilitate interactive testing and debugging. The programmer should take care to make sure that any code that uses the library is also reentered or reloaded, to make sure that code accesses the bindings of the new instance of the library.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(library (test (1)) (export x) (import (rnrs)) (define x 3))
(import (test))
(define f (lambda () x))
(f) ⇒ 3

(library (test (1)) (export x) (import (rnrs)) (define x 4))
(import (test))
(f) ⇒ 3    ; oops---forgot to redefine f
(define f (lambda () x))
(f) ⇒ 4

(library (test (2)) (export x) (import (rnrs)) (define x 5))
(import (test))
(define f (lambda () x))
(f) ⇒ 5</code></pre>
</div>
</div>
<div class="paragraph">
<p>As with module imports (<a href="#section_11.5.">Section 11.5</a>), a library <code>import</code> may appear anywhere a definition may appear, including at top level in the REPL, in a file to be loaded by <code>load</code>, or within a <code>lambda</code>, <code>let</code>, <code>letrec</code>, <code>letrec*</code>, etc., body. The same <code>import</code> form may be used to import from both libraries and modules.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(library (foo) (export a) (import (rnrs)) (define a 'a-from-foo))
(module bar (b) (define b 'b-from-bar))
(let () (import (foo) bar) (list a b)) ⇒ (a-from-foo b-from-bar)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>import</code> keyword is not visible within a library body unless the library imports it from the <code>(chezscheme)</code> library.</p>
</div>
<div id="libraries:s14" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(top-level-program <em>imports</em> <em>body</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="libraries:s15" class="paragraph">
<p>A <code>top-level-program</code> form may be entered into the REPL or placed in a file to be loaded via <code>load</code>, where it behaves as if its subforms were placed in a file and loaded via <code>load-program</code>. Details on the syntax and semantics of a top-level program are given in <a href="#section_10.3.">Section 10.3</a> of <em>The Scheme Programming Language, 4th Edition</em> and in the Revised<sup>6</sup> Report.</p>
</div>
<div class="paragraph">
<p>The following transcript illustrates a <code>top-level-program</code> being tested in the REPL.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (top-level-program (import (rnrs))
    (display "hello!\n"))
hello!</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_10.4.">Section 10.4. Standalone import and export forms</h3>
<div class="paragraph">
<p>Although not required by the Revised<sup>6</sup> Report, <em>Chez Scheme</em> supports the use of standalone import and export forms. The import forms can appear anywhere other definitions can appear, including within a <code>library</code> body, <code>module</code> (<a href="#section_11.5.">Section 11.5</a>) body, <code>lambda</code> or other local body, and at top level. The export forms can appear within the definitions of a <code>library</code> or <code>module</code> body to specify additional exports for the library or module.</p>
</div>
<div class="paragraph">
<p>Within a library or top-level program, the keywords for these forms must be imported from the <code>(chezscheme)</code> library to be available for use, since they are not defined in any of the Revised<sup>6</sup> Report libraries.</p>
</div>
<div id="libraries:s16" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(import <em>import-spec</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(import-only <em>import-spec</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An <code>import</code> or <code>import-only</code> form is a definition and can appear anywhere other definitions can appear, including at the top level of a program, nested within the bodies of <code>lambda</code> expressions, and nested within modules and libraries.</p>
</div>
<div class="paragraph">
<p>Each <code><em>import-spec</em></code> must take one of the following forms.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs"><em>import-set</em>
(for <em>import-set</em> <em>import-level</em> ...)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>for</code> wrapper and <code><em>import-level</em></code> are described in <a href="../../the-scheme-programming-language-4th/en/index.html#chp_10">Chapter 10</a> of <em>The Scheme Programming Language, 4th Edition</em>. They are ignored by <em>Chez Scheme</em>, which determines automatically the levels at which identifiers must be imported, as permitted by the Revised<sup>6</sup> Report. This frees the programmer from the obligation to do so and results in more generality as well as more precision in the set of libraries actually imported at compile and run time (<a href="#ref21">[21]</a>,<a href="#ref19">[19]</a>).</p>
</div>
<div class="paragraph">
<p>An <code><em>import-set</em></code> must take one of the following forms:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs"><em>library-spec</em>
<em>module-name</em>
(only <em>import-set</em> <em>identifier</em> ...)
(except <em>import-set</em> <em>identifier</em> ...)
(prefix <em>import-set</em> <em>prefix</em>)
(add-prefix <em>import-set</em> <em>prefix</em>)
(drop-prefix <em>import-set</em> <em>prefix</em>)
(rename <em>import-set</em> (<em>import-name</em> <em>internal-name</em>) ...)
(alias <em>import-set</em> (<em>import-name</em> <em>internal-name</em>) ...)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Several of these are specified by the Revised<sup>6</sup> Report; the remainder are <em>Chez Scheme</em> extensions, including <code><em>module-name</em></code> and the <code>add-prefix</code>, <code>drop-prefix</code>, and <code>alias</code> forms.</p>
</div>
<div class="paragraph">
<p>An <code>import</code> or <code>import-only</code> form makes the specified bindings visible in the scope in which they appear. Except at top level, they differ in that <code>import</code> leaves all bindings except for those shadowed by the imported names visible, whereas <code>import-only</code> hides all existing bindings, i.e., makes only the imported names visible. At top level, <code>import-only</code> behaves like <code>import</code>.</p>
</div>
<div class="paragraph">
<p>Each <code><em>import-set</em></code> identifies a set of names to make visible as follows.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code><em>library-spec</em></code></dt>
<dd>
<p>all exports of the library identified by the Revised<sup>6</sup> Report <code><em>library-spec</em></code> (<a href="../../the-scheme-programming-language-4th/en/index.html#chp_10">Chapter 10</a>).</p>
</dd>
<dt class="hdlist1"><code><em>module-name</em></code></dt>
<dd>
<p>all exports of module named by the identifier <code><em>module-name</em></code></p>
</dd>
<dt class="hdlist1"><code>(only <em>import-set</em> <em>identifier</em> ...)</code></dt>
<dd>
<p>of those specified by <code><em>import-set</em></code>, just <code><em>identifier</em> ...</code></p>
</dd>
<dt class="hdlist1"><code>(except <em>import-set</em> <em>identifier</em> ...)</code></dt>
<dd>
<p>all specified by <code><em>import-set</em></code> except <code><em>identifier</em> ...</code></p>
</dd>
<dt class="hdlist1"><code>(prefix <em>import-set</em> <em>prefix</em>)</code></dt>
<dd>
<p>all specified by <code><em>import-set</em></code>, each prefixed by <code><em>prefix</em></code></p>
</dd>
<dt class="hdlist1"><code>(add-prefix <em>import-set</em> <em>prefix</em>)</code></dt>
<dd>
<p>all specified by <code><em>import-set</em></code>, each prefixed by <code><em>prefix</em></code> (just like <code>prefix</code>)</p>
</dd>
<dt class="hdlist1"><code>(drop-prefix <em>import-set</em> <em>prefix</em>)</code></dt>
<dd>
<p>all specified by <code><em>import-set</em></code>, with prefix <code><em>prefix</em></code> removed</p>
</dd>
<dt class="hdlist1"><code>(rename <em>import-set</em> (<em>import-name</em> <em>internal-name</em>) ...)</code></dt>
<dd>
<p>all specified by <code><em>import-set</em></code>, with each identifier <code><em>import-name</em></code> renamed to the corresponding identifier <code><em>internal-name</em></code></p>
</dd>
<dt class="hdlist1"><code>(alias <em>import-set</em> (<em>import-name</em> <em>internal-name</em>) ...)</code></dt>
<dd>
<p>all specified by <code><em>import-set</em></code>, with each <code><em>internal-name</em></code> as an alias for <code><em>import-name</em></code></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The <code>alias</code> form differs from the <code>rename</code> form in that both <code><em>import-name</em></code> and <code><em>internal-name</em></code> are in the resulting set, rather than just <code><em>internal-name</em></code>.</p>
</div>
<div class="paragraph">
<p>It is a syntax violation if the given selection or transformation cannot be made because of a missing export or prefix.</p>
</div>
<div class="paragraph">
<p>An identifier made visible via an import of a module or library is scoped as if its definition appears where the import occurs. The following example illustrates these scoping rules, using a local module <code>m</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(library (A) (export x) (import (rnrs)) (define x 0))
(let ([x 1])
  (module m (x setter)
    (define-syntax x (identifier-syntax z))
    (define setter (lambda (x) (set! z x)))
    (define z 2))
  (let ([y x] [z 3])
    (import m (prefix (A) a:))
    (setter 4)
    (list x a:x y z))) ⇒ (4 0 1 3)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The inner <code>let</code> expression binds <code>y</code> to the value of the <code>x</code> bound by the outer <code>let</code>. The import of <code>m</code> makes the definitions of <code>x</code> and <code>setter</code> visible within the inner <code>let</code>. The import of <code>(A)</code> makes the variable <code>x</code> exported from <code>(A)</code> visible as <code>a:x</code> within the body of the inner <code>let</code>. Thus, in the expression <code>(list x a:x y z)</code>, <code>x</code> refers to the identifier macro exported from <code>m</code> while <code>a:x</code> refers to the variable <code>x</code> exported from <code>(A)</code> and <code>y</code> and <code>z</code> refer to the bindings established by the inner <code>let</code>. The identifier macro <code>x</code> expands into a reference to the variable <code>z</code> defined within the module.</p>
</div>
<div class="paragraph">
<p>With local import forms, it is rarely necessary to use the extended import specifiers. For example, an abstraction that encapsulates the import and reference can easily be defined and used as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax from
  (syntax-rules ()
    [(_ m id) (let () (import-only m) id)]))

(library (A) (export x) (import (rnrs)) (define x 1))
(let ([x 10])
  (module M (x) (define x 2))
  (cons (from (A) x) (from M x))) ⇒ (1 . 2)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The definition of <code>from</code> could use <code>import</code> rather than <code>import-only</code>, but by using <code>import-only</code> we get feedback if an attempt is made to import an identifier from a library or module that does not export the identifier. With <code>import</code> instead of <code>import-only</code>, the current binding, if any, would be visible if the library or module does not export the specified name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax lax-from
  (syntax-rules ()
    [(_ m id) (let () (import m) id)]))

(library (A) (export x) (import (rnrs)) (define x 1))

(let ([x 10])
  (module M (x) (define x 2))
  (+ (from (A) x) (from M y))) ⇒ <em>exception: unbound identifier y</em>

(let ([x 10] [y 20])
  (module M (x) (define x 2))
  (+ (lax-from (A) x) (lax-from M y))) ⇒ 21</code></pre>
</div>
</div>
<div class="paragraph">
<p>Import visibility interacts with hygienic macro expansion in such a way that, as one might expect, an identifier <code><em>x</em></code> imported from a module <code><em>M</em></code> is treated in the importing context as if the corresponding export identifier had been present in the import form along with <code><em>M</em></code>.</p>
</div>
<div class="paragraph">
<p>The <code>from</code> abstraction above works because both <code><em>M</em></code> and <code><em>id</em></code> appear in the input to the abstraction, so the imported <code><em>id</em></code> captures the reference to <code><em>id</em></code>.</p>
</div>
<div class="paragraph">
<p>The following variant of <code><em>from</em></code> also works, because both names are introduced into the output by the transformer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(module M (x) (define x 'x-of-M))
(define-syntax x-from-M
  (syntax-rules ()
    [(_) (let () (import M) x)]))

(let ([x 'local-x]) (x-from-M)) ⇒ x-of-M</code></pre>
</div>
</div>
<div class="paragraph">
<p>On the other hand, imports of introduced module names do not capture free references.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([x 'local-x])
  (define-syntax alpha
    (syntax-rules ()
      [(_ var) (let () (import M) (list x var))]))

  (alpha x)) ⇒ (x-of-M local-x)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly, imports from free module names do not capture references to introduced variables.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([x 'local-x])
  (define-syntax beta
    (syntax-rules ()
      [(_ m var) (let () (import m) (list x var))]))

  (beta M x)) ⇒ (local-x x-of-M)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This semantics extends to prefixed, renamed, and aliased bindings created by the extended <code>import</code> specifiers <code>prefix</code>, <code>rename</code>, and <code>alias</code>.</p>
</div>
<div class="paragraph">
<p>The <code>from</code> abstraction works for variables but not for exported keywords, record names, or module names, since the output is an expression and may thus appear only where expressions may appear. A generalization of this technique is used in the following definition of <code>import*</code>, which supports renaming of imported bindings and selective import of specific bindings---without the use of the built-in <code>import</code> subforms for selecting and renaming identifiers</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax import*
  (syntax-rules ()
    [(_ m) (begin)]
    [(_ m (new old))
     (module (new)
       (module (tmp)
         (import m)
         (alias tmp old))
       (alias new tmp))]
    [(_ m id) (module (id) (import m))]
    [(_ m spec0 spec1 ...)
     (begin (import* m spec0) (import* m spec1 ...))]))</code></pre>
</div>
</div>
<div class="paragraph">
<p>To selectively import an identifier from module or library <code>m</code>, the <code>import*</code> form expands into an anonymous module that first imports all exports of <code>m</code> then re-exports only the selected identifier. To rename on import the macro expands into an anonymous module that instead exports an alias (<a href="#section_11.10.">Section 11.10</a>) bound to the new name.</p>
</div>
<div class="paragraph">
<p>If the output placed the definition of <code>new</code> in the same scope as the import of <code>m</code>, a naming conflict would arise whenever <code>new</code> is also present in the interface of <code>m</code>. To prevent this, the output instead places the import within a nested anonymous module and links <code>old</code> and <code>new</code> by means of an alias for the introduced identifier <code>tmp</code>.</p>
</div>
<div class="paragraph">
<p>The macro expands recursively to handle multiple import specifications. Each of the following examples imports <code>cons</code> as <code>+</code> and <code>+</code> as <code>cons</code>, which is probably not a very good idea.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ()
  (import* scheme (+ cons) (cons +))
  (+ (cons 1 2) (cons 3 4))) ⇒ (3 . 7)

(let ()
  (import* (rnrs) (+ cons) (cons +))
  (+ (cons 1 2) (cons 3 4))) ⇒ (3 . 7)</code></pre>
</div>
</div>
<div id="libraries:s17" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(export <em>export-spec</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An <code>export</code> form is a definition and can appear with other definitions at the front of a <code>library</code> or <code>module</code>. It is a syntax error for an <code>export</code> form to appear in other contexts, including at top level or among the definitions of a top-level program or <code>lambda</code> body.</p>
</div>
<div class="paragraph">
<p>Each <code><em>export-spec</em></code> must take one of the following forms.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs"><em>identifier</em>
(rename (<em>internal-name</em> <em>export-name</em>) ...)
(import <em>import-spec</em> ...)</code></pre>
</div>
</div>
<div class="paragraph">
<p>where each <code><em>internal-name</em></code> and <code><em>export-name</em></code> is an identifier. The first two are syntactically identical to <code>library</code> <code><em>export-spec</em></code>s, while the third is syntactically identical to a <em>Chez Scheme</em> <code>import</code> form, which is an extension of the R6RS library <code>import</code> subform. The first form names a single export, <code><em>identifier</em></code>, whose export name is the same as its internal name. The second names a set of exports, each of whose export name is given explicitly and may differ from its internal name.</p>
</div>
<div class="paragraph">
<p>For the third, the identifiers identified by the <code>import</code> form become exports, with aliasing, renaming, prefixing, etc., as specified by the <code><em>import-spec</em></code>s. The module or library whose bindings are exported by an <code>import</code> form appearing within an <code>export</code> form can be defined within or outside the exporting module or library and need not be imported elsewhere within the exporting module or library.</p>
</div>
<div class="paragraph">
<p>The following library exports a two-armed-only variant of <code>if</code> along with all remaining bindings of the <code>(rnrs)</code> library.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(library (rnrs-no-one-armed-if) (export) (import (except (chezscheme) if))
  (export if (import (except (rnrs) if)))
  (define-syntax if
    (let ()
      (import (only (rnrs) if))
      (syntax-rules ()
        [(_ tst thn els) (if tst thn els)]))))

(import (rnrs-no-one-armed-if))
(if #t 3 4) ⇒ 3
(if #t 3) ⇒ <em>exception: invalid syntax</em></code></pre>
</div>
</div>
<div class="paragraph">
<p>Another way to define the same library would be to define the two-armed-only <code>if</code> with a different internal name and use <code>rename</code> to export it under the name <code>if</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(library (rnrs-no-one-armed-if) (export) (import (chezscheme))
  (export (rename (two-armed-if if)) (import (except (rnrs) if)))
  (define-syntax two-armed-if
    (syntax-rules ()
      [(_ tst thn els) (if tst thn els)])))

(import (rnrs-no-one-armed-if))
(if #t 3 4) ⇒ 3
(if #t 3) ⇒ <em>exception: invalid syntax</em></code></pre>
</div>
</div>
<div class="paragraph">
<p>The placement of the <code>export</code> form in the library body is irrelevant, e.g., the <code>export</code> form can appear after the definition in the examples above.</p>
</div>
<div id="libraries:s18" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(indirect-export <em>id</em> <em>indirect-id</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This form is a definition and can appear wherever any other definition can appear.</p>
</div>
<div class="paragraph">
<p>An <code>indirect-export</code> form declares that the named <code><em>indirect-id</em></code>s are indirectly exported to top level if <code><em>id</em></code> is exported to top level.</p>
</div>
<div class="paragraph">
<p>In general, if an identifier is not directly exported by a library or module, it can be referenced outside of the library or module only in the expansion of a macro defined within and exported from the library or module. Even this cannot occur for libraries or modules defined at top level (or nested within other libraries or modules), unless either (1) the library or module has been set up to implicitly export all identifiers as indirect exports, or (2) each indirectly exported identifier is explicitly declared as an indirect export of some other identifier that is exported, either directly or indirectly, from the library or module, via an <code>indirect-export</code> or the built-in indirect export feature of a <code>module</code> export subform. By default, (1) is true for a library and false for a module, but the default can be overridden via the <code>implicit-exports</code> form, which is described below.</p>
</div>
<div class="paragraph">
<p>This form is meaningful only within a top-level library, top-level module, or module enclosed within a library or top-level module, although it has no effect if the library or module already implicitly exports all bindings. It is allowed anywhere else definitions can appear, however, so macros that expand into indirect export forms can be used in any definition context.</p>
</div>
<div class="paragraph">
<p>Indirect exports are listed so the compiler can determine the exact set of bindings (direct and indirect) that must be inserted into the top-level environment, and conversely, the set of bindings that may be treated more efficiently as local bindings (and perhaps discarded, if they are not used).</p>
</div>
<div class="paragraph">
<p>In the example below, <code>indirect-export</code> is used to indirectly export <code>count</code> to top level when <code>current-count</code> is exported to top level.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(module M (bump-count current-count)
  (define-syntax current-count (identifier-syntax count))
  (indirect-export current-count count)
  (define count 0)
  (define bump-count
    (lambda ()
      (set! count (+ count 1)))))

(import M)
(bump-count)
current-count ⇒ 1
count ⇒ <em>exception: unbound identifier count</em></code></pre>
</div>
</div>
<div class="paragraph">
<p>An <code>indirect-export</code> form is not required to make <code>count</code> visible for <code>bump-count</code>, since it is a procedure whose code is contained within the module rather than a macro that might expand into a reference to <code>count</code> somewhere outside the module.</p>
</div>
<div class="paragraph">
<p>It is often useful to use <code>indirect-export</code> in the output of a macro that expands into another macro named <code><em>a</em></code> if <code><em>a</em></code> expands into references to identifiers that might not be directly exported, as illustrated by the alternative definition of module <code>M</code> above.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax define-counter
  (syntax-rules ()
    [(_ getter bumper init incr)
     (begin
       (define count init)
       (define-syntax getter (identifier-syntax count))
       (indirect-export getter count)
       (define bumper
         (lambda ()
           (set! count (incr count)))))]))

(module M (bump-count current-count)
  (define-counter current-count bump-count 0 add1))</code></pre>
</div>
</div>
<div id="libraries:s19" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(implicit-exports #t)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(implicit-exports #f)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An <code>implicit-exports</code> form is a definition and can appear with other definitions at the front of a <code>library</code> or <code>module</code>. It is a syntax error for an <code>implicit-exports</code> form to appear in other contexts, including at top level or among the definitions of a top-level program or <code>lambda</code> body.</p>
</div>
<div class="paragraph">
<p>The <code>implicit-exports</code> form determines whether identifiers not directly exported from a module or library are automatically indirectly exported to the top level if any meta-binding (keyword, meta definition, or property definition) is directly exported to top level from the library or module. The default for libraries is <code>#t</code>, to match the behavior required by the Revised<sup>6</sup> Report, while the default for modules is <code>#f</code>. The <code>implicit-exports</code> form is meaningful only within a library, top-level module, or module enclosed within a library or top-level module. It is allowed in a module enclosed within a <code>lambda</code>, <code>let</code>, or similar body, but ignored there because none of that module&#8217;s bindings can be exported to top level.</p>
</div>
<div class="paragraph">
<p>The advantage of <code>(implicit-exports #t)</code> is that indirect exports need not be listed explicitly, which is convenient. A disadvantage is that it often results in more bindings than necessary being elevated to top level where they cannot be discarded as useless by the optimizer. For modules, another disadvantage is such bindings cannot be proven immutable, which inhibits important optimizations such as procedure inlining. This can result in significantly lower run-time performance.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_10.5.">Section 10.5. Explicitly invoking libraries</h3>
<div id="libraries:s20" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(invoke-library <em>libref</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>libref</em></code> must be an s-expression in the form of a library reference. The syntax for library references is given in <a href="../../the-scheme-programming-language-4th/en/index.html#chp_10">Chapter 10</a> of <em>The Scheme Programming Language, 4th Edition</em> and in the Revised<sup>6</sup> Report.</p>
</div>
<div class="paragraph">
<p>A library is implicitly invoked when or before some expression outside the library (e.g., in another library or in a top-level program) evaluates a reference to one of the library&#8217;s exported variables. When the library is invoked, its body expressions (the right-hand-sides of the library&#8217;s variable definitions and its initialization expressions) are evaluated. Once invoked, the library is not invoked again within the same process, unless it is first explicitly redefined or reloaded.</p>
</div>
<div class="paragraph">
<p><code>invoke-library</code> explicitly invokes the library specified by <code><em>libref</em></code> if it has not already been invoked or has since been redefined or reloaded. If the library has not yet been loaded, <code>invoke-library</code> first loads the library via the process described in <a href="#section_2.4.">Section 2.4</a>.</p>
</div>
<div class="paragraph">
<p><code>invoke-library</code> is typically only useful for libraries whose body expressions have side effects. It is useful to control when the side effects occur and to force invocation of a library that has no exported variables. Invoking a library does not force the compile-time code (macro transformer expressions and meta definitions) to be loaded or evaluated, nor does it cause the library&#8217;s bindings to become visible.</p>
</div>
<div class="paragraph">
<p>It is good practice to avoid externally visible side effects in library bodies so the library can be used equally well at compile time and run time. When feasible, consider moving the side effects of a library body to an initialization routine and adding a top-level program that imports the library and calls the initialization routine. With this structure, calls to <code>invoke-library</code> on the library can be replaced by calls to <code>load-program</code> on the top-level program.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_10.6.">Section 10.6. Library Parameters</h3>
<div id="libraries:s22" class="paragraph">
<p>The parameters described below control where <code>import</code> looks when attempting to load a library, whether it compiles the libraries it loads, and whether it displays tracking messages as it performs its search.</p>
</div>
<div id="libraries:s23" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>library-directories</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>library-extensions</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The parameter <code>library-directories</code> determines where the files containing library source and object code are located in the file system, and the parameter <code>library-extensions</code> determines the filename extensions for the files holding the code, as described in <a href="#section_2.4.">Section 2.4</a>. The values of both parameters are lists of pairs of strings. The first string in each <code>library-directories</code> pair identifies a source-file root directory, and the second identifies the corresponding object-file root directory. Similarly, the first string in each <code>library-extensions</code> pair identifies a source-file extension, and the second identifies the corresponding object-file extension. The full path of a library source or object file consists of the source or object root followed by the components of the library name prefixed by slashes, with the library extension added on the end. For example, for root <code>/usr/lib/scheme</code>, library name <code>(app lib1)</code>, and extension <code>.sls</code>, the full path is <code>/usr/lib/scheme/app/lib1.sls</code>. If the library name portion forms an absolute pathname, e.g., <code>~/.myappinit</code>, the <code>library-directories</code> parameter is ignored and no prefix is added.</p>
</div>
<div class="paragraph">
<p>The initial values of these parameters are shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(library-directories) ⇒ (("." . "."))

(library-extensions) ⇒ ((".chezscheme.sls" . ".chezscheme.so")
                         (".ss" . ".so")
                         (".sls" . ".so")
                         (".scm" . ".so")
                         (".sch" . ".so"))</code></pre>
</div>
</div>
<div class="paragraph">
<p>As a convenience, when either of these parameters is set, any element of the list can be specified as a single source string, in which case the object string is determined automatically. For <code>library-directories</code>, the object string is the same as the source string, effectively naming the same directory as a source- and object-code root. For <code>library-extensions</code>, the object string is the result of removing the last (or only) extension from the string and appending <code>".so"</code>. The <code>library-directories</code> and <code>library-extensions</code> parameters also accept as input strings in the format described in <a href="#section_2.5.">Section 2.5</a> for the <code>--libdirs</code> and <code>--libexts</code> command-line options.</p>
</div>
<div id="libraries:s26" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>compile-imported-libraries</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When the value of this parameter is <code>#t</code>, <code>import</code> automatically calls the value of the <code>compile-library-handler</code> parameter (which defaults to a procedure that simply calls <code>compile-library</code>) on any imported library if the object file is missing, older than the corresponding source file, older than any source files included (via <code>include</code>) when the object file was created, or itself requires a library that has or must be recompiled, as described in <a href="#section_2.4.">Section 2.4</a>. The default initial value of this parameter is <code>#f</code>. It can be set to <code>#t</code> via the command-line option <code>--compile-imported-libraries</code>.</p>
</div>
<div class="paragraph">
<p>When <code>import</code> compiles a library via this mechanism, it does not also load the compiled library, because this would cause portions of library to be reevaluated. Because of this, run-time expressions in the file outside of a <code>library</code> form will not be evaluated. If such expressions are present and should be evaluated, the library should be loaded explicitly.</p>
</div>
<div id="libraries:s29" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>import-notify</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When the new parameter <code>import-notify</code> is set to a true value, <code>import</code> displays messages to the console-output port as it searches for the file containing each library it needs to load. The default value of this parameter is <code>#f</code>.</p>
</div>
<div id="libraries:s30" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>library-search-handler</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of parameter must be a procedure that follows the protocol described below for <code>default-library-search-handler</code>, which is the default value of this parameter.</p>
</div>
<div class="paragraph">
<p>The value of this parameter is invoked to locate the source or object code for a library during <code>import</code>, <code>compile-whole-program</code>, or <code>compile-whole-library</code>.</p>
</div>
<div id="libraries:s31" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(default-library-search-handler <em>who</em> <em>library</em> <em>directories</em> <em>extensions</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure is the default value of the <code>library-search-handler</code>, which is called to locate the source or object code for a library during <code>import</code>, <code>compile-whole-program</code>, or <code>compile-whole-library</code>. <code><em>who</em></code> is a symbol that provides context in <code>import-notify</code> messages. <code><em>library</em></code> is the name of the desired library. <code><em>directories</em></code> is a list of source and object directory pairs in the form returned by <code>library-directories</code>. <code><em>extensions</em></code> is a list of source and object extension pairs in the form returned by <code>library-extensions</code>.</p>
</div>
<div class="paragraph">
<p>This procedure searches the specified directories until it finds a library source or object file with one of the specified extensions. If it finds the source file first, it constructs the corresponding object file path and checks whether the file exists. If it finds the object file first, the procedure looks for a corresponding source file with one of the given source extensions in a source directory paired with that object directory. The procedure returns three values: the file-system path of the library source file or <code>#f</code> if not found, the file-system path of the corresponding object file, which may be <code>#f</code>, and a boolean that is true if the object file exists.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_10.7.">Section 10.7. Library Inspection</h3>
<div id="libraries:s32" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(library-list)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of the libraries currently defined</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The set of libraries initially defined includes those listed in <a href="#section_10.1.">Section 10.1</a> above.</p>
</div>
<div id="libraries:s33" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(library-version <em>libref</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the version of the specified library</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(library-exports <em>libref</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of the exports of the specified library</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(library-requirements <em>libref</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of libraries required by the specified library</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(library-requirements <em>libref</em> <em>options</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of libraries required by the specified library, filtered by <code><em>options</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(library-object-filename <em>libref</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the name of the object file holding the specified library, if any</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Information can be obtained only for built-in libraries or libraries previously loaded into the system. <code><em>libref</em></code> must be an s-expression in the form of a library reference. The syntax for library references is given in <a href="../../the-scheme-programming-language-4th/en/index.html#chp_10">Chapter 10</a> of <em>The Scheme Programming Language, 4th Edition</em> and in the Revised<sup>6</sup> Report.</p>
</div>
<div class="paragraph">
<p>The <code>library-version</code> return value is a list of numbers (possibly empty) representing the library&#8217;s version.</p>
</div>
<div class="paragraph">
<p>The list of exports returned by <code>library-exports</code> is a list of symbols, each identifying one of the library&#8217;s exports. The order in which the elements appear is unspecified.</p>
</div>
<div class="paragraph">
<p>When the optional <code><em>options</em></code> argument is supplied, it must be an enumeration set over the symbols constituting valid library-requirements options, as described in the <code>library-requirements-options</code> entry below. It defaults to a set containing all of the options. Each element of the list of libraries returned by <code>library-requirements</code> is an s-expression form of a library reference. The library reference includes the actual version of the library that is present in the system (if nonempty), even if a version was not specified when it was imported. The order in which the libraries appear in the list returned by <code>library-requirements</code> is unspecified.</p>
</div>
<div class="paragraph">
<p><code>library-object-filename</code> returns a string naming the object file if the specified library was loaded from or compiled to an object file. Otherwise, it returns <code>#f</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(with-output-to-file "A.ss"
  (lambda ()
    (pretty-print
      '(library (A (1 2)) (export x z)
         (import (rnrs))
         (define x 'ex)
         (define y 23)
         (define-syntax z
           (syntax-rules ()
             [(_ e) (+ y e)])))))
  'replace)
(with-output-to-file "B.ss"
  (lambda ()
    (pretty-print
      '(library (B) (export x w)
         (import (rnrs) (A))
         (define w (cons (z 12) x)))))
  'replace)
(compile-imported-libraries #t)
(import (B))
(library-exports '(A)) ⇒ (x z) ; or (z x)
(library-exports '(A (1 2))) ⇒ (x z) ; or (z x)
(library-exports '(B)) ⇒ (x w) ; or (w x)
(library-version '(A)) ⇒ (1 2)
(library-version '(B)) ⇒ ()
(library-requirements '(A)) ⇒ ((rnrs (6)))
(library-requirements '(B)) ⇒ ((rnrs (6)) (A (1 2)))
(library-object-filename '(A)) ⇒ "A.so"
(library-object-filename '(B)) ⇒ "B.so"</code></pre>
</div>
</div>
<div id="libraries:s34" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(library-requirements-options <em>symbol</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a library-requirements-options enumeration set</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Library-requirements-options enumeration sets are passed to <code>library-requirements</code> to determine the library requirements to be listed. The available options are described below.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>import</code></dt>
<dd>
<p>Include the libraries that must be imported when the specified library is imported.</p>
</dd>
<dt class="hdlist1"><code>visit@visit</code></dt>
<dd>
<p>Includes the libraries that must be visited when the specified library is visited.</p>
</dd>
<dt class="hdlist1"><code>invoke@visit</code></dt>
<dd>
<p>Include the libraries that must be invoked when the specified library is visited.</p>
</dd>
<dt class="hdlist1"><code>invoke</code></dt>
<dd>
<p>Includes the libraries that must be invoked when the specified library is invoked.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chp_11">Chapter 11. Syntactic Extension and Modules</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes the <em>Chez Scheme</em> extensions to the syntax-case syntactic abstraction mechanism now standardized in the Revised<sup>6</sup> Report. These extensions include the module system (<a href="#section_11.5.">Section 11.5</a>), meta definitions (<a href="#section_11.8.">Section 11.8</a>), conditional expansion (<a href="#section_11.9.">Section 11.9</a>) <code>syntax-rules</code> fenders, <code>fluid-let-syntax</code>, and <code>include</code>.</p>
</div>
<div class="sect2">
<h3 id="section_11.1.">Section 11.1. Fluid Keyword Bindings</h3>
<div class="paragraph">
<p>Keyword bindings established via the Revised<sup>6</sup> Report <code>define-syntax</code>, <code>let-syntax</code>, or <code>letrec-syntax</code> forms may be rebound temporarily with <code>fluid-let-syntax</code>.</p>
</div>
<div id="syntax:s0" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(fluid-let-syntax ((<em>keyword</em> <em>expr</em>) ...) <em>form<sub>1</sub></em> <em>form<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see explanation</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each <code><em>expr</em></code> must evaluate to a transformer. <code>fluid-let-syntax</code> is similar to the standard <code>let-syntax</code>, except that instead of introducing new bindings for the keywords <code><em>keyword</em> ...</code>, <code>fluid-let-syntax</code> temporarily alters the existing bindings for the keywords during the expansion of its body. That is, during the expansion of <code><em>form<sub>1</sub></em> <em>form<sub>2</sub></em> ...</code>, the visible lexical (or top-level) binding for each <code>keyword</code> is temporarily replaced by a new association between the keyword and the corresponding transformer. This affects any references to the keyword that resolve to the same lexical (or top-level) binding whether the references occur in the text of the body or are introduced during its expansion. In contrast, <code>let-syntax</code> captures only those references that occur within the text of its body.</p>
</div>
<div class="paragraph">
<p>The following example shows how <code>fluid-let-syntax</code> differs from <code>let-syntax</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([f (lambda (x) (+ x 1))])
  (let-syntax ([g (syntax-rules ()
                    [(_ x) (f x)])])
    (let-syntax ([f (syntax-rules ()
                      [(_ x) x])])
      (g 1)))) ⇒ 2

(let ([f (lambda (x) (+ x 1))])
  (let-syntax ([g (syntax-rules ()
                    [(_ x) (f x)])])
    (fluid-let-syntax ([f (syntax-rules ()
                            [(_ x) x])])
      (g 1)))) ⇒ 1</code></pre>
</div>
</div>
<div class="paragraph">
<p>The two expressions are identical except that the inner <code>let-syntax</code> form in the first expression is a <code>fluid-let-syntax</code> form in the second. In the first expression, the <code>f</code> occurring in the expansion of <code>(g 1)</code> refers to the <code>let</code>-bound variable <code>f</code>, whereas in the second it refers to the keyword <code>f</code> by virtue of the fluid syntax binding for <code>f</code>.</p>
</div>
<div id="syntax:s2" class="paragraph">
<p>The following code employs <code>fluid-let-syntax</code> in the definition of a <code>define-integrable</code> form that is similar to <code>define</code> for procedure definitions except that it causes the code for the procedure to be <em>integrated</em>, or inserted, wherever a direct call to the procedure is found. No semantic difference is visible between procedures defined with <code>define-integrable</code> and those defined with <code>define</code>, except that a top-level <code>define-integrable</code> form must appear before the first reference to the defined identifier. Lexical scoping is preserved, the actual parameters in an integrated call are evaluated once and at the proper time, integrable procedures may be used as first-class values, and recursive procedures do not cause indefinite recursive expansion.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax define-integrable
  (syntax-rules (lambda)
    [(_ name (lambda formals form1 form2 ...))
     (begin
       (define xname
         (fluid-let-syntax ([name (identifier-syntax xname)])
           (lambda formals form1 form2 ...)))
       (define-syntax name
         (lambda (x)
           (syntax-case x ()
             [_ (identifier? x) #'xname]
             [(_ arg (... ...))
              #'((fluid-let-syntax ([name (identifier-syntax xname)])
                   (lambda formals form1 form2 ...))
                  arg
                  (... ...))]))))]))</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>define-integrable</code> has the following form.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-integrable <em>name</em> <em>lambda-expression</em>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>define-integrable</code> form expands into a pair of definitions: a syntax definition of <code><em>name</em></code> and a variable definition of <code>xname</code>. The transformer for <code><em>name</em></code> converts apparent calls to <code><em>name</em></code> into direct calls to <code><em>lambda-expression</em></code>. Since the resulting forms are merely direct <code>lambda</code> applications (the equivalent of <code>let</code> expressions), the actual parameters are evaluated exactly once and before evaluation of the procedure&#8217;s body, as required. All other references to <code><em>name</em></code> are replaced with references to <code>xname</code>. The definition of <code>xname</code> binds it to the value of <code><em>lambda-expression</em></code>. This allows the procedure to be used as a first-class value. Because <code>xname</code> is introduced by the transformer, the binding for <code>xname</code> is not visible anywhere except where references to it are introduced by the transformer for <code><em>name</em></code>.</p>
</div>
<div class="paragraph">
<p>Within <code><em>lambda-expression</em></code>, wherever it appears, <code><em>name</em></code> is rebound to a transformer that expands all references into references to <code>xname</code>. The use of <code>fluid-let-syntax</code> for this purpose prevents indefinite expansion from indirect recursion among integrable procedures. This allows the procedure to be recursive without causing indefinite expansion. Nothing special is done by <code>define-integrable</code> to maintain lexical scoping, since lexical scoping is maintained automatically by the expander.</p>
</div>
<div class="paragraph">
<p><em>Chez Scheme</em> integrate locally defined procedures automatically when it is appropriate to do so. It cannot integrate procedures defined at top-level, however, since code that assigns top-level variables can be introduced into the system (via <code>eval</code> or <code>load</code>) at any time. <code>define-integrable</code> can be used to force the integration of procedures bound at top-level, even if the integration of locally bound procedures is left to the compiler. It can also be used to force the integration of large procedures that the compiler would not normally integrate. (The <code>expand/optimize</code> procedure is useful for determining when integration does or does not take place.)</p>
</div>
</div>
<div class="sect2">
<h3 id="section_11.2.">Section 11.2. Syntax-Rules Transformers</h3>
<div class="paragraph">
<p><em>Chez Scheme</em> extends <code>syntax-rules</code> to permit clause to include fenders just like those allowed within <code>syntax-case</code> clauses.</p>
</div>
<div id="syntax:s4" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(syntax-rules (<em>literal</em> ...) <em>clause</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a transformer</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each <code><em>literal</em></code> must be an identifier other than an underscore ( <code>_</code> ) or ellipsis ( <code>...</code> ). Each clause must take the form below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(<em>pattern</em> <em>template</em>)
(<em>pattern</em> <em>fender</em> <em>template</em>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first form is the only form supported by the Revised<sup>6</sup> Report.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_11.3.">Section 11.3. Syntax-Case Transformers</h3>
<div class="paragraph">
<p><em>Chez Scheme</em> provides several procedures and syntactic forms that may be used to simplify the coding of certain syntactic abstractions.</p>
</div>
<div id="syntax:s6" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(syntax-&gt;list <em>syntax-object</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of syntax objects</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure takes a syntax object representing a list-structured form and returns a list of syntax objects, each representing the corresponding subform of the input form.</p>
</div>
<div class="paragraph">
<p><code>syntax-&gt;list</code> may be defined as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define syntax->list
  (lambda (ls)
    (syntax-case ls ()
      [() '()]
      [(x . r) (cons #'x (syntax->list #'r))])))

#'(a b c) ⇒ #&lt;syntax (a b c)&gt;
(syntax->list #'(a b c)) ⇒ (#&lt;syntax a&gt; #&lt;syntax b&gt; #&lt;syntax c&gt;)</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>syntax-&gt;list</code> is not required for list structures constructed from individual pattern variable values or sequences of pattern-variable values, since such structures are already lists. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(list? (with-syntax ([x #'a] [y #'b] [z #'c]) #'(x y z)))) ⇒ #t
(list? (with-syntax ([(x ...) #'(a b c)]) #'(x ...))) ⇒ #t</code></pre>
</div>
</div>
<div id="syntax:s7" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(syntax-&gt;vector <em>syntax-object</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a vector of syntax objects</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure takes a syntax object representing a vector-structured form and returns a vector of syntax objects, each representing the corresponding subform of the input form.</p>
</div>
<div class="paragraph">
<p><code>syntax-&gt;vector</code> may be defined as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define syntax->vector
  (lambda (v)
    (syntax-case v ()
      [#(x ...) (apply vector (syntax->list #'(x ...)))])))

#'#(a b c) ⇒ #&lt;syntax #(a b c)&gt;
(syntax->vector #'#(a b c)) ⇒ #(#&lt;syntax a&gt; #&lt;syntax b&gt; #&lt;syntax c&gt;)</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>syntax-&gt;vector</code> is not required for vector structures constructed from individual pattern variable values or sequences of pattern-variable values, since such structures are already vectors. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(vector? (with-syntax ([x #'a] [y #'b] [z #'c]) #'#(x y z)))) ⇒ #t
(vector? (with-syntax ([(x ...) #'(a b c)]) #'#(x ...))) ⇒ #t</code></pre>
</div>
</div>
<div id="syntax:s8" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(syntax-object-&gt;datum <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code><em>obj</em></code> stripped of syntactic information</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>syntax-object-&gt;datum</code> is identical to the Revised<sup>6</sup> Report <code>syntax-&gt;datum</code>.</p>
</div>
<div id="syntax:s9" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(datum <em>template</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>(datum <em>template</em>)</code> is a convenient shorthand syntax for</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(syntax->datum (syntax <em>template</em>))</code></pre>
</div>
</div>
<div class="paragraph">
<p><code><em>datum</em></code> may be defined simply as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax datum
  (syntax-rules ()
    [(_ t) (syntax->datum #'t)]))

(with-syntax ((a #'(a b c))) (datum a)) ⇒ (a b c)</code></pre>
</div>
</div>
<div id="syntax:s10" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(datum-&gt;syntax-object <em>template-identifier</em> <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a syntax object</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>datum-&gt;syntax-object</code> is identical to the Revised<sup>6</sup> Report <code>datum-&gt;syntax</code>.</p>
</div>
<div id="syntax:s11" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(with-implicit (<em>id<sub>0</sub></em> <em>id<sub>1</sub></em> ...) <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This form abstracts over the common usage of <code>datum-&gt;syntax</code> for creating implicit identifiers (see above). The form</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(with-implicit (<em>id<sub>0</sub></em> <em>id<sub>1</sub></em> ...)
  <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></pre>
</div>
</div>
<div class="paragraph">
<p>is equivalent to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(with-syntax ([<em>id<sub>1</sub></em> (datum->syntax #'<em>id<sub>0</sub></em> '<em>id<sub>1</sub></em>)] ...)
  <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>with-implicit</code> can be defined simply as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax with-implicit
  (syntax-rules ()
    [(_ (tid id ...) b1 b2 ...)
     (with-syntax ([id (datum->syntax #'tid 'id)] ...)
       b1 b2 ...)]))</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can use <code>with-implicit</code> to simplify the (correct version of) <code>loop</code> above.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax loop
  (lambda (x)
    (syntax-case x ()
      [(k e ...)
       (with-implicit (k break)
         #'(call-with-current-continuation
             (lambda (break)
               (let f () e ... (f)))))])))</code></pre>
</div>
</div>
<div id="syntax:s12" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(include <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. <code>include</code> expands into a <code>begin</code> expression containing the forms found in the file named by <code><em>path</em></code>. For example, if the file <code>f-def.ss</code> contains <code>(define f (lambda () x))</code>, the expression</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([x "okay"])
  (include "f-def.ss")
  (f))</code></pre>
</div>
</div>
<div class="paragraph">
<p>evaluates to <code>"okay"</code>. An include form is treated as a definition if it appears within a sequence of definitions and the forms on the file named by <code><em>path</em></code> are all definitions, as in the above example. If the file contains expressions instead, the <code>include</code> form is treated as an expression.</p>
</div>
<div class="paragraph">
<p><code>include</code> may be defined portably as follows, although <em>Chez Scheme</em> uses an implementation-dependent definition that allows it to capture and maintain source information for included code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax include
  (lambda (x)
    (define read-file
      (lambda (fn k)
        (let ([p (open-input-file fn)])
          (let f ([x (read p)])
            (if (eof-object? x)
                (begin (close-input-port p) '())
                (cons (datum->syntax k x)
                      (f (read p))))))))
    (syntax-case x ()
      [(k filename)
       (let ([fn (datum filename)])
         (with-syntax ([(exp ...) (read-file fn #'k)])
           #'(begin exp ...)))])))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The definition of <code>include</code> uses <code>datum-&gt;syntax</code> to convert the objects read from the file into syntax objects in the proper lexical context, so that identifier references and definitions within those expressions are scoped where the <code>include</code> form appears.</p>
</div>
<div class="paragraph">
<p>In <em>Chez Scheme</em>'s implementation of <code>include</code>, the parameter <code>source-directories</code> (<a href="#section_12.5.">Section 12.5</a>) determines the set of directories searched for source files not identified by absolute path names. <a id="syntax:s13"></a></p>
</div>
<div id="desc:syntax-error" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(syntax-error <em>obj</em> <em>string</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>does not return</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Syntax errors may be reported with <code>syntax-error</code>, which produces a message by concatenating <code><em>string</em> ...</code> and a printed representation of <code><em>obj</em></code>. If no string arguments are provided, the string <code>"invalid syntax"</code> is used instead. When <code><em>obj</em></code> is a syntax object, the syntax-object wrapper is stripped (as with <code>syntax-&gt;datum</code>) before the printed representation is created. If source file information is present in the syntax-object wrapper, <code>syntax-error</code> incorporates this information into the error message.</p>
</div>
<div class="paragraph">
<p><code>syntax-case</code> and <code>syntax-rules</code> call <code>syntax-error</code> automatically if the input fails to match one of the clauses.</p>
</div>
<div class="paragraph">
<p>We can use <code>syntax-error</code> to precisely report the cause of the errors detected in the following definition of (unnamed) <code>let</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax let
  (lambda (x)
    (define check-ids!
      (lambda (ls)
        (unless (null? ls)
          (unless (identifier? (car ls))
            (syntax-error (car ls) "let cannot bind non-identifier"))
          (check-ids! (cdr ls)))))
    (define check-unique!
      (lambda (ls)
        (unless (null? ls)
          (let ([x (car ls)])
            (when (let mem? ([ls (cdr ls)])
                    (and (not (null? ls))
                         (or (bound-identifier=? x (car ls))
                             (mem? (cdr ls)))))
              (syntax-error x "let cannot bind two occurrences of")))
          (check-unique! (cdr ls)))))
    (syntax-case x ()
      [(_ ((i e) ...) b1 b2 ...)
       (begin
         (check-ids! #'(i ...))
         (check-unique! #'(i ...))
         #'((lambda (i ...) b1 b2 ...) e ...))])))</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this change, the expression</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([a 3] [a 4]) (+ a a))</code></pre>
</div>
</div>
<div class="paragraph">
<p>produces the error message "let cannot bind two occurrences of <code>a</code>."</p>
</div>
<div id="syntax:s14" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(literal-identifier=? <em>identifier<sub>1</sub></em> <em>identifier<sub>2</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure is identical to the Revised<sup>6</sup> Report <code>free-identifier=?</code>, and is provided for backward compatibility only.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_11.4.">Section 11.4. Compile-time Values and Properties</h3>
<div class="paragraph">
<p>When defining sets of dependent macros, it is often convenient to attach information to identifiers in the same <em>compile time environment</em> that the expander uses to record information about variables, keywords, module names, etc. For example, a record-type definition macro, like <code>define-record-type</code>, might need to attach information to the record-type name in the compile-time environment for use in handling child record-type definitions.</p>
</div>
<div class="paragraph">
<p><em>Chez Scheme</em> provides two mechanisms for attaching information to identifiers in the compile-time environment: compile-time values and compile-time properties. A compile-time value is a kind of transformer that can be associated with an identifier via <code>define-syntax</code>, <code>let-syntax</code>, <code>letrec-syntax</code>, and <code>fluid-let-syntax</code>. When an identifier is associated with a compile-time value, it cannot also have any other meaning, and an attempt to reference it as an ordinary identifier results in a syntax error. A compile-time property, on the other hand, is maintained alongside an existing binding, providing additional information about the binding. Properties are ignored when ordinary references to an identifier occur.</p>
</div>
<div class="paragraph">
<p>The mechanisms used by a macro to obtain compile-time values and properties are similar. In both cases, the macro&#8217;s transformer returns a procedure <code><em>p</em></code> rather than a syntax object. The expander invokes <code><em>p</em></code> with one argument, an environment-lookup procedure <code><em>lookup</em></code>, which <code><em>p</em></code> can then use to obtain compile-time values and properties for one or more identifiers before it constructs the macro&#8217;s final output. <code><em>lookup</em></code> accepts one or two identifier arguments. With one argument, <code><em>id</em></code>, <code><em>lookup</em></code> returns the compile-time value of <code><em>id</em></code>, or <code>#f</code> if <code><em>id</em></code> has no compile-time value. With two arguments, <code><em>id</em></code> and <code><em>key</em></code>, <code><em>lookup</em></code> returns the value of <code><em>id</em></code>'s <code><em>key</em></code> property, or <code>#f</code> if <code><em>id</em></code> has no <code><em>key</em></code> property.</p>
</div>
<div id="syntax:s15" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-compile-time-value <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a compile-time value</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A compile time value is a kind of transformer with which a keyword may be associated by any of the keyword binding constructs, e.g., <code>define-syntax</code> or <code>let-syntax</code>. The transformer encapsulates the supplied <code><em>obj</em></code>. The encapsulated object may be retrieved as described above.</p>
</div>
<div class="paragraph">
<p>The following example illustrates how this feature might be used to define a simple syntactic record-definition mechanism where the record type descriptor is generated at expansion time.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax drt
  (lambda (x)
    (define construct-name
      (lambda (template-identifier . args)
        (datum->syntax template-identifier
          (string->symbol
            (apply string-append
              (map (lambda (x)
                     (if (string? x)
                         x
                         (symbol->string (syntax->datum x))))
                   args))))))
    (define do-drt
      (lambda (rname fname* prtd)
        (with-syntax ([rname rname]
                      [rtd (make-record-type-descriptor
                             (syntax->datum rname) prtd #f #f #f
                             (list->vector
                               (map (lambda (fname)
                                      `(immutable ,(syntax->datum fname)))
                                    fname*)))]
                      [make-rname (construct-name rname "make-" rname)]
                      [rname? (construct-name rname rname "?")]
                      [(rname-fname ...)
                       (map (lambda (fname)
                              (construct-name fname rname "-" fname))
                            fname*)]
                      [(i ...) (enumerate fname*)])
          #'(begin
              (define-syntax rname (make-compile-time-value 'rtd))
              (define rcd (make-record-constructor-descriptor 'rtd #f #f))
              (define make-rname (record-constructor rcd))
              (define rname? (record-predicate 'rtd))
              (define rname-fname (record-accessor 'rtd i))
              ...))))
    (syntax-case x (parent)
      [(_ rname (fname ...))
       (for-all identifier? #'(rname fname ...))
       (do-drt #'rname #'(fname ...) #f)]
      [(_ rname pname (fname ...))
       (for-all identifier? #'(rname pname fname ...))
       (lambda (lookup)
         (let ([prtd (lookup #'pname)])
           (unless (record-type-descriptor? prtd)
             (syntax-error #'pname "unrecognized parent record type"))
           (do-drt #'rname #'(fname ...) prtd)))])))</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(drt prec (x y))
(drt crec prec (z))
(define r (make-crec 1 2 3))
(prec? r) ⇒ #t
(prec-x r) ⇒ 1
(crec-z r) ⇒ 3
prec ⇒ <em>exception: invalid syntax prec</em></code></pre>
</div>
</div>
<div id="syntax:s16" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile-time-value? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a compile-time value; <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax x (make-compile-time-value "eggs"))
(compile-time-value? (top-level-syntax 'x)) ⇒ #t</code></pre>
</div>
</div>
<div id="syntax:s17" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile-time-value-value <em>ctv</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the value of a compile-time value</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax x (make-compile-time-value "eggs"))
(compile-time-value-value (top-level-syntax 'x)) ⇒ "eggs"</code></pre>
</div>
</div>
<div id="syntax:s18" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(define-property <em>id</em> <em>key</em> <em>expr</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A <code>define-property</code> form attaches a property to an existing identifier binding without disturbing the existing meaning of the identifier in the scope of that binding. It is typically used by one macro to record information about a binding for use by another macro. Both <code><em>id</em></code> and <code><em>key</em></code> must be identifiers. The expression <code><em>expr</em></code> is evaluated when the <code>define-property</code> form is expanded, and a new property associating <code><em>key</em></code> with the value of <code><em>expr</em></code> is attached to the existing binding of <code><em>id</em></code>, which must have a visible local or top-level binding.</p>
</div>
<div class="paragraph">
<p><code>define-property</code> is a definition and can appear anywhere other definitions can appear. The scope of a property introduced by <code>define-property</code> is the entire body in which the <code>define-property</code> form appears or global if it appears at top level, except where it is replaced by a property for the same <code><em>id</em></code> and <code><em>key</em></code> or where the binding to which it is attached is shadowed. Any number of properties can be attached to the same binding with different keys. Attaching a new property with the same name as an property already attached to a binding shadows the existing property with the new property.</p>
</div>
<div class="paragraph">
<p>The following example defines a macro, <code>get-info</code>, that retrieves the <code>info</code> property of a binding, defines the variable <code>x</code>, attaches an <code>info</code> property to the binding of <code>x</code>, retrieves the property via <code>get-info</code>, references <code>x</code> to show that its normal binding is still intact, and uses <code>get-info</code> again within the scope of a different binding of <code>x</code> to show that the properties are shadowed as well as the outer binding of <code>x</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define info)
(define-syntax get-info
  (lambda (x)
    (lambda (lookup)
      (syntax-case x ()
        [(_ q)
         (let ([info-value (lookup #'q #'info)])
           #`'#,(datum->syntax #'* info-value))]))))
(define x "x-value")
(define-property x info "x-info")
(get-info x) ⇒ "x-info"
x ⇒ "x-value"
(let ([x "inner-x-value"]) (get-info x)) ⇒ #f</code></pre>
</div>
</div>
<div class="paragraph">
<p>For debugging, it is often useful to have a form that retrieves an arbitrary property, given an identifier and a key. The <code>get-property</code> macro below does just that.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax get-property
  (lambda (x)
    (lambda (r)
      (syntax-case x ()
        [(_ id key)
         #`'#,(datum->syntax #'* (r #'id #'key))]))))
(get-property x info) ⇒ "x-info"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The bindings for both identifiers must be visible where <code>get-property</code> is used.</p>
</div>
<div class="paragraph">
<p>The version of <code>drt</code> defined below is like the one defined using <code>make-compile-time-value</code> above, except that it defines the record name as a macro that raises an exception with a more descriptive message, while attaching the record type descriptor to the binding as a separate property. The variable <code>drt-key</code> defined along with <code>drt</code> is used only as the key for the property that <code>drt</code> attaches to a record name. Both <code>drt-key</code> and <code>drt</code> are defined within a module that exports only the latter, ensuring that the properties used by <code>drt</code> cannot be accessed or forged.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(library (drt) (export drt) (import (chezscheme))
  (define drt-key)
  (define-syntax drt
    (lambda (x)
      (define construct-name
        (lambda (template-identifier . args)
          (datum->syntax template-identifier
            (string->symbol
              (apply string-append
                (map (lambda (x)
                       (if (string? x)
                           x
                           (symbol->string (syntax->datum x))))
                     args))))))
      (define do-drt
        (lambda (rname fname* prtd)
          (with-syntax ([rname rname]
                        [rtd (make-record-type-descriptor
                               (syntax->datum rname) prtd #f #f #f
                               (list->vector
                                 (map (lambda (fname)
                                        `(immutable ,(syntax->datum fname)))
                                      fname*)))]
                        [make-rname (construct-name rname "make-" rname)]
                        [rname? (construct-name rname rname "?")]
                        [(rname-fname ...)
                         (map (lambda (fname)
                                (construct-name fname rname "-" fname))
                              fname*)]
                        [(i ...) (enumerate fname*)])
            #'(begin
                (define-syntax rname
                  (lambda (x)
                    (syntax-error x "invalid use of record name")))
                (define rcd (make-record-constructor-descriptor 'rtd #f #f))
                (define-property rname drt-key 'rtd)
                (define make-rname (record-constructor rcd))
                (define rname? (record-predicate 'rtd))
                (define rname-fname (record-accessor 'rtd i))
                ...))))
      (syntax-case x (parent)
        [(_ rname (fname ...))
         (for-all identifier? #'(rname fname ...))
         (do-drt #'rname #'(fname ...) #f)]
        [(_ rname pname (fname ...))
         (for-all identifier? #'(rname pname fname ...))
         (lambda (lookup)
           (let ([prtd (lookup #'pname #'drt-key)])
             (unless prtd
               (syntax-error #'pname "unrecognized parent record type"))
             (do-drt #'rname #'(fname ...) prtd)))]))))</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(import (drt))
(drt prec (x y))
(drt crec prec (z))
(define r (make-crec 1 2 3))
(prec? r) ⇒ #t
(prec-x r) ⇒ 1
(crec-z r) ⇒ 3
prec ⇒ <em>exception: invalid use of record name prec</em></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_11.5.">Section 11.5. Modules</h3>
<div id="syntax:s20" class="paragraph">
<p>Modules are used to help organize programs into separate parts that interact cleanly via declared interfaces. Although modular programming is typically used to facilitate the development of large programs possibly written by many individuals, it may also be used in <em>Chez Scheme</em> at a "micro-modular" level, since <em>Chez Scheme</em> module and import forms are definitions and may appear anywhere any other kind of definition may appear, including within a <code>lambda</code> body or other local scope.</p>
</div>
<div class="paragraph">
<p>Modules control visibility of bindings and can be viewed as extending lexical scoping to allow more precise control over where bindings are or are not visible. Modules export identifier bindings, i.e., variable bindings, keyword bindings, or module name bindings. Modules may be <em>named</em> or <em>anonymous</em>. Bindings exported from a named module may be made visible via an import form wherever the module&#8217;s name is visible. Bindings exported from an anonymous module are implicitly imported where the module form appears. Anonymous modules are useful for hiding some of a set of bindings while allowing the remaining bindings in the set to be visible.</p>
</div>
<div class="paragraph">
<p>Some of the text and examples given in this section are adapted from the paper "Extending the scope of syntactic abstraction" <a href="#ref32">[32]</a>, which describes modules and their implementation in more detail.</p>
</div>
<div id="syntax:s21" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(module <em>name</em> <em>interface</em> <em>defn</em> ... <em>init</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(module <em>interface</em> <em>defn</em> ... <em>init</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>name</em></code> is an identifier, <code><em>defn</em> ...</code> are definitions, and <code><em>init</em> ...</code> are expressions. <code><em>interface</em></code> is a list of exports <code>(<em>export</em> ...)</code>, where each <code><em>export</em></code> is either an identifier <code><em>identifier</em></code> or of the form <code>(<em>identifier</em> <em>export</em> ...)</code>.</p>
</div>
<div class="paragraph">
<p>The first syntax for <code>module</code> establishes a named scope that encapsulates a set of identifier bindings. The exported bindings may be made visible via <code>import</code> or <code>import-only</code> (<a href="#section_10.4.">Section 10.4</a>) anywhere the module name is visible. The second syntax for <code>module</code> introduces an anonymous module whose bindings are implicitly imported (as if by <code>import</code> of a hidden module name) where the module form appears.</p>
</div>
<div class="paragraph">
<p>A module consists of a (possibly empty) set of definitions and a (possibly empty) sequence of initialization expressions. The identifiers defined within a module are visible within the body of the module and, if exported, within the scope of an import for the module. Each identifier listed in a module&#8217;s interface must be defined within or imported into that module. A <code>module</code> form is a definition and can appear anywhere other definitions can appear, including at the top level of a program, nested within the bodies of <code>lambda</code> expressions, nested within <code>library</code> and top-level program forms, and nested within other modules. Also, because module names are scoped like other identifiers, modules and libraries may export module names as well as variables and keywords.</p>
</div>
<div class="paragraph">
<p>When an interface contains an export of the form <code>(<em>identifier</em> <em>export</em> ...)</code>, only <code><em>identifier</em></code> is visible in the importing context. The identifiers within <code><em>export</em> ...</code> are <em>indirect imports</em>, as if declared via an <code>indirect-export</code> form (<a href="#section_10.4.">Section 10.4</a>).</p>
</div>
<div class="paragraph">
<p>Module names occupy the same namespace as other identifiers and follow the same scoping rules. Unless exported, identifiers defined within a module are visible only within that module.</p>
</div>
<div class="paragraph">
<p>Expressions within a module can reference identifiers bound outside of the module.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([x 3])
  (module m (plusx)
    (define plusx (lambda (y) (+ x y))))
  (import m)
  (let ([x 4])
    (plusx 5))) ⇒ 8</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly, <code>import</code> does not prevent access to identifiers that are visible where the import form appears, except for those variables shadowed by the imported identifiers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(module m (y) (define y 'm-y))
(let ([x 'local-x] [y 'local-y])
  (import m)
  (list x y)) ⇒ (local-x m-y)</code></pre>
</div>
</div>
<div class="paragraph">
<p>On the other hand, use of <code>import-only</code> within a module establishes an isolated scope in which the only visible identifiers are those exported by the imported module.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(module m (y) (define y 'm-y))
(let ([x 'local-x] [y 'local-y])
  (import-only m)
  x) ⇒ Error: x is not visible</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is sometimes desirable for static verification that no identifiers are used except those explicitly imported into a module or local scope.</p>
</div>
<div class="paragraph">
<p>Unless a module imported via <code>import-only</code> exports <code>import</code> or <code>import-only</code> and the name of at least one module, subsequent imports within the scope of the <code>import-only</code> form are not possible. To create an isolated scope containing the exports of more than one module without making <code>import</code> or <code>import-only</code> visible, all of the modules to be imported must be listed in the same <code>import-only</code> form.</p>
</div>
<div class="paragraph">
<p>Another solution is to create a single module that contains the exports of each of the other modules.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(module m2 (y) (define y 'y))
(module m1 (x) (define x 'x))
(module mega-module (cons x y)
  (import m1)
  (import m2)
  (import scheme))
(let ([y 3])
  (import-only mega-module)
  (cons x y)) ⇒ (x . y)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Before it is compiled, a source program is translated into a core language program containing no syntactic abstractions, syntactic definitions, library definitions, module definitions, or import forms. Translation is performed by a <em>syntax expander</em> that processes the forms in the source program via recursive descent.</p>
</div>
<div class="paragraph">
<p>A <code>define-syntax</code> form associates a keyword with a transformer in a translation-time environment. When the expander encounters a keyword, it invokes the associated transformer and reprocesses the resulting form. A <code>module</code> form associates a module name with an interface. When the expander encounters an <code>import</code> form, it extracts the corresponding module interface from the translation-time environment and makes the exported bindings visible in the scope where the <code>import</code> form appears.</p>
</div>
<div class="paragraph">
<p>Internal definitions and definitions within a <code>module</code> body are processed from left to right so that a module&#8217;s definition and import may appear within the same sequence of definitions. Expressions appearing within a body and the right-hand sides of variable definitions, however, are translated only after the entire set of definitions has been processed, allowing full mutual recursion among variable and syntactic definitions.</p>
</div>
<div class="paragraph">
<p>Module and import forms affect only the visibility of identifiers in the source program, not their meanings. In particular, variables are bound to locations whether defined within or outside of a module, and <code>import</code> does not introduce new locations. Local variables are renamed as necessary to preserve the scoping relationships established by both modules and syntactic abstractions. Thus, the expression:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([x 1])
  (module m (x setter)
    (define-syntax x (identifier-syntax z))
    (define setter (lambda (x) (set! z x)))
    (define z 5))
  (let ([y x] [z 0])
    (import m)
    (setter 3)
    (+ x y z))) ⇒ 4</code></pre>
</div>
</div>
<div class="paragraph">
<p>is equivalent to the following program in which identifiers have been consistently renamed as indicated by subscripts.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([x<sub>0</sub> 1])
  (define-syntax x<sub>1</sub> (identifier-syntax z<sub>1</sub>))
  (define setter<sub>1</sub> (lambda (x<sub>2</sub>) (set! z<sub>1</sub> x<sub>2</sub>)))
  (define z<sub>1</sub> 5)
  (let ([y<sub>3</sub> x<sub>0</sub>] [z<sub>3</sub> 0])
    (setter<sub>1</sub> 3)
    (+ x<sub>1</sub> y<sub>3</sub> z<sub>3</sub>)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Definitions within a top-level <code>begin</code>, <code>lambda</code>, top-level program, <code>library</code>, or <code>module</code> body are processed from left to right by the expander at expand time, and the variable definitions are evaluated from left-to-right at run time. Initialization expressions appearing within a <code>module</code> body are evaluated in sequence after the evaluation of the variable definitions.</p>
</div>
<div class="paragraph">
<p>Mutually recursive modules can be defined in several ways. In the following program, <code>a</code> and <code>b</code> are mutually recursive modules exported by an anonymous module whose local scope is used to statically link the two. For example, the free variable <code>y</code> within module <code>a</code> refers to the binding for <code>y</code>, provided by importing <code>b</code>, in the enclosing module.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(module (a b)
  (module a (x) (define x (lambda () y)))
  (module b (y) (define y (lambda () x)))
  (import a)
  (import b))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following syntactic abstraction generalizes this pattern to permit the definition of multiple mutually recursive modules.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax rec-modules
  (syntax-rules (module)
    [(_ (module m (id ...) form ...) ...)
     (module (m ...)
       (module m (id ...) form ...) ...
       (import m) ...)]))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because a module can re-export imported bindings, it is quite easy to provide multiple views on a single module, as <code>s</code> and <code>t</code> provide for <code>r</code> below, or to combine several modules into a compound, as <code>r</code> does.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(module p (x y)
  (define x 1) (define y 2))
(module q (y z)
  (define y 3) (define z 4))
(module r (a b c d)
  (import* p (a x) (b y))
  (import* q (c y) (d z)))
(module s (a c) (import r))
(module t (b d) (import r))</code></pre>
</div>
</div>
<div class="paragraph">
<p>To allow interfaces to be separated from implementations, the following syntactic abstractions support the definition and use of named interfaces.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax define-interface
  (syntax-rules ()
    [(_ name (export ...))
     (define-syntax name
       (lambda (x)
         (syntax-case x ()
           [(_ n defs)
            (with-implicit (n export ...)
              #'(module n (export ...) .
                  defs))])))]))

(define-syntax define-module
  (syntax-rules ()
    [(_ name interface defn ...)
     (interface name (defn ...))]))</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>define-interface</code> creates an interface macro that, given a module name and a list of definitions, expands into a module definition with a concrete interface.</p>
</div>
<div class="paragraph">
<p><code>with-implicit</code> is used to ensure that the introduced <code>export</code> identifiers are visible in the same scope as the name of the module in the <code>define-module</code> form.</p>
</div>
<div class="paragraph">
<p><code>define-interface</code> and <code>define-module</code> can be used as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-interface simple (a b))
(define-module m simple
  (define-syntax a (identifier-syntax 1))
  (define b (lambda () c))
  (define c 2))
(let () (import m) (+ a (b))) ⇒ 3</code></pre>
</div>
</div>
<div class="paragraph">
<p>The abstract module facility defined below allows a module interface to be satisfied incrementally when module forms are evaluated. This permits flexibility in the separation between the interface and implementation, supports separate compilation of mutually recursive modules, and permits redefinition of module implementations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax abstract-module
  (syntax-rules ()
    [(_ name (ex ...) (kwd ...) defn ...)
     (module name (ex ... kwd ...)
       (declare ex) ...
       defn ...)]))

(define-syntax implement
  (syntax-rules ()
    [(_ name form ...)
     (module () (import name) form ...)]))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Within an <code>abstract-module</code> form, each of the exports in the list <code><em>ex</em> ...</code> must be variables. The values of these variables are supplied by one or more separate <code>implement</code> forms. Since keyword bindings must be present at compile time, they cannot be satisfied incrementally and are instead listed as separate exports and defined within the abstract module.</p>
</div>
<div class="paragraph">
<p>Within an <code>implement</code> form, the sequence of forms <code><em>form</em> ...</code> is a sequence of zero or more definitions followed by a sequence of zero or more expressions. Since the module used in the expansion of <code>implement</code> does not export anything, the definitions are all local to the <code>implement</code> form. The expressions may be arbitrary expressions, but should include one <code>satisfy</code> form for each variable whose definition is supplied by the <code>implement</code> form. A <code>satisfy</code> form has the syntax</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(satisfy <em>variable</em> <em>expr</em>)</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>declare</code> and <code>satisfy</code> may simply be the equivalents of <code>define</code> and <code>set!</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax declare (identifier-syntax define))
(define-syntax satisfy (identifier-syntax set!))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, <code>declare</code> can initialize the declared variable to the value of a flag known only to <code>declare</code> and <code>satisfy</code>, and <code>satisfy</code> can verify that this flag is still present to insure that only one attempt to satisfy the value of a given identifier is made.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(module ((declare cookie) (satisfy cookie))
  (define cookie "chocolate chip")
  (define-syntax declare
    (syntax-rules () [(_ var) (define var cookie)]))
  (define-syntax satisfy
    (syntax-rules ()
      [(_ var exp)
       (if (eq? var cookie)
           (set! var exp)
           (assertion-violationf 'satisfy
             "value of variable ~s has already been satisfied"
             'var))])))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using <code>abstract-module</code> and <code>implement</code>, we can define mutually recursive and separately compilable modules as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(abstract-module e (even?) (pred)
  (define-syntax pred
    (syntax-rules () [(_ exp) (- exp 1)])))

(abstract-module o (odd?) ())

(implement e
  (import o)
  (satisfy even?
    (lambda (x)
      (or (zero? x) (odd? (pred x))))))

(implement o
  (import e)
  (satisfy odd?
    (lambda (x) (not (even? x)))))

(let () (import-only e) (even? 38)) ⇒ #t</code></pre>
</div>
</div>
<div id="syntax:s22" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>only</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>except</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>add-prefix</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>drop-prefix</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>rename</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>alias</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These identifiers are auxiliary keywords for <code>import</code> and <code>import-only</code>. It is a syntax violation to reference these identifiers except in contexts where they are recognized as auxiliary keywords.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_11.6.">Section 11.6. Standalone import and export forms</h3>
<div class="paragraph">
<p>The local import and export forms described in <a href="#section_10.4.">Section 10.4</a> can be used equally well for and within modules.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_11.7.">Section 11.7. Built-in Modules</h3>
<div class="paragraph">
<p>Five modules are built-in to <em>Chez Scheme</em>: <code>scheme</code>, <code>r5rs</code>, <code>r5rs-syntax</code>, <code>ieee</code>, and <code>$system</code>. Each module is immutable, i.e., the exported bindings cannot be altered.</p>
</div>
<div id="syntax:s28" class="hdlist">
<table>
<tr>
<td class="hdlist1">
module
</td>
<td class="hdlist2">
<p><code>scheme</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>scheme</code> contains all user-visible top-level bindings (variables, keywords, and module names) built into <em>Chez Scheme</em>.</p>
</div>
<div id="syntax:s29" class="hdlist">
<table>
<tr>
<td class="hdlist1">
module
</td>
<td class="hdlist2">
<p><code>r5rs</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>r5rs</code> contains all top-level bindings (variables and keywords) defined in the Revised<sup>5</sup> Report on Scheme. The bindings exported from <code>r5rs</code> are precisely those that are available within an expression evaluated via <code>eval</code> with the environment specifier returned by <code>scheme-report-environment</code>.</p>
</div>
<div id="syntax:s31" class="hdlist">
<table>
<tr>
<td class="hdlist1">
module
</td>
<td class="hdlist2">
<p><code>r5rs-syntax</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>r5rs-syntax</code> contains all top-level keyword bindings defined in the Revised<sup>5</sup> Report on Scheme. The bindings exported from <code>r5rs-syntax</code> are precisely those that are available within an expression evaluated via <code>eval</code> with the environment specifier returned by <code>null-environment</code>.</p>
</div>
<div id="syntax:s33" class="hdlist">
<table>
<tr>
<td class="hdlist1">
module
</td>
<td class="hdlist2">
<p><code>ieee</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>ieee</code> contains all top-level bindings (variables and keywords) defined in the ANSI/IEEE standard for Scheme. The bindings exported from <code>ieee</code> are precisely those that are available within an expression evaluated via <code>eval</code> with the environment specifier returned by <code>ieee-environment</code>.</p>
</div>
<div id="syntax:s35" class="hdlist">
<table>
<tr>
<td class="hdlist1">
module
</td>
<td class="hdlist2">
<p><code>$system</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>$system</code> contains all user-visible top-level bindings built into <em>Chez Scheme</em> along with various undocumented system bindings.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_11.8.">Section 11.8. Meta Definitions</h3>
<div id="syntax:s36" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(meta . <em>definition</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>meta</code> keyword is actually a prefix that can be placed in front of any definition keyword, e.g.,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(meta define x 3)</code></pre>
</div>
</div>
<div class="paragraph">
<p>It tells the expander that any variable definition resulting from the definition is to be an expand-time definition available only to the right-hand sides of other meta definitions and, most importantly, transformer expressions. It is used to define expand-time helpers and other information for use by one or more <code>syntax-case</code> transformers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(module M (helper1 a b)
  (meta define helper1
    (lambda (---)
      ---))
  (meta define helper2
    (lambda (---)
      --- (helper2 ---) ---))
  (define-syntax a
    (lambda (x)
      --- (helper1 ---) ---))
  (define-syntax b
    (lambda (x)
      --- (helper1 ---) ---
      --- (helper2 ---) ---)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The right-hand-side expressions of a syntax definition or meta definition can refer only to identifiers whose values are already available in the compile-time environment. Because of the left-to-right expansion order for <code>library</code>, <code>module</code>, <code>lambda</code>, and similar bodies, this implies a semantics similar to <code>let*</code> for a sequence of meta definitions, in which each right-hand side can refer only to the variables defined earlier in the sequence. An exception is that the right-hand side of a meta definition can refer to its own name as long as the reference is not evaluated until after the value of the expression has been computed. This permits meta definitions to be self-recursive but not mutually recursive. The right-hand side of a meta definition can, however, build syntax objects containing occurrences of any identifiers defined in the body in which the meta definition appears.</p>
</div>
<div class="paragraph">
<p>Meta definitions propagate through macro expansion, so one can write, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(module (a)
  (meta define-record foo (x))
  (define-syntax a
    (let ([q (make-foo #''q)])
      (lambda (x) (foo-x q)))))
a ⇒ q</code></pre>
</div>
</div>
<div class="paragraph">
<p>where define-record is a macro that expands into a set of defines.</p>
</div>
<div class="paragraph">
<p>It is also sometimes convenient to write</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(meta begin defn ...)</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(meta module {exports} defn ...)</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(meta include "<em>path</em>")</code></pre>
</div>
</div>
<div class="paragraph">
<p>to create groups of meta bindings.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_11.9.">Section 11.9. Conditional expansion</h3>
<div class="paragraph">
<p>Expansion-time decisions can be made via <code>meta-cond</code>, which is similar to <code>cond</code> but evaluates the test expressions at expansion time and can be used in contexts where definitions are expected as well as in expression contexts.</p>
</div>
<div id="syntax:s37" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(meta-cond <em>clause<sub>1</sub></em> <em>clause<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each <code><em>clause</em></code> but the last must take the form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(<em>test</em> <em>expr<sub>1</sub></em> <em>expr<sub>2</sub></em> ...)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The last may take the same form or be an <code>else</code> clause of the form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(<em>else</em> <em>expr<sub>1</sub></em> <em>expr<sub>2</sub></em> ...)</code></pre>
</div>
</div>
<div class="paragraph">
<p>During expansion, the <code><em>test</em></code> expressions are evaluated in order until one evaluates to a true value or until all of the tests have been evaluated. If a <code><em>test</em></code> evaluates to a true value, the <code>meta-cond</code> form expands to a <code>begin</code> form containing the corresponding expressions <code><em>expr<sub>1</sub></em> <em>expr<sub>2</sub></em> ...</code>. If no <code><em>test</em></code> evaluates to a true value and an <code>else</code> clause is present, the <code>meta-cond</code> form expands to a <code>begin</code> form containing the expressions <code><em>expr<sub>1</sub></em> <em>expr<sub>2</sub></em> ...</code> from the <code>else</code> clause. Otherwise the <code>meta-cond</code> expression expands into a call to the <code>void</code> procedure.</p>
</div>
<div class="paragraph">
<p><code>meta-cond</code> might be defined as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax meta-cond
  (syntax-rules ()
    [(_ [a0 a1 a2 ...] [b0 b1 b2 ...] ...)
     (let-syntax ([expr (cond
                          [a0 (identifier-syntax (begin a1 a2 ...))]
                          [b0 (identifier-syntax (begin b1 b2 ...))]
                          ...)])
       expr)]))</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>meta-cond</code> is used to choose, at expansion time, from among a set of possible forms. For example, one might have safe (error-checking) and unsafe (non-error-checking) versions of a procedure and decide which to call based on the compile-time optimization level, as shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(meta-cond
  [(= (optimize-level) 3) (unsafe-frob x)]
  [else (safe-frob x)])</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_11.10.">Section 11.10. Aliases</h3>
<div id="syntax:s38" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(alias <em>id<sub>1</sub></em> <em>id<sub>2</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>alias</code> is a definition and can appear anywhere other definitions can appear. It is used to transfer the binding from one identifier to another.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([x 3]) (alias y x) (set! y 4) (list x y)) ⇒ (4 4)

(module lisp (if)
  (module (scheme:if)
    (import scheme)
    (alias scheme:if if))
  (define-syntax if
    (syntax-rules ()
      [(_ e_1 e_2 e_3)
       (scheme:if (not (memq e_1 '(#f ()))) e_2 e_3)])))
(define (length ls)
  (import lisp)
  (if ls (+ (length (cdr ls)) 1) 0))
(length '(a b c)) ⇒ 3</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because of left-to-right expansion order, aliases should appear after the definition of the right-hand-side identifier, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ()
  (import-only (chezscheme))
  (define y 3)
  (alias x y)
  x) ⇒ 3</code></pre>
</div>
</div>
<div class="paragraph">
<p>rather than:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ()
  (import-only (chezscheme))
  (alias x y)
  (define y 3)
  x) ⇒ <em>exception: unbound identifier</em></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_11.11.">Section 11.11. Annotations</h3>
<div class="paragraph">
<p>When source code is read from a file by <code>load</code>, <code>compile-file</code>, or variants of these, such as <code>load-library</code>, the reader attaches <em>annotations</em> to each object read from the file. These annotations identify the file and the position of the object within the file. Annotations are tracked through the compilation process and associated with compiled code at run time. The expander and compiler use the annotations to produce syntax errors and compiler warnings that identify the location of the offending form, and the inspector uses them to identify the locations of calls and procedure definitions. The compiler and run time also use annotations to associate source positions with profile counts.</p>
</div>
<div class="paragraph">
<p>While these annotations are usually maintained "behind the scenes," the programmer can manipulate them directly via a set of routines for creating and accessing annotations.</p>
</div>
<div class="paragraph">
<p>Annotations are values of a type distinct from other types and have four components: an expression, possibly with annotated subexpressions, a <em>source object</em>, a stripped version of the expression, and usage options. Annotations can be created via <code>make-annotation</code>, which has three required arguments corresponding to the first three components and an optional fourth argument corresponding to the fourth component. The second argument must be a source object, and the third argument should be a stripped version of the first argument, i.e., equivalent to the first argument with each annotation replaced by its expression component. An annotation is essentially equivalent to its stripped component as a representation of source code, with the source information attached and available to the expander or evaluator. The optional fourth argument, if present, must be an enumeration set over the symbols <code>debug</code> and <code>profile</code> and defaults to an enumeration set containing both <code>debug</code> and <code>profile</code>.</p>
</div>
<div class="paragraph">
<p>Annotations marked <code>debug</code> are used for compile-time error reporting and run-time error reporting and inspection; annotations marked <code>profile</code> are used for profiling. Annotations created by the Scheme reader are always marked both <code>debug</code> and <code>profile</code>, but other readers and parsers might choose to mark some annotations only <code>debug</code> or only <code>profile</code>. In particular, it might be useful to annotate multiple expressions in the output of a parser with the same source object for debugging purposes and mark only one of them <code>profile</code> to avoid duplicate counts. It might also be useful to mark no expressions <code>profile</code> and instead introduce explicit <code>profile</code> forms (<a href="#section_12.7.">Section 12.7</a>) to identify the set of source locations to be profiled.</p>
</div>
<div class="paragraph">
<p>Source objects are also values of a type distinct from other types and also have three or five components: a <em>source-file descriptor</em> (sfd), a beginning file position (bfp), an ending file position (efp), an optional beginning line, and an optional beginning column. The sfd identifies the file from which an expression is read and the bfp and efp identify the range of character positions occupied by the object in the file, with the bfp being inclusive and the efp being exclusive. The line and column are either both numbers or both not present. A source object can be created via <code>make-source-object</code>, which takes either three or five arguments corresponding to these components. The first argument must be a source-file descriptor, the second and third must be nonnegative exact integers, the second must not be greater than the third, and the fourth and fifth (if provided) must be positive exact integers.</p>
</div>
<div class="paragraph">
<p>Source-file descriptors are also values of a type distinct from all other types and have two components: the file&#8217;s path, represented by a string, and a checksum, represented by a number. The path might or might not be an absolute path depending on how the file&#8217;s path was specified when the source-file descriptor was created. The checksum is computed based on the file&#8217;s length and contents when the file is created and checked by tools that look for the source file to make sure that the proper file has been found and has not been modified. Source-file descriptors can be created with <code>make-source-file-descriptor</code>, which accepts two arguments: a string naming the path and a binary input port, along with an optional third boolean argument, <code><em>reset?</em></code>, which defaults to false. <code>make-source-file-descriptor</code> computes a checksum based on the contents of the port, starting at its current position. It resets the port, using <code>set-port-position!</code>, after computing the checksum if <code><em>reset?</em></code> is true; otherwise, it leaves the port at end-of-file.</p>
</div>
<div class="paragraph">
<p>The procedures that create, check for, and access annotations, source objects, and source-file descriptors are summarized below and described in more detail later in this section.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(make-annotation <em>obj</em> <em>source-object</em> <em>obj</em>) ⇒ <em>annotation</em>
(annotation? <em>obj</em>) ⇒ <em>boolean</em>
(annotation-expression <em>annotation</em>) ⇒ <em>obj</em>
(annotation-source <em>annotation</em>) ⇒ <em>source-object</em>
(annotation-stripped <em>annotation</em>) ⇒ <em>obj</em>

(make-source-object <em>sfd</em> <em>uint</em> <em>uint</em>) ⇒ <em>source-object</em>
(make-source-object <em>sfd</em> <em>uint</em> <em>uint</em> <em>uint</em> <em>uint</em>) ⇒ <em>source-object</em>
(source-object? <em>obj</em>) ⇒ <em>boolean</em>
(source-object-sfd <em>source-object</em>) ⇒ <em>sfd</em>
(source-object-bfp <em>source-object</em>) ⇒ <em>uint</em>
(source-object-efp <em>source-object</em>) ⇒ <em>uint</em>
(source-object-line <em>source-object</em>) ⇒ <em>uint</em> or #f
(source-object-column <em>source-object</em>) ⇒ <em>uint</em> or #f

(make-source-file-descriptor <em>string</em> <em>binary-input-port</em>) ⇒ <em>sfd</em>
(make-source-file-descriptor <em>string</em> <em>binary-input-port</em> <em>reset?</em>) ⇒ <em>sfd</em>
(source-file-descriptor? <em>obj</em>) ⇒ <em>boolean</em>
(source-file-descriptor-checksum <em>sfd</em>) ⇒ <em>obj</em>
(source-file-descriptor-path <em>sfd</em>) ⇒ <em>obj</em></code></pre>
</div>
</div>
<div class="paragraph">
<p>A program might open a source file with <code>open-file-input-port</code>, create an sfd using <code>make-source-file-descriptor</code>, create a textual port from the binary port using transcoded-port, and create source objects and annotations for each of the objects it reads from the file. If a custom reader is not required, the Scheme reader can be used to read annotations via the <code>get-datum/annotations</code> procedure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(get-datum/annotations <em>textual-input-port</em> <em>sfd</em> <em>uint</em>) ⇒ <em>obj</em>, <em>uint</em></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>get-datum/annotations</code> is like <code>get-datum</code> but instead of returning a plain datum, it returns an annotation encapsulating a datum (possibly with nested annotations), a source object, and the plain (stripped) datum. It also returns a second value, the position of the first character beyond the object in the file. Character positions are accepted and returned by <code>get-datum/annotations</code> so that the textual port need not support <code>port-position</code> and need not report positions in characters if it does support <code>port-position</code>. (Positions are usually reported in bytes.) The bfp and efp positions recorded in the annotations returned by <code>get-datum/annotations</code> are correct only if the positions supplied to it are correct.</p>
</div>
<div class="paragraph">
<p>Once read, an annotation can be passed to the expander, interpreter, or compiler. The procedures <code>eval</code>, <code>expand</code>, <code>interpret</code>, and <code>compile</code> all accept annotated or unannotated input.</p>
</div>
<div class="paragraph">
<p>Two additional procedures complete the set of annotation-related primitives:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(open-source-file <em>sfd</em>) ⇒ #f or <em>port</em>
(syntax->annotation <em>obj</em>) ⇒ #f or <em>annotation</em></code></pre>
</div>
</div>
<div id="syntax:s47" class="paragraph">
<p><code>open-source-file</code> attempts to locate and open the source file identified by <code><em>sfd</em></code>. It returns a textual input port, positioned at the beginning of the file, if successful, and <code>#f</code> otherwise.</p>
</div>
<div class="paragraph">
<p><code>syntax-&gt;annotation</code> accepts a syntax object. If the syntax object&#8217;s expression is annotated, it returns the annotation; otherwise, it returns <code>#f</code>. It can be used by a macro to extract source information, when available, from an input form.</p>
</div>
<div class="paragraph">
<p>The procedure <code>datum-&gt;syntax</code> accepts either an annotated or unannotated input datum.</p>
</div>
<div id="syntax:s49" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-annotation <em>obj</em> <em>source-object</em> <em>stripped-obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-annotation <em>obj</em> <em>source-object</em> <em>stripped-obj</em> <em>options</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>an annotation</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The annotation is formed with <code><em>obj</em></code> as its expression component, <code><em>source-object</em></code> as its source-object component, and <code><em>stripped-obj</em></code> as its stripped component. <code><em>obj</em></code> should represent an expression, possibly with embedded annotations. <code><em>stripped-obj</em></code> should be a stripped version of <code><em>obj</em></code>, i.e., equivalent to <code><em>obj</em></code> with each annotation replaced by its expression component. <code><em>options</em></code>, if present must be an enumeration set over the symbols <code>debug</code> and <code>profile</code>, and defaults to an enumeration set containing both <code>debug</code> and <code>profile</code>. Annotations marked <code>debug</code> are used for compile-time error reporting and run-time error reporting and inspection; annotations marked <code>profile</code> are used for profiling.</p>
</div>
<div id="syntax:s50" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(annotation? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is an annotation, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="syntax:s51" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(annotation-expression <em>annotation</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the expression component of <code><em>annotation</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="syntax:s52" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(annotation-source <em>annotation</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the source-object component of <code><em>annotation</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="syntax:s53" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(annotation-stripped <em>annotation</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the stripped component of <code><em>annotation</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="syntax:s54" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(annotation-options <em>annotation</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the options enumeration set of <code><em>annotation</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="syntax:s55" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-source-object <em>sfd</em> <em>bfp</em> <em>efp</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-source-object <em>sfd</em> <em>bfp</em> <em>efp</em> <em>line</em> <em>column</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a source object</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>sfd</em></code> must be a source-file descriptor. <code><em>bfp</em></code> and <code><em>efp</em></code> must be exact nonnegative integers, and <code><em>bfp</em></code> should not be greater than <code><em>efp</em></code>. <code><em>line</em></code> and <code><em>column</em></code> must be exact positive integers.</p>
</div>
<div id="syntax:s56" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(source-object? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a source object, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="syntax:s57" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(source-object-sfd <em>source-object</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the sfd component of <code><em>source-object</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="syntax:s58" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(source-object-bfp <em>source-object</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the bfp component of <code><em>source-object</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="syntax:s59" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(source-object-efp <em>source-object</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the efp component of <code><em>source-object</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="syntax:s60" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(source-object-line <em>source-object</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the line component of <code><em>source-object</em></code> if present, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="syntax:s61" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(source-object-column <em>source-object</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the column component of <code><em>source-object</em></code> if present, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="syntax:s62" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>current-make-source-object</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>current-make-source-object</code> is used by the reader to construct a source object for an annotation. <code>current-make-source-object</code> is initially bound to <code>make-source-object</code>, and the reader always calls the function bound to the paramater with three arguments.</p>
</div>
<div class="paragraph">
<p>Adjust this parameter to, for example, eagerly convert a position integer to a file-position object, instead of delaying the conversion to <code>locate-source</code>.</p>
</div>
<div id="syntax:s63" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-source-file-descriptor <em>string</em> <em>binary-input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-source-file-descriptor <em>string</em> <em>binary-input-port</em> <em>reset?</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a source-file descriptor</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To compute the checksum encapsulated in the source-file descriptor, this procedure must read all of the data from <code><em>binary-input-port</em></code>. If <code><em>reset?</em></code> is present and <code>#t</code>, the port is reset to its original position, as if via <code>port-position</code>. Otherwise, it is left pointing at end-of-file.</p>
</div>
<div id="syntax:s64" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(source-file-descriptor? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a source-file descriptor, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="syntax:s65" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(source-file-descriptor-checksum <em>sfd</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the checksum component of <code><em>sfd</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="syntax:s66" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(source-file-descriptor-path <em>sfd</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the path component of <code><em>sfd</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>sfd</em></code> must be a source-file descriptor.</p>
</div>
<div id="syntax:s67" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(source-file-descriptor <em>path</em> <em>checksum</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new source-file-descriptor</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string, and <code><em>checksum</em></code> must be an exact nonnegative integer. This procedure can be used to construct custom source-file descriptors or to reconstitute source-file descriptors from the <code><em>path</em></code> and <code><em>checksum</em></code> components.</p>
</div>
<div id="syntax:s68" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(annotation-option-set <em>symbol</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>an annotation-options enumeration set</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Annotation-options enumeration sets may be passed to <code>make-annotation</code> to control whether the annotation is used for debugging, profiling, both, or neither. Accordingly, each <code><em>symbol</em></code> must be either <code><em>debug</em></code> or <code>profile</code>.</p>
</div>
<div id="syntax:s69" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(syntax-&gt;annotation <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>an annotation or <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code><em>obj</em></code> is an annotation or syntax-object encapsulating an annotation, the annotation is returned.</p>
</div>
<div id="syntax:s70" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(get-datum/annotations <em>textual-input-port</em> <em>sfd</em> <em>bfp</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>sfd</em></code> must be a source-file descriptor. <code><em>bfp</em></code> must be an exact nonnegative integer and should be the character position of the next character to be read from <code><em>textual-input-port</em></code>.</p>
</div>
<div class="paragraph">
<p>This procedure returns two values: an annotated object and an ending file position. In most cases, <code><em>bfp</em></code> should be 0 for the first call to <code>get-datum/annotation</code> at the start of a file, and it should be the second return value of the preceding call to <code>get-datum/annotation</code> for each subsequent call. This protocol is necessary to handle files containing multiple-byte characters, since file positions do not necessarily correspond to character positions.</p>
</div>
<div id="syntax:s71" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(open-source-file <em>sfd</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a port or <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>sfd</em></code> must be a source-file descriptor. This procedure attempts to locate and open the source file identified by <code><em>sfd</em></code>. It returns a textual input port, positioned at the beginning of the file, if successful, and <code>#f</code> otherwise. It can fail even if a file with the correct name exists in one of the source directories when the file&#8217;s checksum does not match the checksum recorded in <code><em>sfd</em></code>.</p>
</div>
<div id="syntax:s72" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(locate-source <em>sfd</em> <em>pos</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(locate-source <em>sfd</em> <em>pos</em> <em>use-cache?</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>sfd</em></code> must be a source-file descriptor, and <code><em>pos</em></code> must be an exact nonnegative integer.</p>
</div>
<div class="paragraph">
<p>This procedure either uses cached information from a previous request for <code><em>sfd</em></code> (only when <code><em>use-cache?</em></code> is provided as true) or attempts to locate and open the source file identified by <code><em>sfd</em></code>. If successful, it returns three values: a string <code><em>path</em></code>, an exact nonnegative integer <code><em>line</em></code>, and an exact nonnegative integer <code><em>char</em></code> representing the absolute pathname, line, and character position within the line represented by the specified source-file descriptor and file position. If unsuccessful, it returns zero values. It can fail even if a file with the correct name exists in one of the source directories when the file&#8217;s checksum does not match the checksum recorded in <code><em>sfd</em></code>.</p>
</div>
<div id="syntax:s73" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(locate-source-object-source <em>source-object</em> <em>get-start?</em> <em>use-cache?</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure is similar to <code>locate-source</code>, but instead of taking an sfd and a position, it takes a source object plus a request for either the start or end location.</p>
</div>
<div class="paragraph">
<p>If <code><em>get-start?</em></code> is true and <code><em>source-object</em></code> has a line and column, this procedure returns the path in <code><em>source-objects</em></code>'s sfd, <code><em>source-object</em></code>'s line, and <code><em>source-objects</em></code>'s column.</p>
</div>
<div class="paragraph">
<p>If <code><em>source-object</em></code> has no line and column, then this procedure calls <code>locate-source</code> on <code><em>source-object</em></code>'s sfd, either <code><em>source-object</em></code>'s bfp or efp depending on <code><em>get-start?</em></code>, and <code><em>use-cache?</em></code>.</p>
</div>
<div id="syntax:s74" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>current-locate-source-object-source</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>current-locate-source-object-source</code> determines the source-location lookup function that is used by the system to report errors based on source objects. This parameter is initially bound to <code>locate-source-object-object</code>.</p>
</div>
<div class="paragraph">
<p>Adjust this parameter to control the way that source locations are extracted from source objects, possibly using recorded information, caches, and the filesystem in a way different from <code>locate-source-object-object</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_11.12.">Section 11.12. Source Tables</h3>
<div class="paragraph">
<p>Source tables provide an efficient way to associate information with source objects both in memory and on disk, such as the coverage information saved to <code>.covin</code> files when <code>generate-covin-files</code> is set to <code>#t</code> and the profile counts associated with source objects by <code>with-profile-tracker</code> (<a href="#section_12.7.">Section 12.7</a>).</p>
</div>
<div class="paragraph">
<p>Source tables are manipulated via hashtable-like accessors and setters (<a href="#section_7.12.">Section 7.12</a>, <em>The Scheme Programming Language, 4th Edition</em> <a href="../../the-scheme-programming-language-4th/en/index.html#section_6.13.">Section 6.13</a>), e.g., <code>source-table-ref</code> and <code>source-table-set!</code>. They can be saved to files via <code>put-source-table</code> and restored via <code>get-source-table!</code>.</p>
</div>
<div id="syntax:s81" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-source-table)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a source table</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A source table contains associations between source objects and arbitrary values. For purposes of the source-table operations described below, two source objects are the same if they have the same source-file descriptor, equal beginning file positions and equal ending file positions. Two source-file descriptors are the same if they have the same path and checksum.</p>
</div>
<div id="syntax:s82" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(source-table? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a source-table; <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="syntax:s83" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(source-table-set! <em>source-table</em> <em>source-object</em> <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>source-table-set!</code> associates <code><em>source-object</em></code> with <code><em>obj</em></code> in <code><em>source-table</em></code>, replacing the existing association, if any.</p>
</div>
<div id="syntax:s84" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(source-table-ref <em>source-table</em> <em>source-object</em> <em>default</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>default</em></code> may be any Scheme value.</p>
</div>
<div class="paragraph">
<p><code>source-table-ref</code> returns the value associated with <code><em>source-object</em></code> in <code><em>source-table</em></code>. If no value is associated with <code><em>source-object</em></code> in <code><em>source-table</em></code>, <code>source-table-ref</code> returns <code><em>default</em></code>.</p>
</div>
<div id="syntax:s85" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(source-table-contains? <em>source-table</em> <em>source-object</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if an association for <code><em>source-object</em></code> exists in <code><em>source-table</em></code>, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="syntax:s86" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(source-table-cell <em>source-table</em> <em>source-object</em> <em>default</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a pair (see below)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>default</em></code> may be any Scheme value.</p>
</div>
<div class="paragraph">
<p>If no value is associated with <code><em>source-object</em></code> in <code><em>source-table</em></code>, <code>source-table-cell</code> modifies <code><em>source-table</em></code> to associate <code><em>source-object</em></code> with <code><em>default</em></code>. Regardless, it returns a pair whose car is <code><em>source-object</em></code> and whose cdr is the associated value. Changing the cdr of this pair effectively updates the table to associate <code><em>source-object</em></code> with a new value. The car field of the pair should not be modified.</p>
</div>
<div id="syntax:s87" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(source-table-delete! <em>source-table</em> <em>source-object</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>source-table-delete!</code> drops the association for <code><em>source-object</em></code> from <code><em>source-table</em></code>, if one exists.</p>
</div>
<div id="syntax:s88" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(source-table-size <em>source-table</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the number of entries in <code><em>source-table</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="syntax:s89" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(put-source-table <em>textual-output-port</em> <em>source-table</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure writes a representation of the information stored in <code><em>source-table</em></code> to the port.</p>
</div>
<div id="syntax:s90" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(get-source-table! <em>textual-input-port</em> <em>source-table</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(get-source-table! <em>textual-input-port</em> <em>source-table</em> <em>combine</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The port must be positioned at a representation of source-table information written by some previous call to <code>put-source-table</code>, which reads the information and merges it into <code>source-table</code>.</p>
</div>
<div class="paragraph">
<p>If present and non-false, <code><em>combine</em></code> must be a procedure and should accept two arguments. It is called whenever associations for the same source object are present both in <code><em>source-table</em></code> and in the information read from the port. In this case, <code><em>combine</em></code> is passed two arguments: the associated value from <code><em>source-table</em></code> and the associated value from the port (in that order) and must return one value, which is recorded as the new associated value for the source object in <code><em>source-table</em></code>.</p>
</div>
<div class="paragraph">
<p>If <code><em>combine</em></code> is not present, <code><em>combine</em></code> is <code>#f</code>, or no association for a source object read from the port already exists in <code><em>source-table</em></code>, the value read from the port is recorded as the associated value of the source object in <code><em>source-table</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define st (make-source-table))
(call-with-port (open-input-file "profile.out1")
  (lambda (ip) (get-source-table! ip st)))
(call-with-port (open-input-file "profile.out2")
  (lambda (ip) (get-source-table! ip st +)))</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chp_12">Chapter 12. System Operations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes operations for handling exceptions, interrupts, environments, compilation and evaluation, profiling, controlling the operation of the system, timing and statistics, defining and setting parameters, and querying the operating system environment.</p>
</div>
<div class="sect2">
<h3 id="section_12.1.">Section 12.1. Exceptions</h3>
<div id="system:s0" class="paragraph">
<p><em>Chez Scheme</em> provides some extensions to the Revised<sup>6</sup> Report exception-handling mechanism, including mechanisms for producing formatted error messages, displaying conditions, and redefining the base exception handler. These extensions are described in this section.</p>
</div>
<div id="system:s1" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(warning <em>who</em> <em>msg</em> <em>irritant</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>warning</code> raises a continuable exception with condition type <code>&amp;warning</code> and should be used to describe situations for which the <code>&amp;warning</code> condition type is appropriate, typically a situation that should not prevent the program from continuing but might result in a more serious problem at some later point.</p>
</div>
<div class="paragraph">
<p>The continuation object with which the exception is raised also includes a <code>&amp;who</code> condition whose who field is <code><em>who</em></code> if <code><em>who</em></code> is not <code>#f</code>, a <code>&amp;message</code> condition whose message field is <code><em>msg</em></code>, and an <code>&amp;irritants</code> condition whose irritants field is <code>(<em>irritant</em> ...)</code>.</p>
</div>
<div class="paragraph">
<p><code><em>who</em></code> must be a string, a symbol, or <code>#f</code> identifying the procedure or syntactic form reporting the warning upon whose behalf the warning is being reported. It is usually best to identify a procedure the programmer has called rather than some other procedure the programmer may not be aware is involved in carrying out the operation. <code><em>msg</em></code> must be a string and should describe the exceptional situation. The irritants may be any Scheme objects and should include values that may have caused or been materially involved in the exceptional situation.</p>
</div>
<div id="system:s2" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(assertion-violationf <em>who</em> <em>msg</em> <em>irritant</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>does not return</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(errorf <em>who</em> <em>msg</em> <em>irritant</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>does not return</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(warningf <em>who</em> <em>msg</em> <em>irritant</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="system:s3" class="paragraph">
<p>These procedures are like <code>assertion-violation</code>, <code>error</code>, and <code>warning</code> except that <code><em>msg</em></code> is assumed to be a format string, as if in a call to <code>format</code> (<a href="#section_9.13.">Section 9.13</a>), with <code><em>irritant</em> ...</code> treated as the additional arguments to <code>format</code>. This allows programs to control the appearance of the error message, at least when the default exception handler is in place.</p>
</div>
<div class="paragraph">
<p>For each of these procedures, the continuation object with which the exception is raised includes a <code>&amp;format</code> condition to signify that the string contained in the condition object&#8217;s <code>&amp;message</code> condition is a <code>format</code> string and the objects contained in the condition object&#8217;s <code>&amp;irritants</code> condition should be treated as the additional <code>format</code> arguments.</p>
</div>
<div id="system:s4" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>&amp;format</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-format-condition)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a condition of type <code>&amp;format</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(format-condition? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a condition of type <code>&amp;format</code>, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Presence of this condition type within a compound condition indicates that the string provided by the <code>&amp;message</code> condition, if present, is a <code>format</code> string and the list of objects provided by the <code>&amp;irritants</code> condition, if present, should be treated as additional <code>format</code> arguments. This condition type might be defined as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-condition-type &format &condition
  make-format-condition format-condition?)</code></pre>
</div>
</div>
<div id="system:s5" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>&amp;source</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-source-condition <em>form</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a condition of type <code>&amp;source</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(source-condition? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a condition of type <code>&amp;source</code>, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(source-condition-form <em>condition</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the contents of <code><em>condition</em></code>'s <code>form</code> field</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This condition type can be included within a compound condition when a source expression can be identified in situations in which a <code>&amp;syntax</code> condition would be inappropriate, such as when a run-time assertion violation is detected. The <code>form</code> argument should be an s-expression or syntax object representing the source expression. This condition type might be defined as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-condition-type &source &condition
  make-source-condition source-condition?
  (form source-condition-form))</code></pre>
</div>
</div>
<div id="system:s6" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>&amp;continuation</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-continuation-condition <em>continuation</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a condition of type <code>&amp;continuation</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(continuation-condition? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a condition of type <code>&amp;continuation</code>, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(condition-continuation <em>condition</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the contents of <code><em>condition</em></code>'s <code>continuation</code> field</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This condition type can be included within a compound condition to indicate the current continuation at the point where the exception described by the condition occurred. The continuation of a failed <code>assert</code> or a call to <code>assertion-violation</code>, <code>assertion-violationf</code>, <code>error</code>, <code>errorf</code>, or <code>syntax-error</code> is now included via this condition type in the conditions passed to <code>raise</code>. The <code>continuation</code> argument should be a continuation. This condition type might be defined as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-condition-type &continuation &condition
  make-continuation-condition continuation-condition?
  (continuation condition-continuation))</code></pre>
</div>
</div>
<div id="system:s7" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(display-condition <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(display-condition <em>obj</em> <em>textual-output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code><em>textual-output-port</em></code> is not supplied, it defaults to the current output port. This procedure displays a message to the effect that an exception has occurred with value <code><em>obj</em></code>. If <code><em>obj</em></code> is a condition (<a href="../../the-scheme-programming-language-4th/en/index.html#chp_11">Chapter 11</a> of <em>The Scheme Programming Language, 4th Edition</em>), it displays information encapsulated within the condition, handling messages, <code><em>who</em></code> conditions, irritants, source information, etc., as appropriate.</p>
</div>
<div id="system:s8" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(default-exception-handler <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure is the default value of the <code>base-exception-handler</code> parameter called on a condition when no other exception handler has been defined or when all dynamically established exception handlers have chosen not to handle the condition. It first displays <code><em>obj</em></code>, as if with <code>display-condition</code>, to the console error port. For non-serious warning conditions, it returns immediately after displaying the condition.</p>
</div>
<div class="paragraph">
<p>For serious or other non-warning conditions, it saves the condition in the parameter <code>debug-condition</code>, where <code>debug</code> (<a href="#section_3.2.">Section 3.2</a>) can retrieve it and allow it to be inspected. If the <code>debug-on-exception</code> parameter is set to <code>#f</code> (the default unless the <code>--debug-on-exception</code> command-line option is provided), the handler prints a message instructing the user to type <code>(debug)</code> to enter the debugger, then resets to the current café. Otherwise, the handler invokes <code>debug</code> directly and resets if <code>debug</code> returns.</p>
</div>
<div class="paragraph">
<p>If an I/O exception occurs while attempting to display the condition, the default exception handler resets (as if by calling <code>reset</code>). The intent is to avoid an infinite regression (ultimately ending in exhaustion of memory) in which the process repeatedly recurs back to the default exception handler trying to write to a console-error port (typically stderr) that is no longer writable, e.g., due to the other end of a pipe or socket having been closed.</p>
</div>
<div id="system:s10" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>debug-on-exception</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of this parameter determines whether the default exception handler immediately enters the debugger immediately when it receives a serious or non-warning condition. If the <code>--debug-on-exception</code> command-line option (<a href="#section_2.1.">Section 2.1</a>) has been provided, the initial value of this parameter is <code>#t</code>. Otherwise, the initial value is <code>#f</code>.</p>
</div>
<div id="system:s12" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>base-exception-handler</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of this parameter must be a procedure, and the procedure should accept one argument. The default value of <code>base-exception-handler</code> is the procedure <code>default-exception-handler</code>.</p>
</div>
<div class="paragraph">
<p>The value of this parameter is invoked whenever no exception handler established by a program has chosen to handle an exception.</p>
</div>
<div id="system:s13" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>debug-condition</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This parameter is used by the default exception handler to hold the last serious or non-warning condition received by the handler, where it can be inspected via the <code>debug</code> procedure (<a href="#section_3.2.">Section 3.2</a>). It can also be invoked by user code to store or retrieve a condition.</p>
</div>
<div id="system:s14" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>current-exception-state</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>current-exception-state</code> may be used to get or set the current exception state. When called without arguments, <code>current-exception-state</code> returns an <em>exception state</em> comprising the current stack of handlers established by <code>with-exception-handler</code> and <code>guard</code>. When called with a single argument, which must be an exception state, <code>current-exception-state</code> sets the exception state.</p>
</div>
<div id="system:s15" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(create-exception-state)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(create-exception-state <em>procedure</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>create-exception-state</code> creates an exception state whose stack of exception handlers is empty except for, in effect, an infinite number of occurrences of <em>handler</em> at its base. <code><em>handler</em></code> must be a procedure, and should accept one argument. If not provided, <code><em>handler</em></code> defaults to a procedure equivalent to the value of the following expression.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(lambda (x) ((base-exception-handler) x))</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_12.2.">Section 12.2. Interrupts</h3>
<div id="system:s16" class="paragraph">
<p><em>Chez Scheme</em> allows programs to control the action of the Scheme system when various events occur, including an interrupt from the keyboard, the expiration of an internal timer set by <code>set-timer</code>, a breakpoint caused by a call to <code>break</code>, or a request from the storage manager to initiate a garbage collection. These mechanisms are described in this section, except for the collect request mechanism, which is described in <a href="#section_13.1.">Section 13.1</a>.</p>
</div>
<div class="paragraph">
<p>Timer, keyboard, and collect-request interrupts are supported via a counter that is decremented approximately once for each call to a nonleaf procedure. (A leaf procedure is one that does not itself make any calls.) When no timer is running, this counter is set to a default value (1000 in Version 9) when a program starts or after an interrupt occurs. If a timer is set (via <code>set-timer</code>), the counter is set to the minimum of the default value and the number of ticks to which the timer is set. When the counter reaches zero, the system looks to see if the timer is set and has expired or if a keyboard or collect request interrupt has occurred. If so, the current procedure call is pended ("put on hold") while the appropriate interrupt handler is invoked to handle the interrupt. When (if) the interrupt handler returns, the pended call takes place. Thus, timer, keyboard, and collect-request interrupts effectively occur synchronously with respect to the procedure call mechanism, and keyboard and collect request interrupts may be delayed by a number of calls equal to the default timer value.</p>
</div>
<div class="paragraph">
<p>Calls to the break handler occur immediately whenever <code>break</code> is called.</p>
</div>
<div id="system:s17" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(break <em>who</em> <em>msg</em> <em>irritant</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(break <em>who</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(break)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The arguments to <code>break</code> follow the protocol described above for <code>errorf</code>. The default break handler (see <code>break-handler</code>) displays a message and invokes the debugger. The format string and objects may be omitted, in which case the message issued by the default break handler identifies the break using the <code><em>who</em></code> argument but provides no more information about the break. If the <code><em>who</em></code> argument is omitted as well, no message is generated. The default break handler returns normally if the debugger exits normally.</p>
</div>
<div id="system:s19" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>break-handler</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of this parameter must be a procedure. The current break handler is called by <code>break</code>, which passes along its arguments. See <code>break</code> for a description of the default break handler. The example below shows how to disable breaks.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(break-handler (lambda args (void)))</code></pre>
</div>
</div>
<div id="system:s20" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>keyboard-interrupt-handler</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of this parameter must be a procedure. The keyboard-interrupt handler is called (with no arguments) when a keyboard interrupt occurs. The default keyboard-interrupt handler invokes the interactive debugger. If the debugger exits normally the interrupted computation is resumed. The example below shows how to install a keyboard-interrupt handler that resets without invoking the debugger.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(keyboard-interrupt-handler
  (lambda ()
    (newline (console-output-port))
    (reset)))</code></pre>
</div>
</div>
<div id="desc:set-timer" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-timer <em>n</em>)</code> <a id="system:s22"></a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>previous current timer value</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="system:s23" class="paragraph">
<p><code><em>n</em></code> must be a nonnegative integer. When <code><em>n</em></code> is nonzero, <code>set-timer</code> starts an internal timer with an initial value of <code><em>n</em></code>. When <code><em>n</em></code> ticks elapse, a timer interrupt occurs, resulting in invocation of the timer interrupt handler. Each tick corresponds roughly to one nonleaf procedure call (see the introduction to this section); thus, ticks are not uniform time units but instead depend heavily on how much work is done by each procedure call.</p>
</div>
<div class="paragraph">
<p>When <code><em>n</em></code> is zero, <code>set-timer</code> turns the timer off.</p>
</div>
<div class="paragraph">
<p>The value returned in either case is the value of the timer before the call to <code>set-timer</code>. A return value of 0 should not be taken to imply that the timer was not on; the return value may also be 0 if the timer was just about to fire when the call to <code>set-timer</code> occurred.</p>
</div>
<div class="paragraph">
<p>The engine mechanism (<a href="#section_6.4.">Section 6.4</a>) is built on top of the timer interrupt so timer interrupts should not be used with engines.</p>
</div>
<div id="system:s24" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>timer-interrupt-handler</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="system:s25" class="paragraph">
<p>The value of this parameter must be a procedure. The timer interrupt handler is called by the system when the internal timer (set by <code>set-timer</code>) expires. The default handler raises an exception with condition type <code>&amp;assertion</code> to say that the handler has not been defined; any program that uses the timer should redefine the handler before setting the timer.</p>
</div>
<div id="system:s26" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(disable-interrupts)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(enable-interrupts)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>disable count</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>disable-interrupts</code> disables the handling of interrupts, including timer, keyboard, and collect request interrupts. <code>enable-interrupts</code> re-enables these interrupts. The system maintains a disable count that starts at zero; when zero, interrupts are enabled. Each call to <code>disable-interrupts</code> increments the count, effectively disabling interrupts. Each call to <code>enable-interrupts</code> decrements the count, if not already zero, effectively enabling interrupts. For example, two calls to <code>disable-interrupts</code> followed by one call to <code>enable-interrupts</code> leaves interrupts disabled. Calls to <code>enable-interrupts</code> when the count is already zero (and interrupts are enabled) have no effect. The value returned by either procedure is the number of calls to <code>enable-interrupts</code> required to enable interrupts.</p>
</div>
<div class="paragraph">
<p>Great care should be exercised when using these procedures, since disabling interrupts inhibits the normal processing of keyboard interrupts, timer interrupts, and, perhaps most importantly, collect request interrupts. Since garbage collection does not happen automatically when interrupts are disabled, it is possible for the storage allocator to run out of space unnecessarily should interrupts be disabled for a long period of time.</p>
</div>
<div class="paragraph">
<p>The <code>with-interrupts-disabled</code> syntactic form should be used instead of these more primitive procedures whenever possible, since <code>with-interrupts-disabled</code> ensures that interrupts are re-enabled whenever a nonlocal exit occurs, such as when an exception is handled by the default exception handler.</p>
</div>
<div id="system:s27" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(with-interrupts-disabled <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(critical-section <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the values of the body <code><em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>with-interrupts-disabled</code> evaluates the body <code><em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...</code> with interrupts disabled. That is, upon entry, interrupts are disabled, and upon exit, interrupts are re-enabled. Thus, <code>with-interrupts-disabled</code> allows the implementation of indivisible operations in nonthreaded versions of <em>Chez Scheme</em> or within a single thread in threaded versions of <em>Chez Scheme</em>. <code>critical-section</code> is the same as <code>with-interrupts-disabled</code> and is provided for backward compatibility.</p>
</div>
<div class="paragraph">
<p><code>with-interrupts-disabled</code> can be defined as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax with-interrupts-disabled
  (syntax-rules ()
    [(_ b1 b2 ...)
     (dynamic-wind
       disable-interrupts
       (lambda () b1 b2 ...)
       enable-interrupts)]))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The use of <code>dynamic-wind</code> ensures that interrupts are disabled whenever the body of the <code>with-interrupts-disabled</code> expression is active and re-enabled whenever it is not. Since calls to <code>disable-interrupts</code> are counted (see the discussion under <code>disable-interrupts</code> and <code>enable-interrupts</code> above), <code>with-interrupts-disabled</code> expressions may be nested with the desired effect.</p>
</div>
<div id="system:s28" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(register-signal-handler <em>sig</em> <em>procedure</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>register-signal-handler</code> is used to establish a signal handler for a given low-level signal. <code><em>sig</em></code> must be an exact integer identifying a valid signal, and <code><em>procedure</em></code> should accept one argument. See your host system&#8217;s <code>&lt;signal.h&gt;</code> or documentation for a list of valid signals and their numbers. After a signal handler for a given signal has been registered, receipt of the specified signal results in a call to the handler. The handler is passed the signal number, allowing the same handler to be used for different signals while differentiating among them.</p>
</div>
<div class="paragraph">
<p>Signals handled in this fashion are treated like keyboard interrupts in that the handler is not called immediately when the signal is delivered to the process, but rather at some procedure call boundary after the signal is delivered. It is generally not a good idea, therefore, to establish handlers for memory faults, illegal instructions, and the like, since the code that causes the fault or illegal instruction will continue to execute (presumably erroneously) for some time before the handler is invoked. A finite amount of storage is used to buffer as-yet unhandled signals, after which additional signals are dropped.</p>
</div>
<div class="paragraph">
<p><code>register-signal-handler</code> is supported only on Unix-based systems.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_12.3.">Section 12.3. Environments</h3>
<div class="paragraph">
<p>Environments are first-class objects containing identifier bindings. They are similar to modules but, unlike modules, may be manipulated at run time. Environments may be provided as optional arguments to <code>eval</code>, <code>expand</code>, and the procedures that define, assign, or reference top-level values.</p>
</div>
<div class="paragraph">
<p>There are several built-in environments, and new environments can be created by copying existing environments or selected bindings from existing environments.</p>
</div>
<div class="paragraph">
<p>Environments can be mutable or immutable. A mutable environment can be extended with new bindings, its existing bindings can be modified, and its variables can be assigned. An immutable environment cannot be modified in any of these ways.</p>
</div>
<div id="system:s29" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(environment? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is an environment, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(environment? (interaction-environment)) ⇒ #t
(environment? 'interaction-environment) ⇒ #f
(environment? (copy-environment (scheme-environment))) ⇒ #t
(environment? (environment '(prefix (rnrs) $rnrs-))) ⇒ #t</code></pre>
</div>
</div>
<div id="system:s30" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(environment-mutable? <em>env</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>env</em></code> is mutable, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(environment-mutable? (interaction-environment)) ⇒ #t
(environment-mutable? (scheme-environment)) ⇒ #f
(environment-mutable? (copy-environment (scheme-environment))) ⇒ #t
(environment-mutable? (environment '(prefix (rnrs) $rnrs-))) ⇒ #f</code></pre>
</div>
</div>
<div id="system:s31" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(scheme-environment)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>an environment</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>scheme-environment</code> returns an environment containing the initial top-level bindings. This environment corresponds to the <code>scheme</code> module.</p>
</div>
<div class="paragraph">
<p>The environment returned by this procedure is immutable.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define cons 3)
(top-level-value 'cons (scheme-environment)) ⇒ #&lt;procedure cons&gt;
(set-top-level-value! 'cons 3 (scheme-environment)) ⇒ <em>exception</em></code></pre>
</div>
</div>
<div id="system:s32" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(ieee-environment)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>an IEEE/ANSI standard compatibility environment</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>ieee-environment</code> returns an environment containing bindings for the keywords and variables whose meanings are defined by the IEEE/ANSI Standard for Scheme <a href="#ref26">[26]</a>.</p>
</div>
<div class="paragraph">
<p>The bindings for each of the identifiers in the IEEE environment are those of the corresponding Revised<sup>6</sup> Report library, so this does not provide full backward compatibility.</p>
</div>
<div class="paragraph">
<p>The environment returned by this procedure is immutable.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define cons 3)
(top-level-value 'cons (ieee-environment)) ⇒ #&lt;procedure cons&gt;
(set-top-level-value! 'cons 3 (ieee-environment)) ⇒ <em>exception</em></code></pre>
</div>
</div>
<div id="system:s33" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>interaction-environment</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The original value of <code>interaction-environment</code> is the default top-level environment. It is initially set to a mutable copy of <code>(scheme-environment)</code> and which may be extended or otherwise altered by top-level definitions and assignments. It may be set to any environment, mutable or not, to change the default top-level evaluation environment.</p>
</div>
<div class="paragraph">
<p>An expression&#8217;s top-level bindings resolve to the environment that is in effect when the expression is expanded, and changing the value of this parameter has no effect on running code. Changes affect only code that is subsequently expanded, e.g., as the result of a call to <code>eval</code>, <code>load</code>, or <code>compile-file</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define cons 3)
cons ⇒ 3
(top-level-value 'cons (interaction-environment)) ⇒ 3

(interaction-environment (scheme-environment))
cons ⇒ #&lt;procedure cons&gt;
(set! cons 3) ⇒ <em>exception: attempt to assign immutable variable</em>
(define cons 3) ⇒ <em>exception: invalid definition in immutable environment</em></code></pre>
</div>
</div>
<div id="system:s34" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(copy-environment <em>env</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(copy-environment <em>env</em> <em>mutable?</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(copy-environment <em>env</em> <em>mutable?</em> <em>syms</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new environment</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>copy-environment</code> returns a copy of <code><em>env</em></code>, i.e., a new environment that contains the same bindings as <code><em>env</em></code>.</p>
</div>
<div class="paragraph">
<p>The environment is mutable if <code><em>mutable?</em></code> is omitted or true; if <code><em>mutable?</em></code> is false, the environment is immutable.</p>
</div>
<div class="paragraph">
<p>The set of bindings copied from <code><em>env</em></code> to the new environment is determined by <code><em>syms</em></code>, which defaults to the value of <code>(environment-symbols <em>env</em>)</code>. The binding, if any, for each element of <code><em>syms</em></code> is copied to the new environment, and no other bindings are present in the new environment.</p>
</div>
<div class="paragraph">
<p>In the current implementation, the storage space used by an environment is never collected, so repeated use of <code>copy-environment</code> will eventually cause the system to run out of memory.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define e (copy-environment (scheme-environment)))
(eval '(define cons +) e)
(eval '(cons 3 4) e)                    ⇒ 7
(eval '(cons 3 4) (scheme-environment)) ⇒ (3 . 4)</code></pre>
</div>
</div>
<div id="system:s35" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(environment-symbols <em>env</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of symbols</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure returns a list of symbols representing the identifiers bound in environment <code><em>env</em></code>. It is primarily useful in building the list of symbols to be copied from one environment to another.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define listless-environment
  (copy-environment
    (scheme-environment)
    #t
    (remq 'list (environment-symbols (scheme-environment)))))
(eval '(let ([x (cons 3 4)]) x) listless-environment) ⇒ (3 . 4)
(eval '(list 3 4) listless-environment) ⇒ <em>exception</em></code></pre>
</div>
</div>
<div id="system:s36" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(apropos-list <em>s</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(apropos-list <em>s</em> <em>env</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure returns a selected list of symbols and pairs. Each symbol in the list represents an identifier bound in <code><em>env</em></code>. Each pair represents a set of identifiers exported by a predefined library or a library previously defined or loaded into the system. The car of the pair is the library name, and the cdr is a list of symbols. If <code><em>s</em></code> is a string, only entries whose names have <code><em>s</em></code> as a substring are included, and if <code><em>s</em></code> is a symbol, only those whose names have the name of <code><em>s</em></code> as a substring are selected. If no environment is provided, it defaults to the value of <code>interaction-environment</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(library (a) (export a-vector-sortof) (import (rnrs))
  (define a-vector-sortof '(vector 1 2 3)))
(apropos-list 'vector-sort) ⇒
  (vector-sort vector-sort!
   ((a) a-vector-sortof)
   ((chezscheme) vector-sort vector-sort!)
   ((rnrs) vector-sort vector-sort!)
   ((rnrs sorting) vector-sort vector-sort!)
   ((scheme) vector-sort vector-sort!))</code></pre>
</div>
</div>
<div id="system:s37" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(apropos <em>s</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(apropos <em>s</em> <em>env</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>apropos</code> is like <code>apropos-list</code> except the information is displayed to the current output port, as shown in the following transcript.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (library (a) (export a-vector-sortof) (import (rnrs))
    (define a-vector-sortof '(vector 1 2 3)))
> (apropos 'vector-sort)
interaction environment:
  vector-sort, vector-sort!
(a):
  a-vector-sortof
(chezscheme):
  vector-sort, vector-sort!
(rnrs):
  vector-sort, vector-sort!
(rnrs sorting):
  vector-sort, vector-sort!
(scheme):
  vector-sort, vector-sort!</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_12.4.">Section 12.4. Compilation, Evaluation, and Loading</h3>
<div id="system:s38" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(eval <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(eval <em>obj</em> <em>env</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>value of the Scheme form represented by <code><em>obj</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>eval</code> treats <code><em>obj</em></code> as the representation of an expression. It evaluates the expression in environment <code><em>env</em></code> and returns its value. If no environment is provided, it defaults to the environment returned by <code>interaction-environment</code>.</p>
</div>
<div class="paragraph">
<p>Single-argument <code>eval</code> is a <em>Chez Scheme</em> extension. <em>Chez Scheme</em> also permits <code><em>obj</em></code> to be the representation of a nonexpression form, i.e., a definition, whenever the environment is mutable. <em>Chez Scheme</em> further allows <code><em>obj</em></code> to be an annotation (<a href="#section_11.11.">Section 11.11</a>), and the default evaluators make use of annotations to incorporate source-file information in error messages and associate source-file information with compiled code.</p>
</div>
<div class="paragraph">
<p>In <em>Chez Scheme</em>, <code>eval</code> is actually a wrapper that simply passes its arguments to the current evaluator. (See <code>current-eval</code>.) The default evaluator is <code>compile</code>, which expands the expression via the current expander (see <code>current-expand</code>), compiles it, executes the resulting code, and returns its value. If the environment argument, <code><em>env</em></code>, is present, <code>compile</code> passes it along to the current expander, which is <code>sc-expand</code> by default.</p>
</div>
<div id="system:s39" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>current-eval</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>current-eval</code> determines the evaluation procedure used by the procedures <code>eval</code>, <code>load</code>, and <code>new-cafe</code>. <code>current-eval</code> is initially bound to the value of <code>compile</code>. (In <em>Petite Chez Scheme</em>, it is initially bound to the value of <code>interpret</code>.) The evaluation procedureshould expect one or two arguments: an object to evaluate and an optional environment. The second argument might be an annotation (<a href="#section_11.11.">Section 11.11</a>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(current-eval interpret)
(+ 1 1) ⇒ 2

(current-eval (lambda (x . ignore) x))
(+ 1 1) ⇒ (+ 1 1)</code></pre>
</div>
</div>
<div id="system:s43" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile <em>obj</em> <em>env</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>value of the Scheme form represented by <code><em>obj</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>obj</em></code>, which can be an annotation (<a href="#section_11.11.">Section 11.11</a>) or unannotated value, is treated as a Scheme expression, expanded with the current expander (the value of <code>current-expand</code>) in the specified environment (or the interaction environment, if no environment is provided), compiled to machine code, and executed. <code>compile</code> is the default value of the <code>current-eval</code> parameter.</p>
</div>
<div id="system:s44" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(interpret <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(interpret <em>obj</em> <em>env</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>value of the Scheme form represented by <code><em>obj</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>interpret</code> is like <code>compile</code>, except that the expression is interpreted rather than compiled. <code>interpret</code> may be used as a replacement for <code>compile</code>, with the following caveats:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Interpreted code runs significantly slower.</p>
</li>
<li>
<p>Inspector information is not generated for interpreted code, so the inspector is not as useful for interpreted code as it is for compiled code.</p>
</li>
<li>
<p>Foreign procedure expressions cannot be interpreted, so the interpreter invokes the compiler for all foreign procedure expressions (this is done transparently).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>interpret</code> is sometimes faster than <code>compile</code> when the form to be evaluated is short running, since it avoids some of the work done by <code>compile</code> prior to evaluation.</p>
</div>
<div id="system:s45" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(load <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(load <em>path</em> <em>eval-proc</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. <code>load</code> reads and evaluates the contents of the file specified by <code><em>path</em></code>. The file may contain source or object code. By default, <code>load</code> employs <code>eval</code> to evaluate each source expression found in a source file. If <code><em>eval-proc</em></code> is specified, <code>load</code> uses this procedure instead. <code><em>eval-proc</em></code> must accept one argument, the expression to evaluate. The expression passed to <code><em>eval-proc</em></code> might be an annotation (<a href="#section_11.11.">Section 11.11</a>) or an unannotated value.</p>
</div>
<div class="paragraph">
<p>The <code><em>eval-proc</em></code> argument facilitates the implementation of embedded Scheme-like languages and the use of alternate evaluation mechanisms to be used for Scheme programs. <code><em>eval-proc</em></code> can be put to other uses as well. For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(load "myfile.ss"
  (lambda (x)
    (pretty-print
      (if (annotation? x)
          (annotation-stripped x)
          x))
    (newline)
    (eval x)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>pretty-prints each expression before evaluating it.</p>
</div>
<div class="paragraph">
<p>The parameter <code>source-directories</code> (<a href="#section_12.5.">Section 12.5</a>) determines the set of directories searched for source files not identified by absolute path names.</p>
</div>
<div id="system:s47" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(load-library <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(load-library <em>path</em> <em>eval-proc</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>load-library</code> is identical to <code>load</code> except that it treats the input file as if it were prefixed by an implicit <code>#!r6rs</code>. This effectively disables any non-R6RS lexical syntax except where subsequently overridden by <code>#!chezscheme</code>.</p>
</div>
<div id="system:s48" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(load-program <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(load-program <em>path</em> <em>eval-proc</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. <code>load-program</code> reads and evaluates the contents of the file specified by <code><em>path</em></code>. The file may contain source or object code. If it contains source code, <code>load-program</code> wraps the code in a <code>top-level-program</code> form so that the file&#8217;s content is treated as an RNRS top-level program (<a href="../../the-scheme-programming-language-4th/en/index.html#section_10.3.">Section 10.3</a> of <em>The Scheme Programming Language, 4th Edition</em>). By default, <code>load-program</code> employs <code>eval</code> to evaluate each source expression found in the file. If <code><em>eval-proc</em></code> is specified, <code>load-program</code> uses this procedure instead. <code><em>eval-proc</em></code> must accept one argument, the expression to evaluate. The expression passed to <code><em>eval-proc</em></code> might be an annotation (<a href="#section_11.11.">Section 11.11</a>) or an unannotated value.</p>
</div>
<div class="paragraph">
<p>The parameter <code>source-directories</code> (<a href="#section_12.5.">Section 12.5</a>) determines the set of directories searched for source files not identified by absolute path names.</p>
</div>
<div id="system:s50" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(verify-loadability <em>situation</em> <em>input</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>situation</em></code> must be one of the symbols <code>visit</code>, <code>revisit</code>, or <code>load</code>. Each <code><em>input</em></code> must be a string pathname or a pair of a string pathname and a library search path. Each of the pathnames should name a file containing object code for a set of libraries and top-level programs, such as would be produced by <code>compile-program</code>, <code>compile-library</code>, <code>compile-whole-program</code>, or <code>compile-whole-library</code>. A library search path must be a suitable argument for <code>library-directories</code>.</p>
</div>
<div class="paragraph">
<p><code>verify-loadability</code> verifies, without actually loading any code or definining any libraries, whether the object files named by the specified pathnames and their library dependencies, direct or indirect, are present, readable, and mutually compatible. The type of dependencies for each named object file is determined by the <code><em>situation</em></code> argument: compile-time dependencies for <code><em>visit</em></code>, run-time dependencies for <code><em>revisit</em></code> and both for <code><em>load</em></code>.</p>
</div>
<div class="paragraph">
<p>For each input pathname that is paired with a search path, the <code>library-directories</code> parameter is parameterized to the library search path during the recursive search for dependencies of the programs and libraries found in the object file named by the pathname.</p>
</div>
<div class="paragraph">
<p>If <code>verify-loadabilty</code> finds a problem, such as a missing library dependency or compilation-instance mismatch, it raises an exception with an appropriate condition. Otherwise, it returns an unspecified value.</p>
</div>
<div class="paragraph">
<p>Since <code>verify-loadability</code> does not load or run any code from the files it processes, it cannot determine whether errors unrelated to missing or unreadable files or mutual compatibility will occur when the files are actually loaded.</p>
</div>
<div id="system:s56" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(load-compiled-from-port <em>input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>result of the last compiled expression</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>load-compiled-from-port</code> reads and evaluates the object-code contents of <code><em>input-port</em></code> as previously created by functions like <code>compile-file</code>, <code>compile-script</code>, <code>compile-library</code>, and <code>compile-to-port</code>.</p>
</div>
<div class="paragraph">
<p>The return value is the value of the last expression whose compiled form is in <code><em>input-port</em></code>. If <code><em>input-port</em></code> is empty, then the result value is unspecified. The port is left at end-of-file but is not closed.</p>
</div>
<div id="system:s57" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(visit-compiled-from-port <em>input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>result of the last compiled expression processed</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>visit-compiled-from-port</code> reads and evaluates the object-code contents of <code><em>input-port</em></code> as previously created by functions like <code>compile-file</code>, <code>compile-script</code>, <code>compile-library</code>, and <code>compile-to-port</code>. In the process, it skips any revisit (run-time-only) code.</p>
</div>
<div class="paragraph">
<p>The return value is the value of the last expression whose last non-revisit compiled form is in <code><em>input-port</em></code>. If there are no such forms, then the result value is unspecified. The port is left at end-of-file but is not closed.</p>
</div>
<div id="system:s58" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(revisit-compiled-from-port <em>input-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>result of the last compiled expression processed</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>revisit-compiled-from-port</code> reads and evaluates the object-code contents of <code><em>input-port</em></code> as previously created by functions like <code>compile-file</code>, <code>compile-script</code>, <code>compile-library</code>, and <code>compile-to-port</code>. In the process, it skips any visit (compile-time-only) code.</p>
</div>
<div class="paragraph">
<p>The return value is the value of the last expression whose last non-visit compiled form is in <code><em>input-port</em></code>. If there are no such forms, then the result value is unspecified. The port is left at end-of-file but is not closed.</p>
</div>
<div id="system:s59" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(visit <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. <code>visit</code> reads the named file, which must contain compiled object code compatible with the current machine type and version, and it runs those portions of the compiled object code that establish compile-time information or correspond to expressions identified as "visit" time by <code>eval-when</code> forms contained in the original source file.</p>
</div>
<div class="paragraph">
<p>For example, assume the file <code>t1.ss</code> contains the following forms:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax a (identifier-syntax 3))
(module m (x) (define x 4))
(define y 5)</code></pre>
</div>
</div>
<div class="paragraph">
<p>If <code>t1.ss</code> is compiled to <code>t1.so</code>, applying <code>load</code> to <code>t1.so</code> has the effect of defining all three identifiers. Applying <code>visit</code> to <code>t1.so</code>, however, has the effect of installing the transformer for <code>a</code>, installing the interface for <code>m</code> (for use by <code>import</code>), and recording <code>y</code> as a variable. <code>visit</code> is useful when separately compiling one file that depends on bindings defined in another without actually loading and evaluating the code in the supporting file.</p>
</div>
<div class="paragraph">
<p>The parameter <code>source-directories</code> (<a href="#section_12.5.">Section 12.5</a>) determines the set of directories searched for source files not identified by absolute path names.</p>
</div>
<div id="system:s61" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(revisit <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. <code>revisit</code> reads the named file, which must contain compiled object code compatible with the current machine type and version, and it runs those portions of the compiled object code that compute run-time values or correspond to expressions identified as "revisit" time by <code>eval-when</code> forms contained in the original source file.</p>
</div>
<div class="paragraph">
<p>Continuing the example given for <code>visit</code> above, applying <code>revisit</code> to the object file, <code>t1.so</code>, has the effect of establishing the values of the variable <code>x</code> exported from <code>m</code> and the top-level variable <code>y</code>, without installing either the interface for <code>m</code> or the transformer for <code>a</code>.</p>
</div>
<div class="paragraph">
<p><code>revisit</code> is useful for loading compiled application code without loading unnecessary compile-time information. Care must be taken when using this feature if the application calls <code>eval</code> or uses <code>top-level-value</code>, <code>set-top-level-value!</code>, or <code>top-level-syntax</code> to access top-level bindings at run-time, since these procedures use compile-time information to resolve top-level bindings.</p>
</div>
<div class="paragraph">
<p>The parameter <code>source-directories</code> (<a href="#section_12.5.">Section 12.5</a>) determines the set of directories searched for source files not identified by absolute path names.</p>
</div>
<div id="system:s63" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile-file <em>input-filename</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile-file <em>input-filename</em> <em>output-filename</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>input-filename</em></code> and <code><em>output-filename</em></code> must be strings. <code><em>input-filename</em></code> must name an existing, readable file. It must contain a sequence of zero or more source expressions; if this is not the case, <code>compile-file</code> raises an exception with condition type <code>&amp;syntax</code>.</p>
</div>
<div class="paragraph">
<p>The normal evaluation process proceeds in two steps: compilation and execution. <code>compile-file</code> performs the compilation process for an entire source file, producing an object file. When the object file is subsequently loaded (see <code>load</code>), the compilation process is not necessary, and the file typically loads several times faster.</p>
</div>
<div class="paragraph">
<p>If the optional <code><em>output-filename</em></code> argument is omitted, the actual input and output filenames are determined as follows. If <code><em>input-filename</em></code> has no extension, the input filename is <code><em>input-filename</em></code> followed by <code>.ss</code> and the output filename is <code><em>input-filename</em></code> followed by <code>.so</code>. If <code><em>input-filename</em></code> has the extension <code>.so</code>, the input filename is <code><em>input-filename</em></code> and the output filename is <code><em>input-filename</em></code> followed by <code>.so</code>. Otherwise, the input filename is <code><em>input-filename</em></code> and the output filename is <code><em>input-filename</em></code> without its extension, followed by <code>.so</code>. For example, <code>(compile-file "myfile")</code> produces an object file with the name <code>"myfile.so"</code> from the source file named <code>"myfile.ss"</code>, <code>(compile-file "myfile.sls")</code> produces an object file with the name <code>"myfile.so"</code> from the source file named <code>"myfile.sls"</code>, and <code>(compile-file "myfile1" "myfile2")</code> produces an object file with the name <code>"myfile2"</code> from the source file name <code>"myfile1"</code>.</p>
</div>
<div class="paragraph">
<p>Before compiling a file, <code>compile-file</code> saves the values of the following parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">optimize-level
debug-level
run-cp0
cp0-effort-limit
cp0-score-limit
cp0-outer-unroll-limit
generate-inspector-information
generate-procedure-source-information
compile-profile
generate-covin-files
generate-interrupt-trap
enable-cross-library-optimization</code></pre>
</div>
</div>
<div class="paragraph">
<p>It restores the values after the file has been compiled. This allows the programmer to control the values of these parameters on a per-file basis, e.g., via an <code>eval-when</code> with situation <code>compile</code> embedded in the source file. For example, if</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(eval-when (compile) (optimize-level 3))</code></pre>
</div>
</div>
<div class="paragraph">
<p>appears at the top of a source file, the optimization level is set to 3 just while the remainder of file is compiled.</p>
</div>
<div id="system:s66" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile-script <em>input-filename</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile-script <em>input-filename</em> <em>output-filename</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>input-filename</em></code> and <code><em>output-filename</em></code> must be strings.</p>
</div>
<div class="paragraph">
<p><code>compile-script</code> is like <code>compile-file</code> but differs in that it copies the leading <code>#!</code> line from the source-file script into the object file.</p>
</div>
<div class="paragraph">
<p><code>compile-script</code> permits compiled script files to be created from source script to reduce script load time. As with source-code scripts, compiled scripts may be run with the <code>--script</code> command-line option.</p>
</div>
<div id="system:s68" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile-library <em>input-filename</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile-library <em>input-filename</em> <em>output-filename</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>input-filename</em></code> and <code><em>output-filename</em></code> must be strings.</p>
</div>
<div class="paragraph">
<p><code>compile-library</code> is identical to <code>compile-file</code> except that it treats the input file as if it were prefixed by an implicit <code>#!r6rs</code>. This effectively disables any non-R6RS lexical syntax except where subsequently overridden by <code>#!chezscheme</code>.</p>
</div>
<div id="system:s69" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile-program <em>input-filename</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile-program <em>input-filename</em> <em>output-filename</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of libraries invoked by the program</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>input-filename</em></code> and <code><em>output-filename</em></code> must be strings.</p>
</div>
<div class="paragraph">
<p><code>compile-program</code> is like <code>compile-script</code> but differs in that it implements the semantics of RNRS top-level programs, while <code>compile-script</code> implements the semantics of the interactive top-level. The resulting compiled program will also run faster than if compiled via <code>compile-file</code> or <code>compile-script</code>.</p>
</div>
<div class="paragraph">
<p><code>compile-program</code> returns a list of libraries directly invoked by the compiled top-level program, excluding built-in libraries like <code>(rnrs)</code> and <code>(chezscheme)</code>. The procedure <code>library-requirements</code> may be used to determine the indirect requirements, i.e., additional libraries required by the directly invoked libraries. When combined with <code>library-object-filename</code>, this information can be used to determine the set of files that must be distributed with the compiled program file.</p>
</div>
<div class="paragraph">
<p>A program invokes a library only if it references one or more variables exported from the library. The set of libraries invoked by a top-level program, and hence loaded when the program is loaded, might be smaller than the set imported by the program, and it might be larger than the set directly imported by the program.</p>
</div>
<div class="paragraph">
<p>As with source-code top-level programs, compiled top-level programs may be run with the <code>--program</code> command-line option.</p>
</div>
<div id="system:s71" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(maybe-compile-file <em>input-filename</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(maybe-compile-file <em>input-filename</em> <em>output-filename</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(maybe-compile-library <em>input-filename</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(maybe-compile-library <em>input-filename</em> <em>output-filename</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(maybe-compile-program <em>input-filename</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(maybe-compile-program <em>input-filename</em> <em>output-filename</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These procedures are like their non-<code>maybe</code> counterparts but compile the source file only if the object file is out-of-date. An object file <code><em>X</em></code> is considered out-of-date if it does not exist or if it is older than the source file or any files included (via <code>include</code>) when <code><em>X</em></code> was created. When the value of the parameter <code>compile-imported-libraries</code> is <code>#t</code>, <code><em>X</em></code> is also considered out-of-date if the object file for any library imported when <code><em>X</em></code> was compiled is out-of-date. If <code>maybe-compile-file</code> determines that compilation is necessary, it compiles the source file by passing <code>compile-file</code> the input and output filenames. <code>compile-library</code> does so by similarly invoking the value of the <code>compile-library-handler</code> parameter, and <code>compile-program</code> does so by similarly invoking the value of the <code>compile-program-handler</code> parameter.</p>
</div>
<div class="paragraph">
<p>When <code><em>output-filename</em></code> is not specified, the input and output filenames are determined in the same manner as for <code>compile-file</code>.</p>
</div>
<div id="system:s72" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>compile-library-handler</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This parameter must be set to a procedure, and the procedure should accept two string arguments naming a source file and an object file. The procedure should typically invoke <code>compile-library</code> and pass it the two arguments, but it can also use one of the other file or port compilation procedures. For example, it might read the source file using its own parser and use <code>compile-to-file</code> to finish the compilation process. The procedure can perform other actions as well, such as parameterizing compilation parameters, establishing guards, or gathering statistics. The default value of this parameter simply invokes <code>compile-library</code> on the two string arguments without taking any other action.</p>
</div>
<div class="paragraph">
<p>The value of this parameter is called by <code>maybe-compile-library</code> when the object file is out-of-date. It is also called by the expander to compile an imported library when <code>compile-imported-libraries</code> is <code>#t</code> and the expander determines the object file is out-of-date.</p>
</div>
<div id="system:s74" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>compile-program-handler</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This parameter must be set to a procedure, and the procedure should accept two string arguments naming a source file and an object file. The procedure should typically invoke <code>compile-program</code> and pass it the two arguments, but it can also use one of the other file or port compilation procedures. For example, it might read the source file using its own parser and use <code>compile-to-file</code> to finish the compilation process. The procedure can perform other actions as well, such as parameterizing compilation parameters, establishing guards, or gathering statistics. The default value of this parameter simply invokes <code>compile-program</code> on the two string arguments without taking any other action and returns the list of libraries returned by <code>compile-program</code>.</p>
</div>
<div class="paragraph">
<p>The value of this parameter is called by <code>maybe-compile-program</code> when the object file is out-of-date.</p>
</div>
<div id="system:s76" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile-whole-program <em>input-filename</em> <em>output-filename</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile-whole-program <em>input-filename</em> <em>output-filename</em> <em>libs-visible?</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of libraries left to be loaded at run time</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>compile-whole-program</code> accepts as input a filename naming a "whole program optimization" (wpo) file for a top-level program and produces an object file incorporating the program and each library upon which it depends, provided that a wpo file for the library can be found.</p>
</div>
<div class="paragraph">
<p>If a wpo file for a required library cannot be found, but an object file for the library can, the library is not incorporated in the resulting object file. Such libraries are left to be loaded at run time. <code>compile-whole-program</code> returns a list of such libraries. If there are no such libraries, the resulting object file is self-contained and <code>compile-whole-program</code> returns the empty list.</p>
</div>
<div class="paragraph">
<p>The libraries incorporated into the resulting object file are visible (for use by <code>environment</code> and <code>eval</code>) if the <code><em>libs-visible?</em></code> argument is supplied and non-false. Any library incorporated into the resulting object file and required by an object file left to be loaded at run time is also visible, as are any libraries the object file depends upon, regardless of the value of <code><em>libs-visible?</em></code>.</p>
</div>
<div class="paragraph">
<p><code>compile-whole-program</code> linearizes the initialization code for the set of incorporated libraries in a way that respects static dependencies among the libraries but not necessary dynamic dependencies deriving from initialization-time uses of <code>environment</code> or <code>eval</code>. Additional static dependencies can be added in most cases to force an ordering that allows the dynamic imports to succeed, though not in general since a different order might be required each time the program is run. Adding a static dependency of one library on a second requires adding an import of the second in the first as well as a run-time reference to one of the variables exported by the second in the body of the first.</p>
</div>
<div class="paragraph">
<p><code><em>input-filename</em></code> and <code><em>output-filename</em></code> must be strings. <code><em>input-filename</em></code> must identify a wpo file, and a wpo or object file must also be present for each required library somewhere in the directories specified by the <code>library-directories</code> parameter.</p>
</div>
<div class="paragraph">
<p>To the extent possible given the specified set of visible libraries and requirements of libraries to be loaded at run time, <code>compile-whole-program</code> discards unused code and optimizes across program and library boundaries, potentially reducing program load time, run time, and memory requirements. Some optimization also occurs even across the boundaries of libraries that are not incorporated into the output, though this optimization is limited in nature.</p>
</div>
<div class="paragraph">
<p>The procedures <code>compile-file</code>, <code>compile-program</code>, <code>compile-library</code>, <code>compile-script</code>, and <code>compile-whole-library</code> produce wpo files as well as ordinary object files when the <code>generate-wpo-files</code> parameter is set to <code>#t</code> (the default is <code>#f</code>). <code>compile-port</code> and <code>compile-to-port</code> do so when passed an optional wpo port.</p>
</div>
<div id="system:s78" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile-whole-library <em>input-filename</em> <em>output-filename</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of libraries left to be loaded at run time</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>compile-whole-library</code> is like <code>compile-whole-program</code>, except <code><em>input-filename</em></code> must specify a wpo file for a library, all libraries are automatically made visible, and a new wpo file is produced (when <code>generate-wpo-files</code> is <code>#t</code>) as well as an object file for the resulting combination of libraries.</p>
</div>
<div class="paragraph">
<p>The comment in the description of <code>compile-whole-program</code> about the effect of initialization-code linearization on dynamic dependencies applies to <code>compile-whole-library</code> as well.</p>
</div>
<div id="system:s79" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile-port <em>input-port</em> <em>output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile-port <em>input-port</em> <em>output-port</em> <em>sfd</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile-port <em>input-port</em> <em>output-port</em> <em>sfd</em> <em>wpo-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile-port <em>input-port</em> <em>output-port</em> <em>sfd</em> <em>wpo-port</em> <em>covop</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>input-port</em></code> must be a textual input port. <code><em>output-port</em></code> and, if present and non-false, <code><em>wpo-port</em></code> must be binary output ports. If present and non-false, <code><em>sfd</em></code> must be a source-file descriptor. If present and non-false, <code><em>covop</em></code> must be a textual output port.</p>
</div>
<div class="paragraph">
<p><code>compile-port</code> is like <code>compile-file</code> except that it takes input from an arbitrary textual input port and sends output to an arbitrary binary output port. If <code><em>sfd</em></code> is supplied, it is passed to the reader so that source information can be associated with the expressions read from <code><em>input-port</em></code>. It is also used to associate block-profiling information with the input file name encapsulated within <code><em>sfd</em></code>. If <code><em>wpo-port</em></code> is supplied, <code>compile-port</code> sends whole-program optimization information to <code><em>wpo-port</em></code> for use by <code>compile-whole-program</code>, as if (and regardless of whether) <code>generate-wpo-files</code> is set. If <code><em>covop</em></code> is supplied, <code>compile-port</code> sends coverage information to <code><em>covop</em></code>, as if (and regardless of whether) <code>generate-covin-files</code> is set.</p>
</div>
<div class="paragraph">
<p>The ports are closed automatically after compilation under the assumption the program that opens the ports and invokes <code>compile-port</code> will take care of closing the ports.</p>
</div>
<div id="system:s80" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile-to-port <em>obj-list</em> <em>output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile-to-port <em>obj-list</em> <em>output-port</em> <em>sfd</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile-to-port <em>obj-list</em> <em>output-port</em> <em>sfd</em> <em>wpo-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile-to-port <em>obj-list</em> <em>output-port</em> <em>sfd</em> <em>wpo-port</em> <em>covop</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>obj-list</em></code> must be a list containing a sequence of objects that represent syntactically valid expressions, each possibly annotated (<a href="#section_11.11.">Section 11.11</a>). If any of the objects does not represent a syntactically valid expression, <code>compile-to-port</code> raises an exception with condition type <code>&amp;syntax</code>. <code><em>output-port</em></code> and, if present, <code><em>wpo-port</em></code> must be binary output ports. If present, <code><em>sfd</em></code> must be a source-file descriptor.</p>
</div>
<div class="paragraph">
<p><code>compile-to-port</code> is like <code>compile-file</code> except that it takes input from a list of objects and sends output to an arbitrary binary output port. <code><em>sfd</em></code> is used to associate block-profiling information with the input file name encapsulated within <code><em>sfd</em></code>. If <code><em>wpo-port</em></code> is present, <code><em>compile-to-port</em></code> sends whole-program optimization information to <code><em>wpo-port</em></code> for use by <code>compile-whole-program</code>, as if (and regardless of whether) <code>generate-wpo-files</code> is set. If <code><em>covop</em></code> is present, <code><em>compile-to-port</em></code> sends coverage information to <code><em>covop</em></code>, as if (and regardless of whether) <code>generate-covin-files</code> is set.</p>
</div>
<div class="paragraph">
<p>The ports are not closed automatically after compilation under the assumption the program that opens the port and invokes <code>compile-to-port</code> will take care of closing the port.</p>
</div>
<div class="paragraph">
<p>When <code><em>obj-list</em></code> contains a single list-structured element whose first-element is the symbol <code>top-level-program</code>, <code>compile-to-port</code> returns a list of the libraries the top-level program requires at run time, as with <code>compile-program</code>. Otherwise, the return value is unspecified.</p>
</div>
<div id="system:s81" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile-to-file <em>obj-list</em> <em>output-file</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(compile-to-file <em>obj-list</em> <em>output-file</em> <em>sfd</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>obj-list</em></code> must be a list containing a sequence of objects that represent syntactically valid expressions, each possibly annotated (<a href="#section_11.11.">Section 11.11</a>). If any of the objects does not represent a syntactically valid expression, <code>compile-to-file</code> raises an exception with condition type <code>&amp;syntax</code>. <code><em>output-file</em></code> must be a string. If present, <code><em>sfd</em></code> must be a source-file descriptor.</p>
</div>
<div class="paragraph">
<p><code>compile-to-file</code> is like <code>compile-file</code> except that it takes input from a list of objects. <code><em>sfd</em></code> is used to associate block-profiling information with the input file name encapsulated within <code><em>sfd</em></code>.</p>
</div>
<div class="paragraph">
<p>When <code><em>obj-list</em></code> contains a single list-structured element whose first-element is the symbol <code>top-level-program</code>, <code>compile-to-file</code> returns a list of the libraries the top-level program requires at run time, as with <code>compile-program</code>. Otherwise, the return value is unspecified.</p>
</div>
<div id="system:s82" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(concatenate-object-files <em>out-file</em> <em>in-file<sub>1</sub></em> <em>in-file<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>out-file</em></code> and each <code><em>in-file</em></code> must be strings.</p>
</div>
<div class="paragraph">
<p><code>concatenate-object-files</code> combines the header information contained in the object files named by each <code><em>in-file</em></code>. It then writes the combined header information to the file named by <code><em>out-file</em></code>, followed by the remaining object code from each input file in turn.</p>
</div>
<div id="system:s83" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-boot-file <em>output-filename</em> <em>base-boot-list</em> <em>input-filename</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>output-filename</em></code>, <code><em>input-filename</em></code>, and the elements of <code><em>base-boot-list</em></code> must be strings.</p>
</div>
<div class="paragraph">
<p><code>make-boot-file</code> writes a boot header to the file named by <code><em>output-filename</em></code>, followed by the object code for each <code><em>input-filename</em></code> in turn. If an input file is not already compiled, <code>make-boot-file</code> compiles the file as it proceeds.</p>
</div>
<div class="paragraph">
<p>The boot header identifies the elements of <code><em>base-boot-list</em></code> as alternative boot files upon which the new boot file depends. If the list of strings naming base boot files is empty, the first named input file should be a base boot file, i.e., petite.boot or some boot file derived from petite.boot.</p>
</div>
<div id="system:s85" class="paragraph">
<p>Boot files are loaded explicitly via the <code>--boot</code> or <code>-b</code> command-line options or implicitly based on the name of the executable (<a href="#section_2.9.">Section 2.9</a>).</p>
</div>
<div class="paragraph">
<p>See <a href="#section_2.8.">Section 2.8</a> for more information on boot files and the use of <code>make-boot-file</code>.</p>
</div>
<div id="system:s86" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-boot-header <em>output-filename</em> <em>base-boot<sub>1</sub></em> <em>base-boot<sub>2</sub></em>&#8230;&#8203;)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure has been subsumed by <code>make-boot-file</code> and is provided for backward compatibility. The call</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(make-boot-header <em>output-filename</em> <em>base-boot<sub>1</sub></em> <em>base-boot<sub>2</sub></em> ...)</code></pre>
</div>
</div>
<div class="paragraph">
<p>is equivalent to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(make-boot-file <em>output-filename</em> '(<em>base-boot<sub>1</sub></em> <em>base-boot<sub>2</sub></em> ...))</code></pre>
</div>
</div>
<div id="system:s87" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(strip-fasl-file <em>input-path</em> <em>output-path</em> <em>options</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>input-path</em></code> and <code><em>output-path</em></code> must be strings. <code><em>input-path</em></code> must name an existing, readable file containing object code produced by <code>compile-file</code>, one of the other file-compiling procedures, or an earlier run of <code>strip-fasl-file</code>. <code><em>options</em></code> must be an enumeration set over the symbols constituting valid strip options, as described in the <code>fasl-strip-options</code> entry below.</p>
</div>
<div class="paragraph">
<p>The new procedure <code>strip-fasl-file</code> allows the removal of source information of various sorts from a compiled object (fasl) file produced by <code>compile-file</code> or one of the other file compiling procedures. It also allows removal of library visit code from object files containing compiled libraries. Visit code is the code for macro transformers and meta definitions required to compile (but not run) dependent libraries.</p>
</div>
<div class="paragraph">
<p>On most platforms, the input and output paths can be the same, in which case the input file is replaced with a new file containing the stripped object code. Using the same path will likely fail on Windows file systems, which do not generally permit an open file to be removed.</p>
</div>
<div class="paragraph">
<p>If <code><em>options</em></code> is empty, the output file is effectively equivalent to the input file, though it will not necessarily be identical.</p>
</div>
<div id="system:s88" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(fasl-strip-options <em>symbol</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a fasl-strip-options enumeration set</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Fasl-strip-options enumeration sets are passed to <code>strip-fasl-file</code> to determine what is stripped. The available options are described below.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>inspector-source</code></dt>
<dd>
<p>Strip inspector source information. This includes source expressions that might otherwise be available for procedures and continuations with the "code" and "call" commands and messages in the interactive and object inspectors. It also includes filename and position information that might otherwise be available for the same via the "file" command and "source" messages.</p>
</dd>
<dt class="hdlist1"><code>source-annotations</code></dt>
<dd>
<p>Strip source annotations, which typically appear only on syntax objects, e.g., identifiers, in the templates of macro transformers.</p>
</dd>
<dt class="hdlist1"><code>profile-source</code></dt>
<dd>
<p>Strip source file and character position information from profiled code objects. This does not remove the profile counters or eliminate the overhead for incrementing them at run time.</p>
</dd>
<dt class="hdlist1"><code>compile-time-information</code></dt>
<dd>
<p>This strips compile-time information from compiled libraries, potentially reducing the size of the resulting file but making it impossible to use the file to compile dependent code. This option is useful for creating smaller object files to ship as part of a binary-only package.</p>
</dd>
</dl>
</div>
<div id="system:s89" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(machine-type)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the current machine type</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Consult the release notes for the current version of <em>Chez Scheme</em> for a list of supported machine types. <a id="system:s90"></a></p>
</div>
<div id="desc:expand" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(expand <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(expand <em>obj</em> <em>env</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>expansion of the Scheme form represented by <code><em>obj</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>expand</code> treats <code><em>obj</em></code> as the representation of an expression. It expands the expression in environment <code><em>env</em></code> and returns an object representing the expanded form. If no environment is provided, it defaults to the environment returned by <code>interaction-environment</code>.</p>
</div>
<div class="paragraph">
<p><code><em>obj</em></code> can be an annotation (<a href="#section_11.11.">Section 11.11</a>), and the default expander makes use of annotations to incorporate source-file information in error messages.</p>
</div>
<div class="paragraph">
<p><code>expand</code> actually passes its arguments to the current expander (see <code>current-expand</code>), initially <code>sc-expand</code>.</p>
</div>
<div class="paragraph">
<p>See also <code>expand-output</code> (<a href="#desc:expand-output">page 363</a>) which can be used to request that the compiler or interpreter show expander output.</p>
</div>
<div id="system:s92" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>current-expand</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>current-expand</code> determines the expansion procedure used by the compiler, interpreter, and direct calls to <code>expand</code> to expand syntactic extensions. <code>current-expand</code> is initially bound to the value of <code>sc-expand</code>.</p>
</div>
<div class="paragraph">
<p>It may be set another procedure, but since the format of expanded code expected by the compiler and interpreter is not publicly documented, only <code>sc-expand</code> produces correct output, so the other procedure must ultimately be defined in terms of <code>sc-expand</code>.</p>
</div>
<div class="paragraph">
<p>The first argument to the expansion procedure represents the input expression. It can be an annotation (<a href="#section_11.11.">Section 11.11</a>) or an unannotated value. the second argument is an environment. Additional arguments might be passed to the expansion procedure by the compiler, interpreter, and <code>expand</code>; their number and roles are unspecified.</p>
</div>
<div id="system:s95" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(sc-expand <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(sc-expand <em>obj</em> <em>env</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the expanded form of <code><em>obj</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The procedure <code>sc-expand</code> is used to expand programs written using <code>syntax-case</code> macros. <code>sc-expand</code> is the default expander, i.e., the initial value of <code>current-expand</code>. <code><em>obj</em></code> represents the program to be expanded, and <code><em>env</em></code> must be an environment. <code><em>obj</em></code> can be an annotation (<a href="#section_11.11.">Section 11.11</a>) or unannotated value. If not provided, <code><em>env</em></code> defaults to the environment returned by <code>interaction-environment</code>. <a id="system:s96"></a></p>
</div>
<div id="desc:expand/optimize" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(expand/optimize <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(expand/optimize <em>obj</em> <em>env</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>result of expanding and optimizing form represented by <code><em>obj</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>expand/optimize</code> treats <code><em>obj</em></code> as the representation of an expression. <code><em>obj</em></code> can be an annotation (<a href="#section_11.11.">Section 11.11</a>) or unannotated value. <code>expand/optimize</code> expands the expression in environment <code><em>env</em></code> and passes the expression through the source optimizer <code>cp0</code> (unless <code>cp0</code> is disabled via <code>run-cp0</code>). It also simplifies <code>letrec</code> and <code>letrec*</code> expressions within the expression and makes their undefined checks explicit. It returns an object representing the expanded, simplified, and optimized form. If no environment is provided, it defaults to the environment returned by <code>interaction-environment</code>.</p>
</div>
<div class="paragraph">
<p><code>expand/optimize</code> is primarily useful for understanding what <code>cp0</code> does and does not optimize. Many optimizations are performed later in the compiler, so <code>expand/optimize</code> does not give a complete picture of optimizations performed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(expand/optimize
  '(let ([y '(3 . 4)])
     (+ (car y) (cdr y)))) ⇒ 7

(print-gensym #f)
(expand/optimize
  '(let ([y '(3 . 4)])
     (lambda (x)
       (* (+ (car y) (cdr y)) x)))) ⇒ (lambda (x) (#2%* 7 x))

(expand/optimize
  '(let ([n (expt 2 10)])
     (define even?
       (lambda (x) (or (zero? x) (not (odd? x)))))
     (define odd?
       (lambda (x) (not (even? (- x 1)))))
     (define f
       (lambda (x)
         (lambda (y)
           (lambda (z)
             (if (= z 0) (omega) (+ x y z))))))
     (define omega
       (lambda ()
         ((lambda (x) (x x)) (lambda (x) (x x)))))
     (let ([g (f 1)] [m (f n)])
       (let ([h (if (> ((g 2) 3) 5)
                    (lambda (x) (+ x 1))
                    odd?)])
         (h n))))) ⇒ 1025</code></pre>
</div>
</div>
<div id="system:s97" class="paragraph">
<p>See also <code>expand/optimize-output</code> (<a href="#desc:expand/optimize-output">page 363</a>) which can be used to request that the compiler or interpreter show source-optimizer output.</p>
</div>
<div id="system:s98" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(eval-when <em>situations</em> <em>form<sub>1</sub></em> <em>form<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>situations</em></code> must be a list containing some combination of the symbols <code>eval</code>, <code>compile</code>, <code>load</code>, <code>visit</code>, and <code>revisit</code>.</p>
</div>
<div class="paragraph">
<p>When source files are loaded (see <code>load</code>), the forms in the file are read, compiled, and executed sequentially, so that each form in the file is fully evaluated before the next one is read. When a source file is compiled (see <code>compile-file</code>), however, the forms are read and compiled, <em>but not executed</em>, in sequence. This distinction matters only when the execution of one form in the file affects the compilation of later forms, e.g., when the form results in the definition of a module or syntactic form or sets a compilation parameter such as <code>optimize-level</code> or <code>case-sensitive</code>.</p>
</div>
<div class="paragraph">
<p>For example, assume that a file contains the following two forms:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax reverse-define
  (syntax-rules ()
    [(_ e x) (define x e)]))

(reverse-define 3 three)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Loading this from source has the effect of defining <code>reverse-define</code> as a syntactic form and binding the identifier <code>three</code> to 3. The situation may be different if the file is compiled with <code>compile-file</code>, however. Unless the system or programmer takes steps to assure that the first form is fully executed before the second expression is compiled, the syntax expander will not recognize <code>reverse-define</code> as a syntactic form and will generate code for a procedure call to <code>reverse-define</code> instead of generating code to define <code>three</code> to be 3. When the object file is subsequently loaded, the attempt to reference either <code>reverse-define</code> or <code>three</code> will fail.</p>
</div>
<div class="paragraph">
<p>As it happens, when a <code>define-syntax</code>, <code>module</code>, <code>import</code>, or <code>import-only</code> form appears at top level, as in the example above, the compiler does indeed arrange to evaluate it before going on to compile the remainder of the file. If the compiler encounters a variable definition for an identifier that was previously something else, it records that fact as well. The compiler also generates the appropriate code so that the bindings will be present as well when the object file is subsequently loaded. This solves most, but not all, problems of this nature, since most are related to the use of <code>define-syntax</code> and modules. Some problems are not so straightforwardly handled, however. For example, assume that the file contains the following definitions for <code>nodups?</code> and <code>mvlet</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define nodups?
  (lambda (ids)
    (define bound-id-member?
      (lambda (id ids)
        (and (not (null? ids))
             (or (bound-identifier=? id (car ids))
                 (bound-id-member? id (cdr ids))))))
    (or (null? ids)
        (and (not (bound-id-member? (car ids) (cdr ids)))
             (nodups? (cdr ids))))))

(define-syntax mvlet
  (lambda (x)
    (syntax-case x ()
      [(_ ((x ...) expr) b1 b2 ...)
       (and (andmap identifier? #'(x ...))
            (nodups? #'(x ...)))
       #'(call-with-values
           (lambda () expr)
           (lambda (x ...) b1 b2 ...))])))

(mvlet ((a b c) (values 1 2 3))
  (list (* a a) (* b b) (* c c)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>When loaded directly, this results in the definition of <code>nodups?</code> as a procedure and <code>mvlet</code> as a syntactic abstraction before evaluation of the <code>mvlet</code> expression. Because <code>nodups?</code> is defined before the <code>mvlet</code> expression is expanded, the call to <code>nodups?</code> during the expansion of <code>mvlet</code> causes no difficulty. If instead this file were compiled, using <code>compile-file</code>, the compiler would arrange to define <code>mvlet</code> before continuing with the expansion and evaluation of the <code>mvlet</code> expression, but it would not arrange to define <code>nodups?</code>. Thus the expansion of the <code>mvlet</code> expression would fail.</p>
</div>
<div class="paragraph">
<p>In this case it does not help to evaluate the syntactic extension alone. A solution in this case would be to move the definition of <code>nodups?</code> inside the definition for <code>mvlet</code>, just as the definition for <code>bound-id-member?</code> is placed within <code>nodups?</code>, but this does not work for help routines shared among several syntactic definitions. Another solution is to label the <code>nodups?</code> definition a "meta" definition (see <a href="#section_11.8.">Section 11.8</a>) but this does not work for helpers that are used both by syntactic abstractions and by run-time code.</p>
</div>
<div class="paragraph">
<p>A somewhat simpler problem occurs when setting parameters that affect compilation, such as <code>optimize-level</code> and <code>case-sensitive?</code>. If not set prior to compilation, their settings usually will not have the desired effect.</p>
</div>
<div class="paragraph">
<p><code>eval-when</code> offers a solution to these problems by allowing the programmer to explicitly control what forms should or should not be evaluated during compilation. <code>eval-when</code> is a syntactic form and is handled directly by the expander. The action of <code>eval-when</code> depends upon the <code><em>situations</em></code> argument and whether or not the forms <code><em>form<sub>1</sub></em> <em>form<sub>2</sub></em> ...</code> are being compiled via <code>compile-file</code> or are being evaluated directly. Let&#8217;s consider each of the possible situation specifiers <code>eval</code>, <code>compile</code>, <code>load</code>, <code>visit</code>, and <code>revisit</code> in turn.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>eval</code></dt>
<dd>
<p>The <code>eval</code> specifier is relevant only when the <code>eval-when</code> form is being evaluated directly, i.e., if it is typed at the keyboard or loaded from a source file. Its presence causes <code><em>form<sub>1</sub></em> <em>form<sub>2</sub></em> ...</code> to be expanded and this expansion to be included in the expansion of the <code>eval-when</code> form. Thus, the forms will be evaluated directly as if not contained within an <code>eval-when</code> form.</p>
</dd>
<dt class="hdlist1"><code>compile</code></dt>
<dd>
<p>The <code>compile</code> specifier is relevant only when the <code>eval-when</code> form appears in a file currently being compiled. (Its presence is simply ignored otherwise.) Its presence forces <code><em>form<sub>1</sub></em> <em>form<sub>2</sub></em> ...</code> to be expanded and evaluated immediately.</p>
</dd>
<dt class="hdlist1"><code>load</code></dt>
<dd>
<p>The <code>load</code> specifier is also relevant only when the <code>eval-when</code> form appears in a file currently being compiled. Its presence causes <code><em>form<sub>1</sub></em> <em>form<sub>2</sub></em> ...</code> to be expanded and this expansion to be included in the expansion of the <code>eval-when</code> form. Any code necessary to record binding information and evaluate syntax transformers for definitions contained in the forms is marked for execution when the file is "visited," and any code necessary to compute the values of variable definitions and the expressions contained within the forms is marked for execution when the file is "revisited."</p>
</dd>
<dt class="hdlist1"><code>visit</code></dt>
<dd>
<p>The <code>visit</code> specifier is also relevant only when the <code>eval-when</code> form appears in a file currently being compiled. Its presence causes <code><em>form<sub>1</sub></em> <em>form<sub>2</sub></em> ...</code> to be expanded and this expansion to be included in the expansion of the <code>eval-when</code> form, with an annotation that the forms are to be executed when the file is "visited."</p>
</dd>
<dt class="hdlist1"><code>revisit</code></dt>
<dd>
<p>The <code>revisit</code> specifier is also relevant only when the <code>eval-when</code> form appears in a file currently being compiled. Its presence causes <code><em>form<sub>1</sub></em> <em>form<sub>2</sub></em> ...</code> to be expanded and this expansion to be included in the expansion of the <code>eval-when</code> form, with an annotation that the forms are to be executed when the file is "revisited."</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>A file is considered "visited" when it is brought in by either <code>load</code> or <code>visit</code> and "revisited" when it is brought in by either <code>load</code> or <code>revisit</code>.</p>
</div>
<div class="paragraph">
<p>Top-level expressions are treated as if they are wrapped in an <code>eval-when</code> with situations <code>load</code> and <code>eval</code>. This means that, by default, forms typed at the keyboard or loaded from a source file are evaluated, and forms appearing in a file to be compiled are not evaluated directly but are compiled for execution when the resulting object file is subsequently loaded.</p>
</div>
<div class="paragraph">
<p>The treatment of top-level definitions is slightly more involved. All definitions result in changes to the compile-time environment. For example, an identifier defined by <code>define</code> is recorded as a variable, and an identifier defined by <code>define-syntax</code> is recorded as a keyword and associated with the value of its right-hand-side (transformer) expression. These changes are made at eval, compile, and load time as if the definitions were wrapped in an <code>eval-when</code> with situations <code>eval</code>, <code>load</code>, and <code>compile</code>. (This behavior can be altered by changing the value of the parameter <code>eval-syntax-expanders-when</code>.) Some definitions also result in changes to the run-time environment. For example, a variable is associated with the value of its right-hand-side expression. These changes are made just at evaluation and load time as if the definitions were wrapped in an <code>eval-when</code> with situations <code>eval</code> and <code>load</code>.</p>
</div>
<div class="paragraph">
<p>The treatment of local expressions or definitions (those not at top level) that are wrapped in an <code>eval-when</code> depends only upon whether the situation <code>eval</code> is present in the list of situations. If the situation <code>eval</code> is present, the definitions and expressions are evaluated as if they were not wrapped in an <code>eval-when</code> form, i.e., the <code>eval-when</code> form is treated as a <code>begin</code> form. If the situation <code>eval</code> is not present, the forms are ignored; in a definition context, the <code>eval-when</code> form is treated as an empty <code>begin</code>, and in an expression context, the <code>eval-when</code> form is treated as a constant with an unspecified value.</p>
</div>
<div class="paragraph">
<p>Since top-level syntax bindings are established, by default, at compile time as well as eval and load time, top-level variable bindings needed by syntax transformers should be wrapped in an <code>eval-when</code> form with situations <code>compile</code>, <code>load</code>, and <code>eval</code>. We can thus <code>nodups?</code> problem above by enclosing the definition of <code>nodups?</code> in an <code>eval-when</code> as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(eval-when (compile load eval)
  (define nodups?
    (lambda (ids)
      (define bound-id-member?
        (lambda (id ids)
          (and (not (null? ids))
               (or (bound-identifier=? id (car ids))
                   (bound-id-member? id (cdr ids))))))
      (or (null? ids)
          (and (not (bound-id-member? (car ids) (cdr ids)))
               (nodups? (cdr ids)))))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>This forces it to be evaluated before it is needed during the expansion of the <code>mvlet</code> expression.</p>
</div>
<div class="paragraph">
<p>Just as it is useful to add <code>compile</code> to the default <code>load</code> and <code>eval</code> situations, omitting options is also useful. Omitting one or more of <code>compile</code>, <code>load</code>, and <code>eval</code> has the effect of preventing the evaluation at the given time. Omitting all of the options has the effect of inhibiting evaluation altogether.</p>
</div>
<div class="paragraph">
<p>One common combination of situations is <code>(compile eval)</code>, which by the inclusion of <code>compile</code> causes the expression to be evaluated at compile time, and by the omission of <code>load</code> inhibits the generation of code by the compiler for execution when the file is subsequently loaded. This is typically used for the definition of syntactic extensions used only within the file in which they appear; in this case their presence in the object file is not necessary. It is also used to set compilation parameters that are intended to be in effect whether the file is loaded from source or compiled via <code>compile-file</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(eval-when (compile eval) (case-sensitive #t))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Another common situations list is <code>(compile)</code>, which might be used to set compilation options to be used only when the file is compiled via <code>compile-file</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(eval-when (compile) (optimize-level 3))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, one other common combination is <code>(load eval)</code>, which might be useful for inhibiting the double evaluation (during the compilation of a file and again when the resulting object file is loaded) of syntax definitions when the syntactic extensions are not needed within the file in which their definitions appear.</p>
</div>
<div class="paragraph">
<p>The behavior of <code>eval-when</code> is usually intuitive but can be understood precisely as follows. The <code>syntax-case</code> expander, which handles <code>eval-when</code> forms, maintains two state sets, one for compile-time forms and one for run-time forms. The set of possible states in each set are "L" for <code>load</code>, "C" for <code>compile</code>, "V" for <code>visit</code>, "R" for <code>revisit</code>, and "E" for <code>eval</code>.</p>
</div>
<div class="paragraph">
<p>When compiling a file, the compile-time set initially contains "L" and "C" and the run-time set initially contains only "L." When not compiling a file (as when a form is evaluated by the read-eval-print loop or loaded from a source file), both sets initially contain only "E." The subforms of an <code>eval-when</code> form at top level are expanded with new compile- and run-time sets determined by the current sets and the situations listed in the <code>eval-when</code> form. Each element of the current set contributes zero or more elements to the new set depending upon the given situations according to the following table.</p>
</div>
<table class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>load</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>compile</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>visit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>revisit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>eval</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">L</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">L</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">---</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">---</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">---</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">---</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">---</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">---</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">---</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">---</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">---</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">E</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">---</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">---</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">---</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">---</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For example, if the current compile-time state set is {L} and the situations are <code>load</code> and <code>compile</code>, the new compile-time state set is {L, C}, since L/<code>load</code> contributes "L" and L/<code>compile</code> contributes "C."</p>
</div>
<div class="paragraph">
<p>The state sets determine how forms are treated by the expander. Compile-time forms such as syntax definitions are evaluated at a time or times determined by the compile-time state set, and run-time forms are evaluated at a time or times determined by the run-time state set. A form is evaluated immediately if "C" is in the state set. Code is generated to evaluate the form at visit or revisit time if "V" or "R" is present. If "L" is present in the compile-time set, it is treated as "V;" likewise, if "L" is present in the run-time set, it is treated as "R." If more than one of states is present in the state set, the form is evaluated at each specified time.</p>
</div>
<div class="paragraph">
<p>"E" can appear in the state set only when not compiling a file, i.e., when the expander is invoked from an evaluator such as <code>compile</code> or <code>interpret</code>. When it does appear, the expanded form is returned from the expander to be processed by the evaluator, e.g., <code>compile</code> or <code>interpret</code>, that invoked the expander.</p>
</div>
<div class="paragraph">
<p>The value of the parameter <code>eval-syntax-expanders-when</code> actually determines the initial compile-time state set. The parameter is bound to a list of situations, which defaults to <code>(compile load eval)</code>. When compiling a file, <code>compile</code> contributes "C" to the state set, <code>load</code> contributes "L," <code>visit</code> contributes "V," <code>revisit</code> contributes "R," and <code>eval</code> contributes nothing. When not compiling a file, <code>eval</code> contributes "E" to the state set, and the other situations contribute nothing. There is no corresponding parameter for controlling the initial value of the run-time state set.</p>
</div>
<div id="eval-when-tlp" class="paragraph">
<p>For RNRS top-level programs, <code>eval-when</code> is essentially ineffective. The entire program is treated as a single expression, so <code>eval-when</code> becomes a local <code>eval-when</code> for which only the <code>eval</code> situation has any relevance. As for any local <code>eval-when</code> form, the subforms are ignored if the <code>eval</code> situation is not present; otherwise, they are treated as if the <code>eval-when</code> wrapper were absent.</p>
</div>
<div id="system:s101" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>eval-syntax-expanders-when</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This parameter must be set to a list representing a set of <code>eval-when</code> situations, e.g., a list containing at most one occurrence of each of the symbols <code>eval</code>, <code>compile</code>, <code>load</code>, <code>visit</code>, and <code>revisit</code>. It is used to determine the evaluation time of syntax definitions, module forms, and import forms are expanded. (See the discussion of <code>eval-when</code> above.) The default value is <code>(compile load eval)</code>, which causes compile-time information in a file to be established when the file is loaded from source, when it is compiled via <code>compile-file</code>, and when a compiled version of the file is loaded via <code>load</code> or <code>visit</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_12.5.">Section 12.5. Source Directories and Files</h3>
<div id="system:s102" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>source-directories</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of <code>source-directories</code> must be a list of strings, each of which names a directory path. <code>source-directories</code> determines the set of directories searched for source or object files when a file is loaded via <code>load</code>, <code>load-library</code>, <code>load-program</code>, <code>include</code>, <code>visit</code>, or <code>revisit</code>, when a syntax error occurs, or when a source file is opened in the interactive inspector.</p>
</div>
<div class="paragraph">
<p>The default value is the list <code>(".")</code>, which means source files will be found only in or relative to the current directory, unless named with an absolute path.</p>
</div>
<div class="paragraph">
<p>This parameter is never altered by the system, with one exception. The expander temporarily adds (via <code>parameterize</code>) the directory in which a library file resides to the front of the <code>source-directories</code> list when it compiles (when <code>compile-imported-libraries</code> is true) or loads the library from source, which it does only if the library is not already defined.</p>
</div>
<div id="system:s103" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(with-source-path <em>who</em> <em>name</em> <em>procedure</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The procedure <code>with-source-path</code> searches through the current source-directories path, in order, for a file with the specified <code><em>name</em></code> and invokes <code><em>procedure</em></code> on the result. If no such file is found, an exception is raised with condition types <code>&amp;assertion</code> and <code>&amp;who</code> with <code><em>who</em></code> as who value.</p>
</div>
<div class="paragraph">
<p>If <code><em>name</em></code> is an absolute pathname or one beginning with <code>./</code> (or <code>.\</code> under Windows) or <code>../</code> (or <code>..\</code> under Windows), or if the list of source directories contains only <code>"."</code>, the default, or <code>""</code>, which is equivalent to <code>"."</code>, no searching is performed and <code><em>name</em></code> is returned.</p>
</div>
<div class="paragraph">
<p><code><em>who</em></code> must be a symbol, <code><em>name</em></code> must be a string, and <code><em>procedure</em></code> should accept one argument.</p>
</div>
<div class="paragraph">
<p>The following examples assumes that the file "pie" exists in the directory "../spam" but not in "../ham" or the current directory.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define find-file
  (lambda (fn)
    (with-source-path 'find-file fn values)))

(find-file "pie") ⇒ "pie"

(source-directories '("." "../ham"))
(find-file "pie") ⇒ <em>exception in find-file: pie not found</em>

(source-directories '("." "../spam"))
(find-file "pie") ⇒ "../spam/pie"

(source-directories '("." "../ham"))
(find-file "/pie") ⇒ "/pie"

(source-directories '("." "../ham"))
(find-file "./pie") ⇒ "./pie"

(source-directories '("." "../spam"))
(find-file "../pie") ⇒ "../ham/pie"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_12.6.">Section 12.6. Compiler Controls</h3>
<div id="system:s104" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>optimize-level</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This parameter can take on one of the four values 0, 1, 2, and 3.</p>
</div>
<div class="paragraph">
<p>In theory, this parameter controls the amount of optimization performed by the compiler. In practice, it does so only indirectly, and the only difference is between optimize level 3, at which the compiler generates "unsafe" code, and optimize levels 0-2, at which the compiler generates "safe" code. Safe code performs full type and bounds checking so that, for example, an attempt to apply a non-procedure, an attempt to take the car of a non-pair, or an attempt to reference beyond the end of a vector each result in an exception being raised. With unsafe code, the same situations may result in invalid memory references, corruption of the Scheme heap (which may cause seemingly unrelated problems later), system crashes, or other undesirable behaviors. Unsafe code is typically faster, but optimize-level 3 should be used with caution and only on sections of well-tested code that must run as quickly as possible.</p>
</div>
<div class="paragraph">
<p>While the compiler produces the same code for optimize levels 0-2, user-defined macro transformers can differentiate among the different levels if desired.</p>
</div>
<div class="paragraph">
<p>One way to use optimize levels is on a per-file basis, using <code>eval-when</code> to force the use of a particular optimize level at compile time. For example, placing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(eval-when (compile) (optimize-level 3))</code></pre>
</div>
</div>
<div class="paragraph">
<p>at the front of a file will cause all of the forms in the file to be compiled at optimize level 3 when the file is compiled (using <code>compile-file</code>) but does not affect the optimize level used when the file is loaded from source. Since <code>compile-file</code> parameterizes <code>optimize-level</code> (see <code>parameterize</code>), the above expression does not permanently alter the optimize level in the system in which the <code>compile-file</code> is performed.</p>
</div>
<div class="paragraph">
<p>The optimize level can also be set via the <code>--optimize-level</code> command-line option (<a href="#section_2.9.">Section 2.9</a>). This option is particularly useful for running RNRS top-level programs at optimize-level 3 via the <code>--program</code> command-line option, since <code>eval-when</code> is ineffective for RNRS top-level programs as described on <a href="#eval-when-tlp">page 355</a>. <a id="system:s109"></a></p>
</div>
<div id="desc:hash-primitive" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>($primitive <em>variable</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>#%<em>variable</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>($primitive 2 <em>variable</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>#2%<em>variable</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>($primitive 3 <em>variable</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>#3%<em>variable</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the primitive value for <code><em>variable</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>variable</em></code> must name a primitive procedure. The <code>$primitive</code> syntactic form allows control over the optimize level at the granularity of individual primitive references, and it can be used to access the original value of a primitive, regardless of the lexical context or the current top-level binding for the variable originally bound to the primitive.</p>
</div>
<div class="paragraph">
<p>The expression <code>($primitive <em>variable</em>)</code> may be abbreviated as <code>#%<em>variable</em></code>. The reader expands <code>#%</code> followed by an object into a <code>$primitive</code> expression, much as it expands <code>'<em>object</em></code> into a <code>quote</code> expression.</p>
</div>
<div class="paragraph">
<p>If a <code>2</code> or <code>3</code> appears in the form or between the <code>#</code> and <code>%</code> in the abbreviated form, the compiler treats an application of the primitive as if it were compiled at the corresponding optimize level (see the <code>optimize-level</code> parameter). If no number appears in the form, an application of the primitive is treated as an optimize-level 3 application if the current optimize level is 3; otherwise, it is treated as an optimize-level 2 application.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(#%car '(a b c)) ⇒ a
(let ([car cdr]) (car '(a b c))) ⇒ (b c)
(let ([car cdr]) (#%car '(a b c))) ⇒ a
(begin (set! car cdr) (#%car '(a b c))) ⇒ a</code></pre>
</div>
</div>
<div id="system:s110" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>debug-level</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This parameter can take on one of the four values 0, 1, 2, and 3. It is used to tell the compiler how important the preservation of debugging information is, with 0 being least important and 3 being most important. The default value is 1. As of Version 9.0, it is used solely to determine whether an error-causing call encountered in nontail position is treated as if it were in tail position (thus causing the caller&#8217;s frame not to appear in a stack backtrace); this occurs at debug levels below 2.</p>
</div>
<div id="system:s111" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>generate-interrupt-trap</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To support interrupts, including keyboard, timer, and collect request interrupts, the compiler inserts a short sequence of instructions at the entry to each nonleaf procedure (<a href="#section_12.2.">Section 12.2</a>). This small overhead may be eliminated by setting <code>generate-interrupt-trap</code> to <code>#f</code>. The default value of this parameter is <code>#t</code>.</p>
</div>
<div class="paragraph">
<p>It is rarely a good idea to compile code without interrupt trap generation, since a tight loop in the generated code may completely prevent interrupts from being serviced, including the collect request interrupt that causes garbage collections to occur automatically. Disabling trap generation may be useful, however, for routines that act simply as "wrappers" for other routines for which code is presumably generated with interrupt trap generation enabled. It may also be useful for short performance-critical routines with embedded loops or recursions that are known to be short running and that make no other calls.</p>
</div>
<div id="system:s112" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>compile-interpret-simple</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>At all optimize levels, when the value of <code>compile-interpret-simple</code> is set to a true value (the default), <code>compile</code> interprets simple expressions. A simple expression is one that creates no procedures. This can save a significant amount of time over the course of many calls to <code>compile</code> or <code>eval</code> (with <code>current-eval</code> set to <code>compile</code>, its default value). When set to false, <code>compile</code> compiles all expressions. <a id="system:s114"></a></p>
</div>
<div id="desc:generate-inspector-information" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>generate-inspector-information</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When this parameter is set to a true value (the default), information about the source and contents of procedures and continuations is generated during compilation and retained in tables associated with each code segment. This information allows the inspector to provide more complete information, at the expense of using more memory and producing larger object files (via <code>compile-file</code>). Although compilation and loading may be slower when inspector information is generated, the speed of the compiled code is not affected. If this parameter is changed during the compilation of a file, the original value will be restored. For example, if:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(eval-when (compile) (generate-inspector-information #f))</code></pre>
</div>
</div>
<div class="paragraph">
<p>is included in a file, generation of inspector information will be disabled only for the remainder of that particular file. <a id="system:s115"></a></p>
</div>
<div id="desc:generate-procedure-source-information" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>generate-procedure-source-information</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When <code>generate-inspector-information</code> is set to <code>#f</code> and this parameter is set to <code>#t</code>, then a source location is preserved for a procedure, even though other inspector information is not preserved. Source information provides a small amount of debugging support at a much lower cost in memory and object-file size than full inspector information. If this parameter is changed during the compilation of a file, the original value will be restored.</p>
</div>
<div id="system:s116" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>enable-cross-library-optimization</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This parameter controls whether information is included with the object code for a compiled library to enable propagation of constants and inlining of procedures defined in the library into dependent libraries. When set to <code>#t</code> (the default), this information is included; when set to <code>#f</code>, the information is not included. Setting the parameter to <code>#f</code> potentially reduces the sizes of the resulting object files and the exposure of near-source information via the object file.</p>
</div>
<div id="system:s117" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>generate-wpo-files</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="system:s118" class="paragraph">
<p>When this parameter is set to <code>#t</code> (the default is <code>#f</code>), <code>compile-file</code>, <code>compile-library</code>, <code>compile-program</code>, and <code>compile-script</code> produce whole-program optimization (wpo) files for use by <code>compile-whole-program</code>. The name of the <code>wpo</code> file is derived from the output-file name by replacing the object-file extension (normally <code>.so</code>) with <code>.wpo</code>, or adding the extension <code>.wpo</code> if the object filename has no extension or has the extension <code>.wpo</code>.</p>
</div>
<div id="system:s119" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>compile-file-message</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When this parameter is set to true, the default, <code>compile-file</code>, <code>compile-library</code>, <code>compile-program</code>, and <code>compile-script</code> print a message of the form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">compiling <em>input-path</em> with output to <em>output-path</em></code></pre>
</div>
</div>
<div class="paragraph">
<p>When the parameter is set to <code>#f</code>, the message is not printed. <a id="system:s120"></a></p>
</div>
<div id="desc:run-cp0" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>run-cp0</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>cp0-effort-limit</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>cp0-score-limit</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>cp0-outer-unroll-limit</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These parameters control the operation of <code>cp0</code>, a source optimization pass that runs after macro expansion and prior to most other compiler passes. <code>cp0</code> performs procedure inlining, in which the code of one procedure is inlined at points where it is called by other procedures, as well as copy propagation, constant folding, useless code elimination, and several related optimizations. The algorithm used by the optimizer is described in detail in the paper "Fast and effective procedure inlining" <a href="#ref31">[31]</a>.</p>
</div>
<div class="paragraph">
<p>When <code>cp0</code> is enabled, the programmer can count on the compiler to fold constants, eliminate unnecessary <code>let</code> bindings, and eliminate unnecessary and inaccessible code. This is particularly useful when writing macros, since the programmer can usually handle only the general case and let the compiler simplify the code when possible. For example, the programmer can define <code>case</code> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax case
  (syntax-rules ()
    [(_ e [(k ...) a1 a2 ...] ... [else b1 b2 ...])
     (let ([t e])
       (cond
         [(memv t '(k ...)) a1 a2 ...]
         ...
         [else b1 b2 ...]))]
    [(_ e [(k ...) a1 a2 ...] ...)
     (let ([t e])
       (cond
         [(memv t '(k ...)) a1 a2 ...]
         ...))]))</code></pre>
</div>
</div>
<div class="paragraph">
<p>and count on the introduce <code>let</code> expression to be eliminated if <code>e</code> turns out to be an unassigned variable, and count on the entire <code>case</code> expression to be folded if <code>e</code> turns out to be a constant.</p>
</div>
<div class="paragraph">
<p>It is possible to see what <code>cp0</code> does with an expression via the procedure <code>expand/optimize</code>, which expands its argument and passes the result through <code>cp0</code>, as illustrated by the following transcript.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (print-gensym #f)
> (expand/optimize
    '(lambda (x)
       (case x [(a) 1] [(b c) 2] [(d) 3] [else 4])))
(lambda (x)
  (if (#2%memv x '(a))
      1
      (if (#2%memv x '(b c)) 2 (if (#2%memv x '(d)) 3 4))))
> (expand/optimize
    '(+ (let ([f (lambda (x)
                (case x [(a) 1] [(b c) 2] [(d) 3] [else 4]))])
          (f 'b))
         15))
17</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the first example, the <code>let</code> expression produced by <code>case</code> is eliminated, and in the second, the entire expression is optimized down to the constant <code>17</code>. Although not shown by <code>expand/optimize</code>, the <code>memv</code> calls in the output code for the first example will be replaced by calls to the less expensive <code>eq?</code> by a later pass of the compiler. Additional examples are given in the description of <code>expand/optimize</code>.</p>
</div>
<div class="paragraph">
<p>The value of <code>run-cp0</code> must be a procedure. Whenever the compiler is invoked on a Scheme form, the value <code><em>p</em></code> of this parameter is called to determine whether and how <code>cp0</code> is run. <code><em>p</em></code> receives two arguments: <code><em>cp0</em></code>, the entry point into <code>cp0</code>, and <code><em>x</em></code>, the form being compiled. The default value of <code>run-cp0</code> simply invokes <code><em>cp0</em></code> on <code><em>x</em></code>, then <code><em>cp0</em></code> again on the result. The second run is useful in some cases because the first run may not eliminate bindings for certain variables that appear to be referenced but are not actually referenced after inlining. The marginal benefit of the second run is usually minimal, but so is the cost.</p>
</div>
<div class="paragraph">
<p>Interesting variants include</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(run-cp0 (lambda (cp0 x) x))</code></pre>
</div>
</div>
<div class="paragraph">
<p>which bypasses (disables) <code>cp0</code>, and</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(run-cp0 (lambda (cp0 x) (cp0 x)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>which runs <code>cp0</code> just once.</p>
</div>
<div class="paragraph">
<p>The value of <code>cp0-effort-limit</code> determines the maximum amount of effort spent on each inlining attempt. The time spent optimizing a program is a linear function of this limit and the number of calls in the program&#8217;s source, so small values for this parameter enforce a tighter bound on compile time. When set to zero, inlining is disabled except when the name of a procedure is referenced only once. The value of <code>cp0-score-limit</code> determines the maximum amount of code produced per inlining attempt. Small values for this parameter limit the amount of overall code expansion. These parameters must be set to nonnegative fixnum values.</p>
</div>
<div class="paragraph">
<p>The parameter <code>cp0-outer-unroll-limit</code> controls the amount of inlining performed by the optimizer for recursive procedures. With the parameter&#8217;s value set to the default value of <code>0</code>, recursive procedures are not inlined. A nonzero value for the outer unroll limit allows calls external to a recursive procedure to be inlined. For example, the expression</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(letrec ([fact (lambda (x) (if (zero? x) 1 (* x (fact (- x 1)))))])
  (fact 10))</code></pre>
</div>
</div>
<div class="paragraph">
<p>would be left unchanged with the outer unroll limit set to zero, but would be converted into</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(letrec ([fact (lambda (x) (if (zero? x) 1 (* x (fact (- x 1)))))])
  (* 10 (fact 9)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>with the outer unroll limit set to one.</p>
</div>
<div class="paragraph">
<p>Interesting effects can be had by varying several of these parameters at once. For example, setting the effort and outer unroll limits to large values and the score limit to <code>1</code> has the effect of inlining even complex recursive procedures whose values turn out to be constant at compile time without risking any code expansion. For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(letrec ([fact (lambda (x) (if (zero? x) 1 (* x (fact (- x 1)))))])
  (fact 10))</code></pre>
</div>
</div>
<div class="paragraph">
<p>would be reduced to <code>3628800</code>, but</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(letrec ([fact (lambda (x) (if (zero? x) 1 (* x (fact (- x 1)))))])
  (fact z))</code></pre>
</div>
</div>
<div class="paragraph">
<p>would be left unchanged, although the optimizer may take a while to reach this decision if the effort and outer unroll limits are large.</p>
</div>
<div id="system:s122" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>commonization-level</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After running the main source optimization pass (cp0) for the last time, the compiler optionally runs a <em>commonization</em> pass. The pass commonizes the code for lambda expressions that have identical structure by abstracting differences at certain leaves of the program, namely constants, references to unassigned variables, and references to primitives. The parameter <code>commonization-level</code> controls whether commonization is run and, if so, how aggressive it is. Its value must be a nonnegative exact integer ranging from 0 through 9. When the parameter is set to 0, the default, commonization is not run. Otherwise, higher values result in more commonization.</p>
</div>
<div class="paragraph">
<p>Commonization can undo some of the effects of cp0&#8217;s inlining, can add run-time overhead, and can complicate debugging, particularly at higher commonization levels, which is why it is disabled by default. On the other hand, for macros or other meta programs that can generate large, mostly similar lambda expressions, enabling commonization can result in significant savings in object-code size and even reduce run-time overhead by making more efficient use of instruction caches.</p>
</div>
<div id="system:s123" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>undefined-variable-warnings</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When <code>undefined-variable-warnings</code> is set to <code>#t</code>, the compiler issues a warning message whenever it cannot determine that a variable bound by <code>letrec</code>, <code>letrec*</code>, or an internal definition will not be referenced before it is defined. The default value is <code>#f</code>.</p>
</div>
<div class="paragraph">
<p>Regardless of the setting of this parameter, the compiler inserts code to check for the error, except at optimize level 3. The check is fairly inexpensive and does not typically inhibit inlining or other optimizations. In code that must be carefully tuned, however, it is sometimes useful to reorder bindings or make other changes to eliminate the checks. Enabling undefined-variable warnings can facilitate this process.</p>
</div>
<div class="paragraph">
<p>The checks are also visible in the output of <code>expand/optimize</code>. <a id="system:s124"></a></p>
</div>
<div id="desc:expand-output" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>expand-output</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>expand/optimize-output</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="desc:expand/optimize-output" class="paragraph">
<p>The parameters <code>expand-output</code> and <code>expand/optimize-output</code> can be used to request that the compiler and interpreter print expander and source-optimizer output produced during the compilation or interpretation process. Each parameter must be set to either <code>#f</code> (the default) or a textual output port.</p>
</div>
<div class="paragraph">
<p>When <code>expand-output</code> is set to a textual output port, the output of the expander is printed to the port as a side effect of running <code>compile</code>, <code>interpret</code>, or any of the file compiling primitives, e.g., <code>compile-file</code> or <code>compile-library</code>. Similarly, when <code>expand/optimize-output</code> is set to a textual output port, the output of the source optimizer is printed.</p>
</div>
<div id="system:s126" class="paragraph">
<p>See also <code>expand</code> (<a href="#desc:expand">page 349</a>) and <code>expand-optimize</code> (<a href="#desc:expand/optimize">page 350</a>), which can be used to run the expander or the expander and source optimizer directly on an individual form.</p>
</div>
<div id="system:s127" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(pariah <em>expr<sub>1</sub></em> <em>expr<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the values of the last subexpression</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A <code>pariah</code> expression is just like a <code>begin</code> expression except that it informs the compiler that the code is expected to be executed infrequently. The compiler uses this information to optimize code layout, register assignments, and other aspects of the generated code. The <code>pariah</code> form can be used in performance-critical code to mark the branches of a conditional (e.g., <code>if</code>, <code>cond</code>, or <code>case</code>) that are less likely to be executed than the others.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_12.7.">Section 12.7. Profiling</h3>
<div class="paragraph">
<p>ChezScheme supports two forms of profiling: source profiling and block profiling. With source profiling enabled, the compiler instruments the code it produces to count the number of times each source-code expression is executed. This information can be displayed in HTML format, or it can be packaged in a list or source table for arbitrary user-defined processing. It can also be dumped to a file to be loaded subsequently into the compiler&#8217;s database of profile information for use in source-level optimizations, such as reordering the clauses of a <code>case</code> or <code>exclusive-cond</code> form. In connection with coverage-information (covin) files generated by the compiler when <code>generate-covin-files</code> is <code>#t</code>, profile information can also be used to gauge coverage of a source-code base by a set of tests.</p>
</div>
<div class="paragraph">
<p>The association between source-code expressions and profile counts is usually established via annotations produced by the reader and present in the input to the expander (<a href="#section_11.11.">Section 11.11</a>). It is also possible to explicitly identify source positions to be assigned profile counts via <code>profile</code> expressions. A <code>profile</code> expression has one subform, a source object, and returns an unspecified value. Its only effect is to cause the number of times the expression is executed to be accounted to the source object.</p>
</div>
<div class="paragraph">
<p>In cases where source positions explicitly identified by <code>profile</code> forms are the only ones whose execution counts should be tracked, the parameter <code>generate-profile-forms</code> can be set to <code>#f</code> to inhibit the expander&#8217;s implicit generation of <code>profile</code> forms for all annotated source expressions. It is also possible to obtain finer control over implicit generation of <code>profile</code> forms by marking which annotations that should and should not be used for profiling (<a href="#section_11.11.">Section 11.11</a>).</p>
</div>
<div class="paragraph">
<p>With block profiling enabled, the compiler similarly instruments the code it produces to count the number of times each "basic block" in the code it produces is executed. Basic blocks are the building blocks of the code produced by many compilers, including <em>Chez Scheme</em>'s compiler, and are sequences of straight-line code entered only at the top and exited only at the bottom. Counting the number of times each basic block is executed is equivalent to counting the number of times each instruction is executed, but more efficient. Block-profile information cannot be viewed, but it can be dumped to a file to be loaded subsequently into the compiler&#8217;s database of profile information for use in block- and instruction-level optimizations. These optimizations include reordering blocks to push less frequently used sequences of code out-of-line, so they will not occupy space in the instruction cache, and giving registers to variables that are used in more frequently executed instructions.</p>
</div>
<div class="paragraph">
<p>Source profiling involves at least the following steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>compile the code with source profiling enabled,</p>
</li>
<li>
<p>run the compiled code to generate source-profile information, and</p>
</li>
<li>
<p>dump the profile information.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Source profiling is enabled by setting the parameter <code>compile-profile</code> to the symbol <code>source</code> or to the boolean value <code>#t</code>. The profile information can be dumped via:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>profile-dump-html</code></dt>
<dd>
<p>in HTML format to allow the programmer to visualize how often each expression is executed using a color-coding system that makes it easy to spot "hot spots,"</p>
</dd>
<dt class="hdlist1"><code>profile-dump-list</code></dt>
<dd>
<p>in a form suitable for user-defined post-processing,</p>
</dd>
<dt class="hdlist1"><code>profile-dump</code></dt>
<dd>
<p>in a form suitable for off-line processing by one of the methods above or by some custom means, or</p>
</dd>
<dt class="hdlist1"><code>profile-dump-data</code></dt>
<dd>
<p>in a form suitable for loading into the compiler&#8217;s database.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>If the information is intended to be fed back into the compiler for optimization, the following additional steps are required, either in the same or a different Scheme process:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>load the profile information into the compiler&#8217;s profile database, and</p>
</li>
<li>
<p>recompile the code.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Profile information dumped by <code>profile-dump-data</code> is loaded into the compiler&#8217;s profile database via <code>profile-load-data</code>. Profiling information is <em>not</em> available to the compiler unless it is explicitly dumped via <code>profile-dump-data</code> and loaded via <code>profile-load-data</code>.</p>
</div>
<div class="paragraph">
<p>When block-profile information is to be used for optimization, the steps are similar:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>compile the code with block profiling enabled,</p>
</li>
<li>
<p>run the code to generate block-profile information,</p>
</li>
<li>
<p>dump the profile information,</p>
</li>
<li>
<p>load the profile information, and</p>
</li>
<li>
<p>recompile the code.</p>
</li>
</ul>
</div>
<div id="system:s139" class="paragraph">
<p>Block profiling is enabled by setting the parameter <code>compile-profile</code> to the symbol <code>block</code> or to the boolean value <code>#t</code>. The profile information must be dumped via <code>profile-dump-data</code> and loaded via <code>profile-load-data</code>. As with source profile information, block profile information can be loaded in the same or in a different Scheme process as the one that dumped the information.</p>
</div>
<div class="paragraph">
<p>For block optimization, the code to be recompiled must be identical. In general, this means the files involved must not have been modified, and nothing else can change that indirectly affects the code produced by the compiler, e.g., settings for compiler parameters such as <code>optimize-level</code> or the contents of configuration files read by macros at compile time. Otherwise, the set of blocks or the instructions within them might be different, in which case the block profile information will not line up properly and the compiler will raise an exception.</p>
</div>
<div class="paragraph">
<p>For the same reason, when both source profiling and block profiling information is to be used for optimization, the source information must be gathered first and loaded before both the first and second compilation runs involved in block profiling. That is, the following steps must be used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>1 compile the code with source profiling enabled,</p>
</li>
<li>
<p>2 run the code to generate source-profile information,</p>
</li>
<li>
<p>2 dump the source-profile information,</p>
</li>
<li>
<p>3 load the source-profile information,</p>
</li>
<li>
<p>3 recompile the code with block profiling enabled,</p>
</li>
<li>
<p>4 run the code to generate block-profile information,</p>
</li>
<li>
<p>4 dump the block-profile information,</p>
</li>
<li>
<p>5 load the source- and block-profile information, and</p>
</li>
<li>
<p>5 recompile the code.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The numbers labeling each step indicate both the order of the steps and those that must be performed in the same Scheme process. (All of the steps can be performed in the same Scheme process, if desired.)</p>
</div>
<div class="paragraph">
<p>Both source and block profiling are disabled when <code>compile-profile</code> is set to <code>#f</code>, its default value.</p>
</div>
<div class="paragraph">
<p>The following example highlights the use of source profiling for identifying hot spots in the code. Let&#8217;s assume that the file <code>/tmp/fatfib/fatfib.ss</code> contains the following source code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define fat+
  (lambda (x y)
    (if (zero? y)
        x
        (fat+ (1+ x) (1- y)))))

(define fatfib
  (lambda (x)
    (if (< x 2)
        1
        (fat+ (fatfib (1- x)) (fatfib (1- (1- x)))))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can load fatfib.ss with profiling enabled as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(parameterize ([compile-profile 'source])
  (load "/tmp/fatfib/fatfib.ss"))</code></pre>
</div>
</div>
<div class="paragraph">
<p>We then run the application as usual.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(fatfib 20) ⇒ 10946</code></pre>
</div>
</div>
<div class="paragraph">
<p>After the run (or multiple runs), we dump the profile information as a set of html files using <code>profile-dump-html</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(profile-dump-html)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This creates a file named profile.html containing a summary of the profile information gathered during the run. If we view this file in a browser, we should see something like the following.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/profilehtml.png" alt="profilehtml">
</div>
</div>
<div class="paragraph">
<p>The most frequently executed code is highlighted in colors closer to red in the visible spectrum, while the least frequently executed code is highlighted in colors closer to violet. Each of the entries in the lists of files and hot spots are links into additional generated files, one per source file (provided <code>profile-dump-html</code> was able to locate an unmodified copy of the source file). In this case, there is only one, fatfib.ss.html. If we move to that file, we should see something like this:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/fatfibhtml.png" alt="fatfibhtml">
</div>
</div>
<div class="paragraph">
<p>As in the summary, the code is color-coded according to frequency of execution. Hovering over a color-coded section of code should cause a pop-up box to appear with the starting position and count of the source expression. If a portion of source code is not color-coded or is identified via the starting position as having inherited its color from some enclosing expression, it may have been recognized as dead code by the compiler or garbage collector and discarded, or the expander might not have been able to track it through the macro-expansion process.</p>
</div>
<div class="paragraph">
<p><code>profile-dump</code> and <code>profile-dump-list</code> may be used to generate a list of profile entries, which may then be analyzed manually or via a custom profile-viewing application.</p>
</div>
<div id="system:s140" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>compile-profile</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When this parameter is set to the symbol <code>source</code> or the boolean value <code>#t</code>, the compiler instruments the code it generates with instructions that count the number of times each section of source code is executed. When set to the symbol <code>block</code>, the compiler similarly instruments the code it generates with instructions that count the number of times each block of code is executed. When set to <code>#f</code> (the default), the compiler does not insert these instructions.</p>
</div>
<div class="paragraph">
<p>The general description of profiling above describes how the source and block profile information can be viewed or used for optimization.</p>
</div>
<div class="paragraph">
<p>The code generated when <code>compile-profile</code> is non-false is larger and less efficient, so this parameter should be set only when profile information is needed.</p>
</div>
<div class="paragraph">
<p>The profile counters for code compiled when profile instrumentation is enabled are retained indefinitely, even if the code with which they are associated is reclaimed by the garbage collector. This results in more complete and accurate profile data but can lead to space leaks in programs that dynamically generate or load code. Such programs can avoid the potential space leak by releasing the counters explicitly via the procedure <code>profile-release-counters</code>.</p>
</div>
<div id="system:s142" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>generate-covin-files</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When this parameter is set to <code>#t</code>, the compiler generates "coverage-information" (covin) files that can be used in connection with profile information to measure coverage of a source-code base by a set of tests. One covin file is created for each object file, with the object-file extension replaced by the extension <code>.covin</code>. Each covin file contains the printed representation of a source table (<a href="#section_11.12.">Section 11.12</a>), compressed using the compression format and level specified by <code>compress-format</code> and <code>compress-level</code>. This information can be read via <code>get-source-table!</code> and used as a universe of source expressions to identify source expressions that are not evaluated during the running of a set of tests.</p>
</div>
<div id="system:s144" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(profile <em>source-object</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A <code>profile</code> form has the effect of accounting to the source position identified by <code><em>source-object</em></code> the number of times the <code>profile</code> form is executed. Profile forms are generated implicitly by the expander for source expressions in annotated input, e.g., input read by the compiler or interpreter from a Scheme source file, so this form is typically useful only when unannotated source code is produced by the front end for some language that targets Scheme.</p>
</div>
<div id="system:s145" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>(generate-profile-forms)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When this parameter is set to <code>#t</code>, the default, the expander implicitly introduces <code>profile</code> forms for each annotated input expression, unless the annotation has not been marked for use in profiling (<a href="#section_11.11.">Section 11.11</a>). It can be set to <code>#f</code> to inhibit the expander&#8217;s implicit generation of <code>profile</code> forms, typically when explicit <code>profile</code> forms are already present for all source positions that should be profiled.</p>
</div>
<div id="system:s146" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(profile-clear)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Calling this procedure causes profile information to be cleared, i.e., the counts associated with each section of code are set to zero.</p>
</div>
<div id="system:s147" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(profile-release-counters)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Calling this procedure causes profile information associated with reclaimed code objects to be dropped.</p>
</div>
<div id="system:s148" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(profile-dump)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of pairs of source-object and count</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure produces a dump of all profile information gathered since startup or the last call to <code>profile-clear</code>. It returns a list of pairs, where the car of each pair is a source object (<a href="#section_11.11.">Section 11.11</a>) and the cdr is an exact nonnegative integer count.</p>
</div>
<div class="paragraph">
<p>The list might contain more than one entry per source object due to macro expansion and procedure inlining, and it might contain more than one (non-eq) source object per file and source position due to separate compilation. In such cases, the counts are not overlapping and can be summed together to obtain the full count.</p>
</div>
<div class="paragraph">
<p>The advantage of <code>profile-dump</code> over <code>profile-dump-list</code> is that <code>profile-dump</code> performs only minimal processing and preserves complete source objects, including their embedded source-file descriptors. It might be used, for example, to dump profile information to a fasl file on one machine for subsequent processing on another.</p>
</div>
<div id="system:s149" class="paragraph">
<p><code>with-profile-tracker</code> can be used to obtain the same set of counts as a source table.</p>
</div>
<div id="system:s150" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(with-profile-tracker <em>thunk</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(with-profile-tracker <em>preserve-existing?</em> <em>thunk</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a source table and the values returned by <code><em>thunk</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>thunk</em></code> must be a procedure and should accept zero arguments. It may return any number of values.</p>
</div>
<div class="paragraph">
<p><code>with-profile-tracker</code> invokes <code><em>thunk</em></code> without arguments. If <code><em>thunk</em></code> returns <em>n</em> values <code><em>x<sub>1</sub></em>, <em>x<sub>2</sub></em>, ..., <em>x<sub>n</sub></em></code>, <code>with-profile-tracker</code> returns \(n+1\) values <code><em>st</em>, <em>x<sub>1</sub></em>, <em>x<sub>2</sub></em>, ..., <em>x<sub>n</sub></em></code>, where <code><em>st</em></code> is a source table associating source objects with profile counts. If <code><em>preserve-existing?</em></code> is absent or <code>#f</code>, each count represents the number of times the source expression represented by the associated source object is evaluated during the invocation of <code><em>thunk</em></code>. Otherwise, each count represents the number of times the source expression represented by the associated source object is evaluated before or during the invocation of <code><em>thunk</em></code>.</p>
</div>
<div class="paragraph">
<p>Profile data otherwise cleared by a call to <code>profile-clear</code> or <code>profile-release-counters</code> during the invocation of <code><em>thunk</em></code> is included in the resulting table. That is, invoking these procedures while <code><em>thunk</em></code> is running has no effect on the resulting counts. On the other hand, profile data cleared before <code>with-profile-tracker</code> is invoked is not included in the resulting table.</p>
</div>
<div class="paragraph">
<p>The idiom <code>(with-profile-tracker #t values)</code> can be used to obtain the current set of profile counts as a source table.</p>
</div>
<div id="system:s153" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(source-table-dump <em>source-table</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of pairs of source objects and their associated values in <code><em>source-table</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure can be used to convert a source-table produced by <code>with-profile-tracker</code> or some other mechanism into the form returned by <code>profile-dump</code> for use as an argument to <code>profile-dump-html</code>, <code>profile-dump-list</code>, or <code>profile-dump-data</code>.</p>
</div>
<div id="system:s159" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(profile-dump-html)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(profile-dump-html <em>prefix</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(profile-dump-html <em>prefix</em> <em>dump</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure produces one or more HTML files, including profile.html, which contains color-coded summary information, and one file <code><em>source</em></code>.html for each source file <code><em>source</em></code> containing a color-coded copy of the source code, as described in the lead-in to this section. If <code><em>prefix</em></code> is specified, it must be a string and is prepended to the names of the generated HTML files. For example, if <code><em>prefix</em></code> is <code>"/tmp/"</code>, the generated files are placed in the directory /tmp. The raw profile information is obtained from <code><em>dump</em></code>, which defaults to the value returned by <code>profile-dump</code>.</p>
</div>
<div id="system:s160" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>(profile-palette)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This value of this parameter must be a nonempty vector of at least three pairs. The car of each pair is a background color and the cdr is a foreground (text) color. Each color must be a string, and each string should contain an HTML cascading style sheet (CSS) color specifier. The first pair is used for unprofiled code, and the second is used for unexecuted profiled code. The third is used for code that is executed least frequently, the fourth for code executed next-least frequently, and so on, with the last being used for code that is executed most frequently. Programmers may wish to supply their own palette to enhance visibility or to change the number of colors used.</p>
</div>
<div class="paragraph">
<p>By default, a black background is used for unprofiled code, and a gray background is used for unexecuted profiled code. Background colors ranging from purple to red are used for executed profiled code, depending on frequency of execution, with red for the most frequently executed code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(profile-palette) ⇒
  #(("#111111" . "white") ("#607D8B" . "white")
    ("#9C27B0" . "black") ("#673AB7" . "white")
    ("#3F51B5" . "white") ("#2196F3" . "black")
    ("#00BCD4" . "black") ("#4CAF50" . "black")
    ("#CDDC39" . "black") ("#FFEB3B" . "black")
    ("#FFC107" . "black") ("#FF9800" . "black")
    ("#F44336" . "white"))
(profile-palette
 ; set palette with rainbow colors and black text
 ; for all but unprofiled or unexecuted code
  '#(("#000000" . "white")    ; black
     ("#666666" . "white")    ; gray
     ("#8B00FF" . "black")    ; violet
     ("#6600FF" . "black")    ; indigo
     ("#0000FF" . "black")    ; blue
     ("#00FF00" . "black")    ; green
     ("#FFFF00" . "black")    ; yellow
     ("#FF7F00" . "black")    ; orange
     ("#FF0000" . "black")))  ; red</code></pre>
</div>
</div>
<div id="system:s161" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>(profile-line-number-color)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This value of this parameter must be a string or <code>#f</code>. If it is a string, the string should contain an HTML cascading style sheet (CSS) color specifier. If the parameter is set to a string, <code>profile-dump-html</code> includes line numbers in its html rendering of each source file, using the specified color. If the parameter is set to <code>#f</code>, no line numbers are included.</p>
</div>
<div id="system:s162" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(profile-dump-list)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(profile-dump-list <em>warn?</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(profile-dump-list <em>warn?</em> <em>dump</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a list of profile entries (see below)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure produces a dump of all profile information present in <code><em>dump</em></code>, which defaults to the value returned by <code>profile-dump</code>. It returns a list of entries, each of which is itself a list containing the following elements identifying one block of code and how many times it has been executed.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>execution count</p>
</li>
<li>
<p>pathname</p>
</li>
<li>
<p>beginning file position in characters (inclusive)</p>
</li>
<li>
<p>ending file position in characters (exclusive)</p>
</li>
<li>
<p>line number of beginning file position</p>
</li>
<li>
<p>character position of beginning file position</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>profile-dump-list</code> may be unable to locate an unmodified copy of the file in the current source directories or at the absolute address, if an absolute address was used when the file was compiled or loaded. If this happens, the line number and character position of the beginning file position are <code>#f</code> and the pathname is the pathname originally used. A warning is also issued (an exception with condition type <code>&amp;warning</code> is raised) unless the <code>warn?</code> argument is provided and is false.</p>
</div>
<div class="paragraph">
<p>Otherwise, the pathname is the path to an unmodified copy of the source and the line and character positions are set to exact nonnegative integers.</p>
</div>
<div class="paragraph">
<p>In either case, the execution count, beginning file position, and ending file position are all exact nonnegative integers, and the pathname is a string.</p>
</div>
<div class="paragraph">
<p>For source positions in files that cannot be found, the list might contain more than one entry per position due to macro expansion, procedure inlining, and separate compilation. In such cases, the counts are not overlapping and can be summed together to obtain the full count.</p>
</div>
<div class="paragraph">
<p>The information returned by <code>profile-dump-list</code> can be used to implement a custom viewer or used as input for offline analysis of profile information.</p>
</div>
<div class="paragraph">
<p>The advantage of <code>profile-dump-list</code> over <code>profile-dump</code> is that it attempts to determine the line number and character position for each source point and, if successful, aggregates multiple counts for the source point into a single entry.</p>
</div>
<div id="system:s163" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(profile-dump-data <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(profile-dump-data <em>path</em> <em>dump</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string.</p>
</div>
<div class="paragraph">
<p>This procedure writes, in a machine-readable form consumable by <code>profile-load-data</code>, profile counts represented by <code><em>dump</em></code> to the file named by <code><em>path</em></code>, replacing the file if it already exists. <code><em>dump</em></code> defaults to the value returned by <code>profile-dump</code>.</p>
</div>
<div id="system:s164" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(profile-load-data <em>path</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each <code><em>path</em></code> must be a string.</p>
</div>
<div class="paragraph">
<p>This procedure reads profile information from the files named by <code><em>path</em> ...</code> and stores it in the compiler&#8217;s internal database of profile information. The contents of the files must have been created originally by <code>profile-dump-data</code> using the same version of <em>Chez Scheme</em>.</p>
</div>
<div class="paragraph">
<p>The database stores a weight for each source expression or block rather than the actual count. When a single file is loaded into the database, the weight is the proportion of the actual count over the maximum count for all expressions or blocks represented in the file. When more than one file is loaded, either by one or multiple calls to <code>profile-load-data</code>, the weights are averaged.</p>
</div>
<div id="system:s165" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(profile-query-weight <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code><em>obj</em></code>'s profile weight, or <code>#f</code> if <code><em>obj</em></code> is not in the database</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The compiler&#8217;s profile database maps source objects (<a href="#section_11.11.">Section 11.11</a>) to weights. If <code><em>obj</em></code> is a source object, the <code>profile-query-weight</code> returns the weight associated with the source object or <code>#f</code> if the database does not have a weight recorded for the source object. <code><em>obj</em></code> can also be an annotation or syntax object, in which case <code>profile-query-weight</code> first extracts the source object, if any, using <code>syntax-&gt;annotation</code> and <code>annotation-source</code>, returning <code>#f</code> if no source-object is found.</p>
</div>
<div class="paragraph">
<p>A weight is a flonum in the range 0.0 to 1.0, inclusive, and denotes the ratio of the actual count to the maximum count as described in the description of <code>profile-load-data</code>.</p>
</div>
<div class="paragraph">
<p><code>profile-query-weight</code> can be used by a macro to determine the relative frequency with which its subexpressions were executed in the run or runs that generated the information in the database. This information can be used to guide the generation of code that is likely to be more efficient. For example, the <code>case</code> macro uses profile information, when available, to order the clauses so that those whose keys matched more frequently are tested before those whose keys matched less frequently.</p>
</div>
<div id="system:s166" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(profile-clear-database)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure clears the compiler&#8217;s profile database. It has no impact on the counts associated with individual sections of instrumented code; <code>profile-clear</code> can be used to reset those counts.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_12.8.">Section 12.8. Waiter Customization</h3>
<div id="system:s167" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(new-cafe)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(new-cafe <em>eval-proc</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="system:s169" class="paragraph">
<p><em>Chez Scheme</em> interacts with the user through a <em>waiter</em>, or read-eval-print loop (REPL). The waiter operates within a context called a <em>café</em>. When the system starts up, the user is placed in a café and given a waiter. <code>new-cafe</code> opens a new Scheme café, stacked on top of the old one. In addition to starting the waiter, <code>new-cafe</code> sets up the café&#8217;s reset and exit handlers (see <code>reset-handler</code> and <code>exit-handler</code>). Exiting a café resumes the continuation of the call to <code>new-cafe</code> that created the café. Exiting from the initial café leaves Scheme altogether. A café may be exited from either by an explicit call to <code>exit</code> or by receipt of end-of-file ("control-D" on Unix systems) in response to the waiter&#8217;s prompt. In the former case, any values passed to <code>exit</code> are returned from <code>new-cafe</code>.</p>
</div>
<div class="paragraph">
<p>If the optional <code><em>eval-proc</em></code> argument is specified, <code><em>eval-proc</em></code> is used to evaluate forms entered from the console. Otherwise, the value of the parameter <code>current-eval</code> is used. <code><em>eval-proc</em></code> must accept one argument, the expression to evaluate.</p>
</div>
<div class="paragraph">
<p>Interesting values for <code><em>eval-proc</em></code> include <code>expand</code>, which causes the macro expanded value of each expression entered to be printed and <code>(lambda (x) x)</code>, which simply causes each expression entered to be printed. An arbitrary procedure of one argument may be used to facilitate testing of a program on a series of input values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (new-cafe (lambda (x) x))
>> 3
3
>> (a . (b . (c . ())))
(a b c)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define sum
  (lambda (ls)
    (if (null? ls)
        0
        (+ (car ls) (sum (cdr ls))))))
> (new-cafe sum)
>> (1 2 3)
6</code></pre>
</div>
</div>
<div class="paragraph">
<p>The default waiter reader (see <code>waiter-prompt-and-read</code>) displays the current waiter prompt (see <code>waiter-prompt-string</code>) to the current value of <code>console-output-port</code> and reads from the current value of <code>console-input-port</code>. The default waiter printer (see <code>waiter-write</code>) sends output to the current value of <code>console-output-port</code>. These parameters, along with <code>current-eval</code>, can be modified to change the behavior of the waiter.</p>
</div>
<div id="system:s174" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>waiter-prompt-string</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of <code>waiter-prompt-string</code> must be a string. It is used by the default waiter prompter (see the parameter <code>waiter-prompt-and-read</code>) to print a prompt. Nested cafés are marked by repeating the prompt string once for each nesting level.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (waiter-prompt-string)
">"
> (waiter-prompt-string "%")
% (waiter-prompt-string)
"%"
% (new-cafe)
%% (waiter-prompt-string)
"%"</code></pre>
</div>
</div>
<div id="system:s175" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>waiter-prompt-and-read</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>waiter-prompt-and-read</code> must be set to a procedure. It is used by the waiter to print a prompt and read an expression. The value of <code>waiter-prompt-and-read</code> is called by the waiter with a positive integer that indicates the café nesting level. It should return an expression to be evaluated by the current evaluator (see <code>new-cafe</code> and <code>current-eval</code>).</p>
</div>
<div id="system:s176" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(default-prompt-and-read <em>level</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>level</em></code> must be a positive integer indicating the cafeé nesting level as described above.</p>
</div>
<div class="paragraph">
<p>This procedure is the default value of the <code>waiter-prompt-and-read</code> parameter whenever the expression editor (<a href="#section_2.2.">Section 2.2</a>, <a href="#chp_14">Chapter 14</a>) is <em>not</em> enabled. It might be defined as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define default-prompt-and-read
  (lambda (n)
    (unless (and (integer? n) (>= n 0))
       (assertion-violationf 'default-prompt-and-read
         "~s is not a nonnegative integer"
         n))
    (let ([prompt (waiter-prompt-string)])
      (unless (string=? prompt "")
        (do ([n n (- n 1)])
            ((= n 0)
             (write-char #\space (console-output-port))
             (flush-output-port (console-output-port)))
            (display prompt (console-output-port))))
      (let ([x (read (console-input-port))])
         (when (and (eof-object? x) (not (string=? prompt "")))
            (newline (console-output-port))
            (flush-output-port (console-output-port)))
         x))))</code></pre>
</div>
</div>
<div id="system:s177" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>waiter-write</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of <code>waiter-write</code> must be a procedure. The waiter uses the value of <code>waiter-write</code> to print the results of each expression read and evaluated by the waiter. The following example installs a procedure equivalent to the default <code>waiter-write</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(waiter-write
  (lambda (x)
    (unless (eq? x (void))
      (pretty-print x (console-output-port)))
    (flush-output-port (console-output-port))))</code></pre>
</div>
</div>
<div id="system:s178" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(reset)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>does not return</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>reset</code> invokes the current reset handler (see <code>reset-handler</code>) without arguments.</p>
</div>
<div id="system:s179" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>reset-handler</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of this parameter must be a procedure and should accept zero arguments. The current reset handler is called by <code>reset</code>. The default reset handler resets to the current café.</p>
</div>
<div id="system:s180" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(exit <em>obj</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>does not return</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>exit</code> invokes the current exit handler (see <code>exit-handler</code>), passing along its arguments, if any.</p>
</div>
<div id="system:s181" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>exit-handler</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of this parameter must be a procedure and should accept any number of arguments. The current exit handler is called by <code>exit</code>.</p>
</div>
<div class="paragraph">
<p>The default exit handler exits from the current café, returning its arguments as the values of the call to <code>new-cafe</code> that created the current café. If the current café is the original café, or if <code>exit</code> is called from a script, <code>exit</code> exits from Scheme. In this case, the exit code for the Scheme process is 0 if no arguments were supplied or if the first argument is void, the value of the first argument cast to a C int if it is an exact integer of the host machine&#8217;s bit width, and 1 otherwise.</p>
</div>
<div id="system:s182" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(abort)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(abort <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>does not return</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>abort</code> invokes the current abort handler (see <code>abort-handler</code>), passing along its argument, if any.</p>
</div>
<div id="system:s183" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>abort-handler</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of this parameter must be a procedure and should accept either zero arguments or one argument. The current abort handler is called by <code>abort</code>.</p>
</div>
<div class="paragraph">
<p>The default abort handler exits the Scheme process. The exit code for the Scheme process is -1 if no arguments were supplied, 0 if the first argument is void, the value of the first argument if it is a 32-bit exact integer, and -1 otherwise.</p>
</div>
<div id="system:s184" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>scheme-start</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of <code>scheme-start</code> is a procedure that determines the system&#8217;s action upon start-up. The procedure receives zero or more arguments, which are strings representing the file names (or command-line arguments not recognized by the Scheme executable) after given on the command line. The default value first loads the files named by the arguments, then starts up the initial café:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(lambda fns
  (for-each load fns)
  (new-cafe))</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>scheme-start</code> may be altered to start up an application or to perform customization prior to normal system start-up.</p>
</div>
<div class="paragraph">
<p>To have any effect, this parameter must be set within a boot file. (See <a href="#chp_2">Chapter 2</a>.)</p>
</div>
<div id="system:s185" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>scheme-script</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of <code>scheme-script</code> is a procedure that determines the system&#8217;s action upon start-up, when the <code>--script</code> option is used. The procedure receives one or more arguments. The first is a string identifying the script filename and the remainder are strings representing the remaining file names (or command-line arguments not recognized by the Scheme executable) given on the command line. The default value of this parameter is a procedure that sets the <code>command-line</code> and <code>command-line-arguments</code> parameters, loads the script using <code>load</code>, and returns void, which is translated into a 0 exit status for the script process.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(lambda (fn . fns)
  (command-line (cons fn fns))
  (command-line-arguments fns)
  (load fn))</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>scheme-script</code> may be altered to start up an application or to perform customization prior to normal system start-up.</p>
</div>
<div class="paragraph">
<p>To have any effect, this parameter must be set within a boot file. (See <a href="#chp_2">Chapter 2</a>.)</p>
</div>
<div id="system:s189" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>scheme-program</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of <code>scheme-program</code> is a procedure that determines the system&#8217;s action upon start-up when the <code>--program</code> (RNRS top-level program) option is used. The procedure receives one or more arguments. The first is a string identifying the program filename and the remainder are strings representing the remaining file names (or command-line arguments not recognized by the Scheme executable) given on the command line. The default value of this parameter is a procedure that sets the <code>command-line</code> and <code>command-line-arguments</code> parameters, loads the program using <code>load-program</code>, and returns void, which is translated into a 0 exit status for the script process.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(lambda (fn . fns)
  (command-line (cons fn fns))
  (command-line-arguments fns)
  (load-program fn))</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>scheme-program</code> may be altered to start up an application or to perform customization prior to normal system start-up.</p>
</div>
<div class="paragraph">
<p>To have any effect, this parameter must be set within a boot file. (See <a href="#chp_2">Chapter 2</a>.)</p>
</div>
<div id="system:s193" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>command-line</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="system:s194" class="paragraph">
<p>This parameter is set by the default values of <code>scheme-script</code> and <code>scheme-program</code> to a list representing the command line, with the script name followed by the command-line arguments, when the <code>--script</code> or <code>--program</code> option is used on system startup.</p>
</div>
<div id="system:s195" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>command-line-arguments</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="system:s196" class="paragraph">
<p>This parameter is set by the default values of <code>scheme-script</code> and <code>scheme-program</code> to a list of the command-line arguments when the <code>--script</code> or <code>--program</code> option is used on system startup.</p>
</div>
<div id="system:s197" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>suppress-greeting</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of <code>suppress-greeting</code> is a boolean value that determines whether <em>Chez Scheme</em> prints an identifying banner and copyright notice. The parameter defaults to <code>#f</code> but may be set to <code>#t</code> for use in batch processing applications where the banner would be disruptive.</p>
</div>
<div class="paragraph">
<p>To have any effect, this parameter must be set within a boot file. (See <a href="#chp_2">Chapter 2</a>.)</p>
</div>
</div>
<div class="sect2">
<h3 id="section_12.9.">Section 12.9. Transcript Files</h3>
<div class="paragraph">
<p>A transcript file is a record of an interactive session. It is also useful as a "quick-and-dirty" alternative to opening an output file and using explicit output operations. <a id="system:s199"></a></p>
</div>
<div id="desc:transcript-on" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(transcript-on <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string.</p>
</div>
<div class="paragraph">
<p><code>transcript-on</code> opens the file named by <code><em>path</em></code> for output, and it copies to this file all input from the current input port and all output to the current output port. An exception is raised with condition-type <code>i/o-filename</code> if the file cannot be opened for output.</p>
</div>
<div id="system:s200" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(transcript-off)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>transcript-off</code> ends transcription and closes the transcript file.</p>
</div>
<div id="system:s201" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(transcript-cafe <em>path</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>path</em></code> must be a string. <code>transcript-cafe</code> opens a transcript file as with <code>transcript-on</code> and enters a new café; exiting from this café (see <code>exit</code>) also ends transcription and closes the transcript file. Invoking <code>transcript-off</code> while in a transcript café ends transcription and closes the transcript file but does not cause an exit from the café.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_12.10.">Section 12.10. Times and Dates</h3>
<div class="paragraph">
<p>This section documents procedures for handling times and dates. Most of the procedures described here are proposed in <a href="http://srfi.schemers.org/srfi-19/srfi-19.html">SRFI 19</a>: Time Data Types and Procedures, by Will Fitzgerald.</p>
</div>
<div class="paragraph">
<p>Times are represented by time objects. Time objects record the nanosecond and second of a particular time or duration, along with a <em>time type</em> that identifies the nature of the time object. The time type is one of the following symbols:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>time-utc</code></dt>
<dd>
<p>The time elapsed since the "epoch:" 00:00:00 UTC, January 1, 1970, subject to adjustment, e.g., to correct for leap seconds.</p>
</dd>
<dt class="hdlist1"><code>time-monotonic</code></dt>
<dd>
<p>The time elapsed since some arbitrary point in the past, ideally not subject to adjustment.</p>
</dd>
<dt class="hdlist1"><code>time-duration</code></dt>
<dd>
<p>The time elapsed between two times. When used as an argument to <code>current-time</code>, it behaves like <code>time-monotonic</code>, but may also used to represent the result of subtracting two time objects.</p>
</dd>
<dt class="hdlist1"><code>time-process</code></dt>
<dd>
<p>The amount of CPU time used by the current process.</p>
</dd>
<dt class="hdlist1"><code>time-thread</code></dt>
<dd>
<p>The amount of CPU time used by the current thread. It is the same as <code>time-process</code> if not running threaded or if the system does not allow individual thread times to be determined.</p>
</dd>
<dt class="hdlist1"><code>time-collector-cpu</code></dt>
<dd>
<p>The portion of the current process&#8217;s CPU time consumed by the garbage collector.</p>
</dd>
<dt class="hdlist1"><code>time-collector-real</code></dt>
<dd>
<p>The portion of the current process&#8217;s real time consumed by the garbage collector.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>A time-object second is an exact integer (possibly negative), and a nanosecond is an exact nonnegative integer less than 10<sup>9</sup>. The second and nanosecond of a time object may be converted to an aggregate nanosecond value by scaling the seconds by 10<sup>9</sup> and adding the nanoseconds. Thus, if the second and nanosecond of a time object are 5 and 10, the time object represents 5000000010 nanoseconds (5.000000010 seconds). If the second and nanosecond are -5 and 10, the time object represents -4999999990 nanoseconds (-4.999999990 seconds).</p>
</div>
<div class="paragraph">
<p>Dates are represented by date objects. A date object records the nanosecond, second, minute, hour, day, month, and year of a particular date, along with an offset that identifies the time zone.</p>
</div>
<div class="paragraph">
<p>As for time objects, a nanosecond is an exact integer less than 10<sup>9</sup>. A date-object second is, however, an exact nonnegative integer less than 62. (The values 61 and 62 allow for leap seconds.) A minute is an exact nonnegative integer less than 60, and an hour is an exact nonnegative integer less than 24. A day is an exact nonnegative integer in ranging from 1 representing the first day of the month to <em>n</em>, where <em>n</em> is the number of days in the date&#8217;s month and year. A month is an exact nonnegative integer ranging from 1 through 12, where 1 represents January, 2 represents February, and so on. A year must be an exact integer. Years less than 1970 or greater than 2038 may not be supported depending on limitations of the underlying implementation. A time-zone offset represents the time-zone offset, in seconds, from UTC. It is an exact integer in the range -86400 to +86400, inclusive. For example, Eastern Standard Time (EST), which is 5 hours east, has offset 5 × 3600 = -18000. The offset for Eastern Daylight Time (EDT) is -14400. UTC is represented by offset zero.</p>
</div>
<div id="system:s202" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(current-time)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(current-time <em>time-type</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a time object representing the current time</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>time-type</em></code> must be one of the time-type symbols listed above and defaults to <code>time-utc</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(current-time) ⇒ #&lt;time-utc 1198815722.473668000&gt;
(current-time 'time-process) ⇒ #&lt;time-process 0.120534264&gt;</code></pre>
</div>
</div>
<div id="system:s203" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-time <em>type</em> <em>nsec</em> <em>sec</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a time object</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>type</em></code> must be one of the time-type symbols listed above. <code><em>nsec</em></code> represents nanoseconds and must be an exact nonnegative integer less than 10<sup>9</sup>. <code><em>sec</em></code> represents seconds and must be an exact integer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(make-time 'time-utc 787511000 1198783214)
(make-time 'time-duration 10 5)
(make-time 'time-duration 10 -5)</code></pre>
</div>
</div>
<div id="system:s204" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(time? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a time object, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(time? (current-time)) ⇒ #t
(time? (make-time 'time-utc 0 0)) ⇒ #t
(time? "1400 hours") ⇒ #f</code></pre>
</div>
</div>
<div id="system:s205" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(time-type <em>time</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the time type of <code><em>time</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(time-nanosecond <em>time</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the nanosecond of <code><em>time</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(time-second <em>time</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the second of <code><em>time</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>time</em></code> must be a time object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(time-type (current-time)) ⇒ time-utc
(time-type (current-time 'time-process)) ⇒ time-process
(time-type (make-time 'time-duration 0 50)) ⇒ time-duration
(time-second (current-time)) ⇒ 1198816497
(time-nanosecond (current-time)) ⇒ 2399000
(time-second (make-time 'time-duration 10 -5)) ⇒ -5
(time-nanosecond (make-time 'time-duration 10 -5)) ⇒ 10</code></pre>
</div>
</div>
<div id="system:s206" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-time-type! <em>time</em> <em>type</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-time-nanosecond! <em>time</em> <em>nsec</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-time-second! <em>time</em> <em>sec</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>time</em></code> must be a time object. <code><em>type</em></code> must be one of the time-type symbols listed above. <code><em>nsec</em></code> represents nanoseconds and must be an exact nonnegative integer less than 10<sup>9</sup>. <code><em>sec</em></code> represents seconds and must be an exact integer.</p>
</div>
<div class="paragraph">
<p>Each of these procedures modifies the time object, changing one aspect while leaving the others unaffected. For example, <code>set-time-nanosecond!</code> changes the nanosecond of <code><em>time</em></code> without changing the second or type. In particular, no conversion of values is performed when the type of a time object is changed.</p>
</div>
<div id="system:s207" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(time=? <em>time<sub>1</sub></em> <em>time<sub>2</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(time&lt;? <em>time<sub>1</sub></em> <em>time<sub>2</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(time&lt;=? <em>time<sub>1</sub></em> <em>time<sub>2</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(time&gt;=? <em>time<sub>1</sub></em> <em>time<sub>2</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(time&gt;? <em>time<sub>1</sub></em> <em>time<sub>2</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the relation holds, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>time<sub>1</sub></em></code> and <code><em>time<sub>2</sub></em></code> must be time objects and must have the same type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([t (current-time)])
  (time=? t t)) ⇒ #t
(let ([t (current-time)])
  (let loop ()
    (when (time=? (current-time) t))
      (loop))
  (time>? (current-time) t)) ⇒ #t</code></pre>
</div>
</div>
<div id="system:s208" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(copy-time <em>time</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a copy of <code><em>time</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define t1 (current-time))
(define t2 (copy-time t1))
(eq? t2 t1) ⇒ #f
(eqv? (time-second t2) (time-second t1)) ⇒ #t
(eqv? (time-nanosecond t2) (time-nanosecond t1)) ⇒ #t</code></pre>
</div>
</div>
<div id="system:s209" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(time-difference <em>time<sub>1</sub></em> <em>time<sub>2</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the result of subtracting <code><em>time<sub>2</sub></em></code> from <code><em>time<sub>1</sub></em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(time-difference! <em>time<sub>1</sub></em> <em>time<sub>2</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the result of subtracting <code><em>time<sub>2</sub></em></code> from <code><em>time<sub>1</sub></em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(add-duration <em>time</em> <em>time<sub>d</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the result of adding <code><em>time<sub>d</sub></em></code> to <code>time</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(add-duration! <em>time</em> <em>time<sub>d</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the result of adding <code><em>time<sub>d</sub></em></code> to <code>time</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(subtract-duration <em>time</em> <em>time<sub>d</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the result of subtracting <code><em>time<sub>d</sub></em></code> from <code>time</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(subtract-duration! <em>time</em> <em>time<sub>d</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the result of subtracting <code><em>time<sub>d</sub></em></code> from <code>time</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For <code>time-difference</code>, <code><em>time<sub>1</sub></em></code> and <code><em>time<sub>2</sub></em></code> must have the same time type, and the result is a time object with time type <code>time-duration</code>. For <code>add-duration</code>, <code>add-duration!</code>, <code>subtract-duration</code>, and <code>subtract-duration!</code>, <code><em>time<sub>d</sub></em></code> must have time type <code>time-duration</code>, and the result is a time object with the same time type as <code><em>time</em></code>. <code>time-difference!</code>, <code>add-duration!</code>, and <code>subtract-duration!</code> are potentially destructive, i.e., each might modify and return its first argument, or it might allocate a new time object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([delay (make-time 'time-duration 0 1)])
  (let ([t1 (current-time 'time-monotonic)])
    (sleep delay)
    (let ([t2 (current-time 'time-monotonic)])
      (let ([t3 (time-difference t2 t1)])
        (and
          (eq? (time-type t3) 'time-duration)
          (time>=? t3 delay)
          (time=? (add-duration t1 t3) t2)
          (time=? (subtract-duration t2 t3) t1)))))) ⇒ #t</code></pre>
</div>
</div>
<div id="system:s210" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(current-date)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(current-date <em>offset</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a date object representing the current date</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>offset</em></code> represents the time-zone offset in seconds east of UTC, as described above. It must be an exact integer in the range -86400 to +86400, inclusive and defaults to the local time-zone offset. UTC may be obtained by passing an offset of zero.</p>
</div>
<div class="paragraph">
<p>If <code><em>offset</em></code> is not provided, then the current time zone&#8217;s offset is used, and <code>date-dst?</code> and <code>date-zone-name</code> report information about the time zone. If <code><em>offset</em></code> is provided, then <code>date-dst?</code> and <code>date-zone-name</code> on the resulting date object produce <code>#f</code>.</p>
</div>
<div class="paragraph">
<p>The following examples assume the local time zone is EST.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(current-date) ⇒ #&lt;date Thu Dec 27 23:23:20 2007&gt;
(current-date 0) ⇒ #&lt;date Fri Dec 28 04:23:20 2007&gt;

(date-zone-name (current-date)) ⇒ "EST" <em>or other system-provided string</em>
(date-zone-name (current-date 0)) ⇒ #f</code></pre>
</div>
</div>
<div id="system:s211" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-date <em>nsec</em> <em>sec</em> <em>min</em> <em>hour</em> <em>day</em> <em>mon</em> <em>year</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-date <em>nsec</em> <em>sec</em> <em>min</em> <em>hour</em> <em>day</em> <em>mon</em> <em>year</em> <em>offset</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a date object</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>nsec</em></code> represents nanoseconds and must be an exact nonnegative integer less than 10<sup>9</sup>. <code><em>sec</em></code> represents seconds and must be an exact nonnegative integer less than 62. <code><em>min</em></code> represents minutes and must be an exact nonnegative integer less than 60. <code><em>hour</em></code> must be an exact nonnegative integer less than 24. <code><em>day</em></code> must be an exact integer, 1 ≤ <em>day</em> ≤ 31. (The actual upper limit may be less depending on the month and year.) <code><em>mon</em></code> represents the month must be an exact integer, 1 ≤ <em>mon</em> ≤ 12. <code><em>year</em></code> must be an exact integer. It should be at least 1970. <code><em>offset</em></code> represents the time-zone offset in seconds east of UTC, as described above. It must be an exact integer in the range -86400 to +86400, inclusive. UTC may be specified by passing an offset of zero.</p>
</div>
<div class="paragraph">
<p>If <code><em>offset</em></code> is not provided, then the current time zone&#8217;s offset is used, and <code>date-dst?</code> and <code>date-zone-name</code> report information about the time zone. If <code><em>offset</em></code> is provided, then <code>date-dst?</code> and <code>date-zone-name</code> on the resulting date object produce <code>#f</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(make-date 0 0 0 0 1 1 1970 0) ⇒ #&lt;date Thu Jan  1 00:00:00 1970&gt;
(make-date 0 30 7 9 23 9 2007 -14400) ⇒ #&lt;date Sun Sep 23 09:07:30 2007&gt;

(date-zone-name (make-date 0 30 7 9 23 9 2007 -14400)) ⇒ #f
(string? (date-zone-name (make-date 0 30 7 9 23 9 2007))) ⇒ #t</code></pre>
</div>
</div>
<div id="system:s212" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(date? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a date object, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(date? (current-date))
(date? (make-date 0 30 7 9 23 9 2007 -14400))
(date? "Sun Sep 23 09:07:30 2007") ⇒ #f</code></pre>
</div>
</div>
<div id="system:s213" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(date-nanosecond <em>date</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the nanosecond of <code><em>date</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(date-second <em>date</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the second of <code><em>date</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(date-minute <em>date</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the minute of <code><em>date</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(date-hour <em>date</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the hour of <code><em>date</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(date-day <em>date</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the day of <code><em>date</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(date-month <em>date</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the month of <code><em>date</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(date-year <em>date</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the year of <code><em>date</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(date-zone-offset <em>date</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the time-zone offset of <code><em>date</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>date</em></code> must be a date object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define d (make-date 0 30 7 9 23 9 2007 -14400))
(date-nanosecond d) ⇒ 0
(date-second d) ⇒ 30
(date-minute d) ⇒ 7
(date-hour d) ⇒ 9
(date-day d) ⇒ 23
(date-month d) ⇒ 9
(date-year d) ⇒ 2007
(date-zone-offset d) ⇒ -14400</code></pre>
</div>
</div>
<div id="system:s214" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(date-week-day <em>date</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the week-day of <code><em>date</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(date-year-day <em>date</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the year-day of <code><em>date</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These procedures allow the day-of-week or day-of-year to be determined for the date represented by <code><em>date</em></code>. A week-day is an exact nonnegative integer less than 7, where 0 represents Sunday, 1 represents Monday, and so on. A year-day is an exact nonnegative integer less than 367, where 0 represents the first day of the year (January 1), 1 the second day, 2 the third, and so on.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define d1 (make-date 0 0 0 0 1 1 1970 -18000))
d1 ⇒ #&lt;date Thu Jan  1 00:00:00 1970&gt;
(date-week-day d1) ⇒ 4
(date-year-day d1) ⇒ 0

(define d2 (make-date 0 30 7 9 23 9 2007 -14400))
d2 ⇒ #&lt;date Sun Sep 23 09:07:30 2007&gt;
(date-week-day d2) ⇒ 0
(date-year-day d2) ⇒ 265</code></pre>
</div>
</div>
<div id="system:s215" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(date-dst? <em>date</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>whether <code><em>date</em></code> is in Daylight Saving Time</p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(date-zone-name <em>date</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#f</code> or a string naming the time zone of <code><em>date</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These procedures report time-zone information for the date represented by <code><em>date</em></code> for a date object that is constructed without an explicit time-zone offset. When a date object is created instead with explicit time-zone offset, these procedures produce <code>#f</code>.</p>
</div>
<div class="paragraph">
<p>Daylight Saving Time status for the current time zone and a name string for the time zone are computed using platform-specific routines. In particular, the format of the zone name is platform-specific.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define d (make-date 0 30 7 9 23 9 2007))
(date-zone-offset d) ⇒ -14400 <em>assuming Eastern U.S. time zone</em>
(date-dst? d) ⇒ #t
(date-zone-name d) ⇒ "EDT" <em>or some system-provided string</em></code></pre>
</div>
</div>
<div id="system:s216" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(time-utc-&gt;date <em>time</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(time-utc-&gt;date <em>time</em> <em>offset</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a date object corresponding to <code><em>time</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(date-&gt;time-utc <em>date</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a time object corresponding to <code><em>date</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These procedures are used to convert between time and date objects. The <code><em>time</em></code> argument to <code>time-utc-&gt;date</code> must have time-type <code>utc</code>, and <code>date-&gt;time-utc</code> always returns a time object with time-type <code>utc</code>.</p>
</div>
<div class="paragraph">
<p>For <code>time-utc-&gt;date</code>, <code><em>offset</em></code> represents the time-zone offset in seconds east of UTC, as described at the beginning of this section. It must be an exact integer in the range -86400 to +86400, inclusive and defaults to the local time-zone offset. UTC may be obtained by passing an offset of zero.</p>
</div>
<div class="paragraph">
<p>If <code><em>offset</em></code> is not provided to <code>time-utc-&gt;date</code>, then the current time zone&#8217;s offset is used, and <code>date-dst?</code> and <code>date-zone-name</code> report information about the time zone. If <code><em>offset</em></code> is provided, then <code>date-dst?</code> and <code>date-zone-name</code> on the resulting date object produce <code>#f</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define d (make-date 0 30 7 9 23 9 2007 -14400))
(date->time-utc d) ⇒ #&lt;time-utc 1190552850.000000000&gt;
(define t (make-time 'time-utc 0 1190552850))
(time-utc->date t) ⇒ #&lt;date Sun Sep 23 09:07:30 2007&gt;
(time-utc->date t 0) ⇒ #&lt;date Sun Sep 23 13:07:30 2007&gt;</code></pre>
</div>
</div>
<div id="system:s217" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(date-and-time)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(date-and-time <em>date</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a string giving the current date and time</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The string is always in the format illustrated by the examples below and always has length 24.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(date-and-time) ⇒ "Fri Jul 13 13:13:13 2001"
(define d (make-date 0 0 0 0 1 1 2007 0))
(date-and-time d) ⇒ "Mon Jan 01 00:00:00 2007"</code></pre>
</div>
</div>
<div id="system:s218" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(sleep <em>time</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>time</em></code> must be a time object with type <code>time-duration</code>. <code><em>sleep</em></code> causes the invoking thread to suspend operation for approximately the amount of time indicated by the time object, unless the process receives a signal that interrupts the sleep operation. The actual time slept depends on the granularity of the system clock and how busy the system is running other threads and processes.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_12.11.">Section 12.11. Timing and Statistics</h3>
<div class="paragraph">
<p>This section documents procedures for timing computations. The <code>current-time</code> procedure described in <a href="#section_12.10.">Section 12.10</a> may also be used to time computations.</p>
</div>
<div id="system:s219" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(time <em>expr</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the values of <code><em>expr</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>time</code> evaluates <code><em>expr</em></code> and, as a side-effect, prints (to the console-output port) the amount of cpu time, the amount of real time, the number of bytes allocated, and the amount of collection overhead associated with evaluating <code><em>expr</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (time (collect))
(time (collect))
    1 collection
    1 ms elapsed cpu time, including 1 ms collecting
    1 ms elapsed real time, including 1 ms collecting
    160 bytes allocated, including 8184 bytes reclaimed</code></pre>
</div>
</div>
<div id="system:s220" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(display-statistics)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(display-statistics <em>textual-output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure displays a running total of the amount of cpu time, real time, bytes allocated, and collection overhead. If <code><em>textual-output-port</em></code> is not supplied, it defaults to the current output port.</p>
</div>
<div id="system:s221" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(cpu-time)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the amount of cpu time consumed since system start-up</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The amount is in milliseconds. The amount includes "system" as well as "user" time, i.e., time spent in the kernel on behalf of the process as well as time spent in the process itself.</p>
</div>
<div class="paragraph">
<p>See also <code>current-time</code>, which returns more precise information.</p>
</div>
<div id="system:s222" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(real-time)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the amount of real time that has elapsed since system start-up</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The amount is in milliseconds.</p>
</div>
<div class="paragraph">
<p>See also <code>current-time</code>, which returns more precise information.</p>
</div>
<div id="system:s223" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytes-allocated)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytes-allocated <em>g</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the number of bytes currently allocated</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code><em>g</em></code> is supplied, <code>bytes-allocated</code> returns the number of bytes currently allocated for Scheme objects in the specified generation. <code><em>g</em></code> must be a nonnegative exact integer no greater than the maximum nonstatic generation, i.e., the value returned by <code>collect-maximum-generation</code>, or the symbol <code>static</code>. If <code><em>g</em></code> is not supplied, <code>bytes-allocated</code> returns the total number of bytes allocated in all generations.</p>
</div>
<div id="system:s224" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(initial-bytes-allocated)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the total number of bytes allocated after loading boot files</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="system:s225" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bytes-deallocated)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the total number of bytes deallocated by the garbage collector</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The total number of bytes allocated by the current process, whether still in use or not, can be obtained by summing <code>(bytes-deallocated)</code> and <code>(bytes-allocated)</code> and possibly subtracting <code>(initial-bytes-allocated)</code>.</p>
</div>
<div id="system:s226" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(current-memory-bytes)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the total number of bytes currently allocated, including overhead</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>current-memory-bytes</code> returns the total size of the heap in bytes, including not only the bytes occupied for Scheme objects but also various forms of overhead, including fragmentation and reserved but not currently occupied memory, and is thus an accurate measure of the amount of heap memory currently reserved from the operating system for the current process.</p>
</div>
<div id="system:s227" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(maximum-memory-bytes)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the maximum number of bytes ever allocated, including overhead</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>maximum-memory-bytes</code> returns the maximum size of the heap in bytes, i.e., the maximum value that <code>current-memory-bytes</code> returned or could have returned, since the last call to <code>reset-maximum-memory-bytes!</code> or, if there has been no such call, since the process started.</p>
</div>
<div id="system:s228" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(reset-maximum-memory-bytes!)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>reset-maximum-memory-bytes!</code> resets the maximum recorded size of the heap to the current size of the heap.</p>
</div>
<div id="system:s229" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(collections)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the number garbage collections so far</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="system:s230" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(statistics)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a sstats record containing current statistics</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>statistics</code> packages together various timing and allocation statistics into a single <code>sstats</code> record. A <code>sstats</code> record has the following fields:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>cpu</code></dt>
<dd>
<p>the cpu time consumed,</p>
</dd>
<dt class="hdlist1"><code>real</code></dt>
<dd>
<p>the elapsed real time,</p>
</dd>
<dt class="hdlist1"><code>bytes</code></dt>
<dd>
<p>the number of bytes allocated,</p>
</dd>
<dt class="hdlist1"><code>gc-count</code></dt>
<dd>
<p>the number of collections,</p>
</dd>
<dt class="hdlist1"><code>gc-cpu</code></dt>
<dd>
<p>the cpu time consumed during collections,</p>
</dd>
<dt class="hdlist1"><code>gc-real</code></dt>
<dd>
<p>the elapsed real time during collections, and</p>
</dd>
<dt class="hdlist1"><code>gc-bytes</code></dt>
<dd>
<p>the number of bytes reclaimed by the collector.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>All values are computed since system start-up. The time values are time objects (<a href="#section_12.10.">Section 12.10</a>), and the bytes and count values are exact integers.</p>
</div>
<div class="paragraph">
<p><code>statistics</code> might be defined as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define statistics
  (lambda ()
    (make-sstats
      (current-time 'time-thread)
      (current-time 'time-monotonic)
      (- (+ (bytes-allocated) (bytes-deallocated))
         (initial-bytes-allocated))
      (collections)
      (current-time 'time-collector-cpu)
      (current-time 'time-collector-real)
      (bytes-deallocated))))</code></pre>
</div>
</div>
<div id="system:s231" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-sstats <em>cpu</em> <em>real</em> <em>bytes</em> <em>gc-count</em> <em>gc-cpu</em> <em>gc-real</em> <em>gc-bytes</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a sstats record</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The time arguments (<code><em>cpu</em></code>, <code><em>real</em></code>, <code><em>gc-cpu</em></code>, and <code><em>gc-real</em></code>) must be time objects. The other arguments must be exact integers.</p>
</div>
<div id="system:s232" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(sstats? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a sstats record, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="system:s233" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(sstats-cpu <em>s</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(sstats-real <em>s</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(sstats-bytes <em>s</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(sstats-gc-count <em>s</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(sstats-gc-cpu <em>s</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(sstats-gc-real <em>s</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(sstats-gc-bytes <em>s</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the value of the corresponding field of <code><em>s</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>s</em></code> must be a sstats record.</p>
</div>
<div id="system:s234" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-sstats-cpu! <em>s</em> <em>new-value</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-sstats-real! <em>s</em> <em>new-value</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-sstats-bytes! <em>s</em> <em>new-value</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-sstats-gc-count! <em>s</em> <em>new-value</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-sstats-gc-cpu! <em>s</em> <em>new-value</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-sstats-gc-real! <em>s</em> <em>new-value</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-sstats-gc-bytes! <em>s</em> <em>new-value</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>s</em></code> must be a sstats record, the <code><em>new-value</em></code> arguments for the time fields (<code><em>cpu</em></code>, <code><em>real</em></code>, <code><em>gc-cpu</em></code>, and <code><em>gc-real</em></code>) must be time objects, and the other <code><em>new-value</em></code> arguments must be exact integers. Each procedure sets the value of the corresponding field of <code><em>s</em></code> to <code><em>new-value</em></code>.</p>
</div>
<div id="system:s235" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(sstats-difference <em>s<sub>1</sub></em> <em>s<sub>2</sub></em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a sstats record representing the difference between <code><em>s<sub>1</sub></em></code> and <code><em>s<sub>2</sub></em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>s<sub>1</sub></em></code> and <code><em>s<sub>2</sub></em></code> must be sstats records. <code>sstats-difference</code> subtracts each field of <code><em>s<sub>2</sub></em></code> from the corresponding field of <code><em>s<sub>1</sub></em></code> to produce the resulting <code>sstats</code> record.</p>
</div>
<div id="system:s236" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(sstats-print <em>s</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(sstats-print <em>s</em> <em>textual-output-port</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>s</em></code> must be a <code>sstats</code> record. If <code><em>textual-output-port</em></code> is not supplied, it defaults to the current output port. <code>sstats-print</code> displays the fields of <code>s</code> in a manner similar to <code>display-statistics</code> and <code>time</code>.</p>
</div>
<div id="system:s237" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>enable-object-counts</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of <code>enable-object-counts</code> is a boolean value that determines whether the collector records object counts as it runs and hence whether the object counts returned by the procedure <code>object-counts</code> are accurate. The parameter is set to <code>#f</code> by default, since enabling object counts adds overhead to collection.</p>
</div>
<div class="paragraph">
<p>Counts for the static generation are always correct. Counts for a nonstatic generation <em>n</em> are correct immediately after a collection of generation <em>m</em> ≥ <em>n</em> (regardless of whether the target generation is <em>m</em> or <em>m</em> + 1) if <code>enable-object-counts</code> was set to <code>#t</code> during the collection.</p>
</div>
<div class="paragraph">
<p>One strategy for collecting object counts with minimal overhead is to enable object counts only while collecting the maximum nonstatic generation and to obtain the object counts immediately after that collection.</p>
</div>
<div id="system:s238" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(object-counts)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The procedure <code>object-counts</code> returns a nested association list representing object counts and bytes allocated for each heap-allocated primitive type and record type with at least one live instance in one or more generations. (Heap-allocated primitive types include, e.g., pairs and vectors, but not, e.g., fixnums or characters.) Object counts are gathered by the collector only when <code>enable-object-counts</code> is <code>#t</code>. The description of <code>enable-object-counts</code> details the circumstances under which the counts are accurate.</p>
</div>
<div class="paragraph">
<p>The association list returned by <code>object-counts</code> has the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">((<em>type</em> (<em>generation</em> <em>count</em> . <em>bytes</em>) ...) ...)</code></pre>
</div>
</div>
<div class="paragraph">
<p><code><em>type</em></code> is either the name of a primitive type, represented as a symbol, e.g., <code>pair</code>, or a record-type descriptor (rtd). <code><em>generation</em></code> is a nonnegative fixnum between 0 and the value of <code>(collect-maximum-generation)</code>, inclusive, or the symbol <code>static</code> representing the static generation. <code><em>count</em></code> and <code><em>bytes</em></code> are nonnegative fixnums.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(collect-request-handler void)
(enable-object-counts #t)
(define-record-type frob (fields x))
(define x (make-frob (make-frob #f)))
(collect 3 3)
(cdr (assoc 3
       (cdr (assoc (record-type-descriptor frob)
              (object-counts)))))                ⇒ (2 . 16)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_12.12.">Section 12.12. Cost Centers</h3>
<div class="paragraph">
<p>Cost centers are used to track the bytes allocated, instructions executed, and/or cpu time elapsed while evaluating selected sections of code. Cost centers are created via the procedure <code>make-cost-center</code>, and costs are tracked via the procedure <code>with-cost-center</code>.</p>
</div>
<div class="paragraph">
<p>Allocation and instruction counts are tracked only for code instrumented for that purpose. This instrumentation is controlled by two parameters: <code>generate-allocation-counts</code> and <code>generate-instruction-counts</code>. Instrumentation is disabled by default. Built in procedures are not instrumented, nor is interpreted code or non-Scheme code. Elapsed time is tracked only when the optional <code>timed?</code> argument to <code>with-cost-center</code> is provided and is not false.</p>
</div>
<div class="paragraph">
<p>The <code>with-cost-center</code> procedure accurately tracks costs, subject to the caveats above, even when reentered with the same cost center, used simultaneously in multiple threads, and exited or reentered one or more times via continuation invocation.</p>
</div>
<div id="system:s239" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>generate-allocation-counts</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When this parameter has a true value, the compiler inserts a short sequence of instructions at each allocation point in generated code to track the amount of allocation that occurs. This parameter is initially false.</p>
</div>
<div id="system:s240" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>generate-instruction-counts</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When this parameter has a true value, the compiler inserts a short sequence of instructions in each block of generated code to track the number of instructions executed by that block. This parameter is initially false.</p>
</div>
<div id="system:s241" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-cost-center)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new cost center</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The recorded costs of the new cost center are initialized to zero.</p>
</div>
<div id="system:s242" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(cost-center? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a cost center, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="system:s243" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(with-cost-center <em>cost-center</em> <em>thunk</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(with-cost-center <em>timed?</em> <em>cost-center</em> <em>thunk</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>thunk</em></code> must be a procedure that accepts zero arguments. <code>with-cost-center</code> invokes <code><em>thunk</em></code> without arguments and returns its values. It also tracks, dynamically, the bytes allocated, instructions executed, and cpu time elapsed while evaluating the invocation of <code><em>thunk</em></code> and adds the tracked costs to the cost center&#8217;s running record of these costs.</p>
</div>
<div class="paragraph">
<p>As described above, allocation counts are tracked only for code compiled with the parameter <code>generate-allocation-counts</code> set to true, and instruction counts are tracked only for code compiled with <code>generate-instruction-counts</code> set to true. Cpu time is tracked only if <code><em>timed?</em></code> is provided and not false and includes cpu time spent in instrumented, uninstrumented, and non-Scheme code.</p>
</div>
<div id="system:s244" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(cost-center-instruction-count <em>cost-center</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the number of instructions tracked by <code><em>cost-center</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="system:s245" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(cost-center-allocation-count <em>cost-center</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the number of allocated bytes tracked by <code><em>cost-center</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="system:s246" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(cost-center-time <em>cost-center</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the cpu time tracked by <code><em>cost-center</em></code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The cpu time is returned as a time object with time-type <code>time-duration</code>.</p>
</div>
<div id="system:s247" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(reset-cost-center! <em>cost-center</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure resets the costs recorded by <code><em>cost-center</em></code> to zero.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_12.13.">Section 12.13. Parameters</h3>
<div class="paragraph">
<p>This section describes mechanisms for creating and manipulating parameters. New parameters may be created conveniently with <code>make-parameter</code>. Nothing distinguishes parameters from other procedures, however, except for their behavior. If more complicated actions must be taken when a parameter is invoked than can be accommodated easily through the <code>make-parameter</code> mechanism, the parameter may be defined directly with <code>case-lambda</code>.</p>
</div>
<div id="system:s248" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-parameter <em>object</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-parameter <em>object</em> <em>procedure</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a parameter (procedure)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>make-parameter</code> accepts one or two arguments. The first argument is the initial value of the internal variable, and the second, if present, is a <em>filter</em> applied to the initial value and all subsequent values. The filter should accept one argument. If the value is not appropriate, the filter should raise an exception or convert the value into a more appropriate form.</p>
</div>
<div class="paragraph">
<p>For example, the default value of <code>print-length</code> is defined as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define print-length
  (make-parameter
    #f
    (lambda (x)
      (unless (or (not x) (and (fixnum? x) (fx>= x 0)))
        (assertion-violationf 'print-length
          "~s is not a positive fixnum or #f"
          x))
      x)))</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(print-length)  ⇒ #f
(print-length 3)
(print-length)  ⇒ 3
(format "~s" '(1 2 3 4 5 6))  ⇒ "(1 2 3 ...)"
(print-length #f)
(format "~s" '(1 2 3 4 5 6))  ⇒ "(1 2 3 4 5 6)"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The definition of <code>make-parameter</code> is straightforward using <code>case-lambda</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define make-parameter
  (case-lambda
    [(init guard)
     (let ([v (guard init)])
       (case-lambda
         [() v]
         [(u) (set! v (guard u))]))]
    [(init)
     (make-parameter init (lambda (x) x))]))</code></pre>
</div>
</div>
<div class="paragraph">
<p>In threaded versions of <em>Chez Scheme</em>, <code>make-parameter</code> creates global parameters. The procedure <code>make-thread-parameter</code>, described in <a href="#section_15.7.">Section 15.7</a>, may be used to make thread parameters.</p>
</div>
<div id="system:s250" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(parameterize ((<em>param</em> <em>expr</em>) ...) <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the values of the body <code><em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Using the syntactic form <code>parameterize</code>, the values of parameters can be changed in a manner analogous to <code>fluid-let</code> for ordinary variables. Each <code><em>param</em></code> is set to the value of the corresponding <code><em>expr</em></code> while the body is evaluated. When control leaves the body by normal return or by the invocation of a continuation created outside of the body, the parameters are restored to their original values. If control returns to the body via a continuation created during the execution of the body, the parameters are again set to their temporary values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define test
  (make-parameter 0))
(test)  ⇒ 0
(test 1)
(test)  ⇒ 1
(parameterize ([test 2])
  (test))  ⇒ 2
(test)  ⇒ 1
(parameterize ([test 2])
  (test 3)
  (test))  ⇒ 3
(test)  ⇒ 1
(define k (lambda (x) x))
(begin (set! k (call/cc k))
       'k)  ⇒ k
(parameterize ([test 2])
  (test (call/cc k))
  (test))  ⇒ k
(test)  ⇒ 1
(k 3)  ⇒ 3
(test)  ⇒ 1</code></pre>
</div>
</div>
<div class="paragraph">
<p>The definition of <code>parameterize</code> is similar to the definition of <code>fluid-let</code> (<a href="#defn:fluid-let">page 117</a>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax parameterize
  (lambda (x)
    (syntax-case x ()
      [(_ () b1 b2 ...) #'(begin b1 b2 ...)]
      [(_ ((x e) ...) b1 b2 ...)
       (with-syntax ([(p ...) (generate-temporaries #'(x ...))]
                     [(y ...) (generate-temporaries #'(x ...))])
         #'(let ([p x] ... [y e] ...)
             (let ([swap (lambda ()
                           (let ([t (p)]) (p y) (set! y t))
                           ...)])
               (dynamic-wind swap (lambda () b1 b2 ...) swap))))])))</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_12.14.">Section 12.14. Virtual registers</h3>
<div class="paragraph">
<p>A limited set of <em>virtual registers</em> is supported by the compiler for use by programs that require high-speed, global, and mutable storage locations. Referencing or assigning a virtual register is potentially faster and never slower than accessing an assignable local or global variable, and the code sequences for doing so are generally smaller. Assignment is potentially significantly faster because there is no need to track pointers from the virtual registers to young objects, as there is for variable locations that might reside in older generations. On threaded versions of the system, virtual registers are "per thread" and thus serve as thread-local storage in a manner that is less expensive than thread parameters.</p>
</div>
<div class="paragraph">
<p>The interface consists of three procedures: <code>virtual-register-count</code>, which returns the number of virtual registers, <code>set-virtual-register!</code>, which sets the value of a specified virtual register, and <code>virtual-register</code>, which retrieves the value of a specified virtual register.</p>
</div>
<div class="paragraph">
<p>A virtual register is specified by a nonnegative fixnum index less than the number of virtual registers. To get optimal performance for <code>set-virtual-register!</code> and <code>virtual-register</code>, the index should be a constant embedded right in the call (or propagatable via optimization to the call). To avoid putting these constants in the source code, programmers should consider using identifier macros to give names to virtual registers, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax current-state
  (identifier-syntax
    [id (virtual-register 0)]
    [(set! id e) (set-virtual-register! 0 e)]))
(set! current-state 'start)
current-state ⇒ start</code></pre>
</div>
</div>
<div class="paragraph">
<p>A more elaborate macro could dole out indices at compile time and complain when no more indices are available.</p>
</div>
<div class="paragraph">
<p>Virtual-registers must be treated as an application-level resource, i.e., libraries intended to be used by multiple applications should generally not use virtual registers to avoid conflicts with an application&#8217;s use of the registers.</p>
</div>
<div id="system:s251" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(virtual-register-count)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the number of virtual registers</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As of Version 9.0, the number of virtual registers is set at 16. It cannot be changed except by recompiling <em>Chez Scheme</em> from source.</p>
</div>
<div id="system:s252" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(set-virtual-register! <em>k</em> <em>x</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>set-virtual-register!</code> stores <code><em>x</em></code> in virtual register <code><em>k</em></code>. <code><em>k</em></code> must be a nonnegative fixnum less than the value of <code>(virtual-register-count)</code>.</p>
</div>
<div id="system:s253" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(virtual-register <em>k</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>virtual-register</code> returns the value most recently stored in virtual register <code><em>k</em></code> (on the current thread, in threaded versions of the system).</p>
</div>
</div>
<div class="sect2">
<h3 id="section_12.15.">Section 12.15. Environmental Queries and Settings</h3>
<div id="system:s254" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(scheme-version)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a version string</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The version string is in the form</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">"Chez Scheme Version <em>version</em>"</code></pre>
</div>
</div>
<div class="paragraph">
<p>for <em>Chez Scheme</em>, and</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">"Petite Chez Scheme Version <em>version</em>"</code></pre>
</div>
</div>
<div class="paragraph">
<p>for <em>Petite Chez Scheme</em>.</p>
</div>
<div id="system:s255" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(scheme-version-number)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>three values: the major, minor, and sub-minor version numbers</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each of the three return values is a nonnegative fixnum.</p>
</div>
<div class="paragraph">
<p>In <em>Chez Scheme</em> Version 7.9.4:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(scheme-version-number) ⇒ 7
                           9
                           4</code></pre>
</div>
</div>
<div id="system:s256" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(petite?)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if called in <em>Petite Chez Scheme</em>, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The only difference between <em>Petite Chez Scheme</em> and <em>Chez Scheme</em> is that the compiler is not available in the former, so this predicate can serve as a way to determine if the compiler is available.</p>
</div>
<div id="system:s257" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(threaded?)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if called in a threaded version of the system, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="system:s258" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(interactive?)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if system is run interactively, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This predicate returns <code>#t</code> if the Scheme process&#8217;s stdin and stdout are connected to a tty (Unix-based systems) or console (Windows). Otherwise, it returns <code>#f</code>.</p>
</div>
<div id="system:s259" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(get-process-id)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the operating system process id if the current process</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="system:s260" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(getenv <em>key</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>environment value of <code><em>key</em></code> or <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>key</em></code> must be a string. <code>getenv</code> returns the operating system shell&#8217;s environment value associated with <code><em>key</em></code>, or <code>#f</code> if no environment value is associated with <code><em>key</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(getenv "HOME") ⇒ "/u/freddy"</code></pre>
</div>
</div>
<div id="system:s261" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(putenv <em>key</em> <em>value</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>key</em></code> and <code><em>value</em></code> must be strings.</p>
</div>
<div class="paragraph">
<p><code>putenv</code> stores the <code><em>key</em></code>, <code><em>value</em></code> pair in the environment of the process, where it is available to the current process (e.g., via <code><em>getenv</em></code>) and any spawned processes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(putenv "SCHEME" "rocks!")
(getenv "SCHEME") ⇒ "rocks!"</code></pre>
</div>
</div>
<div id="system:s262" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(get-registry <em>key</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>registry value of <code><em>key</em></code> or <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(put-registry! <em>key</em> <em>val</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(remove-registry! <em>key</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>key</em></code> and <code><em>val</em></code> must be strings.</p>
</div>
<div class="paragraph">
<p><code>get-registry</code> returns a string containing the registry value of <code><em>key</em></code> if the value exists. If no registry value for <code><em>key</em></code> exists, <code>get-registry</code> returns <code>#f</code>.</p>
</div>
<div class="paragraph">
<p><code>put-registry!</code> sets the registry value of <code><em>key</em></code> to <code><em>val</em></code>. It raises an exception with condition type <code>&amp;assertion</code> if the value cannot be set, which may happen if the user has insufficient access.</p>
</div>
<div class="paragraph">
<p><code>remove-registry!</code> removes the registry key or value named by <code><em>key</em></code>. It raises an exception with condition type <code>&amp;assertion</code> if the value cannot be removed. Reasons for failure include the key not being present, the user having insufficient access, or <code><em>key</em></code> being a key with subkeys.</p>
</div>
<div class="paragraph">
<p>These routines are defined for Windows only.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(get-registry "hkey_local_machine\\Software\\North\\South") ⇒ #f
(put-registry! "hkey_local_machine\\Software\\North\\South" "east")
(get-registry "hkey_local_machine\\Software\\North\\South") ⇒ "east"
(remove-registry! "hkey_local_machine\\Software\\North")
(get-registry "hkey_local_machine\\Software\\North\\South") ⇒ #f</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_12.16.">Section 12.16. Subset Modes</h3>
<div id="system:s263" class="hdlist">
<table>
<tr>
<td class="hdlist1">
thread parameter
</td>
<td class="hdlist2">
<p><code>subset-mode</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of this parameter must be <code>#f</code> (the default) or the symbol <code>system</code>. Setting <code>subset-mode</code> to <code>system</code> allows the manipulation of various undocumented system variables, data structures, and settings. It is typically used only for system debugging.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chp_13">Chapter 13. Storage Management</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes aspects of the storage management system and procedures that may be used to control its operation.</p>
</div>
<div class="sect2">
<h3 id="section_13.1.">Section 13.1. Garbage Collection</h3>
<div class="paragraph">
<p>Scheme objects such as pairs, strings, procedures, and user-defined records are never explicitly deallocated by a Scheme program. Instead, the storage management system automatically reclaims the storage associated with an object once it proves the object is no longer accessible. In order to reclaim this storage, <em>Chez Scheme</em> employs a garbage collector which runs periodically as a program runs. Starting from a set of known <em>roots</em>, e.g., the machine registers, the garbage collector locates all accessible objects, copies them (in most cases) in order to eliminate fragmentation between accessible objects, and reclaims storage occupied by inaccessible objects.</p>
</div>
<div class="paragraph">
<p>Collections are triggered automatically by the default collect-request handler, which is invoked via a collect-request interrupt that occurs after approximately <em>n</em> bytes of storage have been allocated, where <em>n</em> is the value of the parameter <code>collect-trip-bytes</code>. The default collect-request handler causes a collection by calling the procedure <code>collect</code> without arguments. The collect-request handler can be redefined by changing the value of the parameter <code>collect-request-handler</code>. A program can also cause a collection to occur between collect-request interrupts by calling <code>collect</code> directly either without or with arguments.</p>
</div>
<div class="paragraph">
<p><em>Chez Scheme</em>'s collector is a <em>generation-based</em> collector. It segregates objects based on their age (roughly speaking, the number of collections survived) and collects older objects less frequently than younger objects. Since younger objects tend to become inaccessible more quickly than older objects, the result is that most collections take little time. The system also maintains a <em>static</em> generation from which storage is never reclaimed. Objects are placed into the static generation only when a heap is compacted (see <code>Scompact_heap</code> in <a href="#section_4.8.">Section 4.8</a>) or when an explicitly specified target-generation is the symbol <code>static</code>. This is primarily useful after an application&#8217;s permanent code and data structures have been loaded and initialized, to reduce the overhead of subsequent collections.</p>
</div>
<div class="paragraph">
<p>Nonstatic generations are numbered starting at zero for the youngest generation up through the current value of <code>collect-maximum-generation</code>. The storage manager places newly allocated objects into generation 0.</p>
</div>
<div class="paragraph">
<p>When <code>collect</code> is invoked without arguments, generation 0 objects that survive collection move to generation 1, generation 1 objects that survive move to generation 2, and so on, except that objects are never moved past the maximum nonstatic generation. Objects in the maximum nonstatic generation are collected back into the maximum nonstatic generation. While generation 0 is collected during each collection, older generations are collected less frequently. An internal counter, gc-trip, is maintained to control when each generation is collected. Each time <code>collect</code> is called without arguments (as from the default collect-request handler), gc-trip is incremented by one, and the set of generations to be collected is determined from the current value of gc-trip and the value of <code>collect-generation-radix</code>: with a collect-generation radix of <em>r</em>, the maximum collected generation is the highest numbered generation <em>g</em> for which gc-trip is a multiple of <em>r</em><sup>g</sup>. If <code>collect-generation-radix</code> is set to 4, the system thus collects generation 0 every time, generation 1 every 4 times, generation 2 every 16 times, and so on.</p>
</div>
<div class="paragraph">
<p>When <code>collect</code> is invoked with arguments, the generations to be collected and their target generations are determined by the arguments. In addition, the first argument <code><em>cg</em></code> affects the value of gc-trip; that is, gc-trip is advanced to the next <em>r</em><sup><em>cg</em></sup> boundary, but not past the next <em>r</em><sup><em>cg</em>+1</sup> boundary, where <em>r</em> is the value of <code>collect-generation-radix</code>.</p>
</div>
<div class="paragraph">
<p>It is possible to make substantial adjustments in the collector&#8217;s behavior by setting the parameters described in this section. It is even possible to completely override the collector&#8217;s default strategy for determining when each generation is collected by redefining the collect-request handler to call <code>collect</code> with arguments. For example, the programmer can redefine the handler to treat the maximum nonstatic generation as a static generation over a long period of time by calling <code>collect</code> with arguments that prevent the maximum nonstatic generation from being collected during that period of time.</p>
</div>
<div class="paragraph">
<p>Additional information on <em>Chez Scheme</em>'s collector can be found in the report "Don&#8217;t stop the BiBOP: Flexible and efficient storage management for dynamically typed languages" <a href="#ref13">[13]</a>.</p>
</div>
<div id="smgmt:s9" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(collect)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(collect <em>cg</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(collect <em>cg</em> <em>max-tg</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(collect <em>cg</em> <em>min-tg</em> <em>max-tg</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure causes the storage manager to perform a garbage collection. <code>collect</code> is invoked periodically without arguments by the default collect-request handler, but it may also be called explicitly, e.g., from a custom collect-request handler, between phases of a computation when collection is most likely to be successful, or before timing a computation. In the threaded versions of <em>Chez Scheme</em>, the thread that invokes <code>collect</code> must be the only active thread.</p>
</div>
<div class="paragraph">
<p>When called without arguments, the system determines automatically which generations to collect and the target generation for each collected generation as described in the lead-in to this section.</p>
</div>
<div class="paragraph">
<p>When called with arguments, the system collects all and only objects in generations less than or equal to <code><em>cg</em></code> (the maximum collected generation) into the target generation or generations determined by <code><em>min-tg</em></code> (the minimum target generation) and <code><em>max-tg</em></code> (the maximum target generation). Specifically, the target generation for any object in a collected generation <code><em>g</em></code> is \(min(max(g+1,\text{min-tg}),\text{max-tg})\), where <code>static</code> is taken to have the value one greater than the maximum nonstatic generation.</p>
</div>
<div class="paragraph">
<p>If present, <code><em>cg</em></code> must be a nonnegative fixnum no greater than the maximum nonstatic generation, i.e., the current value of the parameter <code>collect-maximum-generation</code>.</p>
</div>
<div class="paragraph">
<p>If present, <code><em>max-tg</em></code> must be a nonnegative fixnum or the symbol <code>static</code> and either equal to <code><em>cg</em></code> or one greater than <code><em>cg</em></code>, again treating <code>static</code> as having the value one greater than the maximum nonstatic generation. If <code><em>max-tg</em></code> is not present (but <code><em>cg</em></code> is), it defaults to <code><em>cg</em></code> if <code><em>cg</em></code> is equal to the maximum target generation and to one more than <code><em>cg</em></code> otherwise.</p>
</div>
<div class="paragraph">
<p>If present, <code><em>min-tg</em></code> must be a nonnegative fixnum or the symbol <code>static</code> and no greater than <code><em>max-tg</em></code>, again treating <code>static</code> as having the value one greater than the maximum nonstatic generation. Unless <code><em>max-cg</em></code> is the same as <code><em>cg</em></code>, <code><em>min-tg</em></code> must also be greater than <code><em>cg</em></code>. If <code><em>min-tg</em></code> is not present (but <code><em>cg</em></code> is), it defaults to the same value as <code><em>max-tg</em></code>.</p>
</div>
<div id="smgmt:s10" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(collect-rendezvous)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Requests a garbage collection in the same way as when the system determines that a collection should occur. All running threads are coordinated so that one of them calls the collect-request handler, while the other threads pause until the handler returns.</p>
</div>
<div class="paragraph">
<p>Note that if the collect-request handler (see <code>collect-request-handler</code>) does not call <code>collect</code>, then <code>collect-rendezvous</code> does not actually perform a garbage collection.</p>
</div>
<div id="smgmt:s11" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>collect-notify</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code>collect-notify</code> is set to a true value, the collector prints a message whenever a collection is run. <code>collect-notify</code> is set to <code>#f</code> by default.</p>
</div>
<div id="smgmt:s12" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>collect-trip-bytes</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This parameter determines the approximate amount of storage that is allowed to be allocated between garbage collections. Its value must be a positive fixnum.</p>
</div>
<div class="paragraph">
<p><em>Chez Scheme</em> allocates memory internally in large chunks and subdivides these chunks via inline operations for efficiency. The storage manager determines whether to request a collection only once per large chunk allocated. Furthermore, some time may elapse between when a collection is requested by the storage manager and when the collect request is honored, especially if interrupts are temporarily disabled via <code>with-interrupts-disabled</code> or <code>disable-interrupts</code>. Thus, <code>collect-trip-bytes</code> is an approximate measure only.</p>
</div>
<div id="smgmt:s15" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>collect-generation-radix</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This parameter determines how often each generation is collected when <code>collect</code> is invoked without arguments, as by the default collect-request handler. Its value must be a positive fixnum. Generations are collected once every <em>r</em><sup>g</sup> times a collection occurs, where <em>r</em> is the value of <code>collect-generation-radix</code> and <em>g</em> is the generation number.</p>
</div>
<div class="paragraph">
<p>Setting <code>collect-generation-radix</code> to one forces all generations to be collected each time a collection occurs. Setting <code>collect-generation-radix</code> to a very large number effectively delays collection of older generations indefinitely.</p>
</div>
<div id="smgmt:s16" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>collect-maximum-generation</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This parameter determines the maximum nonstatic generation, hence the total number of generations, currently in use. Its value is an exact integer in the range 1 through 254. When set to 1, only two nonstatic generations are used; when set to 2, three nonstatic generations are used, and so on. When set to 254, 255 nonstatic generations are used, plus the single static generation for a total of 256 generations. Increasing the number of generations effectively decreases how often old objects are collected, potentially decreasing collection overhead but potentially increasing the number of inaccessible objects retained in the system and thus the total amount of memory required.</p>
</div>
<div id="smgmt:s17" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>collect-request-handler</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of <code>collect-request-handler</code> must be a procedure. The procedure is invoked without arguments whenever the system determines that a collection should occur, i.e., some time after an amount of storage determined by the parameter <code>collect-trip-bytes</code> has been allocated since the last collection.</p>
</div>
<div class="paragraph">
<p>By default, <code>collect-request-handler</code> simply invokes <code>collect</code> without arguments.</p>
</div>
<div class="paragraph">
<p>Automatic collection may be disabled by setting <code>collect-request-handler</code> to a procedure that does nothing, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(collect-request-handler void)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Collection can also be temporarily disabled using <code>critical-section</code>, which prevents any interrupts from being handled.</p>
</div>
<div class="paragraph">
<p>In the threaded versions of <em>Chez Scheme</em>, the collect-request handler is invoked by a single thread with all other threads temporarily suspended.</p>
</div>
<div id="smgmt:s18" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>release-minimum-generation</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This parameter&#8217;s value must be between 0 and the value of <code>collect-maximum-generation</code>, inclusive, and defaults to the value of <code>collect-maximum-generation</code>.</p>
</div>
<div class="paragraph">
<p>As new data is allocated and collections occur, the storage-management system automatically requests additional virtual memory address space from the operating system. Correspondingly, in the event the heap shrinks significantly, the system attempts to return some of the virtual-memory previously obtained from the operating system back to the operating system. By default, the system attempts to do so only after a collection that targets the maximum nonstatic generation. The system can be asked to do so after collections targeting younger generations as well by altering the value <code>release-minimum-generation</code> to something less than the value of <code>collect-maximum-generation</code>. When the generation to which the parameter is set, or any older generation, is the target generation of a collection, the storage management system attempts to return unneeded virtual memory to the operating system following the collection.</p>
</div>
<div class="paragraph">
<p>When <code>collect-maximum-generation</code> is set to a new value <code><em>g</em></code>, <code>release-minimum-generation</code> is implicitly set to <code><em>g</em></code> as well if (a) the two parameters have the same value before the change, or (b) <code>release-minimum-generation</code> has a value greater than <code><em>g</em></code>.</p>
</div>
<div id="smgmt:s19" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>heap-reserve-ratio</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This parameter determines the approximate amount of memory reserved (not returned to the O/S as described in the entry for <code>release-minimum-generation</code>) in proportion to the amount currently occupied, excluding areas of memory that have been made static. Its value must be an inexact nonnegative flonum value; if set to an exact real value, the exact value is converted to an inexact value. The default value, 1.0, reserves one page of memory for each currently occupied nonstatic page. Setting it to a smaller value may result in a smaller average virtual memory footprint, while setting it to a larger value may result in fewer calls into the operating system to request and free memory space.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_13.2.">Section 13.2. Weak Pairs, Ephemeron Pairs, and Guardians</h3>
<div id="smgmt:s21" class="paragraph">
<p><em>Weak pairs</em> allow programs to maintain <em>weak pointers</em> to objects. A weak pointer to an object does not prevent the object from being reclaimed by the storage management system, but it does remain valid as long as the object is otherwise accessible in the system.</p>
</div>
<div id="smgmt:s22" class="paragraph">
<p><em>Ephemeron pairs</em> are like weak pairs, but ephemeron pairs combine two pointers where the second is retained only as long as the first is retained.</p>
</div>
<div id="smgmt:s23" class="paragraph">
<p><em>Guardians</em> allow programs to protect objects from deallocation by the garbage collector and to determine when the objects would otherwise have been deallocated.</p>
</div>
<div class="paragraph">
<p>Weak pairs, ephemeron pairs, and guardians allow programs to retain information about objects in separate data structures (such as hash tables) without concern that maintaining this information will cause the objects to remain indefinitely in the system. Ephemeron pairs allow such data structures to retain key-value combinations where a value may refer to its key, but the combination can be reclaimed if neither must be saved otherwise. In addition, guardians allow objects to be saved from deallocation indefinitely so that they can be reused or so that clean-up or other actions can be performed using the data stored within the objects.</p>
</div>
<div class="paragraph">
<p>The implementation of guardians and weak pairs used by <em>Chez Scheme</em> is described in <a href="#ref12">[12]</a>. Ephemerons are described in <a href="#ref23">[23]</a>, but the implementation in <em>Chez Scheme</em> avoids quadratic-time worst-case behavior.</p>
</div>
<div id="desc:weak-cons" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(weak-cons <em>obj<sub>1</sub></em> <em>obj<sub>2</sub></em>)</code> <a id="smgmt:s24"></a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new weak pair</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>obj<sub>1</sub></em></code> becomes the car and <code><em>obj<sub>2</sub></em></code> becomes the cdr of the new pair. Weak pairs are indistinguishable from ordinary pairs in all but two ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>weak pairs can be distinguished from pairs using the <code>weak-pair?</code> predicate, and</p>
</li>
<li>
<p>weak pairs maintain a weak pointer to the object in the car of the pair.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The weak pointer in the car of a weak pair is just like a normal pointer as long as the object to which it points is accessible through a normal (nonweak) pointer somewhere in the system. If at some point the garbage collector recognizes that there are no nonweak pointers to the object, however, it replaces each weak pointer to the object with the "broken weak-pointer" object, <code>#!bwp</code>, and discards the object.</p>
</div>
<div class="paragraph">
<p>The cdr field of a weak pair is <em>not</em> a weak pointer, so weak pairs may be used to form lists of weakly held objects. These lists may be manipulated using ordinary list-processing operations such as <code>length</code>, <code>map</code>, and <code>assv</code>. (Procedures like <code>map</code> that produce list structure always produce lists formed from nonweak pairs, however, even when their input lists are formed from weak pairs.) Weak pairs may be altered using <code>set-car!</code> and <code>set-cdr!</code>; after a <code>set-car!</code> the car field contains a weak pointer to the new object in place of the old object. Weak pairs are especially useful for building association pairs in association lists or hash tables.</p>
</div>
<div class="paragraph">
<p>Weak pairs are printed in the same manner as ordinary pairs; there is no reader syntax for weak pairs. As a result, weak pairs become normal pairs when they are written and then read.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define x (cons 'a 'b))
(define p (weak-cons x '()))
(car p) ⇒ (a . b)

(define x (cons 'a 'b))
(define p (weak-cons x '()))
(set! x '*)
(collect)
(car p) ⇒ #!bwp</code></pre>
</div>
</div>
<div class="paragraph">
<p>The latter example above may in fact return <code>(a . b)</code> if a garbage collection promoting the pair into an older generation occurs prior to the assignment of <code>x</code> to <code>*</code>. It may be necessary to force an older generation collection to allow the object to be reclaimed. The storage management system guarantees only that the object will be reclaimed eventually once all nonweak pointers to it are dropped, but makes no guarantees about when this will occur.</p>
</div>
<div id="smgmt:s25" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(weak-pair? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if obj is a weak pair, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(weak-pair? (weak-cons 'a 'b)) ⇒ #t
(weak-pair? (cons 'a 'b)) ⇒ #f
(weak-pair? "oops") ⇒ #f</code></pre>
</div>
</div>
<div id="desc:ephemeron-cons" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(ephemeron-cons <em>obj<sub>1</sub></em> <em>obj<sub>2</sub></em>)</code> <a id="smgmt:s26"></a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new ephemeron pair</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>obj<sub>1</sub></em></code> becomes the car and <code><em>obj<sub>2</sub></em></code> becomes the cdr of the new pair. Ephemeron pairs are indistinguishable from ordinary pairs in all but two ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ephemeron pairs can be distinguished from pairs using the <code>ephemeron-pair?</code> predicate, and</p>
</li>
<li>
<p>ephemeron pairs maintain a weak pointer to the object in the car of the pair, and the cdr of the pair is preserved only as long as the car of the pair is preserved.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An ephemeron pair behaves like a weak pair, but the cdr is treated specially in addition to the car: the cdr of an ephemeron is set to <code>#!bwp</code> at the same time that the car is set to <code>#!bwp</code>. Since the car and cdr fields are set to <code>#!bwp</code> at the same time, then the fact that the car object may be referenced through the cdr object does not by itself imply that car must be preserved (unlike a weak pair); instead, the car must be saved for some reason independent of the cdr object.</p>
</div>
<div class="paragraph">
<p>Like weak pairs and other pairs, ephemeron pairs may be altered using <code>set-car!</code> and <code>set-cdr!</code>, and ephemeron pairs are printed in the same manner as ordinary pairs; there is no reader syntax for ephemeron pairs.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define x (cons 'a 'b))
(define p (ephemeron-cons x x))
(car p) ⇒ (a . b)
(cdr p) ⇒ (a . b)

(define x (cons 'a 'b))
(define p (ephemeron-cons x x))
(set! x '*)
(collect)
(car p) ⇒ #!bwp
(cdr p) ⇒ #!bwp

(define x (cons 'a 'b))
(define p (weak-cons x x)) ; <em>not an ephemeron pair</em>
(set! x '*)
(collect)
(car p) ⇒ (a . b)
(cdr p) ⇒ (a . b)</code></pre>
</div>
</div>
<div class="paragraph">
<p>As with weak pairs, the last two expressions of the middle example above may in fact return <code>(a . b)</code> if a garbage collection promoting the pair into an older generation occurs prior to the assignment of <code>x</code> to <code>*</code>. In the last example above, however, the results of the last two expressions will always be <code>(a . b)</code>, because the cdr of a weak pair holds a non-weak reference, and that non-weak reference prevents the car field from becoming <code>#!bwp</code>.</p>
</div>
<div id="smgmt:s27" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(ephemeron-pair? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if obj is a ephemeron pair, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(ephemeron-pair? (ephemeron-cons 'a 'b)) ⇒ #t
(ephemeron-pair? (cons 'a 'b)) ⇒ #f
(ephemeron-pair? (weak-cons 'a 'b)) ⇒ #f
(ephemeron-pair? "oops") ⇒ #f</code></pre>
</div>
</div>
<div id="smgmt:s28" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(bwp-object? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if obj is the broken weak-pair object, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(bwp-object? #!bwp) ⇒ #t
(bwp-object? 'bwp) ⇒ #f

(define x (cons 'a 'b))
(define p (weak-cons x '()))
(set! x '*)
(collect (collect-maximum-generation))
(car p) ⇒ #!bwp
(bwp-object? (car p)) ⇒ #t</code></pre>
</div>
</div>
<div id="smgmt:s29" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-guardian)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new guardian</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Guardians are represented by procedures that encapsulate groups of objects registered for preservation. When a guardian is created, the group of registered objects is empty. An object is registered with a guardian by passing the object as an argument to the guardian:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define G (make-guardian))
(define x (cons 'aaa 'bbb))
x ⇒ (aaa . bbb)
(G x)</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible to specify a "representative" object when registering an object. Continuing the above example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define y (cons 'ccc 'ddd))
y ⇒ (ccc . ddd)
(G y 'rep)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The group of registered objects associated with a guardian is logically subdivided into two disjoint subgroups: a subgroup referred to as "accessible" objects, and one referred to "inaccessible" objects. Inaccessible objects are objects that have been proven to be inaccessible (except through the guardian mechanism itself or through the car field of a weak or ephemeron pair), and accessible objects are objects that have not been proven so. The word "proven" is important here: it may be that some objects in the accessible group are indeed inaccessible but that this has not yet been proven. This proof may not be made in some cases until long after the object actually becomes inaccessible (in the current implementation, until a garbage collection of the generation containing the object occurs).</p>
</div>
<div class="paragraph">
<p>Objects registered with a guardian are initially placed in the accessible group and are moved into the inaccessible group at some point after they become inaccessible. Objects in the inaccessible group are retrieved by invoking the guardian without arguments. If there are no objects in the inaccessible group, the guardian returns <code>#f</code>. Continuing the above example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(G) ⇒ #f
(set! x #f)
(set! y #f)
(collect)
(G) ⇒ (aaa . bbb)   ; <em>this might come out second</em>
(G) ⇒ rep           ; <em>and this first</em>
(G) ⇒ #f</code></pre>
</div>
</div>
<div class="paragraph">
<p>The initial call to <code>G</code> returns <code>#f</code>, since the pairs bound to <code>x</code> and <code>y</code> are the only object registered with <code>G</code>, and the pairs are still accessible through those binding. When <code>collect</code> is called, the objects shift into the inaccessible group. The two calls to <code>G</code> therefore return the pair previously bound to <code>x</code> and the representative of the pair previously bound to <code>y</code>, though perhaps in the other order from the one shown. (As noted above for weak pairs, the call to collect may not actually be sufficient to prove the object inaccessible, if the object has migrated into an older generation.)</p>
</div>
<div class="paragraph">
<p>Although an object registered without a representative and returned from a guardian has been proven otherwise inaccessible (except possibly via the car field of a weak or ephemeron pair), it has not yet been reclaimed by the storage management system and will not be reclaimed until after the last nonweak pointer to it within or outside of the guardian system has been dropped. In fact, objects that have been retrieved from a guardian have no special status in this or in any other regard. This feature circumvents the problems that might otherwise arise with shared or cyclic structure. A shared or cyclic structure consisting of inaccessible objects is preserved in its entirety, and each piece registered for preservation with any guardian is placed in the inaccessible set for that guardian. The programmer then has complete control over the order in which pieces of the structure are processed.</p>
</div>
<div class="paragraph">
<p>An object may be registered with a guardian more than once, in which case it will be retrievable more than once:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define G (make-guardian))
(define x (cons 'aaa 'bbb))
(G x)
(G x)
(set! x #f)
(collect)
(G) ⇒ (aaa . bbb)
(G) ⇒ (aaa . bbb)</code></pre>
</div>
</div>
<div class="paragraph">
<p>It may also be registered with more than one guardian, and guardians themselves can be registered with other guardians.</p>
</div>
<div class="paragraph">
<p>An object that has been registered with a guardian without a representative and placed in the car field of a weak or ephemeron pair remains in the car field of the weak or ephemeron pair until after it has been returned from the guardian and dropped by the program or until the guardian itself is dropped.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define G (make-guardian))
(define x (cons 'aaa 'bbb))
(define p (weak-cons x '()))
(G x)
(set! x #f)
(collect)
(set! y (G))
y ⇒ (aaa . bbb)
(car p) ⇒ (aaa . bbb)
(set! y #f)
(collect 1)
(car p) ⇒ #!bwp</code></pre>
</div>
</div>
<div class="paragraph">
<p>(The first collector call above would promote the object at least into generation 1, requiring the second collector call to be a generation 1 collection. This can also be forced by invoking <code>collect</code> several times.)</p>
</div>
<div class="paragraph">
<p>On the other hand, if a representative (other than the object itself) is specified, the guarded object is dropped from the car field of the weak or ephemeron pair at the same time as the representative becomes available from the guardian.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define G (make-guardian))
(define x (cons 'aaa 'bbb))
(define p (weak-cons x '()))
(G x 'rep)
(set! x #f)
(collect)
(G) ⇒ rep
(car p) ⇒ #!bwp</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example illustrates that the object is deallocated and the car field of the weak pair set to <code>#!bwp</code> when the guardian itself is dropped:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define G (make-guardian))
(define x (cons 'aaa 'bbb))
(define p (weak-cons x '()))
(G x)
(set! x #f)
(set! G #f)
(collect)
(car p) ⇒ #!bwp</code></pre>
</div>
</div>
<div class="paragraph">
<p>The example below demonstrates how guardians might be used to deallocate external storage, such as storage managed by the C library "malloc" and "free" operations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define malloc
  (let ([malloc-guardian (make-guardian)])
    (lambda (size)
      ; first free any storage that has been dropped.  to avoid long
      ; delays, it might be better to deallocate no more than, say,
      ; ten objects for each one allocated
      (let f ()
        (let ([x (malloc-guardian)])
          (when x
            (do-free x)
            (f))))
      ; then allocate and register the new storage
      (let ([x (do-malloc size)])
        (malloc-guardian x)
        x))))</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>do-malloc</code> must return a Scheme object "header" encapsulating a pointer to the external storage (perhaps as an unsigned integer), and all access to the external storage must be made through this header. In particular, care must be taken that no pointers to the external storage exist outside of Scheme after the corresponding header has been dropped. <code>do-free</code> must deallocate the external storage using the encapsulated pointer. Both primitives can be defined in terms of <code>foreign-alloc</code> and <code>foreign-free</code> or the C-library "malloc" and "free" operators, imported as foreign procedures. (See <a href="#chp_4">Chapter 4</a>.)</p>
</div>
<div class="paragraph">
<p>If it is undesirable to wait until <code>malloc</code> is called to free dropped storage previously allocated by <code>malloc</code>, a collect-request handler can be used instead to check for and free dropped storage, as shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define malloc)
(let ([malloc-guardian (make-guardian)])
  (set! malloc
    (lambda (size)
      ; allocate and register the new storage
      (let ([x (do-malloc size)])
        (malloc-guardian x)
        x)))
  (collect-request-handler
    (lambda ()
      ; first, invoke the collector
      (collect)
      ; then free any storage that has been dropped
      (let f ()
        (let ([x (malloc-guardian)])
          (when x
            (do-free x)
            (f)))))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>With a bit of refactoring, it would be possible to register the encapsulated foreign address as a representative with each header, in which <code>do-free</code> would take just the foreign address as an argument. This would allow the header to be dropped from the Scheme heap as soon as it becomes inaccessible.</p>
</div>
<div class="paragraph">
<p>Guardians can also be created via <code>ftype-guardian</code>, which supports reference counting of foreign objects.</p>
</div>
<div id="smgmt:s31" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(guardian? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if obj is a guardian, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(guardian? (make-guardian)) ⇒ #t
(guardian? (ftype-guardian iptr)) ⇒ #t
(guardian? (lambda x x)) ⇒ #f
(guardian? "oops") ⇒ #f</code></pre>
</div>
</div>
<div id="smgmt:s32" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(unregister-guardian <em>guardian</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>unregister-guardian</code> unregisters the as-yet unresurrected objects currently registered with the guardian, with one caveat.</p>
</div>
<div class="paragraph">
<p>The caveat, which applies only to threaded versions of <em>Chez Scheme</em>, is that objects registered with the guardian by other threads since the last garbage collection might not be unregistered. To ensure that all objects are unregistered in a multithreaded application, a single thread can be used both to register and unregister objects. Alternatively, an application can arrange to define a collect-request handler that calls <code>unregister-guardian</code> after it calls <code>collect</code>.</p>
</div>
<div class="paragraph">
<p>In any case, <code>unregister-guardian</code> returns a list containing each object (or its representative, if specified) that it unregisters, with duplicates as appropriate if the same object is registered more than once with the guardian. Objects already resurrected but not yet retrieved from the guardian are not included in the list but remain retrievable from the guardian.</p>
</div>
<div class="paragraph">
<p>In the current implementation, <code>unregister-guardian</code> takes time proportional to the number of unresurrected objects currently registered with all guardians rather than those registered just with the corresponding guardian.</p>
</div>
<div class="paragraph">
<p>The example below assumes no collections occur except for those resulting from explicit calls to <code>collect</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define g (make-guardian))
(define x (cons 'a 'b))
(define y (cons 'c 'd))
(g x)
(g x)
(g y)
(g y)
(set! y #f)
(collect 0 0)
(unregister-guardian g) ⇒ ((a . b) (a . b))
(g) ⇒ (c . d)
(g) ⇒ (c . d)
(g) ⇒ #f</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>unregister-guardian</code> can also be used to unregister ftype pointers registered with guardians created by <code>ftype-guardian</code> (<a href="#section_15.6.">Section 15.6</a>).</p>
</div>
</div>
<div class="sect2">
<h3 id="section_13.3.">Section 13.3. Locking Objects</h3>
<div class="paragraph">
<p>All pointers from C variables or data structures to Scheme objects should generally be discarded before entry (or reentry) into Scheme. When this guideline cannot be followed, the object may be <em>locked</em> via <code>lock-object</code> or via the equivalent C library procedure <code>Slock_object</code> (<a href="#section_4.8.">Section 4.8</a>).</p>
</div>
<div id="smgmt:s36" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(lock-object <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Locking an object prevents the storage manager from reclaiming or relocating the object. Locking should be used sparingly, as it introduces memory fragmentation and increases storage management overhead.</p>
</div>
<div class="paragraph">
<p>Locking can also lead to accidental retention of storage if objects are not unlocked. Objects may be unlocked via <code>unlock-object</code> or the equivalent C library procedure <code>Sunlock_object</code>.</p>
</div>
<div class="paragraph">
<p>Locking immediate values, such as fixnums, booleans, and characters, or objects that have been made static is unnecessary but harmless.</p>
</div>
<div id="smgmt:s38" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(unlock-object <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An object may be locked more than once by successive calls to <code>lock-object</code>, <code>Slock_object</code>, or both, in which case it must be unlocked by an equal number of calls to <code>unlock-object</code> or <code>Sunlock_object</code> before it is truly unlocked.</p>
</div>
<div class="paragraph">
<p>An object contained within a locked object, such as an object in the car of a locked pair, need not also be locked unless a separate C pointer to the object exists. That is, if the inner object is accessed only via an indirection of the outer object, it should be left unlocked so that the collector is free to relocate it during collection.</p>
</div>
<div class="paragraph">
<p>Unlocking immediate values, such as fixnums, booleans, and characters, or objects that have been made static is unnecessary and ineffective but harmless.</p>
</div>
<div id="smgmt:s39" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(locked-object? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is locked, immediate, or static</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This predicate returns true if <code><em>obj</em></code> cannot be relocated or reclaimed by the collector, including immediate values, such as fixnums, booleans, and characters, and objects that have been made static.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chp_14">Chapter 14. Expression Editor</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When the expression editor (expeditor) is enabled as described in <a href="#section_2.2.">Section 2.2</a>, it allows the user to edit expressions entered into the system and move backwards and forwards through a history of entered expressions. This chapter describes a set of parameters that may be used to control various aspects of the expression editor&#8217;s behavior (<a href="#section_14.1.">Section 14.1</a>), a procedure for binding key sequences to editing commands (<a href="#section_14.2.">Section 14.2</a>), the built-in editing commands (<a href="#section_14.3.">Section 14.3</a>), and mechanisms for creating new editing commands (<a href="#section_14.4.">Section 14.4</a>).</p>
</div>
<div class="paragraph">
<p>These mechanisms are available through the <code>expression-editor</code> module.</p>
</div>
<div id="expeditor:s0" class="hdlist">
<table>
<tr>
<td class="hdlist1">
module
</td>
<td class="hdlist2">
<p><code>expression-editor</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>expression-editor</code> module exports a set of bindings for parameters and other procedures that can be used to modify how the expression editor interacts with the user, including the particular keys used to invoke the various editing commands.</p>
</div>
<div class="paragraph">
<p>Basic use of the expression editor is described in <a href="#section_2.2.">Section 2.2</a>.</p>
</div>
<div class="sect2">
<h3 id="section_14.1.">Section 14.1. Expression Editor Parameters</h3>
<div id="expeditor:s1" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>ee-auto-indent</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of <code>ee-auto-indent</code> is a boolean value that determines whether the expression editor indents expressions as they are entered. Its default value is <code>#t</code>.</p>
</div>
<div id="expeditor:s2" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>ee-standard-indent</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of <code>ee-standard-indent</code> is a nonnegative fixnum value that determines the amount (in single spaces) by which each expression is indented relative to the enclosing expression, if not aligned otherwise by one of the indenter&#8217;s other heuristics, when <code>ee-auto-indent</code> is true or when one of the indentation commands is invoked explicitly. It&#8217;s default value is <code>2</code>.</p>
</div>
<div id="expeditor:s3" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>ee-auto-paren-balance</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of <code>ee-auto-paren-balance</code> is a boolean value that determines whether the expression editor automatically corrects a close parenthesis or bracket, when typed, to match the corresponding open parenthesis or bracket, if any. Its default value is <code>#t</code>.</p>
</div>
<div id="expeditor:s4" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>ee-flash-parens</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of <code>ee-flash-parens</code> is a boolean value that determines whether the expression editor briefly moves the cursor when an open or close parenthesis or bracket is typed to the matching close or open parenthesis or bracket (if any). Its default value is <code>#t</code>.</p>
</div>
<div id="expeditor:s5" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>ee-paren-flash-delay</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of <code>ee-paren-flash-delay</code> is a nonnegative fixnum value that determines the amount of time (in milliseconds) that the expression editor pauses when the cursor is moved to the matching parenthesis or bracket, if any, when a parenthesis or bracket is entered. The value is ignored if the <code>ee-flash-parens</code> is false. Its default value is <code>100</code>.</p>
</div>
<div id="expeditor:s6" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>ee-default-repeat</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of <code>ee-default-repeat</code> is a nonnegative fixnum value that determines the number of times the next command is repeated after the <code>ee-command-repeat</code> editing command (bound to <code>Esc-^U</code> by default) is used and <em>not</em> followed by a sequence of digits. It&#8217;s default value is <code>4</code>.</p>
</div>
<div id="expeditor:s7" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>ee-noisy</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of <code>ee-noisy</code> is a boolean value that determines whether the expression editor emits a beep (bell) when an error occurs, such as an attempt to find the matching delimiter for a non-delimiter character. Its default value is <code>#f</code>.</p>
</div>
<div id="expeditor:s8" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>ee-history-limit</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of <code>ee-history-limit</code> is a nonnegative fixnum value that determines the number of history entries retained by the expression editor during and across sessions. Only the last <code>(ee-history-limit)</code> entries are retained.</p>
</div>
<div id="expeditor:s9" class="hdlist">
<table>
<tr>
<td class="hdlist1">
global parameter
</td>
<td class="hdlist2">
<p><code>ee-common-identifiers</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of <code>ee-common-identifiers</code> is list of symbols that are considered common enough that they should appear early when one of the incremental identifier-completion editing commands is invoked. Its default value contains a few dozen entries. They are all more than a few characters long (under the theory that users will most likely type short ones out fully) and all would appear later than they likely should when incremental identifier-completion is used.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_14.2.">Section 14.2. Key Binding</h3>
<div class="paragraph">
<p>Key bindings are established via <code>ee-bind-key</code>. The default key bindings are described in <a href="#section_14.3.">Section 14.3</a>.</p>
</div>
<div id="expeditor:s10" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(ee-bind-key <em>key</em> <em>procedure</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>ee-bind-key</code> procedure is used to add to or change the set of key bindings recognized by the expression editor.</p>
</div>
<div class="paragraph">
<p>The <code><em>key</em></code> must be a character or string; if it is a string, it must have the following form.</p>
</div>
<table class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;key-string&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8594;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"</code>&lt;key-char&gt;<sup>+</sup><code>"</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>where</p>
</div>
<table class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;key-char&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8594;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>\\e</code> (specifying an escape character)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">|</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^<em>x</em></code> (specifying control-<code><em>x</em></code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">|</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>\\^</code> (specifying caret)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">|</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>\\\\</code> (specifying back slash)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">|</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>plain char</code> (any character other than <code>\</code> or <code>^</code>)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note that each double-backslash in the syntax actually denotes just one backslash in the string.</p>
</div>
<div class="paragraph">
<p>For example, the <code><em>key</em></code> <code>"\\eX"</code> represents the two-character sequence Escape-x, i.e., the "escape" key followed by the (capital) "X" key. Similarly, they <code><em>key</em></code> <code>"\\e^X"</code> represents the two-character sequence Escape-Control-x, i.e., the "escape" key followed by Control-X.</p>
</div>
<div class="paragraph">
<p>Character keys and string keys consisting of a single plain character always represent a single keystroke.</p>
</div>
<div class="paragraph">
<p>The <code><em>procedure</em></code> argument should normally be one of the built-in editing commands described below. It is also possible to define new editing commands with <code>ee-string-macro</code> and <code>ee-compose</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_14.3.">Section 14.3. Editing Commands</h3>
<div class="paragraph">
<p>The editing commands are grouped into sections according to usage. Each is listed along with the default character sequence or sequences by which it may be invoked.</p>
</div>
<div class="paragraph">
<p><strong>Insertion commands</strong></p>
</div>
<div id="expeditor:s13" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-insert-self</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>most printing characters</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Inserts the entered character into the entry.</p>
</div>
<div id="expeditor:s14" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-insert-paren</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p><code>(</code>, <code>)</code>, <code>[</code>, <code>]</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Inserts the entered parenthesis or bracket into the entry.</p>
</div>
<div class="paragraph">
<p>If the parameter <code>ee-auto-paren-balance</code> is true, the editor corrects close delimiters if necessary to balance existing open delimiters, when a matching open delimiter can be found.</p>
</div>
<div class="paragraph">
<p>If the parameter <code>ee-flash-parens</code> is true, the editor briefly moves the cursor to the matching delimiter, if one can be found, pausing for an amount of time controlled by the parameter <code>ee-paren-flash-delay</code>. If the matching delimiter is not presently displayed, the cursor is flashed to the upper-left or lower-left corner of the displayed portion of the entry, as appropriate.</p>
</div>
<div class="paragraph">
<p>The behavior of this command is undefined if used for something other than a parenthesis or bracket. parentheses and brackets.</p>
</div>
<div id="expeditor:s18" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-newline</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>none</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Inserts a newline at the cursor position, moves to the next line, and indents that line if the parameter <code>ee-auto-indent</code> is true. Does nothing if the entry is empty. See also <code>ee-newline/accept</code>.</p>
</div>
<div id="expeditor:s20" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-open-line</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p><code>^O</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Inserts a newline at the cursor position and indents the next line, but does not move to the next line.</p>
</div>
<div id="expeditor:s21" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-yank-kill-buffer</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p><code>^Y</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Inserts the contents of the kill buffer, which is set by the deletion commands described below.</p>
</div>
<div id="expeditor:s22" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-yank-selection</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p><code>^V</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Inserts the contents of the window system&#8217;s current selection or paste buffer. When running in a shell window under X Windows, this command requires that the DISPLAY environment variable be set to the appropriate display.</p>
</div>
<div class="paragraph">
<p><strong>Cursor movement commands</strong></p>
</div>
<div id="expeditor:s23" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-backward-char</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>leftarrow, <code>^B</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moves the cursor left one character.</p>
</div>
<div id="expeditor:s24" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-forward-char</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>rightarrow, <code>^F</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moves the cursor right one character.</p>
</div>
<div id="expeditor:s25" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-next-line</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>downarrow, <code>^N</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moves the cursor down one line (and to the left if necessary so that the cursor does not sit beyond the last possible position). If the cursor is at the end of the current entry, and the current entry has not been modified, this command behaves like <code>ee-history-fwd</code>.</p>
</div>
<div id="expeditor:s27" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-previous-line</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>uparrow, <code>^P</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moves the cursor up one line (and to the left if necessary so that the cursor does not sit beyond the last possible position). If the cursor is at the top of the current entry, and the current entry has not been modified, this command behaves like <code>ee-history-bwd</code>.</p>
</div>
<div id="expeditor:s29" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-beginning-of-line</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>home, <code>^A</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moves the cursor to the first character of the current line.</p>
</div>
<div id="expeditor:s30" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-end-of-line</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>end, <code>^E</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moves the cursor to the right of the last character of the current line.</p>
</div>
<div id="expeditor:s31" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-beginning-of-entry</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>escape-<code>&lt;</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moves the cursor to the first character of the entry.</p>
</div>
<div id="expeditor:s32" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-end-of-entry</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>escape-<code>&gt;</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moves the cursor to the right of the last character of the entry.</p>
</div>
<div id="expeditor:s33" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-goto-matching-delimiter</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>escape-<code>]</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moves the cursor to the matching delimiter. Has no effect if the character under the cursor is not a parenthesis or bracket or if no matching delimiter can be found.</p>
</div>
<div id="expeditor:s34" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-flash-matching-delimiter</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p><code>^]</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moves the cursor briefly to the matching delimiter, if one can be found, pausing for an amount of time controlled by the parameter <code>ee-paren-flash-delay</code>. If the matching delimiter is not presently displayed, the cursor is flashed to the upper-left or lower-left corner of the displayed portion of the entry, as appropriate.</p>
</div>
<div id="expeditor:s36" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-exchange-point-and-mark</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p><code>^X</code>-<code>^X</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moves the cursor to the mark and leaves the mark at the old cursor position. (The mark can be set with <code>ee-set-mark</code>.)</p>
</div>
<div id="expeditor:s37" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-forward-sexp</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>escape-<code>^F</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moves the cursor to the start of the next expression.</p>
</div>
<div id="expeditor:s38" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-backward-sexp</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>escape-<code>^B</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moves the cursor to the start of the preceding expression.</p>
</div>
<div id="expeditor:s39" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-forward-word</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>escape-f, escape-<code>F</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moves the cursor to the end of the next word.</p>
</div>
<div id="expeditor:s40" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-backward-word</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>escape-b, escape-<code>B</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moves the cursor to the start of the preceding word.</p>
</div>
<div id="expeditor:s41" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-forward-page</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>pagedown, <code>^X</code>-<code>]</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moves the cursor down one screen page.</p>
</div>
<div id="expeditor:s42" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-backward-page</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>pageup, <code>^X</code>-<code>[</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moves the cursor up one screen page.</p>
</div>
<div class="paragraph">
<p><strong>Deletion commands</strong></p>
</div>
<div id="expeditor:s43" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-delete-char</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>delete</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Deletes the character under the cursor.</p>
</div>
<div class="paragraph">
<p>See also <code>ee-eof/delete-char</code>.</p>
</div>
<div id="expeditor:s44" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-backward-delete-char</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>backspace (rubout), <code>^H</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Deletes the character to the left of the cursor.</p>
</div>
<div id="expeditor:s45" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-delete-line</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p><code>^U</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Deletes the contents of the current line, leaving behind an empty line. When used on the first line of a multiline entry of which only the first line is displayed, i.e., immediately after history movement, <code>ee-delete-line</code> deletes the contents of the entire entry, like <code>ee-delete-entry</code> (described below).</p>
</div>
<div id="expeditor:s46" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-delete-to-eol</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p><code>^K</code>, escape-<code>K</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the cursor is at the end of a line, joins the line with the next line, otherwise deletes from the cursor position to the end of the line.</p>
</div>
<div id="expeditor:s47" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-delete-between-point-and-mark</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p><code>^W</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Deletes text between the current cursor position and the mark. (The mark can be set with <code>ee-set-mark</code>.)</p>
</div>
<div id="expeditor:s48" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-delete-entry</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p><code>^G</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Deletes the contents of the current entry.</p>
</div>
<div id="expeditor:s49" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-reset-entry</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p><code>^C</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Deletes the contents of the current entry and moves to the end of the history.</p>
</div>
<div id="expeditor:s50" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-delete-sexp</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>escape-<code>^K</code>, escape-delete</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Deletes the expression that starts under the cursor, or if no expression starts under the cursor, deletes up to the next expression.</p>
</div>
<div id="expeditor:s51" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-backward-delete-sexp</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>escape-backspace (escape-rubout), escape-<code>^H</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Deletes the expression to the left of the cursor.</p>
</div>
<div class="paragraph">
<p><strong>Identifier/filename completion commands</strong></p>
</div>
<div class="paragraph">
<p>These commands perform either identifier or filename completion. Identifier completion is performed outside of a string constant, and filename completion is performed within a string constant. (In determining whether the cursor is within a string constant, the expression editor looks only at the current line and so can be fooled by string constants that span multiple lines.)</p>
</div>
<div id="expeditor:s52" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-id-completion</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>none</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Inserts the common prefix of possible completions of the identifier or filename immediately to the left of the cursor. Identifier completion is based on the identifiers defined in the interaction environment. When there is exactly one possible completion, the common prefix is the completion. This command has no effect if no filename or identifier prefix is immediately the left of the cursor or if the possible completions have no common prefix. If run twice in succession, a list of possible completions is displayed.</p>
</div>
<div id="expeditor:s53" class="paragraph">
<p>See also <code>ee-id-completion/indent</code>.</p>
</div>
<div id="expeditor:s54" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-next-id-completion</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p><code>^R</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Inserts one of the possible completions of the identifier or filename immediately to the left of the cursor. Identifier completion is based on the identifiers defined in the interaction environment. If run twice or more in succession, this command cycles through all of the possible completions. The order is determined by the following heuristics: appearing first are identifiers whose names appear in the list value of the parameter <code>ee-common-identifiers</code>; appearing second are identifiers bound in the interaction environment but not bound in the scheme-environment (i.e., identifiers defined by the user), and appearing last are those in the scheme environment. Within the set of matches appearing in the <code>ee-common-identifiers</code> list, those listed earliest are shown first; the order is alphabetical within the other two sets.</p>
</div>
<div class="paragraph">
<p>See also <code>ee-next-id-completion/indent</code>.</p>
</div>
<div class="paragraph">
<p><strong>History movement commands</strong></p>
</div>
<div id="expeditor:s57" class="paragraph">
<p>The expression editor maintains a history of entries during each session. It also saves the history across sessions unless this behavior is disabled via the command-line argument "<code>--eehistory off</code>".</p>
</div>
<div class="paragraph">
<p>When moving from one history entry to another, only the first line of each multi-line entry is displayed. The redisplay command (which <code>^L</code> is bound to by default) can be used to display the entire entry. It is also possible to move down one line at a time to expose just part of the rest of the entry.</p>
</div>
<div id="expeditor:s58" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-history-bwd</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>escape-uparrow, escape-<code>^P</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moves to the preceding history entry if the current entry is empty or has not been modified; otherwise, has no effect.</p>
</div>
<div class="paragraph">
<p>See also <code>ee-previous-line</code>.</p>
</div>
<div id="expeditor:s59" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-history-fwd</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>escape-downarrow, escape-<code>^N</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moves to the next history entry if the current entry is empty or has not been modified; otherwise, has no effect.</p>
</div>
<div class="paragraph">
<p>See also <code>ee-next-line</code>.</p>
</div>
<div id="expeditor:s60" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-history-bwd-prefix</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>escape-<code>p</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moves to the closest previous history entry, if any, that starts with the sequence of characters that makes up the current entry. May be used multiple times to search for same prefix.</p>
</div>
<div id="expeditor:s61" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-history-fwd-prefix</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>escape-<code>n</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moves to the closest following history entry, if any, that starts with the sequence of characters that makes up the current entry. May be used multiple times to search for same prefix.</p>
</div>
<div id="expeditor:s62" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-history-bwd-contains</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>escape-<code>P</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moves to the closest previous history entry, if any, that contains within it the sequence of characters that makes up the current entry. May be used multiple times to search for same content.</p>
</div>
<div id="expeditor:s63" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-history-fwd-contains</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>escape-<code>N</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moves to the closest following history entry, if any, that contains within it the sequence of characters that makes up the current entry. May be used multiple times to search for same content.</p>
</div>
<div class="paragraph">
<p><strong>Indentation commands</strong></p>
</div>
<div id="expeditor:s64" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-indent</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>escape-tab</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Re-indents the current line.</p>
</div>
<div class="paragraph">
<p>See also <code>ee-next-id-completion/indent</code>.</p>
</div>
<div id="expeditor:s65" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-indent-all</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>escape-<code>q</code>, escape-<code>Q</code>, escape-<code>^Q</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Re-indents each line of the entire entry.</p>
</div>
<div class="paragraph">
<p><strong>Miscellaneous commands</strong></p>
</div>
<div id="expeditor:s66" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-accept</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p><code>^J</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Causes the expression editor to invoke the Scheme reader on the contents of the entry. If the read is successful, the expression is returned to the waiter; otherwise, an error message is printed, the entry redisplayed, and the cursor left (if possible) at the start of the invalid subform.</p>
</div>
<div class="paragraph">
<p>See also <code>ee-newline/accept</code>.</p>
</div>
<div id="expeditor:s67" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-eof</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>none</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Causes end-of-file to be returned from the expression editor, which in turn causes the waiter to exit. Ignored unless entry is empty.</p>
</div>
<div class="paragraph">
<p>See also <code>ee-eof/delete-char</code>.</p>
</div>
<div id="expeditor:s68" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-redisplay</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p><code>^L</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Redisplays the current expression. If run twice in succession, clears the screen and redisplays the expression at the top of the screen.</p>
</div>
<div id="expeditor:s69" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-suspend-process</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p><code>^Z</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Suspends the current process in shells that support job control.</p>
</div>
<div id="expeditor:s70" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-set-mark</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p><code>^@</code>, <code>^</code>space</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Sets the mark to the current cursor position.</p>
</div>
<div id="expeditor:s71" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-command-repeat</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>escape-<code>^U</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Repeats the next command <em>n</em> times. If the next character typed is a digit, <em>n</em> is determined by reading up the sequence of the digits typed and treating it as a decimal number. Otherwise, <em>n</em> is the value of the parameter <code>ee-default-repeat</code>.</p>
</div>
<div class="paragraph">
<p><strong>Combination commands</strong></p>
</div>
<div id="expeditor:s73" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-newline/accept</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>enter, <code>^M</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Behaves like <code>ee-accept</code> if run at the end (not including whitespace) of an entry that starts with a balanced expression; otherwise, behaves like <code>ee-newline</code>.</p>
</div>
<div id="expeditor:s74" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-id-completion/indent</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>tab</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Behaves like <code>ee-id-completion</code> if an identifier (outside a string constant) or filename (within a string constant) appears just to the left of the cursor and the last character of that identifier or filename was just entered; otherwise, behaves like <code>ee-indent</code>.</p>
</div>
<div class="paragraph">
<p>If an existing identifier or filename, i.e., not one just typed, appears to the left of the cursor, the first use of this command behaves like <code>ee-newline</code>, the second consecutive use behaves like <code>ee-id-completion</code>, and the third behaves like a second consecutive use of <code>ee-id-completion</code>.</p>
</div>
<div id="expeditor:s75" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-next-id-completion/indent</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p>none</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Behaves like <code>ee-next-id-completion</code> if an identifier (outside a string constant) or filename (within a string constant) appears just to the left of the cursor and the last character of that identifier or identifier was just entered; otherwise, behaves like <code>ee-indent</code>.</p>
</div>
<div id="expeditor:s76" class="hdlist">
<table>
<tr>
<td class="hdlist1">
command
</td>
<td class="hdlist2">
<p><code>ee-eof/delete-char</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
key(s)
</td>
<td class="hdlist2">
<p><code>^D</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Behaves like <code>ee-delete-char</code> if the entry is nonempty; otherwise, behaves like <code>ee-eof</code>. If the entry is nonempty and this command is run twice or more in succession, it does nothing once the entry becomes empty. This is to prevent accidental exit from the waiter in cases where the command is run repeatedly (perhaps with the help of a keyboard&#8217;s auto-repeat feature) to delete all of the characters in an entry.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_14.4.">Section 14.4. Creating New Editing Commands</h3>
<div id="expeditor:s77" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(ee-string-macro <em>string</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new editing command</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The new editing command produced inserts <code><em>string</em></code> before the current cursor position.</p>
</div>
<div class="paragraph">
<p>Two string macros are predefined:</p>
</div>
<table class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ee-string-macro "(define ")</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8594;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">escape-d</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ee-string-macro "(lambda ")</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8594;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">escape-l</p></td>
</tr>
</tbody>
</table>
<div id="expeditor:s78" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(ee-compose <em>ecmd</em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new editing command</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each <code><em>ecmd</em></code> must be an editing command.</p>
</div>
<div class="paragraph">
<p>The new editing command runs each of the editing commands <code><em>ecmd</em> ...</code> in sequence.</p>
</div>
<div class="paragraph">
<p>For example, the following expression binds <code>^X</code>-p to an editing command that behaves like <code>ee-history-bwd-prefix</code> but leaves the cursor at the end of the expression rather than at the end of the first line, causing the entire entry to be displayed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ()
  (import expression-editor)
  (ee-bind-key "^Xp"
    (ee-compose ee-history-bwd ee-end-of-entry)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>A command such as <code>ee-id-completion</code> that performs a different action when run twice in succession will not recognize that it has been run twice in succession if run as part of a composite command.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chp_15">Chapter 15. Thread System</h2>
<div class="sectionbody">
<div id="threads:s0" class="paragraph">
<p>This chapter describes the <em>Chez Scheme</em> thread-system procedures and syntactic forms. With the exception of locks, locked increment, and locked decrement, the features of the thread system are implemented on top of the Posix thread system (pthreads) on non-Windows-based system and directly using the Windows API on Windows-based systems. Consult the appropriate documentation on your system for basic details of thread creation and interaction.</p>
</div>
<div class="paragraph">
<p>Most primitive Scheme procedures are <em>thread-safe</em>, meaning that they can be called concurrently from multiple threads. This includes allocation operations like <code><em>cons</em></code> and <code>make-string</code>, accessors like <code>car</code> and <code>vector-ref</code>, numeric operators like <code>+</code> and <code>sqrt</code>, and nondestructive higher-level primitive operators like <code>append</code> and <code>map</code>.</p>
</div>
<div class="paragraph">
<p>Simple mutation operators, like <code>set-car!</code>, <code>vector-set!</code>, and record field mutators are thread-safe. Likewise, assignments to local variables, including assignments to (unexported) library and top-level program variables are thread-safe.</p>
</div>
<div class="paragraph">
<p>Other destructive operators are thread safe only if they are used to operate on different objects from those being read or modified by other threads. For example, assignments to global variables are thread-safe only as long as one thread does not assign the same variable another thread references or assigns. Similarly, <code>putprop</code> can be called in one thread while another concurrently calls <code>putprop</code> or <code>getprop</code> if the symbols whose property lists are being modified or accessed differ.</p>
</div>
<div class="paragraph">
<p>In this context, most I/O operations should be considered destructive, since they might modify a port&#8217;s internal structure; see also <a href="#section_15.8.">Section 15.8</a> for information on buffered ports.</p>
</div>
<div class="paragraph">
<p>Use of operators that are not thread-safe without proper synchronization can corrupt the objects upon which they operate. This corruption can lead to incorrect behavior, memory faults, and even unrecoverable errors that cause the system to abort.</p>
</div>
<div class="paragraph">
<p>The compiler and interpreter are thread-safe to the extent that user code evaluated during the compilation and evaluation process is thread-safe or properly synchronized. Thus, two or more threads can call any of the compiler or interpreter entry points, i.e., <code>compile</code>, <code>compile-file</code>, <code>compile-program</code>, <code>compile-script</code>, <code>compile-port</code>, or <code>interpret</code> at the same time. Naturally, the object-file targets of two file compilation operations that run at the same time should be different. The same is true for <code>eval</code> and <code>load</code> as long as the default evaluator is used or is set explicitly to <code>compile</code>, <code>interpret</code>, or some other thread-safe evaluator.</p>
</div>
<div class="paragraph">
<p>One restriction should be observed when one of multiple threads creates or loads compiled code, however, which is that only that thread or subsequently created children, or children of subsequently created children, etc., should run the code. This is because multiple-processor systems upon which threaded code may run might not guarantee that the data and instruction caches are synchronized across processors.</p>
</div>
<div class="sect2">
<h3 id="section_15.1.">Section 15.1. Thread Creation</h3>
<div id="threads:s2" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(fork-thread <em>thunk</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a thread object</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>thunk</em></code> must be a procedure that accepts zero arguments.</p>
</div>
<div class="paragraph">
<p><code>fork-thread</code> invokes <code><em>thunk</em></code> in a new thread and returns a thread object.</p>
</div>
<div class="paragraph">
<p>Nothing can be done with the thread object returned by <code>fork-thread</code>, other than to print it.</p>
</div>
<div class="paragraph">
<p>Threads created by foreign code using some means other than <code>fork-thread</code> must call <code>Sactivate_thread</code> (<a href="#section_4.8.">Section 4.8</a>) before touching any Scheme data or calling any Scheme procedures.</p>
</div>
<div id="threads:s3" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(thread? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a thread object, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="threads:s4" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(get-thread-id)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the thread id of the current thread</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The thread id is a thread number assigned by thread id, and has no relationship to the process id returned by <code>get-process-id</code>, which is the same in all threads.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_15.2.">Section 15.2. Mutexes</h3>
<div id="threads:s6" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-mutex)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-mutex <em>name</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new mutex object</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>name</em></code>, if supplied, must be a symbol which identifies the mutex, or <code>#f</code> for no name. The name is printed every time the mutex is printed, which is useful for debugging.</p>
</div>
<div id="threads:s7" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(mutex? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a mutex, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="threads:s8" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(mutex-acquire <em>mutex</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(mutex-acquire <em>mutex</em> <em>block?</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>mutex</em></code> must be a mutex.</p>
</div>
<div class="paragraph">
<p><code><em>mutex-acquire</em></code> acquires the mutex identified by <code><em>mutex</em></code>. The optional boolean argument <code><em>block?</em></code> defaults to <code>#t</code> and specifies whether the thread should block waiting for the mutex. If <code><em>block?</em></code> is omitted or is true, the thread blocks until the mutex has been acquired, and an unspecified value is returned.</p>
</div>
<div class="paragraph">
<p>If <code>block?</code> is false and the mutex currently belongs to a different thread, the current thread does not block. Instead, <code>mutex-acquire</code> returns immediately with the value <code>#f</code> to indicate that the mutex is not available. If <code><em>block?</em></code> is false and the mutex is successfully acquired, <code>mutex-acquire</code> returns <code>#t</code>.</p>
</div>
<div class="paragraph">
<p>Mutexes are <em>recursive</em> in Posix threads terminology, which means that the calling thread can use <code>mutex-acquire</code> to (re)acquire a mutex it already has. In this case, an equal number of <code>mutex-release</code> calls is necessary to release the mutex.</p>
</div>
<div id="threads:s9" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(mutex-release <em>mutex</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>mutex</em></code> must be a mutex.</p>
</div>
<div class="paragraph">
<p><code>mutex-release</code> releases the mutex identified by <code><em>mutex</em></code>. Unpredictable behavior results if the mutex is not owned by the calling thread.</p>
</div>
<div id="threads:s10" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(with-mutex <em>mutex</em> <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the values of the body <code><em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>with-mutex</code> evaluates the expression <code><em>mutex</em></code>, which must evaluate to a mutex, acquires the mutex, evaluates the body <code><em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...</code>, and releases the mutex. The mutex is released whether the body returns normally or via a control operation (that is, throw to a continuation, perhaps because of an error) that results in a nonlocal exit from the <code>with-mutex</code> form. If control subsequently returns to the body via a continuation invocation, the mutex is reacquired.</p>
</div>
<div class="paragraph">
<p>Using <code>with-mutex</code> is generally more convenient and safer than using <code>mutex-acquire</code> and <code>mutex-release</code> directly.</p>
</div>
<div id="threads:s11" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(mutex-name <em>mutex</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the name associated with <code><em>mutex</em></code>, if any; otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>mutex</em></code> must be a mutex.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_15.3.">Section 15.3. Conditions</h3>
<div id="threads:s12" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-condition)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-condition <em>name</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new condition object</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>name</em></code>, if supplied, must be a symbol which identifies the condition object, or <code>#f</code> for no name. The name is printed every time the condition is printed, which is useful for debugging.</p>
</div>
<div id="threads:s13" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(thread-condition? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a condition object, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="threads:s14" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(condition-wait <em>cond</em> <em>mutex</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(condition-wait <em>cond</em> <em>mutex</em> <em>timeout</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the calling thread was awakened by the condition, <code>#f</code> if the calling thread timed out waiting</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>cond</em></code> must be a condition object, and <code><em>mutex</em></code> must be a mutex. The optional argument <code><em>timeout</em></code> is a time record of type <code>time-duration</code> or <code>time-utc</code>, or <code>#f</code> for no timeout. It defaults to <code>#f</code>.</p>
</div>
<div class="paragraph">
<p><code>condition-wait</code> waits up to the specified <code><em>timeout</em></code> for the condition identified by the condition object <code><em>cond</em></code>. The calling thread must have acquired the mutex identified by the mutex <code><em>mutex</em></code> at the time <code>condition-wait</code> is called. <code><em>mutex</em></code> is released as a side effect of the call to <code>condition-wait</code>. When a thread is later released from the condition variable by one of the procedures described below or the timeout expires, <code><em>mutex</em></code> is reacquired and <code>condition-wait</code> returns.</p>
</div>
<div id="threads:s15" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(condition-signal <em>cond</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>cond</em></code> must be a condition object.</p>
</div>
<div class="paragraph">
<p><code>condition-signal</code> releases one of the threads waiting for the condition identified by <code><em>cond</em></code>.</p>
</div>
<div id="threads:s16" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(condition-broadcast <em>cond</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>cond</em></code> must be a condition object.</p>
</div>
<div class="paragraph">
<p><code>condition-broadcast</code> releases all of the threads waiting for the condition identified by <code><em>cond</em></code>.</p>
</div>
<div id="threads:s17" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(condition-name <em>condition</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>the name associated with <code><em>condition</em></code>, if any; otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>condition</em></code> must be a condition.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_15.4.">Section 15.4. Locks</h3>
<div id="threads:s18" class="paragraph">
<p>Locks are more primitive but more flexible and efficient than mutexes and can be used in situations where the added mutex functionality is not needed or desired. They can also be used independently of the thread system (including in nonthreaded versions of <em>Chez Scheme</em>) to synchronize operations running in separate Scheme processes as long as the lock is allocated in memory shared by the processes.</p>
</div>
<div class="paragraph">
<p>A lock is simply a word-sized integer, i.e., an <code>iptr</code> or <code>uptr</code> foreign type (<a href="#section_4.5.">Section 4.5</a>) with the native endiannes of the target machine, possibly part of a larger structure defined using <code>define-ftype</code> (<a href="#defn:define-ftype">page 77</a>). It must be explicitly allocated in memory that resides outside the Scheme heap and, when appropriate, explicitly deallocated. When just threads are involved (i.e., when multiple processes are not involved), the memory can be allocated via <code>foreign-alloc</code>. When multiple processes are involved, the lock should be allocated in some area shared by the processes that will interact with the lock.</p>
</div>
<div class="paragraph">
<p>Once initialized using <code>ftype-init-lock!</code>, a process or thread can attempt to lock the lock via <code>ftype-lock!</code> or <code>ftype-spin-lock!</code>. Once the lock has been locked and before it is unlocked, further attempts to lock the lock fail, even by the process or thread that most recently locked it. Locks can be unlocked, via <code>ftype-unlock!</code>, by any process or thread, not just by the process or thread that most recently locked the lock.</p>
</div>
<div class="paragraph">
<p>The lock mechanism provides little structure, and mistakes in allocation and use can lead to memory faults, deadlocks, and other problems. Thus, it is usually advisable to use locks only as part of a higher-level abstraction that ensures locks are used in a disciplined manner.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define lock
  (make-ftype-pointer uptr
    (foreign-alloc (ftype-sizeof uptr))))

(ftype-init-lock! uptr () lock)
(ftype-lock! uptr () lock) ⇒ #t
(ftype-lock! uptr () lock) ⇒ #f
(ftype-unlock! uptr () lock)
(ftype-spin-lock! uptr () lock)
(ftype-lock! uptr () lock) ⇒ #f
(ftype-unlock! uptr () lock)</code></pre>
</div>
</div>
<div id="threads:s19" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-init-lock! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-init-lock! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em> <em>index</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-lock! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-lock! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em> <em>index</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the lock is not already locked, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-spin-lock! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-spin-lock! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em> <em>index</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-unlock! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-unlock! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em> <em>index</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each of these has a syntax like and behaves similarly to <code>ftype-set!</code> (<a href="#defn:ftype-set!">page 86</a>), though with an implicit <code><em>val-expr</em></code>. In particular, the restrictions on and handling of <code><em>fptr-expr</em></code> and the accessors <code><em>a</em> ...</code> is similar, with one important restriction: the field specified by the last accessor, upon which the form operates, must be a word-size integer, i.e., an <code>iptr</code>, <code>uptr</code>, or the equivalent, with the native endianness.</p>
</div>
<div class="paragraph">
<p><code>ftype-init-lock!</code> should be used to initialize the lock prior to the use of any of the other operators; if this is not done, the behavior of the other operators is undefined.</p>
</div>
<div class="paragraph">
<p><code>ftype-lock!</code> can be used to lock the lock. If it finds the lock unlocked at the time of the operation, it locks the lock and returns <code>#t</code>; if it finds the lock already locked, it returns <code>#f</code> without changing the lock.</p>
</div>
<div class="paragraph">
<p><code>ftype-spin-lock!</code> can also be used to lock the lock. If it finds the lock unlocked at the time of the operation, it locks the lock and returns; if it finds the lock already locked, it waits until the lock is unlocked, then locks the lock and returns. If no other thread or process unlocks the lock, the operation does not return and cannot be interrupted by normal means, including by the storage manager for the purpose of initiating a garbage collection. There are also no guarantees of fairness, so a process might hang indefinitely even if other processes are actively locking and unlocking the lock.</p>
</div>
<div class="paragraph">
<p><code>ftype-unlock!</code> is used to unlock a lock. If it finds the lock locked, it unlocks the lock and returns. Otherwise, it returns without changing the lock.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_15.5.">Section 15.5. Locked increment and decrement</h3>
<div class="paragraph">
<p>The locked operations described here can be used when just an atomic increment or decrement is required.</p>
</div>
<div id="threads:s20" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-locked-incr! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-locked-incr! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em> <em>index</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the updated value is 0, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-locked-decr! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-locked-decr! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em> <em>index</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if the updated value is 0, <code>#f</code> otherwise</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each of these has a syntax like and behaves similarly to <code>ftype-set!</code> (<a href="#defn:ftype-set!">page 86</a>), though with an implicit <code><em>val-expr</em></code>. In particular, the restrictions on and handling of <code><em>fptr-expr</em></code> and the accessors <code><em>a</em> ...</code> is similar, with one important restriction: the field specified by the last accessor, upon which the form operates, must be a word-size integer, i.e., an <code>iptr</code>, <code>uptr</code>, or the equivalent, with the native endianness.</p>
</div>
<div class="paragraph">
<p><code>ftype-locked-incr!</code> atomically reads the value of the specified field, adds 1 to the value, and writes the new value back into the field. Similarly, <code>ftype-locked-decr!</code> atomically reads the value of the specified field, subtracts 1 from the value, and writes the new value back into the field. Both return <code>#t</code> if the new value is 0, otherwise <code>#f</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_15.6.">Section 15.6. Reference counting with ftype guardians</h3>
<div id="threads:s21" class="paragraph">
<p>Applications that manage memory outside the Scheme heap can leverage the Scheme storage management system to help perform reference counting via <em>ftype guardians</em>. In a reference-counted memory management system, each object holds a count of pointers to it. The count is incremented when a new pointer is created and decremented when a pointer is dropped. When the count reaches zero, the object is no longer needed and the memory it formerly occupied can be made available for some other purpose.</p>
</div>
<div class="paragraph">
<p>Ftype guardians are similar to guardians created by <code>make-guardian</code> (<a href="#section_13.2.">Section 13.2</a>). The <code>guardian?</code> procedure returns true for both, and the <code>unregister-guardian</code> procedure can be used to unregister objects registered with either.</p>
</div>
<div id="threads:s25" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(ftype-guardian <em>ftype-name</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new ftype guardian</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>ftype-name</em></code> must name an ftype. The first base field of the ftype (or one of the first base fields in the case of unions) must be a word-sized integer (iptr or uptr) with native endianness. This field is assumed to hold a reference count.</p>
</div>
<div class="paragraph">
<p>The return value is a new ftype guardian <code><em>g</em></code>, with which ftype-pointers of type <code><em>ftype-name</em></code> (or some subtype of <code><em>ftype-name</em></code>) can be registered. An ftype pointer is registered with <code><em>g</em></code> by invoking <code><em>g</em></code> with the ftype pointer as an argument.</p>
</div>
<div class="paragraph">
<p>An ftype guardian does not automatically protect from collection the ftype pointers registered with it, as a normal guardian would do. Instead, for each registered ftype pointer that becomes inaccessible via normal (non-weak, non-guardian pointers), the guardian decrements the reference count of the object to which the ftype pointer points. If the resulting reference-count value is zero, the ftype pointer is preserved and can be retrieved from the guardian. If the resulting reference-count value is non-zero, however, the ftype pointer is not preserved. Objects retrieved from an ftype guardian (by calling it without arguments) are guaranteed to have zero reference counts, assuming reference counts are maintained properly by code outside the collector.</p>
</div>
<div class="paragraph">
<p>The collector decrements the reference count using the equivalent of <code>ftype-locked-decr!</code> to support systems in which non-Scheme objects are stored in memory shared by multiple processes. In such systems, programs should themselves use <code>ftype-locked-incr!</code> and <code>ftype-locked-decr!</code> or non-Scheme equivalents (e.g., the C <code>LOCKED_INCR</code> and <code>LOCKED_DECR</code> macros in scheme.h, which are described in <a href="#section_4.8.">Section 4.8</a>) to maintain reference counts.</p>
</div>
<div class="paragraph">
<p>The following example defines a simple ftype and an allocator for objects of that ftype that frees any objects of that ftype that were previously allocated and no longer accessible.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(module (A make-A free-dropped-As)
  (define-ftype A
    (struct
      [refcount uptr]
      [data int]))
  (define g (ftype-guardian A))
  (define free-dropped-As
    (lambda ()
      (let ([a (g)])
        (when a
          (printf "freeing ~s\n" (ftype-ref A (data) a))
          (foreign-free (ftype-pointer-address a))
          (free-dropped-As)))))
  (define make-A
    (lambda (n)
      (free-dropped-As)
      (let ([a (make-ftype-pointer A (foreign-alloc (ftype-sizeof A)))])
        (ftype-set! A (refcount) a 1)
        (ftype-set! A (data) a n)
        (g a)
        a))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can test this by allocating, dropping, and immediately collecting ftype pointers to A.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (do ([i 10 (fx- i 1)])
      ((fx= i 0))
    (make-A i)
    (collect))
freeing 10
freeing 9
freeing 8
freeing 7
freeing 6
freeing 5
freeing 4
freeing 3
freeing 2
> (free-dropped-As)
freeing 1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Objects guarded by an ftype guardian might contain pointers to other objects whose reference counts should also be incremented upon allocation of the containing object and decremented upon freeing of the containing object.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_15.7.">Section 15.7. Thread Parameters</h3>
<div id="threads:s30" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-thread-parameter <em>object</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-thread-parameter <em>object</em> <em>procedure</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new thread parameter</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See <a href="#section_12.13.">Section 12.13</a> for a general discussion of parameters and the use of the optional second argument.</p>
</div>
<div class="paragraph">
<p>When a thread parameter is created, a separate location is set aside in each current and future thread to hold the value of the parameter&#8217;s internal state variable. (This location may be eliminated by the storage manager when the parameter becomes inaccessible.) Changes to the thread parameter in one thread are not seen by any other thread.</p>
</div>
<div class="paragraph">
<p>When a new thread is created (see <code>fork-thread</code>), the current value (not location) of each thread parameter is inherited from the forking thread by the new thread. Similarly, when a thread created by some other means is activated for the first time (see <code>Sactivate_thread</code> in <a href="#section_4.8.">Section 4.8</a>), the current value (not location) of each thread parameter is inherited from the main (original) thread by the new thread.</p>
</div>
<div class="paragraph">
<p>Most built-in parameters are thread parameters, but some are global. All are marked as global or thread where they are defined. There is no distinction between built-in global and thread parameters in the nonthreaded versions of the system.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_15.8.">Section 15.8. Buffered I/O</h3>
<div class="paragraph">
<p>Chez Scheme buffers file I/O operations for efficiency, but buffered I/O is not thread safe. Two threads that write to or read from the same buffered port concurrently can corrupt the port, resulting in buffer overruns and, ultimately, invalid memory references.</p>
</div>
<div class="paragraph">
<p>Buffering on binary output ports can be disabled when opened with buffer-mode <code>none</code>. Buffering on input ports cannot be completely disabled, however, due to the need to support lookahead, and buffering on textual ports, even textual output ports, cannot be disabled completely because the transcoders that convert between characters and bytes sometimes require some lookahead.</p>
</div>
<div class="paragraph">
<p>Two threads should thus <em>never</em> read from or write to the same port concurrently, except in the special case of a binary output port opened buffer-mode <code>none</code>. Alternatives include appointing one thread to perform all I/O for a given port and providing a per-thread generic-port wrapper that forwards requests to the port only after acquiring a mutex.</p>
</div>
<div class="paragraph">
<p>The initial console and current input and output ports are thread-safe, as are transcript ports, so it is safe for multiple threads to print error and/or debugging messages to the console. The output may be interleaved, even within the same line, but the port will not become corrupted. Thread safety for these ports is accomplished at the high cost of acquiring a mutex for each I/O operation.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_15.9.">Section 15.9. Example: Bounded Queues</h3>
<div class="paragraph">
<p>The following code, taken from the article "A Scheme for native threads <a href="#ref10">[10]</a>," implements a bounded queue using many of the thread-system features. A bounded queue has a fixed number of available slots. Attempting to enqueue when the queue is full causes the calling thread to block. Attempting to dequeue from an empty queue causes the calling thread to block.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-record-type bq
  (fields
    (immutable data)
    (mutable head)
    (mutable tail)
    (immutable mutex)
    (immutable ready)
    (immutable room))
  (protocol
    (lambda (new)
      (lambda (bound)
        (new (make-vector bound) 0 0 (make-mutex)
          (make-condition) (make-condition))))))

(define dequeue!
  (lambda (q)
    (with-mutex (bq-mutex q)
      (let loop ()
        (let ([head (bq-head q)])
          (cond
            [(= head (bq-tail q))
             (condition-wait (bq-ready q) (bq-mutex q))
             (loop)]
            [else
             (bq-head-set! q (incr q head))
             (condition-signal (bq-room q))
             (vector-ref (bq-data q) head)]))))))

(define enqueue!
  (lambda (item q)
    (with-mutex (bq-mutex q)
      (let loop ()
        (let* ([tail (bq-tail q)] [tail^ (incr q tail)])
          (cond
            [(= tail^ (bq-head q))
             (condition-wait (bq-room q) (bq-mutex q))
             (loop)]
            [else
             (vector-set! (bq-data q) tail item)
             (bq-tail-set! q tail^)
             (condition-signal (bq-ready q))]))))))

(define incr
  (lambda (q i)
    (modulo (+ i 1) (vector-length (bq-data q)))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code below demonstrates the use of the bounded queue abstraction with a set of threads that act as consumers and producers of the data in the queue.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define job-queue)
(define die? #f)

(define make-job
  (let ([count 0])
    (define fib
      (lambda (n)
        (if (< n 2)
            n
            (+ (fib (- n 2)) (fib (- n 1))))))
    (lambda (n)
      (set! count (+ count 1))
      (printf "Adding job #~s = (lambda () (fib ~s))\n" count n)
      (cons count (lambda () (fib n))))))

(define make-producer
  (lambda (n)
    (rec producer
      (lambda ()
        (printf "producer ~s posting a job\n" n)
        (enqueue! (make-job (+ 20 (random 10))) job-queue)
        (if die?
            (printf "producer ~s dying\n" n)
            (producer))))))

(define make-consumer
  (lambda (n)
    (rec consumer
      (lambda ()
        (printf "consumer ~s looking for a job~%" n)
        (let ([job (dequeue! job-queue)])
          (if die?
              (printf "consumer ~s dying\n" n)
              (begin
                (printf "consumer ~s executing job #~s~%" n (car job))
                (printf "consumer ~s computed:  ~s~%" n ((cdr job)))
                (consumer))))))))

(define (bq-test np nc)
  (set! job-queue (make-bq (max nc np)))
  (do ([np np (- np 1)])
      ((<= np 0))
      (fork-thread (make-producer np)))
  (do ([nc nc (- nc 1)])
      ((<= nc 0))
      (fork-thread (make-consumer nc))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here are a possible first several lines of output from a sample run of the example program.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">> (begin
    (bq-test 3 4)
    (system "sleep 3")
    (set! die? #t))
producer 3 posting a job
Adding job #1 = (lambda () (fib 29))
producer 3 posting a job
Adding job #2 = (lambda () (fib 26))
producer 3 posting a job
Adding job #3 = (lambda () (fib 22))
producer 3 posting a job
Adding job #4 = (lambda () (fib 21))
producer 2 posting a job
Adding job #5 = (lambda () (fib 29))
producer 1 posting a job
Adding job #6 = (lambda () (fib 29))
consumer 4 looking for a job
producer 3 posting a job
Adding job #7 = (lambda () (fib 24))
consumer 4 executing job #1
consumer 3 looking for a job
producer 2 posting a job
Adding job #8 = (lambda () (fib 26))
consumer 3 executing job #2
consumer 3 computed:  121393
consumer 3 looking for a job
producer 1 posting a job
Adding job #9 = (lambda () (fib 26))
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Additional examples, including definitions of suspendable threads and threads that automatically terminate when they become inaccessible, are given in "A Scheme for native threads <a href="#ref10">[10]</a>."</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chp_16">Chapter 16. Compatibility Features</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes several items that are included with current versions of <em>Chez Scheme</em> primarily for compatibility with older versions of the system.</p>
</div>
<div class="paragraph">
<p><a href="#section_16.1.">Section 16.1</a> describes a hash-table interface that has since been replaced by the R6RS hashtable interface. <a href="#section_16.2.">Section 16.2</a> describes <code>extend-syntax</code> macros. These features are supported directly by current versions of <em>Chez Scheme</em>, but support may be dropped in future versions. New programs should use the standard mechanisms described in <em>The Scheme Programming Language, 4th Edition</em> <a href="#ref11">[11]</a> instead.</p>
</div>
<div class="paragraph">
<p><a href="#section_16.3.">Section 16.3</a> describes a mechanism for defining record-like structures as vectors instead of new unique types. New programs should use <code>define-record</code>, which is described in <a href="#section_7.15.">Section 7.15</a>, instead.</p>
</div>
<div class="paragraph">
<p><a href="#section_16.4.">Section 16.4</a> describes a compatibility file distributed with <em>Chez Scheme</em> that contains definitions for forms and procedures no longer supported directly by <em>Chez Scheme</em>.</p>
</div>
<div class="sect2">
<h3 id="section_16.1.">Section 16.1. Hash Tables</h3>
<div class="paragraph">
<p>The hash table procedures here are obviated by the new hash table procedures listed in <a href="#section_7.12.">Section 7.12</a>.</p>
</div>
<div id="compat:s0" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-hash-table)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(make-hash-table <em>weak?</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>a new hash table</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code><em>weak?</em></code> is provided and is non-false, the hash table is a weak hash table, which means that it does not protect keys from the garbage collector. Keys reclaimed by the garbage collector are removed from the table, and their associated values are dropped the next time the table is modified, if not sooner.</p>
</div>
<div id="compat:s1" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(hash-table? <em>obj</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p><code>#t</code> if <code><em>obj</em></code> is a hash table, otherwise <code>#f</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div id="compat:s2" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(put-hash-table! <em>ht</em> <em>k</em> <em>v</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><em>ht</em></code> must be a hash table. <code><em>k</em></code> and <code><em>v</em></code> may be any Scheme values.</p>
</div>
<div class="paragraph">
<p><code>put-hash-table!</code> associates the value <code><em>v</em></code> with the key <code><em>k</em></code> in <code><em>ht</em></code>.</p>
</div>
<div id="compat:s3" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(get-hash-table <em>ht</em> <em>k</em> <em>d</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>get-hash-table</code> returns the value associated with <code><em>k</em></code> in <code><em>ht</em></code>. If no value is associated with <code><em>k</em></code> in <code><em>ht</em></code>, <code>get-hash-table</code> returns <code><em>d</em></code>.</p>
</div>
<div class="paragraph">
<p>Key comparisons are performed with <code><em>eq?</em></code>.</p>
</div>
<div class="paragraph">
<p>Because objects may be moved by the garbage collector, <code>get-hash-table</code> may need to rehash some objects and therefore cause side effects in the hash table. Thus, it is not safe to perform concurrent accesses of the same hash table from multiple threads using <code>get-hash-table</code>.</p>
</div>
<div id="compat:s4" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(remove-hash-table! <em>ht</em> <em>k</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>remove-hash-table!</code> drops any association for <code><em>k</em></code> from <code><em>ht</em></code>.</p>
</div>
<div id="compat:s5" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(hash-table-map <em>ht</em> <em>p</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>see below</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>hash-table-map</code> applies <code><em>p</em></code> to each key, value association in <code><em>ht</em></code>, in no particular order, and returns a list of the resulting values, again in no particular order. <code><em>p</em></code> should accept two arguments, a key and a value.</p>
</div>
<div id="compat:s6" class="hdlist">
<table>
<tr>
<td class="hdlist1">
procedure
</td>
<td class="hdlist2">
<p><code>(hash-table-for-each <em>ht</em> <em>p</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>hash-table-for-each</code> applies <code><em>p</em></code> to each key, value association in <code><em>ht</em></code>, in no particular order. Unlike <code>hash-table-map</code>, it does not create a list of the values; instead, it&#8217;s value is unspecified. <code><em>p</em></code> should accept two arguments, a key and a value.</p>
</div>
</div>
<div class="sect2">
<h3 id="section_16.2.">Section 16.2. Extend-Syntax Macros</h3>
<div class="paragraph">
<p>This section describes <code>extend-syntax</code>, a powerful yet easy to use syntactic extension facility based on pattern matching <a href="#ref27">[27]</a>. Syntactic transformations written using <code>extend-syntax</code> are similar to those written using a <code>define-syntax</code> with <code>syntax-case</code>, except that the transformations produced by <code>extend-syntax</code> do not automatically respect lexical scoping.</p>
</div>
<div class="paragraph">
<p>It is not typically possible to mix syntactic abstractions written using <code>syntax-case</code> with those written using <code>extend-syntax</code> seamlessly; it is generally preferable to use one or the other wherever possible. Support for <code>extend-syntax</code> within the <code>syntax-case</code> expander is provided only as an aid to migrating to <code>syntax-case</code>.</p>
</div>
<div id="compat:s8" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(extend-syntax (<em>name</em> <em>key</em> ...) (<em>pat</em> <em>fender</em> <em>template</em>) ...)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The identifier <code><em>name</em></code> is the name, or syntax keyword, for the syntactic extension to be defined. When the system expander processes any list expression whose car is <code><em>name</em></code>, the syntactic transformation procedure generated by <code>extend-syntax</code> is invoked on this expression. The remaining identifiers <code><em>key</em> ...</code> are additional keywords to be recognized within input expressions during expansion (such as <code>else</code> in <code>cond</code> or <code>case</code>).</p>
</div>
<div class="paragraph">
<p>Each clause after the list of keys consists of a pattern <code><em>pat</em></code>, an optional <code><em>fender</em></code>, and a <code><em>template</em></code>. The optional <code><em>fender</em></code> is omitted more often than not. The <code><em>pat</em></code> specifies the syntax the input expression must have for the clause to be chosen. Identifiers within the pattern that are not keywords (<em>pattern variables</em>) are bound to corresponding pieces of the input expression. If present, the <code><em>fender</em></code> is a Scheme expression that specifies additional constraints on the input expression (accessed through the pattern variables) that must be satisfied in order for the clause to be chosen. The <code><em>template</em></code> specifies what form the output takes, usually in terms of the pattern variables.</p>
</div>
<div class="paragraph">
<p>During expansion, the transformation procedure <code>extend-syntax</code> generates attempts to match the input expression against each pattern in the order the clauses are given. If the input expression matches the pattern, the pattern variables are bound to the corresponding pieces of the input expression and the fender for the clause, if any, is evaluated. If the fender returns a true value, the given expansion is performed. If input does not match the pattern or if the fender returns a false value, the transformation procedure tries the next clause. An exception is raised with condition type <code>&amp;assertion</code> if no clause can be chosen.</p>
</div>
<div class="paragraph">
<p>Within the pattern, <em>ellipsis</em> (<code>...</code>) may be used to specify zero or more occurrences of the preceding pattern fragment, or prototype. Similarly, ellipses may be used in the output to specify the construction of zero or more expansion prototypes. In this case, the expansion prototype must contain part of an input pattern prototype. The use of patterns, templates, ellipses within patterns and templates, and fenders is illustrated in the following sequence of examples.</p>
</div>
<div class="paragraph">
<p>The first example, defining <code>rec</code>, uses a single keyword, a single clause with no fender, and no ellipses.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(extend-syntax (rec)
  [(rec id val)
   (let ([id #f])
     (set! id val)
     id)])</code></pre>
</div>
</div>
<div class="paragraph">
<p>The second example, defining <code>when</code>, shows the use of ellipses.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(extend-syntax (when)
  [(when test exp1 exp2 ...)
   (if test (begin exp1 exp2 ...) #f)])</code></pre>
</div>
</div>
<div class="paragraph">
<p>The next example shows the definition of <code>let</code>. The definition of <code>let</code> shows the use of multiple ellipses, employing one for the identifier/value pairs and one for the expressions in the body. It also shows that the prototype need not be a single identifier, and that pieces of the prototype may be separated from one another in the template.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(extend-syntax (let)
  [(let ([x e] ...) b1 b2 ...)
   ((lambda (x ...) b1 b2 ...) e ...)])</code></pre>
</div>
</div>
<div class="paragraph">
<p>The next example shows <code>let*</code>, whose syntax is the same as for <code>let</code>, but which is defined recursively in terms of <code>let</code> with two clauses (one for the base case, one for the recursion step) since it must produce a nested structure.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(extend-syntax (let*)
  [(let* () b1 b2 ...)
   (let () b1 b2 ...)]
  [(let* ([x e] more ...) b1 b2 ...)
   (let ([x e]) (let* (more ...) b1 b2 ...))])</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first pattern/template pair matches any <code>let*</code> expression with no identifier/value pairs and maps it into the equivalent <code>begin</code> expression. This is the base case. The second pattern/template pair matches any <code>let*</code> expression with one or more identifier/value pairs and transforms it into a <code>let</code> expression binding the first pair whose body is a <code>let*</code> expression binding the remaining pairs. This is the recursion step, which will eventually lead us to the base case because we remove one identifier/value pair at each step. Notice that the second pattern uses the pattern variable <code>more</code> for the second and later identifier/value pairs; this makes the pattern and template less cluttered and makes it clear that only the first identifier/value pair is dealt with explicitly.</p>
</div>
<div class="paragraph">
<p>The definition for <code>and</code> requires three clauses. The first clause is necessary to recognize <code>(and)</code>, and the second two define all other <code>and</code> forms recursively.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(extend-syntax (and)
  [(and) #t]
  [(and x) x]
  [(and x y ...) (if x (and y ...) #f)])</code></pre>
</div>
</div>
<div class="paragraph">
<p>The definition for <code>cond</code> requires four clauses. As with <code>let*</code>, <code>cond</code> must be described recursively, partly because it produces nested <code>if</code> expressions, and partly because one ellipsis prototype would not be sufficient to describe all possible <code>cond</code> clauses. The definition of <code>cond</code> also requires that we specify <code>else</code> as a keyword, in addition to <code>cond</code>. Here is the definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(extend-syntax (cond else)
  [(cond) #f]
  [(cond (else e1 e2 ...))
   (begin e1 e2 ...)]
  [(cond (test) more ...)
   (or test (cond more ...))]
  [(cond (test e1 e2 ...) more ...)
   (if test
       (begin e1 e2 ...)
       (cond more ...))])</code></pre>
</div>
</div>
<div class="paragraph">
<p>Two of the clauses are base cases and two are recursion steps. The first base case is an empty <code>cond</code>. The value of <code>cond</code> in this case is unspecified, so the choice of <code>#f</code> is somewhat arbitrary. The second base case is a <code>cond</code> containing only an <code>else</code> clause; this is transformed to the equivalent <code>begin</code> expression. The two recursion steps differ in the number of expressions in the <code>cond</code> clause. The value of <code>cond</code> when the first true clause contains only the test expression is the value of the test. This is similar to what <code>or</code> does, so we expand the <code>cond</code> clause into an <code>or</code> expression. On the other hand, when there are expressions following the test expression, the value of the last expression is returned, so we use <code>if</code> and <code>begin</code>.</p>
</div>
<div class="paragraph">
<p>To be absolutely correct about the syntax of <code>let</code>, we actually must require that the bound identifiers in the input are symbols. If we typed something like <code>(let ([3 x]) x)</code> we would not get an error from <code>let</code> because it does not check to verify that the objects in the identifier positions are symbols. Instead, <code>lambda</code> may complain, or perhaps the system evaluator long after expansion is complete. This is where fenders are useful.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(extend-syntax (let)
  [(let ([x e] ...) b1 b2 ...)
   (andmap symbol? '(x ...))
   ((lambda (x ...) b1 b2 ...) e ...)])</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>andmap</code> of <code>symbol?</code> over <code>'(x ...)</code> assures that each bound identifier is a symbol. A fender is simply a Scheme expression. Within that expression, any quoted object is first expanded by the same rules as the template part of the clause. In this case, <code>'(x ...)</code> is expanded to the list of identifiers from the identifier/value pairs.</p>
</div>
<div class="paragraph">
<p><code>extend-syntax</code> typically handles everything you need it for, but some syntactic extension definitions require the ability to include the result of evaluating an arbitrary Scheme expression. This ability is provided by <code>with</code>.</p>
</div>
<div id="compat:s20" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(with ((<em>pat</em> <em>expr</em>) ...) <em>template</em>)</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>processed <code><em>template</em></code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>with</code> is valid only within an template inside of <code>extend-syntax</code>. <code>with</code> patterns are the same as <code>extend-syntax</code> patterns, <code>with</code> expressions are the same as <code>extend-syntax</code> fenders, and <code>with</code> templates are the same as <code>extend-syntax</code> templates.</p>
</div>
<div class="paragraph">
<p><code>with</code> can be used to introduce new pattern identifiers bound to expressions produced by arbitrary Scheme expressions within <code>extend-syntax</code> templates. That is, <code>with</code> allows an escape from the declarative style of <code>extend-syntax</code> into the procedural style of full Scheme.</p>
</div>
<div class="paragraph">
<p>One common use of <code>with</code> is the introduction of a temporary identifier or list of temporary identifiers into a template. <code>with</code> is also used to perform complex transformations that might be clumsy or inefficient if performed within the <code>extend-syntax</code> framework.</p>
</div>
<div class="paragraph">
<p>For example, <code>or</code> requires the use of a temporary identifier. We could define <code>or</code> as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(extend-syntax (or)
  [(or) #f]
  [(or x) x]
  [(or x y ...)
   (let ([temp x])
     (if temp temp (or y ...)))])</code></pre>
</div>
</div>
<div class="paragraph">
<p>This would work until we placed an <code>or</code> expression within the scope of an occurrence of <code>temp</code>, in which case strange things could happen, since <code>extend-syntax</code> does not respect lexical scoping. (This is one of the reasons that <code>define-syntax</code> is preferable to <code>extend-syntax</code>.)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(let ([temp #t])
  (or #f temp)) ⇒ #f</code></pre>
</div>
</div>
<div class="paragraph">
<p>One solution is to use <code>gensym</code> and <code>with</code> to create a temporary identifier, as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(extend-syntax (or)
  [(or) #f]
  [(or x) x]
  [(or x y ...)
   (with ([temp (gensym)])
     (let ([temp x])
       (if temp temp (or y ...))))])</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also, <code>with</code> can be used to combine elements of the input pattern in ways not possible directly with <code>extend-syntax</code>, such as the following <code>folding-plus</code> example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(extend-syntax (folding-plus)
  [(folding-plus x y)
   (and (number? 'x) (number? 'y))
   (with ([val (+ 'x 'y)])
      val)]
  [(folding-plus x y) (+ x y)])</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>folding-plus</code> collapses into the value of <code>(+ x y)</code> if both <code>x</code> and <code>y</code> are numeric constants. Otherwise, <code>folding-plus</code> is transformed into <code>(+ x y)</code> for later evaluation. The fender checks that the operands are numbers at expansion time, and the <code>with</code> performs the evaluation. As with fenders, expansion is performed only within a quoted expressions, since <code>quote</code> sets the data apart from the remainder of the Scheme expression.</p>
</div>
<div class="paragraph">
<p>The example below binds a list of pattern variables to a list of temporary symbols, taking advantage of the fact that <code>with</code> allows us to bind patterns to expressions. This list of temporaries helps us to implement the <code>sigma</code> syntactic extension. <code>sigma</code> is similar to <code>lambda</code>, except it assigns the identifiers in the identifier list instead of creating new bindings. It may be used to perform a series of assignments in parallel.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(extend-syntax (sigma)
  [(sigma (x ...) e1 e2 ...)
   (with ([(t ...) (map (lambda (x) (gensym)) '(x ...))])
     (lambda (t ...)
       (set! x t) ...
       e1 e2 ...))])

(let ([x 'a] [y 'b])
  ((sigma (x y) (list x y)) y x)) ⇒ (b a)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The final example below uses <code>extend-syntax</code> to implement <code>define-structure</code>, following a similar example using <code>syntax-case</code> in <a href="../../the-scheme-programming-language-4th/en/index.html#section_8.4.">Section 8.4</a> of <em>The Scheme Programming Language, 4th Edition</em>.</p>
</div>
<div class="paragraph">
<p>The definition of <code>define-structure</code> makes use of two pattern/template clauses. Two clauses are needed to handle the optionality of the second subexpression. The first clause matches the form without the second subexpression and merely converts it into the equivalent form with the second subexpression present, but empty.</p>
</div>
<div class="paragraph">
<p>The definition also makes heavy use of <code>with</code> to evaluate Scheme expressions at expansion time. The first four <code>with</code> clauses are used to manufacture the identifiers that name the automatically defined procedures. (The procedure <code>format</code> is particularly useful here, but it could be replaced with <code>string-append!</code>, using <code>symbol-&gt;string</code> as needed.) The first two clauses yield single identifiers (for the constructor and predicate), while the next two yield lists of identifiers (for the field access and assignment procedures). The fifth <code>with</code> clause (the final clause in the outer <code>with</code>) is used to count the total length vector needed for each instance of the structure, which must include room for the name and all of the fields. The final <code>with</code> clause (the only clause in the inner <code>with</code>) is used to create a list of vector indexes, one for each field (starting at 1, since the structure name occupies position 0).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(extend-syntax (define-structure)
  [(define-structure (name id1 ...))
   (define-structure (name id1 ...) ())]
  [(define-structure (name id1 ...) ([id2 val] ...))
   (with ([constructor
           (string->symbol (format "make-~a" 'name))]
          [predicate
           (string->symbol (format "~a?" 'name))]
          [(access ...)
           (map (lambda (x)
                  (string->symbol
                    (format "~a-~a" 'name x)))
                '(id1 ... id2 ...))]
          [(assign ...)
           (map (lambda (x)
                  (string->symbol
                    (format "set-~a-~a!" 'name x)))
                '(id1 ... id2 ...))]
          [count (length '(name id1 ... id2 ...))])
     (with ([(index ...)
             (let f ([i 1])
               (if (= i 'count)
                   '()
                   (cons i (f (+ i 1)))))])
       (begin
         (define constructor
           (lambda (id1 ...)
             (let* ([id2 val] ...)
               (vector 'name id1 ... id2 ...))))
         (define predicate
           (lambda (obj)
             (and (vector? obj)
                  (= (vector-length obj) count)
                  (eq? (vector-ref obj 0) 'name))))
         (define access
           (lambda (obj)
             (vector-ref obj index)))
         ...
         (define assign
           (lambda (obj newval)
             (vector-set! obj index newval)))
         ...)))])</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_16.3.">Section 16.3. Structures</h3>
<div class="paragraph">
<p>This section describes a mechanism, similar to the record-defining mechanisms of <a href="#section_7.15.">Section 7.15</a>, that permits the creation of data structures with fixed sets of named fields. Unlike record types, structure types are not unique types, but are instead implemented as vectors. Specifically, a structure is implemented as a vector whose length is one more than the number of fields and whose first element contains the symbolic name of the structure.</p>
</div>
<div class="paragraph">
<p>The representation of structures as vectors simplifies reading and printing of structures somewhat as well as extension of the structure definition facility. It does, however, have some drawbacks. One is that structures may be treated as ordinary vectors by mistake in situations where doing so is inappropriate. When dealing with both structures and vectors in a program, care must be taken to look for the more specific structure type before checking for the more generic vector type, e.g., in a series of <code>cond</code> clauses. A similar drawback is that structure instances are easily "forged," either intentionally or by accident. It is also impossible to control how structures are printed and read.</p>
</div>
<div class="paragraph">
<p>Structures are created via <code>define-structure</code>. Each structure definition defines a constructor procedure, a type predicate, an access procedure for each of its fields, and an assignment procedure for each of its fields. <code>define-structure</code> allows the programmer to control which fields are arguments to the generated constructor procedure and which fields are explicitly initialized by the constructor procedure.</p>
</div>
<div class="paragraph">
<p><code>define-structure</code> is simple yet powerful enough for most applications, and it is easily extended to handle many applications for which it is not sufficient. The definition of <code>define-structure</code> given at the end of this section can serve as a starting point for more complicated variants.</p>
</div>
<div id="compat:s25" class="hdlist">
<table>
<tr>
<td class="hdlist1">
syntax
</td>
<td class="hdlist2">
<p><code>(define-structure (<em>name</em> <em>id<sub>1</sub></em> ...) ((<em>id<sub>2</sub></em> <em>expr</em>) ...))</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
returns
</td>
<td class="hdlist2">
<p>unspecified</p>
</td>
</tr>
<tr>
<td class="hdlist1">
libraries
</td>
<td class="hdlist2">
<p><code>(chezscheme)</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A <code>define-structure</code> form is a definition and may appear anywhere and only where other definitions may appear.</p>
</div>
<div class="paragraph">
<p><code>define-structure</code> defines a new data structure, <code><em>name</em></code>, and creates a set of procedures for creating and manipulating instances of the structure. The identifiers <code><em>id<sub>1</sub></em> ...</code> and <code><em>id<sub>2</sub></em> ...</code> name the fields of the data structure.</p>
</div>
<div class="paragraph">
<p>The following procedures are defined by <code>define-structure</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a constructor procedure whose name is <code>make-<em>name</em></code>,</p>
</li>
<li>
<p>a type predicate whose name is <code><em>name</em>?</code>,</p>
</li>
<li>
<p>an access procedure whose name is <code><em>name</em>-<em>field</em></code> for each field name <code><em>id<sub>1</sub></em> ...</code> and <code><em>id<sub>2</sub></em> ...</code>, and</p>
</li>
<li>
<p>an assignment procedure whose name is <code>set-<em>name</em>-<em>field</em>!</code> for each field name <code><em>id<sub>1</sub></em> ...</code> and <code><em>id<sub>2</sub></em> ...</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The fields named by the identifiers <code><em>id<sub>1</sub></em> ...</code> are initialized by the arguments to the constructor procedure. The fields named by the identifiers <code><em>id<sub>2</sub></em> ...</code> are initialized explicitly to the values of the expressions <code><em>expr</em> ...</code>. Each expression is evaluated within the scope of the identifiers <code><em>id<sub>1</sub></em> ...</code> (bound to the corresponding field values) and any of the identifiers <code><em>id<sub>2</sub></em> ...</code> (bound to the corresponding field values) appearing before it (as if within a <code>let*</code>).</p>
</div>
<div class="paragraph">
<p>To clarify, the constructor behaves as if defined as</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define make-<em>name</em>
  (lambda (<em>id<sub>1</sub></em> ...)
    (let* ([<em>id<sub>2</sub></em> <em>expr</em>] ...)
      <em>body</em>)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code><em>body</em></code> builds the structure from the values of the identifiers <code><em>id<sub>1</sub></em> ...</code> and <code><em>id<sub>2</sub></em> ...</code>.</p>
</div>
<div class="paragraph">
<p>If no fields other than those initialized by the arguments to the constructor procedure are needed, the second subexpression, <code>((<em>id<sub>2</sub></em> <em>expr</em>) ...)</code>, may be omitted.</p>
</div>
<div id="compat:s27" class="paragraph">
<p>The following simple example demonstrates how pairs might be defined in Scheme if they did not already exist. Both fields are initialized by the arguments to the constructor procedure.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-structure (pare car cdr))
(define p (make-pare 'a 'b))

(pare? p) ⇒ #t
(pair? p) ⇒ #f
(pare? '(a . b)) ⇒ #f

(pare-car p) ⇒ a
(pare-cdr p) ⇒ b

(set-pare-cdr! p (make-pare 'b 'c))

(pare-car (pare-cdr p)) ⇒ b
(pare-cdr (pare-cdr p)) ⇒ c</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example defines a handy string data structure, called a <em>stretch-string</em>, that grows as needed. This example uses a field explicitly initialized to a value that depends on the value of the constructor argument fields.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-structure (stretch-string length fill)
  ([string (make-string length fill)]))

(define stretch-string-ref
  (lambda (s i)
    (let ([n (stretch-string-length s)])
      (when (>= i n) (stretch-stretch-string! s (+ i 1) n))
      (string-ref (stretch-string-string s) i))))

(define stretch-string-set!
  (lambda (s i c)
    (let ([n (stretch-string-length s)])
      (when (>= i n) (stretch-stretch-string! s (+ i 1) n))
      (string-set! (stretch-string-string s) i c))))

(define stretch-string-fill!
  (lambda (s c)
    (string-fill! (stretch-string-string s) c)
    (set-stretch-string-fill! s c)))

(define stretch-stretch-string!
  (lambda (s i n)
    (set-stretch-string-length! s i)
    (let ([str (stretch-string-string s)]
          [fill (stretch-string-fill s)])
      (let ([xtra (make-string (- i n) fill)])
        (set-stretch-string-string! s
          (string-append str xtra))))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>As often happens, most of the procedures defined automatically are used only to define more specialized procedures, in this case the procedures <code>stretch-string-ref</code> and <code>stretch-string-set!</code>. <code>stretch-string-length</code> and <code>stretch-string-string</code> are the only automatically defined procedures that are likely to be called directly in code that uses stretch strings.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define ss (make-stretch-string 2 #\X))

(stretch-string-string ss) ⇒ "XX"
(stretch-string-ref ss 3) ⇒ #\X
(stretch-string-length ss) ⇒ 4
(stretch-string-string ss) ⇒ "XXXX"

(stretch-string-fill! ss #\@)
(stretch-string-string ss) ⇒ "@@@@"
(stretch-string-ref ss 5) ⇒ #\@
(stretch-string-string ss) ⇒ "@@@@@@"

(stretch-string-set! ss 7 #\=)
(stretch-string-length ss) ⇒ 8
(stretch-string-string ss) ⇒ "@@@@@@@="</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="../../the-scheme-programming-language-4th/en/index.html#section_8.4.">Section 8.4</a> of <em>The Scheme Programming Language, 4th Edition</em> defines a simplified variant of <code>define-structure</code> as an example of the use of <code>syntax-case</code>. The definition given below implements the complete version.</p>
</div>
<div class="paragraph">
<p><code>define-structure</code> expands into a series of definitions for names generated from the structure name and field names. The generated identifiers are created with <code>datum-&gt;syntax</code> to make the identifiers visible where the <code>define-structure</code> form appears. Since a <code>define-structure</code> form expands into a <code>begin</code> containing definitions, it is itself a definition and can be used wherever definitions are valid.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="scheme" class="language-scheme hljs">(define-syntax define-structure
  (lambda (x)
    (define gen-id
      (lambda (template-id . args)
        (datum->syntax template-id
          (string->symbol
            (apply string-append
                   (map (lambda (x)
                          (if (string? x)
                              x
                              (symbol->string
                                (syntax->datum x))))
                        args))))))
    (syntax-case x ()
      ((_ (name field1 ...))
       (andmap identifier? #'(name field1 ...))
       #'(define-structure (name field1 ...) ()))
      ((_ (name field1 ...) ((field2 init) ...))
       (andmap identifier? #'(name field1 ... field2 ...))
       (with-syntax
         ((constructor (gen-id #'name "make-" #'name))
          (predicate (gen-id #'name #'name "?"))
          ((access ...)
           (map (lambda (x) (gen-id x #'name "-" x))
                #'(field1 ... field2 ...)))
          ((assign ...)
           (map (lambda (x) (gen-id x "set-" #'name "-" x "!"))
                #'(field1 ... field2 ...)))
          (structure-length
           (+ (length #'(field1 ... field2 ...)) 1))
          ((index ...)
           (let f ([i 1] [ids #'(field1 ... field2 ...)])
             (if (null? ids)
                 '()
                 (cons i (f (+ i 1) (cdr ids)))))))
         #'(begin
             (define constructor
               (lambda (field1 ...)
                 (let* ([field2 init] ...)
                   (vector 'name field1 ... field2 ...))))
             (define predicate
               (lambda (x)
                 (and (vector? x)
                      (#3%fx= (vector-length x) structure-length)
                      (eq? (vector-ref x 0) 'name))))
             (define access (lambda (x) (vector-ref x index)))
             ...
             (define assign
               (lambda (x update) (vector-set! x index update)))
             ...))))))</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="section_16.4.">Section 16.4. Compatibility File</h3>
<div class="paragraph">
<p>Current versions of <em>Chez Scheme</em> are distributed with a compatibility file containing definitions of various syntactic forms and procedures supported by earlier versions of <em>Chez Scheme</em> for which support has since been dropped. This file, <code>compat.ss</code>, is typically installed in the library subdirectory of the <em>Chez Scheme</em> installation directory.</p>
</div>
<div class="paragraph">
<p>In some cases, the forms and procedures found in <code>compat.ss</code> have been dropped because they were infrequently used and easily written directly in Scheme. In other cases, the forms and procedures have been rendered obsolete by improvements in the system. In such cases, new code should be written to use the newer features, and older code should be rewritten if possible to use the newer features as well.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bibliography">Bibliography</h2>
<div class="sectionbody">
<div class="ulist bibliography">
<ul class="bibliography">
<li>
<p><a id="ref1"></a>[1] Michael Adams and R. Kent Dybvig. Efficient nondestructive equality checking for trees and graphs. In <em>Proceedings of the 13th ACM SIGPLAN International Conference on Functional Programming</em>, 179-188, September 2008.</p>
</li>
<li>
<p><a id="ref2"></a>[2] J. Michael Ashley and R. Kent Dybvig. An efficient implementation of multiple return values in Scheme. In <em>Proceedings of the 1994 ACM Conference on Lisp and Functional Programming</em>, 140-149, June 1994.</p>
</li>
<li>
<p><a id="ref3"></a>[3] Carl Bruggeman, Oscar Waddell, and R. Kent Dybvig. Representing control in the presence of one-shot continuations. In <em>Proceedings of the SIGPLAN '96 Conference on Programming Language Design and Implementation</em>, 99-107, May 1996.</p>
</li>
<li>
<p><a id="ref4"></a>[4] Robert G. Burger and R. Kent Dybvig. Printing floating-point numbers quickly and accurately. In <em>Proceedings of the SIGPLAN '96 Conference on Programming Language Design and Implementation</em>, 108-116, May 1996.</p>
</li>
<li>
<p><a id="ref5"></a>[5] Robert G. Burger and R. Kent Dybvig. An infrastructure for profile-driven dynamic recompilation. In <em>Proceedings of the IEEE Computer Society 1998 International Conference on Computer Languages</em>, 240-251, May 1998.</p>
</li>
<li>
<p><a id="ref6"></a>[6] Robert G. Burger, Oscar Waddell, and R. Kent Dybvig. Register allocation using lazy saves, eager restores, and greedy shuffling. In <em>Proceedings of the ACM SIGPLAN '95 Conference on Programming Language Design and Implementation</em>, 130-138, June 1995.</p>
</li>
<li>
<p><a id="ref7"></a>[7] R. Kent Dybvig. <em>Three Implementation Models for Scheme</em>. PhD thesis, University of North Carolina, Chapel Hill, April 1987.</p>
</li>
<li>
<p><a id="ref8"></a>[8] R. Kent Dybvig. Writing hygienic macros in scheme with syntax-case. Technical Report 356, Indiana Computer Science Department, June 1992.</p>
</li>
<li>
<p><a id="ref9"></a>[9] R. Kent Dybvig. The development of Chez Scheme. In <em>Proceedings of the Eleventh ACM SIGPLAN International Conference on Functional Programming</em>, 1-12, September 2006.</p>
</li>
<li>
<p><a id="ref10"></a>[10] R. Kent Dybvig. A Scheme for native threads. In <em>Symposium in Honor of Mitchell Wand</em>, August 2009. <em><a href="http://www.ccs.neu.edu/events/wand-symposium/" class="bare">http://www.ccs.neu.edu/events/wand-symposium/</a></em>.</p>
</li>
<li>
<p><a id="ref11"></a>[11] R. Kent Dybvig. <em>The Scheme Programming Language</em>, 4th edition. MIT Press, 2009.</p>
</li>
<li>
<p><a id="ref12"></a>[12] R. Kent Dybvig, Carl Bruggeman, and David Eby. Guardians in a generation-based garbage collector. In <em>Proceedings of the SIGPLAN '93 Conference on Programming Language Design and Implementation</em>, 207-216, June 1993.</p>
</li>
<li>
<p><a id="ref13"></a>[13] R. Kent Dybvig, David Eby, and Carl Bruggeman. Don&#8217;t stop the BiBOP: Flexible and efficient storage management for dynamically-typed languages. Technical Report 400, Indiana Computer Science Department, March 1994.</p>
</li>
<li>
<p><a id="ref14"></a>[14] R. Kent Dybvig, Daniel P. Friedman, and Christopher T. Haynes. Expansion-passing style: A general macro mechanism. <em>Lisp and Symbolic Computation</em>, 1(1):53-75, 1988.</p>
</li>
<li>
<p><a id="ref15"></a>[15] R. Kent Dybvig and Robert Hieb. Engines from continuations. <em>Computer Languages</em>, 14(2):109-123, 1989.</p>
</li>
<li>
<p><a id="ref16"></a>[16] R. Kent Dybvig and Robert Hieb. A new approach to procedures with variable arity. <em>Lisp and Symbolic Computation</em>, 3(3):229-244, September 1990.</p>
</li>
<li>
<p><a id="ref17"></a>[17] R. Kent Dybvig, Robert Hieb, and Carl Bruggeman. Syntactic abstraction in Scheme. <em>Lisp and Symbolic Computation</em>, 5(4):295-326, 1993.</p>
</li>
<li>
<p><a id="ref18"></a>[18] R. Kent Dybvig, Robert Hieb, and Tom Butler. Destination-driven code generation. Technical Report 302, Indiana Computer Science Department, February 1990.</p>
</li>
<li>
<p><a id="ref19"></a>[19] Abdulaziz Ghuloum. <em>Implicit phasing for library dependencies</em>. PhD thesis, Indiana University, Indianapolis, IN, USA, 2008. Adviser-Dybvig, R. Kent.</p>
</li>
<li>
<p><a id="ref20"></a>[20] Abdulaziz Ghuloum and R. Kent Dybvig. Generation-friendly eq hash tables. In <em>2007 Workshop on Scheme and Functional Programming</em>, 27-35, 2007. <em><a href="http://sfp2007.ift.ulaval.ca/programme.html" class="bare">http://sfp2007.ift.ulaval.ca/programme.html</a></em>.</p>
</li>
<li>
<p><a id="ref21"></a>[21] Abdulaziz Ghuloum and R. Kent Dybvig. Implicit phasing for R6RS libraries. In <em>Proceedings of the 12th ACM SIGPLAN International Conference on Functional Programming</em>, 303-314, 2007. <a href="http://doi.acm.org/10.1145/1291220.1291197" class="bare">http://doi.acm.org/10.1145/1291220.1291197</a>.</p>
</li>
<li>
<p><a id="ref22"></a>[22] Abdulaziz Ghuloum and R. Kent Dybvig. Fixing letrec (reloaded). In 2009 Workshop on Scheme and Functional Programming, August 2009. <a href="http://www.schemeworkshop.org/2009/" class="bare">http://www.schemeworkshop.org/2009/</a>.</p>
</li>
<li>
<p><a id="ref23"></a>[23] Barry Hayes. Ephemerons: a new finalization mechanism. In Proceedings of the 12th ACM SIGPLAN Conference on Object-Oriented Languages, Programming, Systems, and Applications, 176-183, 1997. <a href="https://doi.org/10.1145/263700.263733" class="bare">https://doi.org/10.1145/263700.263733</a>.</p>
</li>
<li>
<p><a id="ref24"></a>[24] Christopher T. Haynes and Daniel P. Friedman. Abstracting timed preemption with engines. Computer Languages, 12(2):109-121, 1987.</p>
</li>
<li>
<p><a id="ref25"></a>[25] Robert Hieb, R. Kent Dybvig, and Carl Bruggeman. Representing control in the presence of first-class continuations. In Proceedings of the SIGPLAN '90 Conference on Programming Language Design and Implementation, 66-77, June 1990.</p>
</li>
<li>
<p><a id="ref26"></a>[26] IEEE Computer Society. IEEE Standard for the Scheme Programming Language, May 1991. IEEE Std 1178-1990.</p>
</li>
<li>
<p><a id="ref27"></a>[27] Eugene Kohlbecker. Syntactic Extensions in the Programming Language Lisp. PhD thesis, Indiana University, Bloomington, August 1986.</p>
</li>
<li>
<p><a id="ref28"></a>[28] Michael Sperber, R. Kent Dybvig, Matthew Flatt, and Anton van Straaten (eds.). Revised<sup>6</sup> report on the algorithmic language Scheme, September 2007. <a href="http://www.r6rs.org/" class="bare">http://www.r6rs.org/</a>.</p>
</li>
<li>
<p><a id="ref29"></a>[29] Michael Sperber, R. Kent Dybvig, Matthew Flatt, and Anton van Straaten (eds.). Revised<sup>6</sup> report on the algorithmic language Scheme---non-normative appendices, September 2007. <a href="http://www.r6rs.org/" class="bare">http://www.r6rs.org/</a>.</p>
</li>
<li>
<p><a id="ref30"></a>[30] Guy L. Steele Jr. Common Lisp, the Language, second edition. Digital Press, 1990.</p>
</li>
<li>
<p><a id="ref31"></a>[31] Oscar Waddell and R. Kent Dybvig. Fast and effective procedure inlining. In Fourth International Symposium on Static Analysis, volume 1302 of Springer-Verlag Lecture Notes in Computer Science, 35-52. Springer-Verlag, 1997.</p>
</li>
<li>
<p><a id="ref32"></a>[32] Oscar Waddell and R. Kent Dybvig. Extending the scope of syntactic abstraction. In Conference Record of the 26th Annual ACM Symposium on Principles of Programming Languages, 203-213, January 1999.</p>
</li>
<li>
<p><a id="ref33"></a>[33] Oscar Waddell, Dipanwita Sarkar, and R. Kent Dybvig. Fixing letrec: A faithful yet efficient implementation of Scheme&#8217;s recursive binding construct. Higher-order and symbolic computation, 18(3/4):299-326, 2005.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="summary_of_forms">Summary of Forms</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The table that follows summarizes the syntactic forms and procedures described in this book along with standard Scheme syntactic forms and procedures. It shows each item&#8217;s category and the page number where it is defined. Page numbers prefixed by "t" refer to <a href="../../the-scheme-programming-language-4th/en/index.html">The Scheme Programming Language, 4th Edition</a> (TSPL4).</p>
</div>
<div class="paragraph">
<p>All page numbers appearing here refer to the printed version of these books and also serve as hypertext links to the corresponding locations in the electronic versions of these books.</p>
</div>
<table class="tableblock frame-none grid-none fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Form</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Category</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'<em>obj</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s2">t141</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>`<em>obj</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s5">t142</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>,<em>obj</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s5">t142</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>,@<em>obj</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s5">t142</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>=&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s16">t112</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s26">t297</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>...</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s26">t297</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#'<em>template</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s33">t300</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#`<em>template</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s40">t305</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#,<em>template</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s40">t305</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#,@<em>template</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s40">t305</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#%<em>variable</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s109">358</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#2%<em>variable</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s109">358</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#3%<em>variable</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s109">358</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>($primitive <em>variable</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s109">358</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>($primitive 2 <em>variable</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s109">358</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>($primitive 3 <em>variable</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s109">358</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$system</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">module</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s35">311</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;assertion</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s21">t366</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;condition</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s13">t362</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;continuation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s6">327</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;error</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s22">t367</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;format</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s4">326</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;i/o</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s32">t371</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;i/o-decoding</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s42">t375</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;i/o-encoding</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s43">t376</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;i/o-file-already-exists</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s39">t374</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;i/o-file-does-not-exist</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s40">t374</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;i/o-file-is-read-only</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s38">t374</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;i/o-file-protection</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s37">t373</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;i/o-filename</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s36">t373</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;i/o-invalid-position</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s35">t372</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;i/o-port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s41">t375</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;i/o-read</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s33">t372</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;i/o-write</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s34">t372</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;implementation-restriction</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s28">t369</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;irritants</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s25">t368</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;lexical</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s29">t370</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;message</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s24">t368</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;no-infinities</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s44">t376</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;no-nans</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s45">t377</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;non-continuable</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s27">t369</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;serious</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s19">t366</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;source</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s5">326</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;syntax</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s30">t370</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;undefined</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s31">t371</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;violation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s20">t366</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;warning</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s23">t367</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;who</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s26">t369</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(* <em>num</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s91">t172</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(+ <em>num</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s89">t171</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(- <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s90">t172</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(- <em>num<sub>1</sub></em> <em>num<sub>2</sub></em> <em>num<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s90">t172</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(-1+ <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s68">209</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(/ <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s92">t172</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(/ <em>num<sub>1</sub></em> <em>num<sub>2</sub></em> <em>num<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s92">t172</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(1+ <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s68">209</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(1- <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s68">209</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(&lt; <em>real<sub>1</sub></em> <em>real<sub>2</sub></em> <em>real<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s67">208</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(&lt; <em>real<sub>1</sub></em> <em>real<sub>2</sub></em> <em>real<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s88">t170</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(&lt;= <em>real<sub>1</sub></em> <em>real<sub>2</sub></em> <em>real<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s67">208</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(&lt;= <em>real<sub>1</sub></em> <em>real<sub>2</sub></em> <em>real<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s88">t170</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(= <em>num<sub>1</sub></em> <em>num<sub>2</sub></em> <em>num<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s67">208</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(= <em>num<sub>1</sub></em> <em>num<sub>2</sub></em> <em>num<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s88">t170</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(&gt; <em>real<sub>1</sub></em> <em>real<sub>2</sub></em> <em>real<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s67">208</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(&gt; <em>real<sub>1</sub></em> <em>real<sub>2</sub></em> <em>real<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s88">t170</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(&gt;= <em>real<sub>1</sub></em> <em>real<sub>2</sub></em> <em>real<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s67">208</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(&gt;= <em>real<sub>1</sub></em> <em>real<sub>2</sub></em> <em>real<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s88">t170</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(abort)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s182">377</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(abort <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s182">377</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>abort-handler</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s183">377</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(abs <em>real</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s105">t178</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(acos <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s132">t185</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(acosh <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s77">212</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(add-duration <em>time</em> <em>time<sub>d</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s209">383</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(add-duration! <em>time</em> <em>time<sub>d</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s209">383</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>add-prefix</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s22">310</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(add1 <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s68">209</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>alias</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s22">310</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(alias <em>id<sub>1</sub></em> <em>id<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s38">314</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(and <em>expr</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s11">t110</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(andmap <em>procedure</em> <em>list<sub>1</sub></em> <em>list<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#control:s8">125</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(angle <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s124">t183</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(annotation-expression <em>annotation</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s51">317</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(annotation-option-set <em>symbol</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s68">320</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(annotation-options <em>annotation</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s54">318</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(annotation-source <em>annotation</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s52">318</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(annotation-stripped <em>annotation</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s53">318</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(annotation? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s50">317</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(append)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s49">t160</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(append <em>list</em> ... <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s49">t160</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(append! <em>list</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s13">137</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(apply <em>procedure</em> <em>obj</em> ... <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s3">t107</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(apropos <em>s</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s37">335</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(apropos <em>s</em> <em>env</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s37">335</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(apropos-list <em>s</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s36">335</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(apropos-list <em>s</em> <em>env</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s36">335</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ash <em>int</em> <em>count</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s52">204</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(asin <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s132">t185</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(asinh <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s77">212</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(assert <em>expression</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s5">t359</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(assertion-violation <em>who</em> <em>msg</em> <em>irritant</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s4">t358</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(assertion-violation? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s21">t366</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(assertion-violationf <em>who</em> <em>msg</em> <em>irritant</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s2">326</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(assoc <em>obj</em> <em>alist</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s58">t165</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(assp <em>procedure</em> <em>alist</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s60">t166</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(assq <em>obj</em> <em>alist</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s58">t165</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(assv <em>obj</em> <em>alist</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s58">t165</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(atan <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s133">t185</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(atan <em>real<sub>1</sub></em> <em>real<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s133">t185</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(atanh <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s77">212</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(atom? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s2">133</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>base-exception-handler</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s12">328</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(begin <em>expr<sub>1</sub></em> <em>expr<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s4">t108</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bignum? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s11">190</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(binary-port-input-buffer <em>binary-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s16">219</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(binary-port-input-count <em>binary-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s18">220</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(binary-port-input-index <em>binary-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s16">219</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(binary-port-input-size <em>binary-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s16">219</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(binary-port-output-buffer <em>output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s20">221</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(binary-port-output-count <em>binary-output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s22">222</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(binary-port-output-index <em>output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s20">221</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(binary-port-output-size <em>output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s20">221</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(binary-port? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s45">t270</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bitwise-and <em>exint</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s134">t186</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bitwise-arithmetic-shift <em>exint<sub>1</sub></em> <em>exint<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s144">t190</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bitwise-arithmetic-shift-left <em>exint<sub>1</sub></em> <em>exint<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s143">t189</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bitwise-arithmetic-shift-right <em>exint<sub>1</sub></em> <em>exint<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s143">t189</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bitwise-bit-count <em>exint</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s136">t187</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bitwise-bit-field <em>exint<sub>1</sub></em> <em>exint<sub>2</sub></em> <em>exint<sub>3</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s141">t189</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bitwise-bit-set? <em>exint<sub>1</sub></em> <em>exint<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s139">t188</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bitwise-copy-bit <em>exint<sub>1</sub></em> <em>exint<sub>2</sub></em> <em>exint<sub>3</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s140">t188</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bitwise-copy-bit-field <em>exint<sub>1</sub></em> <em>exint<sub>2</sub></em> <em>exint<sub>3</sub></em> <em>exint<sub>4</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s142">t189</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bitwise-first-bit-set <em>exint</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s138">t187</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bitwise-if <em>exint<sub>1</sub></em> <em>exint<sub>2</sub></em> <em>exint<sub>3</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s135">t186</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bitwise-ior <em>exint</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s134">t186</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bitwise-length <em>exint</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s137">t187</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bitwise-not <em>exint</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s134">t186</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bitwise-reverse-bit-field <em>exint<sub>1</sub></em> <em>exint<sub>2</sub></em> <em>exint<sub>3</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s146">t191</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bitwise-rotate-bit-field <em>exint<sub>1</sub></em> <em>exint<sub>2</sub></em> <em>exint<sub>3</sub></em> <em>exint<sub>4</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s145">t190</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bitwise-xor <em>exint</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s134">t186</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(block-read <em>textual-input-port</em> <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s69">235</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(block-read <em>textual-input-port</em> <em>string</em> <em>count</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s69">235</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(block-write <em>textual-output-port</em> <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s86">242</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(block-write <em>textual-output-port</em> <em>string</em> <em>count</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s86">242</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(boolean=? <em>boolean<sub>1</sub></em> <em>boolean<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s271">t243</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(boolean? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s14">t150</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bound-identifier=? <em>identifier<sub>1</sub></em> <em>identifier<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s37">t302</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(box <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s82">150</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(box-cas! <em>box</em> <em>old-obj</em> <em>new-obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s85">151</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(box-immutable <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s87">151</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(box? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s81">150</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(break <em>who</em> <em>msg</em> <em>irritant</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s17">329</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(break <em>who</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s17">329</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(break)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s17">329</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>break-handler</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s19">330</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(buffer-mode <em>symbol</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s27">t261</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(buffer-mode? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s28">t262</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bwp-object? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#smgmt:s28">408</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytes-allocated)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s223">389</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytes-allocated <em>g</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s223">389</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytes-deallocated)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s225">389</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector <em>fill</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s59">146</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-&gt;immutable-bytevector <em>bytevector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s66">149</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-&gt;s8-list <em>bytevector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s60">147</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-&gt;sint-list <em>bytevector</em> <em>eness</em> <em>size</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s260">t238</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-&gt;string <em>bytevector</em> <em>transcoder</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s91">t286</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-&gt;u8-list <em>bytevector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s252">t232</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-&gt;uint-list <em>bytevector</em> <em>eness</em> <em>size</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s260">t238</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-compress <em>bytevector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s69">149</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-copy <em>bytevector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s246">t229</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-copy! <em>src</em> <em>src-start</em> <em>dst</em> <em>dst-start</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s247">t230</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-fill! <em>bytevector</em> <em>fill</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s245">t229</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-ieee-double-native-ref <em>bytevector</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s262">t239</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-ieee-double-native-set! <em>bytevector</em> <em>n</em> <em>x</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s263">t239</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-ieee-double-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s264">t240</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-ieee-double-set! <em>bytevector</em> <em>n</em> <em>x</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s265">t240</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-ieee-single-native-ref <em>bytevector</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s262">t239</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-ieee-single-native-set! <em>bytevector</em> <em>n</em> <em>x</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s263">t239</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-ieee-single-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s264">t240</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-ieee-single-set! <em>bytevector</em> <em>n</em> <em>x</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s265">t240</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-length <em>bytevector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s243">t229</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-s16-native-ref <em>bytevector</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s254">t232</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-s16-native-set! <em>bytevector</em> <em>n</em> <em>s16</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s255">t233</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-s16-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s256">t235</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-s16-set! <em>bytevector</em> <em>n</em> <em>s16</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s257">t236</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-s24-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s63">148</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-s24-set! <em>bytevector</em> <em>n</em> <em>s24</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s64">148</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-s32-native-ref <em>bytevector</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s254">t232</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-s32-native-set! <em>bytevector</em> <em>n</em> <em>s32</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s255">t233</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-s32-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s256">t235</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-s32-set! <em>bytevector</em> <em>n</em> <em>s32</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s257">t236</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-s40-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s63">148</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-s40-set! <em>bytevector</em> <em>n</em> <em>s40</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s64">148</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-s48-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s63">148</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-s48-set! <em>bytevector</em> <em>n</em> <em>s48</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s64">148</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-s56-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s63">148</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-s56-set! <em>bytevector</em> <em>n</em> <em>s56</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s64">148</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-s64-native-ref <em>bytevector</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s254">t232</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-s64-native-set! <em>bytevector</em> <em>n</em> <em>s64</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s255">t233</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-s64-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s256">t235</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-s64-set! <em>bytevector</em> <em>n</em> <em>s64</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s257">t236</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-s8-ref <em>bytevector</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s249">t231</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-s8-set! <em>bytevector</em> <em>n</em> <em>s8</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s251">t231</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-sint-ref <em>bytevector</em> <em>n</em> <em>eness</em> <em>size</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s258">t237</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-sint-set! <em>bytevector</em> <em>n</em> <em>sint</em> <em>eness</em> <em>size</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s259">t238</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-truncate! <em>bytevector</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s62">147</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-u16-native-ref <em>bytevector</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s254">t232</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-u16-native-set! <em>bytevector</em> <em>n</em> <em>u16</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s255">t233</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-u16-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s256">t235</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-u16-set! <em>bytevector</em> <em>n</em> <em>u16</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s257">t236</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-u24-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s63">148</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-u24-set! <em>bytevector</em> <em>n</em> <em>u24</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s64">148</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-u32-native-ref <em>bytevector</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s254">t232</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-u32-native-set! <em>bytevector</em> <em>n</em> <em>u32</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s255">t233</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-u32-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s256">t235</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-u32-set! <em>bytevector</em> <em>n</em> <em>u32</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s257">t236</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-u40-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s63">148</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-u40-set! <em>bytevector</em> <em>n</em> <em>u40</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s64">148</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-u48-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s63">148</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-u48-set! <em>bytevector</em> <em>n</em> <em>u48</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s64">148</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-u56-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s63">148</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-u56-set! <em>bytevector</em> <em>n</em> <em>u56</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s64">148</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-u64-native-ref <em>bytevector</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s254">t232</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-u64-native-set! <em>bytevector</em> <em>n</em> <em>u64</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s255">t233</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-u64-ref <em>bytevector</em> <em>n</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s256">t235</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-u64-set! <em>bytevector</em> <em>n</em> <em>u64</em> <em>eness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s257">t236</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-u8-ref <em>bytevector</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s248">t230</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-u8-set! <em>bytevector</em> <em>n</em> <em>u8</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s250">t231</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-uint-ref <em>bytevector</em> <em>n</em> <em>eness</em> <em>size</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s258">t237</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-uint-set! <em>bytevector</em> <em>n</em> <em>uint</em> <em>eness</em> <em>size</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s259">t238</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector-uncompress <em>bytevector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s72">150</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector=? <em>bytevector<sub>1</sub></em> <em>bytevector<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s244">t229</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(bytevector? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s24">t155</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(caaaar <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(caaadr <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(caaar <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(caadar <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(caaddr <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(caadr <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(caar <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cadaar <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cadadr <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cadar <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(caddar <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cadddr <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(caddr <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cadr <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(call-with-bytevector-output-port <em>procedure</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s38">t266</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(call-with-bytevector-output-port <em>procedure</em> <em>?transcoder</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s38">t266</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(call-with-current-continuation <em>procedure</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s54">t123</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(call-with-input-file <em>path</em> <em>procedure</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s58">231</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(call-with-input-file <em>path</em> <em>procedure</em> <em>options</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s58">231</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(call-with-input-file <em>path</em> <em>procedure</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s77">t281</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(call-with-output-file <em>path</em> <em>procedure</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s78">240</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(call-with-output-file <em>path</em> <em>procedure</em> <em>options</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s78">240</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(call-with-output-file <em>path</em> <em>procedure</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s78">t282</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(call-with-port <em>port</em> <em>procedure</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s51">t272</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(call-with-string-output-port <em>procedure</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s39">t267</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(call-with-values <em>producer</em> <em>consumer</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s71">t131</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(call/1cc <em>procedure</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#control:s9">126</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(call/cc <em>procedure</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s54">t123</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(car <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s38">t156</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(case <em>expr<sub>0</sub></em> <em>clause<sub>1</sub></em> <em>clause<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#control:s1">123</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(case <em>expr<sub>0</sub></em> <em>clause<sub>1</sub></em> <em>clause<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s18">t113</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(case-lambda <em>clause</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#binding:s13">t94</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>case-sensitive</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s109">253</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cd</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s139">260</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cdaaar <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cdaadr <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cdaar <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cdadar <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cdaddr <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cdadr <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cdar <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cddaar <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cddadr <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cddar <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cdddar <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cddddr <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cdddr <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cddr <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s42">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cdr <em>pair</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s39">t156</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ceiling <em>real</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s103">t177</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cfl* <em>cflonum</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s38">198</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cfl+ <em>cflonum</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s38">198</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cfl- <em>cflonum<sub>1</sub></em> <em>cflonum<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s38">198</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cfl-conjugate <em>cflonum</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s39">199</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cfl-imag-part <em>cflonum</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s36">198</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cfl-magnitude-squared <em>cflonum</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s41">199</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cfl-real-part <em>cflonum</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s36">198</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cfl/ <em>cflonum<sub>1</sub></em> <em>cflonum<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s38">198</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cfl= <em>cflonum</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s37">198</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cflonum? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s13">191</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char- <em>char<sub>1</sub></em> <em>char<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s16">138</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-&gt;integer <em>char</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s210">t215</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-alphabetic? <em>char</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s203">t213</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-ci&lt;=? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s15">138</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-ci&lt;=? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> <em>char<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s202">t212</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-ci&lt;? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s15">138</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-ci&lt;? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> <em>char<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s202">t212</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-ci=? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s15">138</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-ci=? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> <em>char<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s202">t212</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-ci&gt;=? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s15">138</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-ci&gt;=? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> <em>char<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s202">t212</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-ci&gt;? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s15">138</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-ci&gt;? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> <em>char<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s202">t212</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-downcase <em>char</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s207">t214</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-foldcase <em>char</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s209">t215</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-general-category <em>char</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s205">t214</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-lower-case? <em>char</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s204">t213</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-name <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s107">251</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-name <em>name</em> <em>char</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s107">251</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-numeric? <em>char</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s203">t213</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-ready?)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s68">235</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-ready? <em>textual-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s68">235</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-title-case? <em>char</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s204">t213</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-titlecase <em>char</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s208">t214</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-upcase <em>char</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s206">t214</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-upper-case? <em>char</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s204">t213</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char-whitespace? <em>char</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s203">t213</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char&lt;=? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s15">138</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char&lt;=? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> <em>char<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s201">t212</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char&lt;? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s15">138</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char&lt;? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> <em>char<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s201">t212</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char=? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s15">138</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char=? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> <em>char<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s201">t212</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char&gt;=? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s15">138</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char&gt;=? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> <em>char<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s201">t212</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char&gt;? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s15">138</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char&gt;? <em>char<sub>1</sub></em> <em>char<sub>2</sub></em> <em>char<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s201">t212</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(char? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s19">t154</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(chmod <em>path</em> <em>mode</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s150">263</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(clear-input-port)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s36">226</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(clear-input-port <em>input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s36">226</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(clear-output-port)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s37">226</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(clear-output-port <em>output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s37">226</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(close-input-port <em>input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s88">t285</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(close-output-port <em>output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s88">t285</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(close-port <em>port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s46">t270</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(collect)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#smgmt:s9">402</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(collect <em>cg</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#smgmt:s9">402</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(collect <em>cg</em> <em>max-tg</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#smgmt:s9">402</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(collect <em>cg</em> <em>min-tg</em> <em>max-tg</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#smgmt:s9">402</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>collect-generation-radix</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#smgmt:s15">404</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>collect-maximum-generation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#smgmt:s16">404</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>collect-notify</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#smgmt:s11">403</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(collect-rendezvous)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#smgmt:s10">403</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>collect-request-handler</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#smgmt:s17">404</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>collect-trip-bytes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#smgmt:s12">403</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(collections)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s229">390</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>command-line</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s193">379</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(command-line)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#libraries:s17">t350</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>command-line-arguments</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s195">379</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>commonization-level</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s122">363</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s43">337</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile <em>obj</em> <em>env</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s43">337</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile-file <em>input-filename</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s63">341</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile-file <em>input-filename</em> <em>output-filename</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s63">341</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>compile-file-message</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s119">360</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>compile-imported-libraries</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#libraries:s26">288</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>compile-interpret-simple</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s112">359</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile-library <em>input-filename</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s68">342</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile-library <em>input-filename</em> <em>output-filename</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s68">342</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>compile-library-handler</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s72">343</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile-port <em>input-port</em> <em>output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s79">345</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile-port <em>input-port</em> <em>output-port</em> <em>sfd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s79">345</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile-port <em>input-port</em> <em>output-port</em> <em>sfd</em> <em>wpo-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s79">345</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile-port <em>input-port</em> <em>output-port</em> <em>sfd</em> <em>wpo-port</em> <em>covop</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s79">345</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>compile-profile</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s140">368</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile-program <em>input-filename</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s69">342</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile-program <em>input-filename</em> <em>output-filename</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s69">342</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>compile-program-handler</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s74">344</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile-script <em>input-filename</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s66">342</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile-script <em>input-filename</em> <em>output-filename</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s66">342</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile-time-value-value <em>ctv</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s17">302</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile-time-value? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s16">302</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile-to-file <em>obj-list</em> <em>output-file</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s81">346</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile-to-file <em>obj-list</em> <em>output-file</em> <em>sfd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s81">346</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile-to-port <em>obj-list</em> <em>output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s80">346</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile-to-port <em>obj-list</em> <em>output-port</em> <em>sfd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s80">346</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile-to-port <em>obj-list</em> <em>output-port</em> <em>sfd</em> <em>wpo-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s80">346</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile-to-port <em>obj-list</em> <em>output-port</em> <em>sfd</em> <em>wpo-port</em> <em>covop</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s80">346</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile-whole-library <em>input-filename</em> <em>output-filename</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s78">345</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile-whole-program <em>input-filename</em> <em>output-filename</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s76">344</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compile-whole-program <em>input-filename</em> <em>output-filename</em> <em>libs-visible?</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s76">344</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(complex? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s17">t151</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>compress-format</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s42">227</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>compress-level</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s43">227</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compute-composition <em>object</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#debug:s31">55</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compute-composition <em>object</em> <em>generation</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#debug:s31">55</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compute-size <em>object</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#debug:s30">54</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(compute-size <em>object</em> <em>generation</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#debug:s30">54</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(concatenate-object-files <em>out-file</em> <em>in-file<sub>1</sub></em> <em>in-file<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s82">347</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cond <em>clause<sub>1</sub></em> <em>clause<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s13">t111</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(condition <em>condition</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s15">t362</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(condition-accessor <em>rtd</em> <em>procedure</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s18">t365</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(condition-broadcast <em>cond</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s16">430</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(condition-continuation <em>condition</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s6">327</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(condition-irritants <em>condition</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s25">t368</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(condition-message <em>condition</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s24">t368</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(condition-name <em>condition</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s17">431</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(condition-predicate <em>rtd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s18">t365</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(condition-signal <em>cond</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s15">430</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(condition-wait <em>cond</em> <em>mutex</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s14">430</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(condition-wait <em>cond</em> <em>mutex</em> <em>timeout</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s14">430</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(condition-who <em>condition</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s26">t369</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(condition? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s14">t362</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(conjugate <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s74">211</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cons <em>obj<sub>1</sub></em> <em>obj<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s37">t156</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cons* <em>obj</em> ... <em>final-obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s44">t158</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>console-error-port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s73">238</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>console-input-port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s55">230</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>console-output-port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s71">238</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>constant</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s1">t141</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>constructor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s176">178</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(continuation-condition? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s6">327</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(copy-environment <em>env</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s34">334</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(copy-environment <em>env</em> <em>mutable?</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s34">334</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(copy-environment <em>env</em> <em>mutable?</em> <em>syms</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s34">334</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(copy-time <em>time</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s208">383</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cos <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s131">t185</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cosh <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s76">211</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cost-center-allocation-count <em>cost-center</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s245">394</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cost-center-instruction-count <em>cost-center</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s244">394</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cost-center-time <em>cost-center</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s246">394</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cost-center? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s242">393</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cp0-effort-limit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s120">360</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cp0-outer-unroll-limit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s120">360</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cp0-score-limit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s120">360</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(cpu-time)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s221">388</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(create-exception-state)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s15">329</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(create-exception-state <em>procedure</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s15">329</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(critical-section <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s27">331</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(current-date)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s210">384</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(current-date <em>offset</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s210">384</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>current-directory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s139">260</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>current-error-port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s74">238</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(current-error-port)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s32">t263</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>current-eval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s39">336</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>current-exception-state</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s14">328</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>current-expand</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s92">349</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>current-input-port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s56">230</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(current-input-port)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s32">t263</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>current-locate-source-object-source</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s74">321</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>current-make-source-object</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s62">319</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(current-memory-bytes)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s226">389</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>current-output-port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s72">238</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(current-output-port)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s32">t263</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(current-time)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s202">381</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(current-time <em>time-type</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s202">381</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>current-transcoder</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s11">218</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>custom-port-buffer-size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s54">230</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(date-&gt;time-utc <em>date</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s216">387</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(date-and-time)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s217">387</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(date-and-time <em>date</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s217">387</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(date-day <em>date</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s213">385</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(date-dst? <em>date</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s215">386</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(date-hour <em>date</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s213">385</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(date-minute <em>date</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s213">385</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(date-month <em>date</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s213">385</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(date-nanosecond <em>date</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s213">385</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(date-second <em>date</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s213">385</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(date-week-day <em>date</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s214">386</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(date-year <em>date</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s213">385</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(date-year-day <em>date</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s214">386</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(date-zone-name <em>date</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s215">386</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(date-zone-offset <em>date</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s213">385</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(date? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s212">385</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(datum <em>template</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s9">297</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(datum-&gt;syntax <em>template-identifier</em> <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s45">t308</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(datum-&gt;syntax-object <em>template-identifier</em> <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s10">297</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(debug)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#debug:s16">41</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>debug-condition</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s13">328</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>debug-level</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s110">358</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>debug-on-exception</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s10">328</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(decode-float <em>x</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s30">197</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(default-exception-handler <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s8">327</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(default-library-search-handler <em>who</em> <em>library</em> <em>directories</em> <em>extensions</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#libraries:s31">289</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(default-prompt-and-read <em>level</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s176">376</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>default-record-equal-procedure</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s160">171</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>default-record-hash-procedure</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s161">171</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(define <em>var</em> <em>expr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#binding:s24">t100</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(define <em>var</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#binding:s24">t100</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(define (<em>var<sub>0</sub></em> <em>var<sub>1</sub></em> ...) <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#binding:s24">t100</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(define (<em>var<sub>0</sub></em> . <em>var<sub>r</sub></em>) <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#binding:s24">t100</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(define (<em>var<sub>0</sub></em> <em>var<sub>1</sub></em> <em>var<sub>2</sub></em> ... . <em>var<sub>r</sub></em>) <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#binding:s24">t100</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(define-condition-type <em>name</em> <em>parent</em> <em>constructor</em> <em>pred</em> <em>field</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s17">t364</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(define-enumeration <em>name</em> (<em>symbol</em> ...) <em>constructor</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s290">t250</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(define-ftype <em>ftype-name</em> <em>ftype</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s137">77</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(define-ftype (<em>ftype-name</em> <em>ftype</em>) ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s137">77</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(define-property <em>id</em> <em>key</em> <em>expr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s18">302</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(define-record <em>name</em> (<em>fld<sub>1</sub></em> ...) <em>fld<sub>2</sub></em> <em>init</em>) ...) (<em>opt</em> ...</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s172">174</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(define-record <em>name</em> <em>parent</em> (<em>fld<sub>1</sub></em> ...) <em>fld<sub>2</sub></em> <em>init</em>) ...) (<em>opt</em> ...</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s172">174</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(define-record-type <em>record-name</em> <em>clause</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s13">t328</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(define-record-type (<em>record-name</em> <em>constructor</em> <em>pred</em>) <em>clause</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s13">t328</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(define-structure (<em>name</em> <em>id<sub>1</sub></em> ...) <em>id<sub>2</sub></em> <em>expr</em>) ...</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#compat:s25">447</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(define-syntax <em>keyword</em> <em>expr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s12">t292</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(define-top-level-syntax <em>symbol</em> <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#binding:s32">119</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(define-top-level-syntax <em>symbol</em> <em>obj</em> <em>env</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#binding:s32">119</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(define-top-level-value <em>symbol</em> <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#binding:s24">117</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(define-top-level-value <em>symbol</em> <em>obj</em> <em>env</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#binding:s24">117</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(define-values <em>formals</em> <em>expr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#binding:s16">114</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(delay <em>expr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s65">t128</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(delete-directory <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s148">262</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(delete-directory <em>path</em> <em>error?</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s148">262</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(delete-file <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s147">262</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(delete-file <em>path</em> <em>error?</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s147">262</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(delete-file <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s90">t286</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(denominator <em>rat</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s119">t181</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(directory-list <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s140">260</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(directory-separator)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s153">263</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(directory-separator? <em>char</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s152">263</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(disable-interrupts)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s26">331</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(display <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s85">t285</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(display <em>obj</em> <em>textual-output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s85">t285</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(display-condition <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s7">327</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(display-condition <em>obj</em> <em>textual-output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s7">327</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(display-statistics)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s220">388</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(display-statistics <em>textual-output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s220">388</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(display-string <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s85">242</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(display-string <em>string</em> <em>textual-output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s85">242</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(div <em>x<sub>1</sub></em> <em>x<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s99">t175</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(div-and-mod <em>x<sub>1</sub></em> <em>x<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s99">t175</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(div0 <em>x<sub>1</sub></em> <em>x<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s100">t176</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(div0-and-mod0 <em>x<sub>1</sub></em> <em>x<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s100">t176</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(do ((<em>var</em> <em>init</em> <em>update</em>) ...) (<em>test</em> <em>result</em> ...) <em>expr</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s25">t115</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>drop-prefix</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s22">310</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(dynamic-wind <em>in</em> <em>body</em> <em>out</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#control:s11">127</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(dynamic-wind <em>critical?</em> <em>in</em> <em>body</em> <em>out</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#control:s11">127</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(dynamic-wind <em>in</em> <em>body</em> <em>out</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s56">t124</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ee-auto-indent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#expeditor:s1">415</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ee-auto-paren-balance</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#expeditor:s3">416</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ee-bind-key <em>key</em> <em>procedure</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#expeditor:s10">417</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ee-common-identifiers</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#expeditor:s9">416</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ee-compose <em>ecmd</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#expeditor:s78">425</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ee-default-repeat</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#expeditor:s6">416</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ee-flash-parens</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#expeditor:s4">416</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ee-history-limit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#expeditor:s8">416</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ee-noisy</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#expeditor:s7">416</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ee-paren-flash-delay</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#expeditor:s5">416</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ee-standard-indent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#expeditor:s2">415</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ee-string-macro <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#expeditor:s77">425</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>else</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s16">t112</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>enable-cross-library-optimization</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s116">360</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(enable-interrupts)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s26">331</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>enable-object-counts</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s237">392</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(endianness <em>symbol</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s240">t228</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(engine-block)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#control:s27">131</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(engine-return <em>obj</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#control:s28">132</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(enum-set-&gt;list <em>enum-set</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s294">t252</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(enum-set-complement <em>enum-set</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s299">t254</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(enum-set-constructor <em>enum-set</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s292">t251</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(enum-set-difference <em>enum-set<sub>1</sub></em> <em>enum-set<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s298">t253</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(enum-set-indexer <em>enum-set</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s301">t254</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(enum-set-intersection <em>enum-set<sub>1</sub></em> <em>enum-set<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s298">t253</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(enum-set-member? <em>symbol</em> <em>enum-set</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s297">t253</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(enum-set-projection <em>enum-set<sub>1</sub></em> <em>enum-set<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s300">t254</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(enum-set-subset? <em>enum-set<sub>1</sub></em> <em>enum-set<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s295">t252</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(enum-set-union <em>enum-set<sub>1</sub></em> <em>enum-set<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s298">t253</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(enum-set-universe <em>enum-set</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s293">t252</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(enum-set=? <em>enum-set<sub>1</sub></em> <em>enum-set<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s296">t252</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(enum-set? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s0">133</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(enumerate <em>ls</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s9">135</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(environment <em>import-spec</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s81">t137</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(environment-mutable? <em>env</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s30">333</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(environment-symbols <em>env</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s35">335</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(environment? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s29">333</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(eof-object)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s54">t273</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(eof-object? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s53">t273</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(eol-style <em>symbol</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s23">t259</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ephemeron-cons <em>obj<sub>1</sub></em> <em>obj<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#smgmt:s26">407</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ephemeron-pair? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#smgmt:s27">408</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(eq-hashtable-cell <em>hashtable</em> <em>key</em> <em>default</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s131">164</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(eq-hashtable-contains? <em>hashtable</em> <em>key</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s129">163</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(eq-hashtable-delete! <em>hashtable</em> <em>key</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s132">164</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(eq-hashtable-ephemeron? <em>hashtable</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s126">162</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(eq-hashtable-ref <em>hashtable</em> <em>key</em> <em>default</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s128">162</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(eq-hashtable-set! <em>hashtable</em> <em>key</em> <em>value</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s127">162</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(eq-hashtable-update! <em>hashtable</em> <em>key</em> <em>procedure</em> <em>default</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s130">163</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(eq-hashtable-weak? <em>hashtable</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s125">162</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(eq-hashtable? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s124">161</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(eq? <em>obj<sub>1</sub></em> <em>obj<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s10">t143</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(equal-hash <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s279">t245</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(equal? <em>obj<sub>1</sub></em> <em>obj<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s13">t148</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(eqv? <em>obj<sub>1</sub></em> <em>obj<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s12">t146</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(error <em>who</em> <em>msg</em> <em>irritant</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s4">t358</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(error-handling-mode <em>symbol</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s25">t260</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(error? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s22">t367</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(errorf <em>who</em> <em>msg</em> <em>irritant</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s2">326</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(eval <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s38">336</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(eval <em>obj</em> <em>env</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s38">336</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(eval <em>obj</em> <em>environment</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s80">t136</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>eval-syntax-expanders-when</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s101">355</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(eval-when <em>situations</em> <em>form<sub>1</sub></em> <em>form<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s98">351</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(even? <em>int</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s96">t174</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(exact <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s114">t180</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(exact-&gt;inexact <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s116">t181</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(exact-integer-sqrt <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s128">t184</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(exact? <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s86">t170</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>except</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s22">310</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(exclusive-cond <em>clause<sub>1</sub></em> <em>clause<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#control:s0">123</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(exists <em>procedure</em> <em>list<sub>1</sub></em> <em>list<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s36">t119</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(exit <em>obj</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s180">377</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(exit)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#libraries:s18">t350</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(exit <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#libraries:s18">t350</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>exit-handler</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s181">377</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(exp <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s129">t184</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(expand <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s90">349</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(expand <em>obj</em> <em>env</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s90">349</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>expand-output</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s124">363</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(expand/optimize <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s96">350</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(expand/optimize <em>obj</em> <em>env</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s96">350</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>expand/optimize-output</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s124">363</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(export <em>export-spec</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#libraries:s17">284</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>expression-editor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">module</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#expeditor:s0">415</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(expt <em>num<sub>1</sub></em> <em>num<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s111">t179</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(expt-mod <em>int<sub>1</sub></em> <em>int<sub>2</sub></em> <em>int<sub>3</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s69">209</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(extend-syntax (<em>name</em> <em>key</em> ...) (<em>pat</em> <em>fender</em> <em>template</em>) ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#compat:s8">441</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fasl-compressed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s135">260</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fasl-file <em>ifn</em> <em>ofn</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s138">260</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fasl-read <em>binary-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s134">259</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fasl-read <em>binary-input-port situation</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s134">259</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fasl-strip-options <em>symbol</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s88">348</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fasl-write <em>obj</em> <em>binary-output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s133">258</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fields</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s16">t331</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(file-access-time <em>path/port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s145">261</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(file-access-time <em>path/port</em> <em>follow?</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s145">261</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>file-buffer-size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s51">229</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(file-change-time <em>path/port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s145">261</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(file-change-time <em>path/port</em> <em>follow?</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s145">261</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(file-directory? <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s143">261</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(file-directory? <em>path</em> <em>follow?</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s143">261</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(file-exists? <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s141">261</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(file-exists? <em>path</em> <em>follow?</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s141">261</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(file-exists? <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s89">t286</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(file-length <em>port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s31">224</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(file-modification-time <em>path/port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s145">261</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(file-modification-time <em>path/port</em> <em>follow?</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s145">261</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(file-options <em>symbol</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s26">t261</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(file-port? <em>port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s52">229</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(file-position <em>port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s35">225</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(file-position <em>port</em> <em>pos</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s35">225</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(file-regular? <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s142">261</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(file-regular? <em>path</em> <em>follow?</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s142">261</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(file-symbolic-link? <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s144">261</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(filter <em>procedure</em> <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s55">t164</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(find <em>procedure</em> <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s57">t165</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(finite? <em>real</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s97">t174</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fixnum-&gt;flonum <em>fx</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s198">t211</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fixnum-width)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s152">t193</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fixnum? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s150">t193</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fl* <em>fl</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s186">t207</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fl+ <em>fl</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s184">t206</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fl- <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s185">t206</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fl- <em>fl<sub>1</sub></em> <em>fl<sub>2</sub></em> <em>fl<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s185">t206</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fl-make-rectangular <em>flonum<sub>1</sub></em> <em>flonum<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s35">198</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fl/ <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s187">t207</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fl/ <em>fl<sub>1</sub></em> <em>fl<sub>2</sub></em> <em>fl<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s187">t207</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fl&lt; <em>flonum<sub>1</sub></em> <em>flonum<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s28">195</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fl&lt;= <em>flonum<sub>1</sub></em> <em>flonum<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s28">195</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fl&lt;=? <em>fl<sub>1</sub></em> <em>fl<sub>2</sub></em> <em>fl<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s178">t203</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fl&lt;? <em>fl<sub>1</sub></em> <em>fl<sub>2</sub></em> <em>fl<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s178">t203</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fl= <em>flonum<sub>1</sub></em> <em>flonum<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s28">195</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fl=? <em>fl<sub>1</sub></em> <em>fl<sub>2</sub></em> <em>fl<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s178">t203</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fl&gt; <em>flonum<sub>1</sub></em> <em>flonum<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s28">195</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fl&gt;= <em>flonum<sub>1</sub></em> <em>flonum<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s28">195</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fl&gt;=? <em>fl<sub>1</sub></em> <em>fl<sub>2</sub></em> <em>fl<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s178">t203</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fl&gt;? <em>fl<sub>1</sub></em> <em>fl<sub>2</sub></em> <em>fl<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s178">t203</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flabs <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s192">t209</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flacos <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s195">t210</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flasin <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s195">t210</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flatan <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s195">t210</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flatan <em>fl<sub>1</sub></em> <em>fl<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s195">t210</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flceiling <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s190">t208</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flcos <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s194">t210</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fldenominator <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s191">t209</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fldiv <em>fl<sub>1</sub></em> <em>fl<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s188">t207</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fldiv-and-mod <em>fl<sub>1</sub></em> <em>fl<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s188">t207</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fldiv0 <em>fl<sub>1</sub></em> <em>fl<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s189">t208</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fldiv0-and-mod0 <em>fl<sub>1</sub></em> <em>fl<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s189">t208</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fleven? <em>fl-int</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s182">t205</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flexp <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s193">t209</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flexpt <em>fl<sub>1</sub></em> <em>fl<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s197">t210</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flfinite? <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s181">t205</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flfloor <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s190">t208</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flinfinite? <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s181">t205</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flinteger? <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s180">t204</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fllog <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s193">t209</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fllog <em>fl<sub>1</sub></em> <em>fl<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s193">t209</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fllp <em>flonum</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s31">197</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flmax <em>fl<sub>1</sub></em> <em>fl<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s183">t205</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flmin <em>fl<sub>1</sub></em> <em>fl<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s183">t205</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flmod <em>fl<sub>1</sub></em> <em>fl<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s188">t207</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flmod0 <em>fl<sub>1</sub></em> <em>fl<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s189">t208</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flnan? <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s181">t205</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flnegative? <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s179">t204</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flnonnegative? <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s29">196</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flnonpositive? <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s29">196</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flnumerator <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s191">t209</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flodd? <em>fl-int</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s182">t205</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flonum-&gt;fixnum <em>flonum</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s26">195</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flonum? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s177">t203</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(floor <em>real</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s102">t177</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flpositive? <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s179">t204</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flround <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s190">t208</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flsin <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s194">t210</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flsqrt <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s196">t210</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fltan <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s194">t210</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fltruncate <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s190">t208</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fluid-let ((<em>var</em> <em>expr</em>) ...) <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#binding:s19">116</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fluid-let-syntax ((<em>keyword</em> <em>expr</em>) ...) <em>form<sub>1</sub></em> <em>form<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s0">293</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flush-output-port)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s38">226</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flush-output-port <em>output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s38">226</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flush-output-port <em>output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s74">t280</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(flzero? <em>fl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s179">t204</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fold-left <em>procedure</em> <em>obj</em> <em>list<sub>1</sub></em> <em>list<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s38">t120</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fold-right <em>procedure</em> <em>obj</em> <em>list<sub>1</sub></em> <em>list<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s41">t121</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(for-all <em>procedure</em> <em>list<sub>1</sub></em> <em>list<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s37">t119</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(for-each <em>procedure</em> <em>list<sub>1</sub></em> <em>list<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s33">t118</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(force <em>promise</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s65">t128</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(foreign-address-name <em>address</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s159">90</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(foreign-alloc <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s132">74</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(foreign-callable <em>conv</em> ... <em>proc-exp</em> (<em>param-type</em> ...) <em>res-type</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s127">70</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(foreign-callable-code-object <em>address</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s131">73</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(foreign-callable-entry-point <em>code</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s130">73</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(foreign-entry <em>entry-name</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s158">90</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(foreign-entry? <em>entry-name</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s157">90</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(foreign-free <em>address</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s133">74</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(foreign-procedure <em>conv</em> ... <em>entry-exp</em> (<em>param-type</em> ...) <em>res-type</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s10">59</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(foreign-ref <em>type</em> <em>address</em> <em>offset</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s134">75</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(foreign-set! <em>type</em> <em>address</em> <em>offset</em> <em>value</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s135">76</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(foreign-sizeof <em>type</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s136">77</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fork-thread <em>thunk</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s2">428</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(format <em>format-string</em> <em>obj</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s104">249</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(format #f <em>format-string</em> <em>obj</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s104">249</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(format #t <em>format-string</em> <em>obj</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s104">249</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(format <em>textual-output-port</em> <em>format-string</em> <em>obj</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s104">249</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(format-condition? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s4">326</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fprintf <em>textual-output-port</em> <em>format-string</em> <em>obj</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s106">251</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(free-identifier=? <em>identifier<sub>1</sub></em> <em>identifier<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s37">t302</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fresh-line)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s88">243</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fresh-line <em>textual-output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s88">243</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-&amp;ref <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s151">84</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-&amp;ref <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em> <em>index</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s151">84</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-guardian <em>ftype-name</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s25">433</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-init-lock! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s19">432</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-init-lock! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em> <em>index</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s19">432</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-lock! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s19">432</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-lock! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em> <em>index</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s19">432</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-locked-decr! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s20">433</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-locked-decr! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em> <em>index</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s20">433</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-locked-incr! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s20">433</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-locked-incr! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em> <em>index</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s20">433</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-pointer-&gt;sexpr <em>fptr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s156">88</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-pointer-address <em>fptr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s148">84</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-pointer-ftype <em>fptr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s155">88</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-pointer-null? <em>fptr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s150">84</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-pointer=? <em>fptr<sub>1</sub></em> <em>fptr<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s149">84</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-pointer? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s147">83</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-pointer? <em>ftype-name</em> <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s147">83</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-ref <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s152">86</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-ref <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em> <em>index</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s152">86</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-set! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em> <em>val-expr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s152">86</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-set! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em> <em>index</em> <em>val-expr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s152">86</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-sizeof <em>ftype-name</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s142">81</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-spin-lock! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s19">432</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-spin-lock! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em> <em>index</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s19">432</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-unlock! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s19">432</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ftype-unlock! <em>ftype-name</em> (<em>a</em> ...) <em>fptr-expr</em> <em>index</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s19">432</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fx* <em>fixnum</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s19">193</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fx* <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s159">t195</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fx*/carry <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em> <em>fx<sub>3</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s162">t197</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fx+ <em>fixnum</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s17">192</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fx+ <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s157">t195</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fx+/carry <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em> <em>fx<sub>3</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s162">t197</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fx- <em>fixnum<sub>1</sub></em> <em>fixnum<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s18">193</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fx- <em>fx</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s158">t195</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fx- <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s158">t195</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fx-/carry <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em> <em>fx<sub>3</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s162">t197</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fx/ <em>fixnum<sub>1</sub></em> <em>fixnum<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s20">193</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fx1+ <em>fixnum</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s21">193</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fx1- <em>fixnum</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s21">193</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fx&lt; <em>fixnum<sub>1</sub></em> <em>fixnum<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s15">191</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fx&lt;= <em>fixnum<sub>1</sub></em> <em>fixnum<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s15">191</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fx&lt;=? <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em> <em>fx<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s153">t193</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fx&lt;? <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em> <em>fx<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s153">t193</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fx= <em>fixnum<sub>1</sub></em> <em>fixnum<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s15">191</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fx=? <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em> <em>fx<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s153">t193</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fx&gt; <em>fixnum<sub>1</sub></em> <em>fixnum<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s15">191</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fx&gt;= <em>fixnum<sub>1</sub></em> <em>fixnum<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s15">191</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fx&gt;=? <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em> <em>fx<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s153">t193</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fx&gt;? <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em> <em>fx<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s153">t193</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxabs <em>fixnum</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s25">194</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxand <em>fx</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s163">t197</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxarithmetic-shift <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s173">t201</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxarithmetic-shift-left <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s172">t201</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxarithmetic-shift-right <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s172">t201</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxbit-count <em>fx</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s165">t198</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxbit-field <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em> <em>fx<sub>3</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s170">t200</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxbit-set? <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s168">t199</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxcopy-bit <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em> <em>fx<sub>3</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s169">t200</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxcopy-bit-field <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em> <em>fx<sub>3</sub></em> <em>fx<sub>4</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s171">t200</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxdiv <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s160">t196</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxdiv-and-mod <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s160">t196</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxdiv0 <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s161">t196</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxdiv0-and-mod0 <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s161">t196</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxeven? <em>fx</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s155">t194</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxfirst-bit-set <em>fx</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s167">t199</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxif <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em> <em>fx<sub>3</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s164">t198</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxior <em>fx</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s163">t197</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxlength <em>fx</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s166">t198</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxlogand <em>fixnum</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s53">204</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxlogbit0 <em>index</em> <em>fixnum</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s59">206</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxlogbit1 <em>index</em> <em>fixnum</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s60">207</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxlogbit? <em>index</em> <em>fixnum</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s57">205</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxlogior <em>fixnum</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s54">204</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxlognot <em>fixnum</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s56">205</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxlogor <em>fixnum</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s54">204</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxlogtest <em>fixnum<sub>1</sub></em> <em>fixnum<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s58">206</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxlogxor <em>fixnum</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s55">205</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxmax <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s156">t195</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxmin <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s156">t195</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxmod <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s160">t196</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxmod0 <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s161">t196</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxmodulo <em>fixnum<sub>1</sub></em> <em>fixnum<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s24">194</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxnegative? <em>fx</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s154">t194</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxnonnegative? <em>fixnum</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s16">192</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxnonpositive? <em>fixnum</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s16">192</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxnot <em>fx</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s163">t197</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxodd? <em>fx</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s155">t194</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxpositive? <em>fx</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s154">t194</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxquotient <em>fixnum<sub>1</sub></em> <em>fixnum<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s22">194</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxremainder <em>fixnum<sub>1</sub></em> <em>fixnum<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s23">194</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxreverse-bit-field <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em> <em>fx<sub>3</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s175">t202</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxrotate-bit-field <em>fx<sub>1</sub></em> <em>fx<sub>2</sub></em> <em>fx<sub>3</sub></em> <em>fx<sub>4</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s174">t201</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxsll <em>fixnum</em> <em>count</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s61">207</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxsra <em>fixnum</em> <em>count</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s63">207</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxsrl <em>fixnum</em> <em>count</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s62">207</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxvector <em>fixnum</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s43">143</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxvector-&gt;immutable-fxvector <em>fxvector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s53">146</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxvector-&gt;list <em>fxvector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s49">145</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxvector-copy <em>fxvector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s51">145</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxvector-fill! <em>fxvector</em> <em>fixnum</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s48">145</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxvector-length <em>fxvector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s45">144</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxvector-ref <em>fxvector</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s46">144</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxvector-set! <em>fxvector</em> <em>n</em> <em>fixnum</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s47">144</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxvector? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s42">143</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxxor <em>fx</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s163">t197</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(fxzero? <em>fx</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s154">t194</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(gcd <em>int</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s109">t179</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>generate-allocation-counts</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s239">393</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>generate-covin-files</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s142">369</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>generate-inspector-information</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s114">359</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>generate-instruction-counts</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s240">393</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>generate-interrupt-trap</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s111">358</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>generate-procedure-source-information</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s115">359</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(generate-profile-forms)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s145">369</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(generate-temporaries <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s49">t310</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>generate-wpo-files</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s117">360</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(gensym)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s92">152</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(gensym <em>pretty-name</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s92">152</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(gensym <em>pretty-name</em> <em>unique-name</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s92">152</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(gensym-&gt;unique-string <em>gensym</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s102">154</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gensym-count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s100">154</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gensym-prefix</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s100">154</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(gensym? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s103">154</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-bytevector-all <em>binary-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s60">t275</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-bytevector-n <em>binary-input-port</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s57">t274</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-bytevector-n! <em>binary-input-port</em> <em>bytevector</em> <em>start</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s58">t274</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-bytevector-some <em>binary-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s59">t275</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-bytevector-some! <em>binary-input-port</em> <em>bytevector</em> <em>start</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s64">233</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-char <em>textual-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s61">t275</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-datum <em>textual-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s67">t278</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-datum/annotations <em>textual-input-port</em> <em>sfd</em> <em>bfp</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s70">320</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-hash-table <em>ht</em> <em>k</em> <em>d</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#compat:s3">440</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-line <em>textual-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s66">t277</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-mode <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s151">263</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-mode <em>path</em> <em>follow?</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s151">263</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-output-string <em>string-output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s49">228</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-process-id)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s259">399</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-registry <em>key</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s262">399</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-source-table! <em>textual-input-port</em> <em>source-table</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s90">323</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-source-table! <em>textual-input-port</em> <em>source-table</em> <em>combine</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s90">323</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-string-all <em>textual-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s65">t277</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-string-n <em>textual-input-port</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s63">t276</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-string-n! <em>textual-input-port</em> <em>string</em> <em>start</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s64">t276</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-string-some <em>textual-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s62">232</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-string-some! <em>textual-input-port</em> <em>string</em> <em>start</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s63">233</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-thread-id)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s4">428</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(get-u8 <em>binary-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s55">t274</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(getenv <em>key</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s260">399</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(getprop <em>symbol</em> <em>key</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s106">155</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(getprop <em>symbol</em> <em>key</em> <em>default</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s106">155</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(greatest-fixnum)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s151">t193</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(guard (<em>var</em> <em>clause<sub>1</sub></em> <em>clause<sub>2</sub></em> ...) <em>b1</em> <em>b2</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s8">t361</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(guardian? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#smgmt:s31">412</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hash-table-for-each <em>ht</em> <em>p</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#compat:s6">440</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hash-table-map <em>ht</em> <em>p</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#compat:s5">440</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hash-table? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#compat:s1">439</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-cell <em>hashtable</em> <em>key</em> <em>default</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s115">158</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-cells <em>hashtable</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s119">160</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-cells <em>hashtable</em> <em>size</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s119">160</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-clear! <em>hashtable</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s287">t249</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-clear! <em>hashtable</em> <em>size</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s287">t249</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-contains? <em>hashtable</em> <em>key</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s282">t246</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-copy <em>hashtable</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s286">t248</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-copy <em>hashtable</em> <em>mutable?</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s286">t248</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-delete! <em>hashtable</em> <em>key</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s284">t248</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-entries <em>hashtable</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s118">159</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-entries <em>hashtable</em> <em>size</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s118">159</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-entries <em>hashtable</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s289">t250</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-ephemeron? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s123">161</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-equivalence-function <em>hashtable</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s278">t245</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-hash-function <em>hashtable</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s278">t245</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-keys <em>hashtable</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s116">158</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-keys <em>hashtable</em> <em>size</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s116">158</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-keys <em>hashtable</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s288">t249</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-mutable? <em>hashtable</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s277">t245</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-ref <em>hashtable</em> <em>key</em> <em>default</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s281">t246</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-set! <em>hashtable</em> <em>key</em> <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s280">t246</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-size <em>hashtable</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s285">t248</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-update! <em>hashtable</em> <em>key</em> <em>procedure</em> <em>default</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s283">t247</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-values <em>hashtable</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s117">159</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-values <em>hashtable</em> <em>size</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s117">159</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable-weak? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s122">161</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(hashtable? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s25">t155</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>heap-reserve-ratio</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#smgmt:s19">405</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(i/o-decoding-error? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s42">t375</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(i/o-encoding-error-char <em>condition</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s43">t376</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(i/o-encoding-error? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s43">t376</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(i/o-error-filename <em>condition</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s36">t373</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(i/o-error-port <em>condition</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s41">t375</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(i/o-error-position <em>condition</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s35">t372</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(i/o-error? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s32">t371</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(i/o-file-already-exists-error? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s39">t374</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(i/o-file-does-not-exist-error? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s40">t374</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(i/o-file-is-read-only-error? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s38">t374</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(i/o-file-protection-error? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s37">t373</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(i/o-filename-error? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s36">t373</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(i/o-invalid-position-error? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s35">t372</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(i/o-port-error? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s41">t375</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(i/o-read-error? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s33">t372</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(i/o-write-error? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s34">t372</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(iconv-codec <em>code-page</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s10">218</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(identifier-syntax <em>tmpl</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s27">t297</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(identifier-syntax (<em>id<sub>1</sub></em> <em>tmpl<sub>1</sub></em>) set! <em>id<sub>2</sub></em> <em>e<sub>2</sub></em>) <em>tmpl<sub>2</sub></em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s27">t297</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(identifier? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s35">t301</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ieee</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">module</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s33">311</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ieee-environment)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s32">333</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(if <em>test</em> <em>consequent</em> <em>alternative</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s8">t109</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(if <em>test</em> <em>consequent</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s8">t109</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(imag-part <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s121">t182</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>immutable</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s16">t331</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(immutable-box? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s86">151</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(immutable-bytevector? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s65">149</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(immutable-fxvector? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s52">146</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(immutable-string? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s24">141</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(immutable-vector? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s34">142</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(implementation-restriction-violation? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s28">t369</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(implicit-exports #t)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#libraries:s19">286</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(implicit-exports #f)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#libraries:s19">286</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(import <em>import-spec</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#libraries:s16">280</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>import-notify</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#libraries:s29">289</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(import-only <em>import-spec</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#libraries:s16">280</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(include <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s12">298</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(indirect-export <em>id</em> <em>indirect-id</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#libraries:s18">285</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(inexact <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s112">t180</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(inexact-&gt;exact <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s116">t181</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(inexact? <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s87">t170</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(infinite? <em>real</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s97">t174</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(initial-bytes-allocated)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s224">389</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(input-port-ready? <em>input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s67">235</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(input-port? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s44">t270</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(inspect <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#debug:s22">42</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(inspect/object <em>object</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#debug:s25">47</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(integer-&gt;char <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s211">t215</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(integer-length <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s71">210</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(integer-valued? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s18">t153</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(integer? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s17">t151</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>interaction-environment</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s33">334</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(interactive?)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s258">398</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>internal-defines-as-letrec*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#binding:s15">114</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(interpret <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s44">337</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(interpret <em>obj</em> <em>env</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s44">337</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(invoke-library <em>libref</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#libraries:s20">287</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(iota <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s8">135</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(irritants-condition? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s25">t368</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(isqrt <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s70">210</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>keyboard-interrupt-handler</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s20">330</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(lambda <em>formals</em> <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#binding:s3">t92</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(last-pair <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s4">134</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(latin-1-codec)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s22">t259</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(lcm <em>int</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s110">t179</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(least-fixnum)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s151">t193</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(length <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s46">t159</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(let ((<em>var</em> <em>expr</em>) ...) <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#binding:s16">t95</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(let <em>name</em> ((<em>var</em> <em>expr</em>) ...) <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s20">t114</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(let* ((<em>var</em> <em>expr</em>) ...) <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#binding:s18">t96</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(let*-values ((<em>formals</em> <em>expr</em>) ...) <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#binding:s23">t99</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(let-syntax ((<em>keyword</em> <em>expr</em>) ...) <em>form<sub>1</sub></em> <em>form<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s13">t293</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(let-values ((<em>formals</em> <em>expr</em>) ...) <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#binding:s23">t99</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(letrec ((<em>var</em> <em>expr</em>) ...) <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#binding:s20">t97</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(letrec* ((<em>var</em> <em>expr</em>) ...) <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#binding:s22">t98</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(letrec-syntax ((<em>keyword</em> <em>expr</em>) ...) <em>form<sub>1</sub></em> <em>form<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s13">t293</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(lexical-violation? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s29">t370</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(library <em>name</em> <em>exports</em> <em>imports</em> <em>library-body</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#libraries:s13">278</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>library-directories</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#libraries:s23">288</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(library-exports <em>libref</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#libraries:s33">290</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>library-extensions</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#libraries:s23">288</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(library-list)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#libraries:s32">290</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(library-object-filename <em>libref</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#libraries:s33">290</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(library-requirements <em>libref</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#libraries:s33">290</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(library-requirements <em>libref</em> <em>options</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#libraries:s33">290</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(library-requirements-options <em>symbol</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#libraries:s34">291</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>library-search-handler</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#libraries:s30">289</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(library-version <em>libref</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#libraries:s33">290</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(list <em>obj</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s43">t158</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(list* <em>obj</em> ... <em>final-obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s6">135</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(list-&gt;fxvector <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s50">145</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(list-&gt;string <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s229">t223</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(list-&gt;vector <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s238">t226</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(list-copy <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s5">134</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(list-head <em>list</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s3">134</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(list-ref <em>list</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s47">t159</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(list-sort <em>predicate</em> <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s62">t167</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(list-tail <em>list</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s48">t160</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(list? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s45">t158</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(literal-identifier=? <em>identifier<sub>1</sub></em> <em>identifier<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s14">300</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(load <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s45">337</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(load <em>path</em> <em>eval-proc</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s45">337</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(load-compiled-from-port <em>input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s56">339</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(load-library <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s47">338</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(load-library <em>path</em> <em>eval-proc</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s47">338</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(load-program <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s48">338</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(load-program <em>path</em> <em>eval-proc</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s48">338</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(load-shared-object <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s160">91</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(locate-source <em>sfd</em> <em>pos</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s72">320</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(locate-source <em>sfd</em> <em>pos</em> <em>use-cache?</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s72">320</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(locate-source-object-source <em>source-object</em> <em>get-start?</em> <em>use-cache?</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s73">321</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(lock-object <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#smgmt:s36">413</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(locked-object? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#smgmt:s39">414</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(log <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s130">t184</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(log <em>num<sub>1</sub></em> <em>num<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s130">t184</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(logand <em>int</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s44">200</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(logbit0 <em>index</em> <em>int</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s50">203</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(logbit1 <em>index</em> <em>int</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s51">203</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(logbit? <em>index</em> <em>int</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s48">201</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(logior <em>int</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s45">200</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(lognot <em>int</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s47">201</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(logor <em>int</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s45">200</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(logtest <em>int<sub>1</sub></em> <em>int<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s49">202</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(logxor <em>int</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s46">201</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(lookahead-char <em>textual-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s62">t275</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(lookahead-u8 <em>binary-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s56">t274</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(machine-type)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s89">349</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(magnitude <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s125">t183</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(magnitude-squared <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s75">211</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-annotation <em>obj</em> <em>source-object</em> <em>stripped-obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s49">317</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-annotation <em>obj</em> <em>source-object</em> <em>stripped-obj</em> <em>options</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s49">317</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-assertion-violation)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s21">t366</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-boot-file <em>output-filename</em> <em>base-boot-list</em> <em>input-filename</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s83">347</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-boot-header <em>output-filename</em> <em>base-boot<sub>1</sub></em> <em>base-boot<sub>2</sub></em>...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s86">347</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-bytevector <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s242">t228</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-bytevector <em>n</em> <em>fill</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s242">t228</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-compile-time-value <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s15">300</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-condition)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s12">430</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-condition <em>name</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s12">430</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-continuation-condition <em>continuation</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s6">327</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-cost-center)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s241">393</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-custom-binary-input-port <em>id</em> <em>r!</em> <em>gp</em> <em>sp!</em> <em>close</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s41">t267</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-custom-binary-input/output-port <em>id</em> <em>r!</em> <em>w!</em> <em>gp</em> <em>sp!</em> <em>close</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s41">t267</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-custom-binary-output-port <em>id</em> <em>w!</em> <em>gp</em> <em>sp!</em> <em>close</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s41">t267</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-custom-textual-input-port <em>id</em> <em>r!</em> <em>gp</em> <em>sp!</em> <em>close</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s42">t268</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-custom-textual-input/output-port <em>id</em> <em>r!</em> <em>w!</em> <em>gp</em> <em>sp!</em> <em>close</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s42">t268</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-custom-textual-output-port <em>id</em> <em>w!</em> <em>gp</em> <em>sp!</em> <em>close</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s42">t268</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-date <em>nsec</em> <em>sec</em> <em>min</em> <em>hour</em> <em>day</em> <em>mon</em> <em>year</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s211">384</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-date <em>nsec</em> <em>sec</em> <em>min</em> <em>hour</em> <em>day</em> <em>mon</em> <em>year</em> <em>offset</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s211">384</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-engine <em>thunk</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#control:s16">127</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-enumeration <em>symbol-list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s291">t251</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-ephemeron-eq-hashtable)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s121">161</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-ephemeron-eq-hashtable <em>size</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s121">161</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-ephemeron-eqv-hashtable)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s121">161</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-ephemeron-eqv-hashtable <em>size</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s121">161</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-eq-hashtable)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s274">t243</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-eq-hashtable <em>size</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s274">t243</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-eqv-hashtable)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s275">t244</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-eqv-hashtable <em>size</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s275">t244</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-error)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s22">t367</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-format-condition)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s4">326</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-ftype-pointer <em>ftype-name</em> <em>expr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s143">82</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-fxvector <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s44">144</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-fxvector <em>n</em> <em>fixnum</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s44">144</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-guardian)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#smgmt:s29">408</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-hash-table)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#compat:s0">439</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-hash-table <em>weak?</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#compat:s0">439</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-hashtable <em>hash</em> <em>equiv?</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s276">t244</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-hashtable <em>hash</em> <em>equiv?</em> <em>size</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s276">t244</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-i/o-decoding-error <em>pobj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s42">t375</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-i/o-encoding-error <em>pobj</em> <em>cobj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s43">t376</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-i/o-error)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s32">t371</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-i/o-file-already-exists-error <em>filename</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s39">t374</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-i/o-file-does-not-exist-error <em>filename</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s40">t374</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-i/o-file-is-read-only-error <em>filename</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s38">t374</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-i/o-file-protection-error <em>filename</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s37">t373</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-i/o-filename-error <em>filename</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s36">t373</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-i/o-invalid-position-error <em>position</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s35">t372</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-i/o-port-error <em>pobj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s41">t375</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-i/o-read-error)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s33">t372</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-i/o-write-error)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s34">t372</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-implementation-restriction-violation)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s28">t369</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-input-port <em>handler</em> <em>input-buffer</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s13">219</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-input/output-port <em>handler</em> <em>input-buffer</em> <em>output-buffer</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s13">219</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-irritants-condition <em>irritants</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s25">t368</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-lexical-violation)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s29">t370</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-list <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s7">135</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-list <em>n</em> <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s7">135</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-message-condition <em>message</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s24">t368</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-mutex)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s6">428</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-mutex <em>name</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s6">428</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-no-infinities-violation)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s44">t376</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-no-nans-violation)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s45">t377</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-non-continuable-violation)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s27">t369</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-object-finder <em>pred</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#debug:s26">53</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-object-finder <em>pred</em> <em>g</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#debug:s26">53</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-object-finder <em>pred</em> <em>x</em> <em>g</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#debug:s26">53</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-output-port <em>handler</em> <em>output-buffer</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s13">219</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-parameter <em>object</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s248">394</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-parameter <em>object</em> <em>procedure</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s248">394</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-polar <em>real<sub>1</sub></em> <em>real<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s123">t183</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-record-constructor-descriptor <em>rtd</em> <em>parent-rcd</em> <em>protocol</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s24">t332</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-record-type <em>type-name</em> <em>fields</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s186">182</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-record-type <em>parent-rtd</em> <em>type-name</em> <em>fields</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s186">182</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-record-type-descriptor <em>name</em> <em>parent</em> <em>uid</em> <em>s?</em> <em>o?</em> <em>fields</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s20">t331</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-rectangular <em>real<sub>1</sub></em> <em>real<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s122">t182</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-serious-condition)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s19">t366</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-source-condition <em>form</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s5">326</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-source-file-descriptor <em>string</em> <em>binary-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s63">319</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-source-file-descriptor <em>string</em> <em>binary-input-port</em> <em>reset?</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s63">319</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-source-object <em>sfd</em> <em>bfp</em> <em>efp</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s55">318</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-source-object <em>sfd</em> <em>bfp</em> <em>efp</em> <em>line</em> <em>column</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s55">318</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-source-table)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s81">322</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-sstats <em>cpu</em> <em>real</em> <em>bytes</em> <em>gc-count</em> <em>gc-cpu</em> <em>gc-real</em> <em>gc-bytes</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s231">390</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-string <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s218">t218</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-string <em>n</em> <em>char</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s218">t218</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-syntax-violation <em>form</em> <em>subform</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s30">t370</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-thread-parameter <em>object</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s30">435</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-thread-parameter <em>object</em> <em>procedure</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s30">435</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-time <em>type</em> <em>nsec</em> <em>sec</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s203">381</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-transcoder <em>codec</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s19">t259</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-transcoder <em>codec</em> <em>eol-style</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s19">t259</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-transcoder <em>codec</em> <em>eol-style</em> <em>error-handling-mode</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s19">t259</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-undefined-violation)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s31">t371</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-variable-transformer <em>procedure</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s42">t306</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-vector <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s232">t224</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-vector <em>n</em> <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s232">t224</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-violation)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s20">t366</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-warning)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s23">t367</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-weak-eq-hashtable)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s120">160</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-weak-eq-hashtable <em>size</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s120">160</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-weak-eqv-hashtable)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s120">160</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-weak-eqv-hashtable <em>size</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s120">160</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(make-who-condition <em>who</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s26">t369</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(map <em>procedure</em> <em>list<sub>1</sub></em> <em>list<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s30">t117</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(mark-port-closed! <em>port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s24">222</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(max <em>real<sub>1</sub></em> <em>real<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s107">t178</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(maximum-memory-bytes)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s227">389</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(maybe-compile-file <em>input-filename</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s71">343</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(maybe-compile-file <em>input-filename</em> <em>output-filename</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s71">343</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(maybe-compile-library <em>input-filename</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s71">343</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(maybe-compile-library <em>input-filename</em> <em>output-filename</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s71">343</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(maybe-compile-program <em>input-filename</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s71">343</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(maybe-compile-program <em>input-filename</em> <em>output-filename</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s71">343</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(member <em>obj</em> <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s51">t161</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(memp <em>procedure</em> <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s52">t163</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(memq <em>obj</em> <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s51">t161</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(memv <em>obj</em> <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s51">t161</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(merge <em>predicate</em> <em>list<sub>1</sub></em> <em>list<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s114">157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(merge! <em>predicate</em> <em>list<sub>1</sub></em> <em>list<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s114">157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(message-condition? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s24">t368</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(meta . <em>definition</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s36">312</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(meta-cond <em>clause<sub>1</sub></em> <em>clause<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s37">313</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(min <em>real<sub>1</sub></em> <em>real<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s108">t178</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(mkdir <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s146">262</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(mkdir <em>path</em> <em>mode</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s146">262</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(mod <em>x<sub>1</sub></em> <em>x<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s99">t175</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(mod0 <em>x<sub>1</sub></em> <em>x<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s100">t176</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(module <em>name</em> <em>interface</em> <em>defn</em> ... <em>init</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s21">305</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(module <em>interface</em> <em>defn</em> ... <em>init</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s21">305</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(modulo <em>int<sub>1</sub></em> <em>int<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s98">t175</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(most-negative-fixnum)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s14">191</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(most-positive-fixnum)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s14">191</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(multibyte-&gt;string <em>code-page</em> <em>bytevector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s92">244</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mutable</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s16">t331</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(mutable-box? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s86">151</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(mutable-bytevector? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s65">149</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(mutable-fxvector? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s52">146</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(mutable-string? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s24">141</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(mutable-vector? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s34">142</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(mutex-acquire <em>mutex</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s8">429</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(mutex-acquire <em>mutex</em> <em>block?</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s8">429</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(mutex-name <em>mutex</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s11">429</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(mutex-release <em>mutex</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s9">429</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(mutex? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s7">428</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(nan? <em>real</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s97">t174</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(native-endianness)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s241">t228</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(native-eol-style)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s24">t260</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(native-transcoder)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s21">t259</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(negative? <em>real</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s95">t173</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(new-cafe)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s167">374</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(new-cafe <em>eval-proc</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s167">374</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(newline)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s87">t285</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(newline <em>textual-output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s87">t285</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(no-infinities-violation? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s44">t376</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(no-nans-violation? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s45">t377</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(non-continuable-violation? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s27">t369</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>nongenerative</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s16">t331</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(nonnegative? <em>real</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s73">211</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(nonpositive? <em>real</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s72">210</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(not <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s10">t110</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(null-environment <em>version</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s82">t137</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(null? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s15">t151</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(number-&gt;string <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s79">212</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(number-&gt;string <em>num</em> <em>radix</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s79">212</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(number-&gt;string <em>num</em> <em>radix</em> <em>precision</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s79">212</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(number-&gt;string <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s148">t191</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(number-&gt;string <em>num</em> <em>radix</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s148">t191</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(number-&gt;string <em>num</em> <em>radix</em> <em>precision</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s148">t191</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(number? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s17">t151</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(numerator <em>rat</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s118">t181</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(object-counts)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s238">392</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(oblist)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s111">156</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(odd? <em>int</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s96">t174</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>only</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s22">310</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>opaque</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s16">t331</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-bytevector-input-port <em>bytevector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s34">t264</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-bytevector-input-port <em>bytevector</em> <em>?transcoder</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s34">t264</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-bytevector-output-port)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s36">t265</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-bytevector-output-port <em>?transcoder</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s36">t265</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-fd-input-port <em>fd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s60">232</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-fd-input-port <em>fd</em> <em>b-mode</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s60">232</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-fd-input-port <em>fd</em> <em>b-mode</em> <em>?transcoder</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s60">232</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-fd-input/output-port <em>fd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s90">244</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-fd-input/output-port <em>fd</em> <em>b-mode</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s90">244</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-fd-input/output-port <em>fd</em> <em>b-mode</em> <em>?transcoder</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s90">244</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-fd-output-port <em>fd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s80">241</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-fd-output-port <em>fd</em> <em>b-mode</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s80">241</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-fd-output-port <em>fd</em> <em>b-mode</em> <em>?transcoder</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s80">241</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-file-input-port <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s29">t262</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-file-input-port <em>path</em> <em>options</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s29">t262</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-file-input-port <em>path</em> <em>options</em> <em>b-mode</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s29">t262</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-file-input-port <em>path</em> <em>options</em> <em>b-mode</em> <em>?transcoder</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s29">t262</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-file-input/output-port <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s31">t263</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-file-input/output-port <em>path</em> <em>options</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s31">t263</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-file-input/output-port <em>path</em> <em>options</em> <em>b-mode</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s31">t263</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-file-input/output-port <em>path</em> <em>options</em> <em>b-mode</em> <em>?transcoder</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s31">t263</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-file-output-port <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s30">t262</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-file-output-port <em>path</em> <em>options</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s30">t262</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-file-output-port <em>path</em> <em>options</em> <em>b-mode</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s30">t262</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-file-output-port <em>path</em> <em>options</em> <em>b-mode</em> <em>?transcoder</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s30">t262</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-input-file <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s57">230</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-input-file <em>path</em> <em>options</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s57">230</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-input-file <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s75">t280</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-input-output-file <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s89">243</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-input-output-file <em>path</em> <em>options</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s89">243</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-input-string <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s44">228</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-output-file <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s75">239</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-output-file <em>path</em> <em>options</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s75">239</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-output-file <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s76">t281</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-output-string)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s47">228</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-process-ports <em>command</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s5">58</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-process-ports <em>command</em> <em>b-mode</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s5">58</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-process-ports <em>command</em> <em>b-mode</em> <em>?transcoder</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s5">58</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-source-file <em>sfd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s71">320</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-string-input-port <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s35">t265</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(open-string-output-port)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s37">t266</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>optimize-level</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s104">357</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(or <em>expr</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s12">t110</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ormap <em>procedure</em> <em>list<sub>1</sub></em> <em>list<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#control:s7">125</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(output-port-buffer-mode <em>port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s52">t273</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(output-port? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s44">t270</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(pair? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s16">t151</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(parameterize ((<em>param</em> <em>expr</em>) ...) <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s250">395</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>parent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s16">t331</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>parent-rtd</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s16">t331</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(pariah <em>expr<sub>1</sub></em> <em>expr<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s127">364</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(partition <em>procedure</em> <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s56">t164</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(path-absolute? <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s154">264</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(path-extension <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s154">264</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(path-first <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s154">264</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(path-last <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s154">264</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(path-parent <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s154">264</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(path-rest <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s154">264</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(path-root <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s154">264</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(peek-char)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s83">t284</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(peek-char <em>textual-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s83">t284</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(petite?)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s256">398</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-bol? <em>port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s27">223</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-closed? <em>port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s25">222</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-eof? <em>input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s68">t278</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-file-compressed! <em>port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s39">226</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-file-descriptor <em>port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s53">229</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-handler <em>port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s15">219</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-has-port-length? <em>port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s31">224</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-has-port-nonblocking?? <em>port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s33">225</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-has-port-position? <em>port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s49">t271</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-has-set-port-length!? <em>port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s32">224</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-has-set-port-nonblocking!? <em>port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s34">225</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-has-set-port-position!? <em>port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s50">t272</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-input-buffer <em>input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s16">219</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-input-count <em>input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s18">220</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-input-empty? <em>input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s19">220</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-input-index <em>input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s16">219</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-input-size <em>input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s16">219</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-length <em>port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s31">224</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-name <em>port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s29">223</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-nonblocking? <em>port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s33">225</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-output-buffer <em>output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s20">221</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-output-count <em>output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s22">222</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-output-full? <em>output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s23">222</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-output-index <em>output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s20">221</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-output-size <em>output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s20">221</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-position <em>port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s49">t271</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port-transcoder <em>port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s48">t271</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(port? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s43">t270</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(positive? <em>real</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s94">t173</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>predicate</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s176">178</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>prefix</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s176">178</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(pretty-file <em>ifn</em> <em>ofn</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s94">245</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(pretty-format <em>sym</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s95">246</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(pretty-format <em>sym</em> <em>fmt</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s95">246</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pretty-initial-indent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s100">248</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pretty-line-length</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s98">248</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pretty-maximum-lines</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s103">248</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pretty-one-line-limit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s98">248</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(pretty-print <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s93">245</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(pretty-print <em>obj</em> <em>textual-output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s93">245</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pretty-standard-indent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s102">248</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>print-brackets</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s125">256</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>print-char-name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s108">253</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>print-extended-identifiers</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s127">256</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>print-gensym</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s120">255</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>print-graph</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s110">253</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>print-length</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s114">254</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>print-level</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s114">254</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>print-precision</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s130">258</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>print-radix</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s119">255</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>print-record</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s185">182</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>print-unicode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s131">258</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>print-vector-length</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s128">257</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(printf <em>format-string</em> <em>obj</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s106">251</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(<em>expr<sub>0</sub></em> <em>expr<sub>1</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s1">t107</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(procedure-arity-mask <em>proc</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s200">187</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(procedure? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s23">t155</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(process <em>command</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s7">58</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(profile <em>source-object</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s144">369</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(profile-clear)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s146">369</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(profile-clear-database)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s166">374</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(profile-dump)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s148">370</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(profile-dump-data <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s163">373</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(profile-dump-data <em>path</em> <em>dump</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s163">373</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(profile-dump-html)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s159">371</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(profile-dump-html <em>prefix</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s159">371</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(profile-dump-html <em>prefix</em> <em>dump</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s159">371</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(profile-dump-list)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s162">372</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(profile-dump-list <em>warn?</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s162">372</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(profile-dump-list <em>warn?</em> <em>dump</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s162">372</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(profile-line-number-color)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s161">372</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(profile-load-data <em>path</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s164">373</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(profile-palette)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s160">371</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(profile-query-weight <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s165">374</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(profile-release-counters)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s147">370</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(property-list <em>symbol</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s110">156</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>protocol</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s16">t331</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(put-bytevector <em>binary-output-port</em> <em>bytevector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s70">t279</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(put-bytevector <em>binary-output-port</em> <em>bytevector</em> <em>start</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s70">t279</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(put-bytevector <em>binary-output-port</em> <em>bytevector</em> <em>start</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s70">t279</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(put-bytevector-some <em>binary-output-port</em> <em>bytevector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s83">242</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(put-bytevector-some <em>binary-output-port</em> <em>bytevector</em> <em>start</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s83">242</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(put-bytevector-some <em>binary-output-port</em> <em>bytevector</em> <em>start</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s83">242</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(put-char <em>textual-output-port</em> <em>char</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s71">t279</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(put-datum <em>textual-output-port</em> <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s73">t279</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(put-hash-table! <em>ht</em> <em>k</em> <em>v</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#compat:s2">440</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(put-registry! <em>key</em> <em>val</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s262">399</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(put-source-table <em>textual-output-port</em> <em>source-table</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s89">323</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(put-string <em>textual-output-port</em> <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s72">t279</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(put-string <em>textual-output-port</em> <em>string</em> <em>start</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s72">t279</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(put-string <em>textual-output-port</em> <em>string</em> <em>start</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s72">t279</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(put-string-some <em>textual-output-port</em> <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s84">242</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(put-string-some <em>textual-output-port</em> <em>string</em> <em>start</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s84">242</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(put-string-some <em>textual-output-port</em> <em>string</em> <em>start</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s84">242</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(put-u8 <em>binary-output-port</em> <em>octet</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s69">t278</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(putenv <em>key</em> <em>value</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s261">399</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(putprop <em>symbol</em> <em>key</em> <em>value</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s104">154</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(quasiquote <em>obj</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s5">t142</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(quasisyntax <em>template</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s40">t305</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(quote <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s2">t141</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(quotient <em>int<sub>1</sub></em> <em>int<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s98">t175</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>r5rs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">module</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s29">311</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>r5rs-syntax</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">module</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s31">311</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(raise <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s3">t357</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(raise-continuable <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s3">t357</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(random <em>real</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s64">208</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>random-seed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s65">208</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(rational-valued? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s18">t153</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(rational? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s17">t151</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(rationalize <em>real<sub>1</sub></em> <em>real<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s117">t181</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(ratnum? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s12">191</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(read)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s81">t284</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(read <em>textual-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s81">t284</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(read-char)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s82">t284</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(read-char <em>textual-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s82">t284</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(read-token)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s70">236</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(read-token <em>textual-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s70">236</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(read-token <em>textual-input-port</em> <em>sfd</em> <em>bfp</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s70">236</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(real-&gt;flonum <em>real</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s198">t211</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(real-part <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s120">t182</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(real-time)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s222">388</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(real-valued? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s18">t153</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(real? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s17">t151</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(rec <em>var</em> <em>expr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#binding:s17">115</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-accessor <em>rtd</em> <em>idx</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s31">t334</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-case <em>expr</em> <em>clause<sub>1</sub></em> <em>clause<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#control:s3">124</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-constructor <em>rcd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s189">184</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-constructor <em>rtd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s189">184</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-constructor <em>rcd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s29">t333</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-constructor-descriptor <em>record-name</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s28">t333</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-constructor-descriptor? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s1">133</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-equal-procedure <em>record<sub>1</sub></em> <em>record<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s157">170</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-field-accessible? <em>rtd</em> <em>field-id</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s191">184</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-field-accessor <em>rtd</em> <em>field-id</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s190">184</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-field-mutable? <em>rtd</em> <em>field-id</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s193">185</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-field-mutable? <em>rtd</em> <em>idx</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s39">t338</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-field-mutator <em>rtd</em> <em>field-id</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s192">184</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-hash-procedure <em>record</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s159">171</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-mutator <em>rtd</em> <em>idx</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s32">t334</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-predicate <em>rtd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s30">t333</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-reader <em>name</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s180">179</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-reader <em>rtd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s180">179</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-reader <em>name</em> <em>rtd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s180">179</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-reader <em>name</em> #f)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s180">179</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-reader <em>rtd</em> #f)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s180">179</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-rtd <em>record</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s41">t338</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-type-descriptor <em>rec</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s199">186</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-type-descriptor <em>record-name</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s28">t333</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-type-descriptor? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s23">t332</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-type-equal-procedure <em>rtd</em> <em>equal-proc</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s156">170</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-type-equal-procedure <em>rtd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s156">170</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-type-field-decls <em>rtd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s197">186</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-type-field-names <em>rtd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s196">185</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-type-field-names <em>rtd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s38">t337</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-type-generative? <em>rtd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s37">t337</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-type-hash-procedure <em>rtd</em> <em>hash-proc</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s158">170</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-type-hash-procedure <em>rtd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s158">170</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-type-name <em>rtd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s194">185</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-type-name <em>rtd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s34">t336</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-type-opaque? <em>rtd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s37">t337</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-type-parent <em>rtd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s35">t336</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-type-sealed? <em>rtd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s37">t337</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-type-symbol <em>rtd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s195">185</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-type-uid <em>rtd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s36">t336</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-writer <em>rtd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s181">180</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record-writer <em>rtd</em> <em>procedure</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s181">180</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s198">186</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record? <em>obj</em> <em>rtd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s198">186</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(record? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s40">t338</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(register-signal-handler <em>sig</em> <em>procedure</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s28">332</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>release-minimum-generation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#smgmt:s18">404</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(remainder <em>int<sub>1</sub></em> <em>int<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s98">t175</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(remove <em>obj</em> <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s53">t163</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(remove! <em>obj</em> <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s10">136</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(remove-foreign-entry <em>entry-name</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s162">93</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(remove-hash-table! <em>ht</em> <em>k</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#compat:s4">440</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(remove-registry! <em>key</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s262">399</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(remp <em>procedure</em> <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s54">t163</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(remprop <em>symbol</em> <em>key</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s108">155</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(remq <em>obj</em> <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s53">t163</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(remq! <em>obj</em> <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s10">136</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(remv <em>obj</em> <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s53">t163</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(remv! <em>obj</em> <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s10">136</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rename</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s22">310</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(rename-file <em>old-pathname</em> <em>new-pathname</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s149">263</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>require-nongenerative-clause</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s142">167</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(reset)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s178">377</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(reset-cost-center! <em>cost-center</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s247">394</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>reset-handler</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s179">377</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(reset-maximum-memory-bytes!)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s228">389</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(reverse <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s50">t161</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(reverse! <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s12">137</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(revisit <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s61">340</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(revisit-compiled-from-port <em>input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s58">340</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(round <em>real</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s104">t178</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>run-cp0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s120">360</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(s8-list-&gt;bytevector <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s61">147</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(sc-expand <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s95">349</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(sc-expand <em>obj</em> <em>env</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s95">349</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scheme</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">module</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s28">311</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(scheme-environment)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s31">333</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scheme-program</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s189">378</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(scheme-report-environment <em>version</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s82">t137</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scheme-script</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s185">378</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scheme-start</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s184">378</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(scheme-version)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s254">398</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(scheme-version-number)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s255">398</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sealed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#records:s16">t331</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(serious-condition? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s19">t366</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set! <em>var</em> <em>expr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#binding:s28">t102</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-binary-port-input-buffer! <em>binary-input-port</em> <em>bytevector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s17">220</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-binary-port-input-index! <em>binary-input-port</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s17">220</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-binary-port-input-size! <em>binary-input-port</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s17">220</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-binary-port-output-buffer! <em>binary-output-port</em> <em>bytevector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s21">221</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-binary-port-output-index! <em>output-port</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s21">221</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-binary-port-output-size! <em>output-port</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s21">221</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-box! <em>box</em> <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s84">151</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-car! <em>pair</em> <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s40">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-cdr! <em>pair</em> <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s41">t157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-port-bol! <em>output-port</em> <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s26">222</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-port-eof! <em>input-port</em> <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s28">223</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-port-input-buffer! <em>input-port</em> <em>x</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s17">220</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-port-input-index! <em>input-port</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s17">220</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-port-input-size! <em>input-port</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s17">220</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-port-length! <em>port</em> <em>len</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s32">224</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-port-name! <em>port</em> <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s30">224</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-port-nonblocking! <em>port</em> <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s34">225</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-port-output-buffer! <em>output-port</em> <em>x</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s21">221</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-port-output-index! <em>output-port</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s21">221</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-port-output-size! <em>output-port</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s21">221</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-port-position! <em>port</em> <em>pos</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s50">t272</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-sstats-bytes! <em>s</em> <em>new-value</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s234">391</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-sstats-cpu! <em>s</em> <em>new-value</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s234">391</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-sstats-gc-bytes! <em>s</em> <em>new-value</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s234">391</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-sstats-gc-count! <em>s</em> <em>new-value</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s234">391</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-sstats-gc-cpu! <em>s</em> <em>new-value</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s234">391</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-sstats-gc-real! <em>s</em> <em>new-value</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s234">391</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-sstats-real! <em>s</em> <em>new-value</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s234">391</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-textual-port-input-buffer! <em>textual-input-port</em> <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s17">220</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-textual-port-input-index! <em>textual-input-port</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s17">220</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-textual-port-input-size! <em>textual-input-port</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s17">220</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-textual-port-output-buffer! <em>textual-output-port</em> <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s21">221</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-textual-port-output-index! <em>textual-output-port</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s21">221</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-textual-port-output-size! <em>textual-output-port</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s21">221</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-time-nanosecond! <em>time</em> <em>nsec</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s206">382</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-time-second! <em>time</em> <em>sec</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s206">382</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-time-type! <em>time</em> <em>type</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s206">382</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-timer <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s22">330</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-top-level-value! <em>symbol</em> <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#binding:s26">118</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-top-level-value! <em>symbol</em> <em>obj</em> <em>env</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#binding:s26">118</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(set-virtual-register! <em>k</em> <em>x</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s252">397</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(simple-conditions <em>condition</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s16">t363</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(sin <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s131">t185</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(sinh <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s76">211</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(sint-list-&gt;bytevector <em>list</em> <em>eness</em> <em>size</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s261">t239</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(sleep <em>time</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s218">387</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(sort <em>predicate</em> <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s113">157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(sort! <em>predicate</em> <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s113">157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(source-condition-form <em>condition</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s5">326</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(source-condition? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s5">326</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>source-directories</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s102">356</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(source-file-descriptor <em>path</em> <em>checksum</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s67">319</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(source-file-descriptor-checksum <em>sfd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s65">319</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(source-file-descriptor-path <em>sfd</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s66">319</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(source-file-descriptor? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s64">319</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(source-object-bfp <em>source-object</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s58">318</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(source-object-column <em>source-object</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s61">319</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(source-object-efp <em>source-object</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s59">318</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(source-object-line <em>source-object</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s60">318</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(source-object-sfd <em>source-object</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s57">318</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(source-object? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s56">318</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(source-table-cell <em>source-table</em> <em>source-object</em> <em>default</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s86">322</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(source-table-contains? <em>source-table</em> <em>source-object</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s85">322</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(source-table-delete! <em>source-table</em> <em>source-object</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s87">323</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(source-table-dump <em>source-table</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s153">371</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(source-table-ref <em>source-table</em> <em>source-object</em> <em>default</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s84">322</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(source-table-set! <em>source-table</em> <em>source-object</em> <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s83">322</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(source-table-size <em>source-table</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s88">323</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(source-table? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s82">322</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(sqrt <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s127">t183</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(sstats-bytes <em>s</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s233">391</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(sstats-cpu <em>s</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s233">391</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(sstats-difference <em>s<sub>1</sub></em> <em>s<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s235">391</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(sstats-gc-bytes <em>s</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s233">391</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(sstats-gc-count <em>s</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s233">391</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(sstats-gc-cpu <em>s</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s233">391</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(sstats-gc-real <em>s</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s233">391</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(sstats-print <em>s</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s236">391</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(sstats-print <em>s</em> <em>textual-output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s236">391</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(sstats-real <em>s</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s233">391</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(sstats? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s232">391</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(standard-error-port)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s82">241</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(standard-error-port <em>b-mode</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s82">241</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(standard-error-port <em>b-mode</em> <em>?transcoder</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s82">241</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(standard-error-port)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s33">t264</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(standard-input-port)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s61">232</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(standard-input-port <em>b-mode</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s61">232</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(standard-input-port <em>b-mode</em> <em>?transcoder</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s61">232</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(standard-input-port)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s33">t264</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(standard-output-port)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s81">241</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(standard-output-port <em>b-mode</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s81">241</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(standard-output-port <em>b-mode</em> <em>?transcoder</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s81">241</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(standard-output-port)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s33">t264</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(statistics)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s230">390</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string <em>char</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s217">t218</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-&gt;bytevector <em>string</em> <em>transcoder</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s92">t287</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-&gt;immutable-string <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s25">141</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-&gt;list <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s228">t222</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-&gt;multibyte <em>code-page</em> <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s92">244</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-&gt;number <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s78">212</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-&gt;number <em>string</em> <em>radix</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s78">212</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-&gt;number <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s147">t191</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-&gt;number <em>string</em> <em>radix</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s147">t191</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-&gt;symbol <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s269">t242</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-&gt;utf16 <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s94">t287</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-&gt;utf16 <em>string</em> <em>endianness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s94">t287</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-&gt;utf32 <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s94">t287</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-&gt;utf32 <em>string</em> <em>endianness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s94">t287</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-&gt;utf8 <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s93">t287</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-append <em>string</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s223">t219</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-ci-hash <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s279">t245</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-ci&lt;=? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s20">139</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-ci&lt;=? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s216">t217</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-ci&lt;? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s20">139</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-ci&lt;? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s216">t217</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-ci=? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s20">139</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-ci=? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s216">t217</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-ci&gt;=? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s20">139</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-ci&gt;=? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s216">t217</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-ci&gt;? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s20">139</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-ci&gt;? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s216">t217</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-copy <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s222">t219</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-copy! <em>src</em> <em>src-start</em> <em>dst</em> <em>dst-start</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s21">139</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-downcase <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s226">t221</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-fill! <em>string</em> <em>char</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s225">t220</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-foldcase <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s226">t221</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-for-each <em>procedure</em> <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s50">t122</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-hash <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s279">t245</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-length <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s219">t218</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-normalize-nfc <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s227">t222</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-normalize-nfd <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s227">t222</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-normalize-nfkc <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s227">t222</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-normalize-nfkd <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s227">t222</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-ref <em>string</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s220">t218</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-set! <em>string</em> <em>n</em> <em>char</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s221">t219</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-titlecase <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s226">t221</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-truncate! <em>string</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s23">140</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string-upcase <em>string</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s226">t221</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string&lt;=? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s20">139</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string&lt;=? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s215">t216</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string&lt;? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s20">139</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string&lt;? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s215">t216</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string=? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s20">139</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string=? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s215">t216</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string&gt;=? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s20">139</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string&gt;=? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s215">t216</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string&gt;? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s20">139</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string&gt;? <em>string<sub>1</sub></em> <em>string<sub>2</sub></em> <em>string<sub>3</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s215">t216</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(string? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s20">t154</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(strip-fasl-file <em>input-path</em> <em>output-path</em> <em>options</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s87">348</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(sub1 <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s68">209</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>subset-mode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s263">400</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(subst <em>new</em> <em>old</em> <em>tree</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s11">136</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(subst! <em>new</em> <em>old</em> <em>tree</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s11">136</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(substq <em>new</em> <em>old</em> <em>tree</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s11">136</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(substq! <em>new</em> <em>old</em> <em>tree</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s11">136</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(substring <em>string</em> <em>start</em> <em>end</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s224">t220</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(substring-fill! <em>string</em> <em>start</em> <em>end</em> <em>char</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s22">140</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(substv <em>new</em> <em>old</em> <em>tree</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s11">136</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(substv! <em>new</em> <em>old</em> <em>tree</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s11">136</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(subtract-duration <em>time</em> <em>time<sub>d</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s209">383</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(subtract-duration! <em>time</em> <em>time<sub>d</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s209">383</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>suppress-greeting</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">global param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s197">379</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(symbol-&gt;string <em>symbol</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s270">t242</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(symbol-hash <em>symbol</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s279">t245</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(symbol-hashtable-cell <em>hashtable</em> <em>key</em> <em>default</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s138">166</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(symbol-hashtable-contains? <em>hashtable</em> <em>key</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s136">165</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(symbol-hashtable-delete! <em>hashtable</em> <em>key</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s139">167</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(symbol-hashtable-ref <em>hashtable</em> <em>key</em> <em>default</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s135">165</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(symbol-hashtable-set! <em>hashtable</em> <em>key</em> <em>value</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s134">164</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(symbol-hashtable-update! <em>hashtable</em> <em>key</em> <em>procedure</em> <em>default</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s137">165</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(symbol-hashtable? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s133">164</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(symbol=? <em>symbol<sub>1</sub></em> <em>symbol<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s268">t242</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(symbol? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s22">t154</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(syntax <em>template</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s33">t300</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(syntax-&gt;annotation <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s69">320</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(syntax-&gt;datum <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s44">t308</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(syntax-&gt;list <em>syntax-object</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s6">295</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(syntax-&gt;vector <em>syntax-object</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s7">296</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(syntax-case <em>expr</em> (<em>literal</em> ...) <em>clause</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s30">t299</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(syntax-error <em>obj</em> <em>string</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s13">299</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(syntax-object-&gt;datum <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s8">296</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(syntax-rules (<em>literal</em> ...) <em>clause</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s4">295</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(syntax-rules (<em>literal</em> ...) <em>clause</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s14">t294</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(syntax-violation <em>who</em> <em>msg</em> <em>form</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s6">t359</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(syntax-violation <em>who</em> <em>msg</em> <em>form</em> <em>subform</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s6">t359</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(syntax-violation-form <em>condition</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s30">t370</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(syntax-violation-subform <em>condition</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s30">t370</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(syntax-violation? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s30">t370</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(system <em>command</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#foreign:s4">57</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(tan <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s131">t185</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(tanh <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#numeric:s76">211</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(textual-port-input-buffer <em>textual-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s16">219</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(textual-port-input-count <em>textual-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s18">220</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(textual-port-input-index <em>textual-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s16">219</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(textual-port-input-size <em>textual-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s16">219</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(textual-port-output-buffer <em>output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s20">221</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(textual-port-output-count <em>textual-output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s22">222</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(textual-port-output-index <em>output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s20">221</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(textual-port-output-size <em>output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s20">221</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(textual-port? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s45">t270</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(thread-condition? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s13">430</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(thread? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s3">428</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(threaded?)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s257">398</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(time <em>expr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s219">388</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(time-difference <em>time<sub>1</sub></em> <em>time<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s209">383</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(time-difference! <em>time<sub>1</sub></em> <em>time<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s209">383</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(time-nanosecond <em>time</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s205">382</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(time-second <em>time</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s205">382</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(time-type <em>time</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s205">382</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(time-utc-&gt;date <em>time</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s216">387</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(time-utc-&gt;date <em>time</em> <em>offset</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s216">387</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(time&lt;=? <em>time<sub>1</sub></em> <em>time<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s207">383</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(time&lt;? <em>time<sub>1</sub></em> <em>time<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s207">383</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(time=? <em>time<sub>1</sub></em> <em>time<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s207">383</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(time&gt;=? <em>time<sub>1</sub></em> <em>time<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s207">383</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(time&gt;? <em>time<sub>1</sub></em> <em>time<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s207">383</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(time? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s204">382</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>timer-interrupt-handler</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s24">330</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(top-level-bound? <em>symbol</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#binding:s30">118</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(top-level-bound? <em>symbol</em> <em>env</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#binding:s30">118</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(top-level-mutable? <em>symbol</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#binding:s31">119</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(top-level-mutable? <em>symbol</em> <em>env</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#binding:s31">119</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(top-level-program <em>imports</em> <em>body</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#libraries:s14">279</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(top-level-syntax <em>symbol</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#binding:s34">120</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(top-level-syntax <em>symbol</em> <em>env</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#binding:s34">120</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(top-level-syntax? <em>symbol</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#binding:s35">121</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(top-level-syntax? <em>symbol</em> <em>env</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#binding:s35">121</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(top-level-value <em>symbol</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#binding:s29">118</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(top-level-value <em>symbol</em> <em>env</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#binding:s29">118</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(trace <em>var<sub>1</sub></em> <em>var<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#debug:s9">36</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(trace)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#debug:s9">36</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(trace-case-lambda <em>name</em> <em>clause</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#debug:s3">34</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(trace-define <em>var</em> <em>expr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#debug:s14">38</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(trace-define (<em>var</em> . <em>idspec</em>) <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#debug:s14">38</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(trace-define-syntax <em>keyword</em> <em>expr</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#debug:s15">39</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(trace-do ((<em>var</em> <em>init</em> <em>update</em>) ...) (<em>test</em> <em>result</em> ...) <em>expr</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#debug:s7">35</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(trace-lambda <em>name</em> <em>formals</em> <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#debug:s0">33</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(trace-let <em>name</em> ((<em>var</em> <em>expr</em>) ...) <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#debug:s5">34</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>trace-output-port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#debug:s11">38</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>trace-print</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#debug:s12">38</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(transcoded-port <em>binary-port</em> <em>transcoder</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s47">t271</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(transcoder-codec <em>transcoder</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s20">t259</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(transcoder-eol-style <em>transcoder</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s20">t259</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(transcoder-error-handling-mode <em>transcoder</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s20">t259</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(transcoder? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s12">218</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(transcript-cafe <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s201">380</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(transcript-off)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s200">380</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(transcript-on <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s199">380</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(truncate <em>real</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s101">t177</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(truncate-file <em>output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s87">243</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(truncate-file <em>output-port</em> <em>pos</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s87">243</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(truncate-port <em>output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s87">243</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(truncate-port <em>output-port</em> <em>pos</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s87">243</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(type-descriptor <em>name</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s179">179</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(u8-list-&gt;bytevector <em>list</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s253">t232</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(uint-list-&gt;bytevector <em>list</em> <em>eness</em> <em>size</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s261">t239</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(unbox <em>box</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s83">150</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>undefined-variable-warnings</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s123">363</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(undefined-violation? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s31">t371</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(unget-char <em>textual-input-port</em> <em>char</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s65">234</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(unget-u8 <em>binary-input-port</em> <em>octet</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s66">235</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(unless <em>test-expr</em> <em>expr<sub>1</sub></em> <em>expr<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s17">t112</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(unlock-object <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#smgmt:s38">414</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(unquote <em>obj</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s5">t142</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(unquote-splicing <em>obj</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s5">t142</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(unread-char <em>char</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s65">234</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(unread-char <em>char</em> <em>textual-input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s65">234</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(unregister-guardian <em>guardian</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#smgmt:s32">412</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(unsyntax <em>template</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s40">t305</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(unsyntax-splicing <em>template</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s40">t305</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(untrace <em>var<sub>1</sub></em> <em>var<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#debug:s10">37</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(untrace)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#debug:s10">37</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(utf-16-codec)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s9">217</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(utf-16-codec <em>endianness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s9">217</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(utf-16-codec)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s22">t259</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(utf-16be-codec)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s9">217</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(utf-16le-codec)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s9">217</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(utf-8-codec)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s22">t259</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(utf16-&gt;string <em>bytevector</em> <em>endianness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s96">t288</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(utf16-&gt;string <em>bytevector</em> <em>endianness</em> <em>endianness-mandatory?</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s96">t288</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(utf32-&gt;string <em>bytevector</em> <em>endianness</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s96">t288</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(utf32-&gt;string <em>bytevector</em> <em>endianness</em> <em>endianness-mandatory?</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s96">t288</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(utf8-&gt;string <em>bytevector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s95">t287</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(values <em>obj</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s70">t131</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>variable</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#binding:s2">t91</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(vector <em>obj</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s231">t224</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(vector-&gt;immutable-vector <em>vector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s35">143</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(vector-&gt;list <em>vector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s237">t225</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(vector-cas! <em>vector</em> <em>n</em> <em>old-obj</em> <em>new-obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s33">142</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(vector-copy <em>vector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s31">141</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(vector-fill! <em>vector</em> <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s236">t225</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(vector-for-each <em>procedure</em> <em>vector<sub>1</sub></em> <em>vector<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s47">t122</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(vector-length <em>vector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s233">t224</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(vector-map <em>procedure</em> <em>vector<sub>1</sub></em> <em>vector<sub>1</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s44">t121</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(vector-ref <em>vector</em> <em>n</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s234">t224</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(vector-set! <em>vector</em> <em>n</em> <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s235">t225</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(vector-set-fixnum! <em>vector</em> <em>n</em> <em>fixnum</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s32">142</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(vector-sort <em>predicate</em> <em>vector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s239">t226</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(vector-sort! <em>predicate</em> <em>vector</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s239">t226</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(vector? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s21">t154</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(verify-loadability <em>situation</em> <em>input</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s50">339</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(violation? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s20">t366</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(virtual-register <em>k</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s253">397</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(virtual-register-count)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s251">397</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(visit <em>path</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s59">340</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(visit-compiled-from-port <em>input-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s57">339</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(void)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#objects:s112">157</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>waiter-prompt-and-read</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s175">376</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>waiter-prompt-string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s174">375</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>waiter-write</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s177">376</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(warning <em>who</em> <em>msg</em> <em>irritant</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s1">325</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(warning? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s23">t367</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(warningf <em>who</em> <em>msg</em> <em>irritant</em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s2">326</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(weak-cons <em>obj<sub>1</sub></em> <em>obj<sub>2</sub></em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#smgmt:s24">406</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(weak-pair? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#smgmt:s25">407</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(when <em>test-expr</em> <em>expr<sub>1</sub></em> <em>expr<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#control:s17">t112</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(who-condition? <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s26">t369</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(with ((<em>pat</em> <em>expr</em>) ...) <em>template</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#compat:s20">443</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(with-cost-center <em>cost-center</em> <em>thunk</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s243">393</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(with-cost-center <em>timed?</em> <em>cost-center</em> <em>thunk</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s243">393</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(with-exception-handler <em>procedure</em> <em>thunk</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#exceptions:s7">t360</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(with-implicit (<em>id<sub>0</sub></em> <em>id<sub>1</sub></em> ...) <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#syntax:s11">297</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(with-input-from-file <em>path</em> <em>thunk</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s59">231</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(with-input-from-file <em>path</em> <em>thunk</em> <em>options</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s59">231</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(with-input-from-file <em>path</em> <em>thunk</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s79">t283</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(with-input-from-string <em>string</em> <em>thunk</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s46">228</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(with-interrupts-disabled <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s27">331</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(with-mutex <em>mutex</em> <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#threads:s10">429</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(with-output-to-file <em>path</em> <em>thunk</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s79">240</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(with-output-to-file <em>path</em> <em>thunk</em> <em>options</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s79">240</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(with-output-to-file <em>path</em> <em>thunk</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s80">t283</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(with-output-to-string <em>thunk</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#io:s50">229</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(with-profile-tracker <em>thunk</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s150">370</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(with-profile-tracker <em>preserve-existing?</em> <em>thunk</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s150">370</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(with-source-path <em>who</em> <em>name</em> <em>procedure</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#system:s103">356</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(with-syntax ((<em>pattern</em> <em>expr</em>) ...) <em>body<sub>1</sub></em> <em>body<sub>2</sub></em> ...)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#syntax:s38">t304</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(write <em>obj</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s84">t284</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(write <em>obj</em> <em>textual-output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s84">t284</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(write-char <em>char</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s86">t285</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(write-char <em>char</em> <em>textual-output-port</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#io:s86">t285</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(zero? <em>num</em>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procedure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../the-scheme-programming-language-4th/en/index.html#objects:s93">t173</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="index">Index</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This index is a unified index for this book and <a href="../../the-scheme-programming-language-4th/en/index.html">The Scheme Programming Language, 4th Edition</a> (TSPL4). Page numbers prefixed by "t" refer the latter document. Italicized page numbers refer to the primary description of a syntactic form or procedure.</p>
</div>
<div class="paragraph">
<p>All page numbers appearing here refer to the printed version of these books and also serve as hypertext links to the corresponding locations in the electronic versions of these books.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_book_converting_tools">Appendix A: Book Converting Tools</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://asciidoctor.org/docs/user-manual/">Asciidoctor User Manual</a></p>
</li>
<li>
<p><a href="https://asciidoctor.org/docs/asciidoc-syntax-quick-reference/">AsciiDoc Syntax Quick Reference</a></p>
</li>
<li>
<p><a href="https://math.meta.stackexchange.com/questions/5020/mathjax-basic-tutorial-and-quick-reference">MathJax basic tutorial and quick reference</a></p>
</li>
<li>
<p><a href="https://www.whatsmyip.org/html-characters/">HTML Entities &amp; Special Characters</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_format_javascript_and_replacement_regex_for_the_original_book">Appendix B: Format Javascript and Replacement Regex for The Original Book</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Generate Bash Script for Creating Section Files<br></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="javascript" class="language-javascript hljs">var chapters = [];
document.querySelectorAll('a.toc').forEach(function(node) {
    var text = node.innerText;
    if (text.startsWith('Chapter ')) {
        chapters.push(text);
    }
});

chapters.map(function(chapter) {
    var index = chapter.replace(/^Chapter\s+(\d+)\..+/g, "$1");
    var name = chapter.replace(/.+\d+\.\s+(.+)/g, "$1").replace(/(\s|\/)+/g, "-").toLowerCase();
    var file = name + '.adoc';

    return [
        'touch ' + file,
        'echo -n \'\' > ' + file,
        'echo \'[#chp_' + index + ']\' >> ' + file,
        'echo \'== ' + chapter + '\' >> ' + file,
        'echo ' + ' >> ' + file,
        'echo ' + ' >> ' + file,
    ].join('\n');
}).join('\n\n');</code></pre>
</div>
</div>
</li>
<li>
<p>Generate Toc of the Book<br></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="javascript" class="language-javascript hljs">var chapters = [];
document.querySelectorAll('a.toc').forEach(function(node) {
    var text = node.innerText;
    if (text.startsWith('Chapter ')) {
        chapters.push(text);
    }
});

chapters.map(function(chapter) {
    var name = chapter.replace(/.+\d+\.\s+(.+)/g, "$1");
    var file = name.replace(/(\s|\/)+/g, "-").toLowerCase() + '.adoc';

    return [
        '// ' + name,
        'include::' + file + '[]',
    ].join('\n');
}).join('\n\n');</code></pre>
</div>
</div>
</li>
<li>
<p>Format Javascript<br></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="javascript" class="language-javascript hljs">// Format the content with AsciiDoc syntax
document.querySelectorAll('h3')
        .forEach(function(node) {
            var title=node.innerText;
            var anchor='section_'+title.replace(/^Section ([\d.]+) .+/, '$1');
            node.outerHTML = '=== ' + title + ' [['+anchor+']]';
        })
document.querySelectorAll('h4')
        .forEach(function(node) {
            var title=node.innerText;
            var anchor='exercise_'+title.replace(/^Exercise ([\d.]+)$/, '$1');
            node.outerHTML = '==== ' + title + ' [['+anchor+']]&lt;br&gt;&lt;br&gt;';
        })
document.querySelectorAll('[src="math/csug/0.gif"]')
        .forEach(function(node) { node.outerHTML = '⇒' })
document.querySelectorAll('i')
        .forEach(function(node) { node.innerHTML = '_'+node.innerHTML+'_' })
document.querySelectorAll('li')
        .forEach(function(node) { node.innerHTML = '- '+node.innerHTML })
document.querySelectorAll('sub')
        .forEach(function(node) { node.outerHTML = '~'+node.innerText+'~' })
document.querySelectorAll('sup')
        .forEach(function(node) { node.outerHTML = '^'+node.innerText+'^' })
document.querySelectorAll('b')
        .forEach(function(node) { node.innerHTML = '*'+node.innerHTML+'*' })
document.querySelectorAll('tt').forEach(function(node) {
    if (node.parentNode.nodeName.toLowerCase() == 'p' && node.innerText == node.parentNode.innerText) {
        node.innerHTML = '[source,scheme,subs="quotes"]&lt;br&gt;----&lt;br&gt;'+node.innerHTML+'&lt;br&gt;----&lt;br&gt;';
    } else {
        node.innerHTML = '`'+node.innerHTML+'`';
    }
})

document.querySelectorAll('tbody').forEach(function(node) {
    node.innerHTML = '[%autowidth,grid=none,frame=none]&lt;br&gt;|===&lt;br&gt;&lt;br&gt;'+node.innerHTML+'&lt;br&gt;|===&lt;br&gt;';

    node.querySelectorAll('td').forEach(function(td) {
        td.innerHTML = '|' + td.innerHTML + ' ';
    });
})

document.querySelectorAll('a')
        .forEach(function(node) {
            var name=node.name;
            if (name && name.match(/^\.\/(.+)$/)) {
                node.outerHTML='[#'+(name.replace(/^\.\/(.+)$/, '$1'))+']&lt;br&gt;';
            }
        })
document.querySelectorAll('a')
        .forEach(function(node) {
            var name=node.name;
            if (node.previousSibling
                && node.previousSibling.nodeName.toLowerCase() == '#text') {
                return;
            }
            if (name && name.match(/^[^#.\/]+$/)) {
                node.outerHTML='[#'+name+']&lt;br&gt;';
            }
        })
document.querySelectorAll('a.citation')
        .forEach(function(node) {
            var text = node.innerText;
            node.innerText = '&lt;&lt;ref' + text + '&gt;&gt;';
        })

// Highlight the code blocks and italic text
document.querySelectorAll('tt')
        .forEach(function(node) {
            node.style='font-size: 2em; border-bottom: 1px solid grey;'
        })
document.querySelectorAll('i')
        .forEach(function(node) {
            node.style='font-size: 2em; border-right: 1px solid red;'
        })

// JavaScript for generating the page links in the section [Summary of Forms]
document.querySelectorAll('a').forEach(function(node) {
    var href = node.href;
    var text = node.innerText;
    var anchor = href.replace(/.*#\.\//g, "");
    if (href.startsWith('http://scheme.com/tspl4/')) {
        node.innerText = 'link:../../the-scheme-programming-language-4th/en/index.html#' + anchor + '[' + text + ']';
    } else {
        node.innerText = '&lt;&lt;' + anchor + ',' + text + '&gt;&gt;';
    }
})</code></pre>
</div>
</div>
</li>
<li>
<p>Replacement Regex<br></p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Regex</th>
<th class="tableblock halign-left valign-top">Replacement</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>\[(&lt;&lt;ref\d+&gt;&gt;)\]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(^|\(|[^=]\s+)Chapter\s+(\d+)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$1&lt;&lt;chp_$2,Chapter $2&gt;&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(^|\(|[^=]\s+)Section\s+([\d\.]+\d)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$1&lt;&lt;section_$2.,Section $2&gt;&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(^|\(|[^=]\s+)Exercise\s+([\d\.]+\d)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$1&lt;&lt;exercise_$2,Exercise $2&gt;&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Sections\s+([\d\.]+)\s+and\s+([\d\.]+)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Sections &lt;&lt;section_$1.,$1&gt;&gt; and &lt;&lt;section_$2.,$2&gt;&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>`[^`]*\(\([^`]+\)\)[^`]*`</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add slash to the first double brackets</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>`([^`]*\s+)(\.\.\.)([^`]*)`</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add slash to the head of ... : <code>`$1\\$2$3`</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>`([^\\`]*)(-&gt;|=&gt;|&lt;=)([^`]*)`</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add slash to the head of -&gt;, =&gt; or &lt;= : <code>`$1\\$2$3`</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(^$|^\[.+\])\n([\w\s]+::)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$1\n[horizontal]\n$2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#&lt;([^&lt;&gt;]+)&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#&amp;lt;$1&amp;gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"(`[^`"]+`)"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>++"++$1++"++</code></p></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Check the lost links<br></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="javascript" class="language-javascript hljs">var lostAnchors=[];
document.querySelector('#content')
        .querySelectorAll('a[href^="#"]')
        .forEach(function(node) {
            var anchor = node.getAttribute('href');

            if (!document.querySelector('[id="' + anchor.replace(/^#/, '') + '"]')) {
                lostAnchors.push(anchor);
            }
        });
console.log(lostAnchors.join('\n'));</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<link rel="stylesheet" href="../../theme/js/highlight/styles/github.min.css">
<script src="../../theme/js/highlight/highlight.min.js"></script>
<script src="../../theme/js/highlight/languages/scheme.min.js"></script>
<script src="../../theme/js/highlight/languages/bash.min.js"></script>
<script src="../../theme/js/highlight/languages/javascript.min.js"></script>
<script>hljs.initHighlighting()</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains('stemblock')) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="../../theme/js/mathjax/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>